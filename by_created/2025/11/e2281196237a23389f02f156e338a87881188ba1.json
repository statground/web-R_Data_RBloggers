{
  "id": "e2281196237a23389f02f156e338a87881188ba1",
  "url": "https://www.r-bloggers.com/2025/09/building-dna-sequence-alignment-with-needleman-wunsch-algorithm-from-scratch-a-note-to-my-self/",
  "created_at_utc": "2025-11-22T19:57:43Z",
  "data": null,
  "raw_original": {
    "uuid": "0ce4b701-3ced-4496-93c1-e03cbc68edab",
    "created_at": "2025-11-22 19:57:43",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2025/09/building-dna-sequence-alignment-with-needleman-wunsch-algorithm-from-scratch-a-note-to-my-self/",
      "crawled_at": "2025-11-22T10:43:12.723599",
      "external_links": [
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/",
          "text": "r on Everyday Is A School Day"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#motivations",
          "text": null
        },
        {
          "href": "https://www.kenkoonwong.com/blog/amr/",
          "text": "detecting AMR genes"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/phylo/",
          "text": "phylogenetic analysis workflow"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#disclaimer",
          "text": null
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#objectives",
          "text": null
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#alignment",
          "text": "What is Alignment"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#method",
          "text": "What method can be used for Alignment?"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#example",
          "text": "Let‚Äôs work through an example"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#step1",
          "text": "Step 1: Set Up Scores"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#step2",
          "text": "Step 2: Calculate Scoring Matrix"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#step3",
          "text": "Step 3: Traceback To Find Optimal Alingment"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#more",
          "text": "Let‚Äôs Try Our Code With More Examples"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#opportunity",
          "text": "Opportunity for improvement"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#lessons",
          "text": "Lessons Learnt"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#alignment",
          "text": null
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#method",
          "text": null
        },
        {
          "href": "https://en.wikipedia.org/wiki/Needleman%E2%80%93Wunsch_algorithm",
          "text": "Needleman-Wunsch"
        },
        {
          "href": "https://en.wikipedia.org/wiki/Sequence_alignment",
          "text": "source"
        },
        {
          "href": "https://en.wikipedia.org/wiki/Needleman%E2%80%93Wunsch_algorithm",
          "text": "Needleman-Wunsch"
        },
        {
          "href": "https://www.youtube.com/watch?v=b6xBvl0yPAY&themeRefresh=1",
          "text": "youtube tutorial by Professor Hendrix"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#example",
          "text": null
        },
        {
          "href": "https://www.youtube.com/watch?v=b6xBvl0yPAY&themeRefresh=1",
          "text": "youtube tutorial by Professor Hendrix"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#step1",
          "text": null
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#step2",
          "text": null
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#step3",
          "text": null
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#more",
          "text": null
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#final-thoughts",
          "text": null
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#opportunity",
          "text": null
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/#lessons",
          "text": null
        },
        {
          "href": "https://www.kenkoonwong.com/blog/",
          "text": "comment or visit my other blogs"
        },
        {
          "href": "https://bsky.app/profile/kenkoonwong.bsky.social",
          "text": "BlueSky"
        },
        {
          "href": "https://twitter.com/kenkoonwong/",
          "text": "twitter"
        },
        {
          "href": "https://github.com/kenkoonwong/",
          "text": "GitHub"
        },
        {
          "href": "https://med-mastodon.com/@kenkoonwong",
          "text": "Mastodon"
        },
        {
          "href": "https://www.kenkoonwong.com/contact/",
          "text": "contact me"
        },
        {
          "href": "https://www.kenkoonwong.com/blog/dynamic-programming/",
          "text": "r on Everyday Is A School Day"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Building DNA Sequence Alignment With Needleman-Wunsch Algorithm From Scratch ‚Äì A Note To My Self | R-bloggers",
      "images": [
        {
          "alt": "image",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image",
          "base64": null,
          "src": "https://i2.wp.com/www.kenkoonwong.com/blog/dynamic-programming/endinmind.png?w=10%25&ssl=1"
        },
        {
          "alt": "image",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image",
          "base64": null,
          "src": "https://i2.wp.com/www.kenkoonwong.com/blog/dynamic-programming/scoring_mat.png?w=30%25&ssl=1"
        },
        {
          "alt": "image",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image",
          "base64": null,
          "src": "https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/scoring_mat_empty.png?w=30%25&ssl=1"
        },
        {
          "alt": "image",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image",
          "base64": null,
          "src": "https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/scoring_mat_step.png?w=450&ssl=1"
        },
        {
          "alt": "image",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image",
          "base64": null,
          "src": "https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/scoring_mat_filled.png?w=30%25&ssl=1"
        },
        {
          "alt": "image",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image",
          "base64": null,
          "src": "https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/trace_back.png?w=450&ssl=1"
        },
        {
          "alt": "image",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image",
          "base64": null,
          "src": "https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example1.png?w=60%25&ssl=1"
        },
        {
          "alt": "image",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image",
          "base64": null,
          "src": "https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example2.png?w=60%25&ssl=1"
        },
        {
          "alt": "image",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image",
          "base64": null,
          "src": "https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example3.png?w=60%25&ssl=1"
        },
        {
          "alt": "image",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image",
          "base64": null,
          "src": "https://i2.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example4.png?w=450&ssl=1"
        },
        {
          "alt": "image",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image",
          "base64": null,
          "src": "https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example5.png?w=60%25&ssl=1"
        },
        {
          "alt": "image",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image",
          "base64": null,
          "src": "https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/ecoli1.png?w=450&ssl=1"
        },
        {
          "alt": "image",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image",
          "base64": null,
          "src": "https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/ecoli2.png?w=40%25&ssl=1"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/r-on-everyday-is-a-school-day/",
          "text": "r on Everyday Is A School Day"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-395266 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Building DNA Sequence Alignment With Needleman-Wunsch Algorithm From Scratch ‚Äì A Note To My Self</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">September 6, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/r-on-everyday-is-a-school-day/\">r on Everyday Is A School Day</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/\"> r on Everyday Is A School Day</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47--><blockquote>\n<p>Ever wondered how DNA alignment actually works under the hood? üß¨ We coded the Needleman-Wunsch algorithm from scratch, working through scoring matrices by hand with simple examples like ‚ÄúCAT‚Äù vs ‚ÄúCT‚Äù before testing on real E. coli sequences. Pretty neat to see the magic happen! ‚ú®</p>\n</blockquote>\n<h2 id=\"motivations\">Motivations\n  <a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#motivations\" rel=\"nofollow\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"anchor-symbol\" height=\"26\" viewbox=\"0 0 22 22\" width=\"26\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M0 0h24v24H0z\" fill=\"currentColor\"></path>\n<path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z\"></path>\n</svg></a>\n</h2>\n<p>We‚Äôve looked at \n<a href=\"https://www.kenkoonwong.com/blog/amr/\" rel=\"nofollow\" target=\"_blank\">detecting AMR genes</a> and \n<a href=\"https://www.kenkoonwong.com/blog/phylo/\" rel=\"nofollow\" target=\"_blank\">phylogenetic analysis workflow</a> previously. As we like to look under the hood to see how things work, today, let‚Äôs look at how the alignment actually works.</p>\n<h4 id=\"disclaimer\">Disclaimer:\n  <a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#disclaimer\" rel=\"nofollow\" target=\"_blank\"></a>\n</h4>\n<p><em>I am not a bioinformatician and do not work with genes directly, the articles and method presented is my attempt to get a better understanding on the method behind the aligment. Please take this with a grain of salt. Verify the information presented. If you noted some error in this article, please let me know so that I can learn! Also, these codes were not run during rmarkdown knitting because of significant delay for each knitting, however, the results posted here should be reprodicuble. Please again let me know if they are not</em></p>\n<h2 id=\"objectives\">Objectives\n  <a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#objectives\" rel=\"nofollow\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"anchor-symbol\" height=\"26\" viewbox=\"0 0 22 22\" width=\"26\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M0 0h24v24H0z\" fill=\"currentColor\"></path>\n<path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z\"></path>\n</svg></a>\n</h2>\n<ul>\n<li>\n<a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#alignment\" rel=\"nofollow\" target=\"_blank\">What is Alignment</a></li>\n<li>\n<a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#method\" rel=\"nofollow\" target=\"_blank\">What method can be used for Alignment?</a></li>\n<li>\n<a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#example\" rel=\"nofollow\" target=\"_blank\">Let‚Äôs work through an example</a>\n<ul>\n<li>\n<a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#step1\" rel=\"nofollow\" target=\"_blank\">Step 1: Set Up Scores</a></li>\n<li>\n<a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#step2\" rel=\"nofollow\" target=\"_blank\">Step 2: Calculate Scoring Matrix</a></li>\n<li>\n<a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#step3\" rel=\"nofollow\" target=\"_blank\">Step 3: Traceback To Find Optimal Alingment</a></li>\n</ul>\n</li>\n<li>\n<a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#more\" rel=\"nofollow\" target=\"_blank\">Let‚Äôs Try Our Code With More Examples</a></li>\n<li>\n<a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#opportunity\" rel=\"nofollow\" target=\"_blank\">Opportunity for improvement</a></li>\n<li>\n<a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#lessons\" rel=\"nofollow\" target=\"_blank\">Lessons Learnt</a></li>\n</ul>\n<h2 id=\"alignment\">What Is Alignment?\n  <a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#alignment\" rel=\"nofollow\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"anchor-symbol\" height=\"26\" viewbox=\"0 0 22 22\" width=\"26\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M0 0h24v24H0z\" fill=\"currentColor\"></path>\n<path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z\"></path>\n</svg></a>\n</h2>\n<p>Sequence alignment is a fundamental technique in bioinformatics that arranges two or more biological sequences (like DNA, RNA, or protein sequences) to identify regions of similarity and difference. By introducing gaps represented by dashes, alignment algorithms position corresponding characters from different sequences in the same columns, revealing evolutionary relationships, functional similarities, and structural conservation. For example, aligning ‚ÄúCCCCCGGGGG‚Äù with ‚ÄúCCCGGG‚Äù might show that the shorter sequence is missing certain bases but shares a common core with the longer one.</p>\n<h2 id=\"method\">What Method Can Be Used For Alignment?\n  <a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#method\" rel=\"nofollow\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"anchor-symbol\" height=\"26\" viewbox=\"0 0 22 22\" width=\"26\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M0 0h24v24H0z\" fill=\"currentColor\"></path>\n<path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z\"></path>\n</svg></a>\n</h2>\n<p>Sequence alignment methods include dynamic programming algorithms like \n<a href=\"https://en.wikipedia.org/wiki/Needleman%E2%80%93Wunsch_algorithm\" rel=\"nofollow\" target=\"_blank\">Needleman-Wunsch</a> (global) and Smith-Waterman (local) that provide optimal but slow results, fast heuristic methods like BLAST and FASTA for database searching, progressive approaches like ClustalW for multiple sequences, and specialized techniques including dot-matrix visualization, structural alignment using 3D protein information, and profile-based methods with hidden Markov models. \n<a href=\"https://en.wikipedia.org/wiki/Sequence_alignment\" rel=\"nofollow\" target=\"_blank\">source</a></p>\n<p>Global alignment method such as \n<a href=\"https://en.wikipedia.org/wiki/Needleman%E2%80%93Wunsch_algorithm\" rel=\"nofollow\" target=\"_blank\"><code>Needleman-Wunsch</code></a> should be a good one to learn from scratch with dynamic programming. This \n<a href=\"https://www.youtube.com/watch?v=b6xBvl0yPAY&amp;themeRefresh=1\" rel=\"nofollow\" target=\"_blank\">youtube tutorial by Professor Hendrix</a> is very helpful in creating <code>scoring matrix</code>, <code>traceback matrix</code> and <code>optimal alignment</code>.</p>\n<h2 id=\"example\">Let‚Äôs Work Through An Example\n  <a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#example\" rel=\"nofollow\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"anchor-symbol\" height=\"26\" viewbox=\"0 0 22 22\" width=\"26\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M0 0h24v24H0z\" fill=\"currentColor\"></path>\n<path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z\"></path>\n</svg></a>\n</h2>\n<p>What we‚Äôll do here is we‚Äôll go through a simple example by hand, then write code that reresents that. I wouldn‚Äôt be surprised if some of these are confusing, because they are, and it took me quite a few days working on paper to follow the procedure. If you find it confusing, please look at \n<a href=\"https://www.youtube.com/watch?v=b6xBvl0yPAY&amp;themeRefresh=1\" rel=\"nofollow\" target=\"_blank\">youtube tutorial by Professor Hendrix</a>, I found it very helpful.</p>\n<p>Let‚Äôs set an example. We have 2 very simple sequences and having the end in mind will be beneficial IMO.</p>\n<p align=\"center\">\n<img alt=\"image\" data-lazy-src=\"https://i2.wp.com/www.kenkoonwong.com/blog/dynamic-programming/endinmind.png?w=10%25&amp;ssl=1\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://i2.wp.com/www.kenkoonwong.com/blog/dynamic-programming/endinmind.png?w=10%25&amp;ssl=1\"/></noscript>\n</p>\n<p>As you can see above, we have 2 sequences. The first row is <code>CAT</code>, and the second row is <code>CT</code>. The <code>-</code> is what we call a <code>gap</code>. If the algorithm works, we will see the dynamic programming do its magic and automatically insert a gap on our second sequence</p>\n<h3 id=\"step1\">Step 1: Set Up Scores\n  <a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#step1\" rel=\"nofollow\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"anchor-symbol\" height=\"26\" viewbox=\"0 0 22 22\" width=\"26\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M0 0h24v24H0z\" fill=\"currentColor\"></path>\n<path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z\"></path>\n</svg></a>\n</h3>\n<center>\n<p>Match = +2</p>\n<p>Mismatch = -1</p>\n<p>Gap = -2</p>\n</center>\n<p>What the above mean is that, when we compare our first and second sequence for element, we will use these score to form our scoring matrix below. For example, if it‚Äôs a match (e.g. <code>A-A</code>), we will <code>+2</code> from a diagonal score. If it‚Äôs a mismatch, we will <code>-1</code> from diagonal score. Then we will just <code>-2</code> for the score above and on the left. Confusing? I‚Äôm with you. See below example for better visual procedure.</p>\n<h3 id=\"step2\">Step 2: Calculate Scoring Matrix\n  <a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#step2\" rel=\"nofollow\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"anchor-symbol\" height=\"26\" viewbox=\"0 0 22 22\" width=\"26\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M0 0h24v24H0z\" fill=\"currentColor\"></path>\n<path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z\"></path>\n</svg></a>\n</h3>\n<p>Having the end in mind, we should have this scoring matrix for our above sequences.</p>\n<p align=\"center\">\n<img alt=\"image\" data-lazy-src=\"https://i2.wp.com/www.kenkoonwong.com/blog/dynamic-programming/scoring_mat.png?w=30%25&amp;ssl=1\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://i2.wp.com/www.kenkoonwong.com/blog/dynamic-programming/scoring_mat.png?w=30%25&amp;ssl=1\"/></noscript>\n</p>\n<p>But of course, when we first begin, we will have an empty matrix, like so.</p>\n<p align=\"center\">\n<img alt=\"image\" data-lazy-src=\"https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/scoring_mat_empty.png?w=30%25&amp;ssl=1\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/scoring_mat_empty.png?w=30%25&amp;ssl=1\"/></noscript>\n</p>\n<p>Let‚Äôs view the steps all at a time, like so.</p>\n<p align=\"center\">\n<img alt=\"image\" data-lazy-src=\"https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/scoring_mat_step.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/scoring_mat_step.png?w=450&amp;ssl=1\"/></noscript>\n</p>\n<p>Notice that the <code>matrix[1,1]</code> is always <code>0</code> and we name the column and row as <code>.</code>. Then, we fill <code>matrix[1,1:3]</code> with cumulative <code>-2</code>. Same goes to <code>matrix[1:4,1]</code>. Then, we start filling our first score on <code>matrix[2,2]</code> by finding the <code>maximum</code> of 3 calculations (<code>diagonal</code>, <code>up</code>, <code>left</code>), see picture for actual calculation above. To be explicit, for <code>matrix[2,2]</code>, we first assess if <code>column name</code> and <code>row name</code> of <code>matrix[2,2]</code> is a match or a mismatch. What do you think? <code>Matrix[2,2]</code> is <code>C-C</code>, hence a match! On diagonal (meaning <code>matrix[1,1]</code>), we all use <code>matrix[1,1]</code> score and <code>+2</code>. For the one above (up) <code>matrix[1,2]</code>, we will <code>-2</code>. Same goes with left <code>matrix[2,1]</code>, we will <code>-2</code>, since these are gaps. One thing that got me really confused are these ups and lefts. But remember, we will ALWAYS use these score and subtract by our gap penalty (in our case <code>-2</code>). After all these calculation, the max of these 3 (diag, up, left) is 2, which is from diag. Hence <code>matrix[2,2]</code> is <code>2</code>. Then, we‚Äôll move next to <code>matrix[3,2]</code> etc.</p>\n<details>\n<summary>Code: click to expand</summary>\n<pre>nrow &lt;- nchar(seq1)+1\nncol &lt;- nchar(seq2)+1\n\nmat &lt;- matrix(nrow = nrow, ncol = ncol, dimnames = list(c(\".\",str_split_1(seq1,\"\")),c(\".\",str_split_1(seq2,\"\"))))\n                                                  \n# gap penalty\nmat[1,1:ncol] &lt;- seq(0,-2*(ncol-1),-2)\nmat[1:nrow,1] &lt;- seq(0,-2*(nrow-1),-2)\n\n# calc score\ncolname &lt;- colnames(mat)\nrowname &lt;- rownames(mat)\n\nrow_list &lt;- 2:nrow\ncol_list &lt;- 2:ncol\n\nfor (i in row_list) {\n  for (j in col_list) {\nsame &lt;- ifelse(rowname[i]==colname[j], T, F)\n\n## calc diag\nif (same) {\n  score_diag &lt;- mat[i-1,j-1] + 2\n} else {\n  score_diag &lt;- mat[i-1,j-1] - 1\n}\n\n## calc up\nscore_up &lt;- mat[i-1,j] - 2 \n\n## calc left\nscore_left &lt;- mat[i,j-1] - 2\n\nscore_i &lt;- max(score_diag, score_up, score_left)\n\nmat[i,j] &lt;- score_i\n# print(mat)\n\n  }\n}\n</pre></details>\n<h3 id=\"step3\">Step 3: Traceback To Get Optimal Alignment\n  <a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#step3\" rel=\"nofollow\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"anchor-symbol\" height=\"26\" viewbox=\"0 0 22 22\" width=\"26\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M0 0h24v24H0z\" fill=\"currentColor\"></path>\n<path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z\"></path>\n</svg></a>\n</h3>\n<p>Alright, our final scoring matrix is as such.</p>\n<p align=\"center\">\n<img alt=\"image\" data-lazy-src=\"https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/scoring_mat_filled.png?w=30%25&amp;ssl=1\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/scoring_mat_filled.png?w=30%25&amp;ssl=1\"/></noscript>\n</p>\n<p>We first start at the bottom right grid, then follow the maximum score grid like so.</p>\n<p align=\"center\">\n<img alt=\"image\" data-lazy-src=\"https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/trace_back.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/trace_back.png?w=450&amp;ssl=1\"/></noscript>\n</p>\n<p>So, we first start off with bottom right grid. First assess if the column name and row name is the same, in this case it is, hence we align them up<code>T-T</code>. Next, we look at <code>diag</code>, <code>up</code>, and <code>left</code> and see which is the <code>maximum</code>. In this case, <code>1</code> is the highest, hence we move <code>up</code>. When we move <code>up</code>, it means, the <code>row name</code> persists while we place a <code>gap</code> on column name for our alignment. This took me a while to get the intuition, but notice that there is one row index reduction but the column index remains the same. That‚Äôs why we insert a <code>gap</code> on our new column name sequence. Next, you do the same thing, and the max is the move diagonally to <code>matrix[2,2]</code>, and since the column namd and row name are the same <code>C-C</code>, we align them as such.</p>\n<p>There you go! That‚Äôs the basics of Needleman-Wunsch Algorithm! üôå</p>\n<details>\n<summary>click to expand</summary>\n<pre>library(tidyverse)\nlibrary(Biostrings)\n\n\nken_tedious_alignment &lt;- function(seq1,seq2) {\n{\nnrow &lt;- nchar(seq1)+1\nncol &lt;- nchar(seq2)+1\n\nmat &lt;- matrix(nrow = nrow, ncol = ncol, dimnames = list(c(\".\",str_split_1(seq1,\"\")),c(\".\",str_split_1(seq2,\"\"))))\n                                                  \n# gap penalty\nmat[1,1:ncol] &lt;- seq(0,-2*(ncol-1),-2)\nmat[1:nrow,1] &lt;- seq(0,-2*(nrow-1),-2)\n\n# calc score\ncolname &lt;- colnames(mat)\nrowname &lt;- rownames(mat)\n\nrow_list &lt;- 2:nrow\ncol_list &lt;- 2:ncol\n\nfor (i in row_list) {\n  for (j in col_list) {\nsame &lt;- ifelse(rowname[i]==colname[j], T, F)\n\n## calc diag\nif (same) {\n  score_diag &lt;- mat[i-1,j-1] + 2\n} else {\n  score_diag &lt;- mat[i-1,j-1] - 1\n}\n\n## calc up\nscore_up &lt;- mat[i-1,j] - 2 \n\n## calc left\nscore_left &lt;- mat[i,j-1] - 2\n\nscore_i &lt;- max(score_diag, score_up, score_left)\n\nmat[i,j] &lt;- score_i\n# print(mat)\n\n  }\n}\n\n\n}\n\n\n## now walk back - start where?\n{\nrow_i &lt;- nrow\ncol_i &lt;- ncol\n\nseq_instruct &lt;- c()\nsame &lt;- F\n\nfor (repeat_i in 1:(nrow-1)) {\n  # print(paste(\"row: \",rowname[row_i],\" \",row_i, \" col: \",colname[col_i],\" \",col_i))\nif (colname[col_i]==rowname[row_i]) { \n  same &lt;- T \n  \n} else { same &lt;- F }\n# print(same)\n  \n\nif (is.null(seq_instruct)) { \n  if (same) {\n  seq_instruct &lt;- c(seq_instruct, \"S\")\n  next}\n  if (!same &amp;&amp; (nrow&gt;ncol)) {\n    seq_instruct &lt;- c(seq_instruct, \"A\")\n  }\n  if (!same &amp;&amp; (ncol&gt;nrow)) {\n    seq_instruct &lt;- c(seq_instruct, \"-\")\n    # print(\"ncol&gt;nrow\")\n  }\n  # print(\"this should only show once\")\n  } \n\n## find max \ndiag &lt;- mat[row_i-1,col_i-1] #1\nup &lt;- mat[row_i-1,col_i] #2\nleft &lt;- mat[row_i, col_i-1] #3\n\n# print(seq_instruct)\n\nmax_score &lt;- max(diag,up,left)\nmax_score_location &lt;- which(c(diag,up,left) == max_score)\n# print(max_score_location)\nif (length(max_score_location) &gt; 1) { max_score_location &lt;- sample(max_score_location, 1) }\n\n## match and find location for new start\nif (max_score_location==1) { \n  row_i &lt;- row_i - 1\n  col_i &lt;- col_i - 1\n  # seq_instruct &lt;- c(seq_instruct, \"S\")\n  } \nif (max_score_location==2) {\n  row_i &lt;- row_i - 1\n  # seq_instruct &lt;- c(seq_instruct, \"A\")\n} \nif (max_score_location==3) {\n  col_i &lt;- col_i - 1\n  # seq_instruct &lt;- c(seq_instruct, \"-\")\n}\n\nif (repeat_i!=1) {\n  if (max_score_location==1) { seq_instruct &lt;- c(seq_instruct, \"S\") }\n  if (max_score_location==2) { seq_instruct &lt;- c(seq_instruct, \"A\") }\n  if (max_score_location==3) { seq_instruct &lt;- c(seq_instruct, \"-\") }\n}\n# print(seq_instruct)\n}\nprint(mat)\n}\n\n\n\n## turn instruction back to sequence\n{\n# seq_instruct\n# max_length &lt;- max(nrow-1,ncol-1)\nseq1_align &lt;- seq2_align &lt;- vector(mode = \"character\", length=length(seq_instruct))\nmax_i &lt;- length(seq_instruct)\ni &lt;- nrow\nj &lt;- ncol\n\nfor (count in 1:length(seq_instruct)) {\n    if (seq_instruct[count]==\"S\") {\n      seq1_align[max_i] &lt;- rowname[i]\n      seq2_align[max_i] &lt;- colname[j]\n      i &lt;- i - 1\n      j &lt;- j - 1\n    }\n    if (seq_instruct[count]==\"A\") {\n      seq1_align[max_i] &lt;- rowname[i]\n      seq2_align[max_i] &lt;- \"-\"\n      i &lt;- i - 1\n    }\n    if (seq_instruct[count]==\"-\") {\n      seq1_align[max_i] &lt;- \"-\"\n      seq2_align[max_i] &lt;- colname[j]\n      j &lt;- j -1\n    }\n    max_i &lt;- max_i - 1\n}\n}\n  tryCatch(expr = {\n  print(DNAString(seq1_align |&gt; paste(collapse=\"\")))\n  print(DNAString(seq2_align |&gt; paste(collapse=\"\"))) \n  return(list(seq1_align, seq2_align))}\n  , error=function(e) {\n    print(seq1_align)\n    print(seq2_align)}\n  )\n}\n\n\n\n## Some examples, uncomment to try\n# seq1 &lt;- \"dogcathorse\"\n# seq2 &lt;- \"dogcthrs\"\n# \n# seq1 &lt;- \"CCAGCCAGGACTACGTAAGTCA\"\n# seq2 &lt;- \"CCGCGGACTCGTATCA\"\n# ken_ted ious_alignment(seq1,seq2)\n</pre></details>\n<h2 id=\"more\">Let‚Äôs Try Our Code With More Sequences\n  <a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#more\" rel=\"nofollow\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"anchor-symbol\" height=\"26\" viewbox=\"0 0 22 22\" width=\"26\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M0 0h24v24H0z\" fill=\"currentColor\"></path>\n<path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z\"></path>\n</svg></a>\n</h2>\n<pre>seq1 &lt;- \"CCAGCCAGGACTACGTAAGTCA\"\nseq2 &lt;- \"CCGCGGACTCGTATCA\"\nken_tedious_alignment(seq1,seq2)\n</pre><p align=\"center\">\n<img alt=\"image\" data-lazy-src=\"https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example1.png?w=60%25&amp;ssl=1\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example1.png?w=60%25&amp;ssl=1\"/></noscript>\n</p>\n<p>The first example with longer sequence. Not bad. Looks like it works.</p>\n<pre>seq1 &lt;- \"AAATCCATATGCCACAGA\"\nseq2 &lt;- \"AATTCGATCCATATATTTGCCAAATTCCAGA\"\nken_tedious_alignment(seq1,seq2)\n</pre><p align=\"center\">\n<img alt=\"image\" data-lazy-src=\"https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example2.png?w=60%25&amp;ssl=1\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example2.png?w=60%25&amp;ssl=1\"/></noscript>\n</p>\n<p>Second example, we made seq1 shorter. Not bad too! It works!</p>\n<pre>seq1 &lt;- \"GATATAGCGGGTTTAACCGTTAAA\"\nseq2 &lt;- \"GATATAGCGGGTTTAACCGTT\"\nken_tedious_alignment(seq1,seq2)\n</pre><p align=\"center\">\n<img alt=\"image\" data-lazy-src=\"https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example3.png?w=60%25&amp;ssl=1\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example3.png?w=60%25&amp;ssl=1\"/></noscript>\n</p>\n<p>Thirds example, we want to make sure we can have gaps towards the end. Yes, it works too!</p>\n<pre>seq1 &lt;- \"dogcathorse\"\nseq2 &lt;- \"dgcthrs\"\nken_tedious_alignment(seq1,seq2)\n</pre><p align=\"center\">\n<img alt=\"image\" data-lazy-src=\"https://i2.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example4.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://i2.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example4.png?w=450&amp;ssl=1\"/></noscript>\n</p>\n<p>Let‚Äôs try just regular words and see if it works? Yes it does!</p>\n<p>Now, here are a few examples that don‚Äôt quite work that might be a good opportunity to debug</p>\n<pre>seq1 &lt;- \"GATATAGCGGGTTTAACCGTTAAA\"\nseq2 &lt;- \"AGCGGGTTTAACCGTT\"\nken_tedious_alignment(seq1,seq2)\n</pre><p align=\"center\">\n<img alt=\"image\" data-lazy-src=\"https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example5.png?w=60%25&amp;ssl=1\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://i0.wp.com/www.kenkoonwong.com/blog/dynamic-programming/example5.png?w=60%25&amp;ssl=1\"/></noscript>\n</p>\n<p>Yea, that looks really wrong. üòë Might be good to debug some other time! Now since the above sequences were just letters and randomly entered, let‚Äôs check 2 Ecoli 16s rRNA sequences.</p>\n<pre>seq1 &lt;- \"TTGAAGAGTTTGATCATGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAACGGTAACAGAAAGCAGCTTGCTGCTTTGCTGACGAGTGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAACGTCGCAAGACCAAAGAGGGGGACCTTCGGGCCTCTTGCCATCGGATGTGCCCAGATGGGATTAGCTTGTTGGTGGGGTAACGGCTCACCAAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGGAGTAAAGTTAATACCTTTACTCATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGCAGCCGCGGTAATACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGCACGCAGGCGGTTTGTTAAGTCAGATGTGAAATCCCCGGGCTCAACCTGGGAACTGCATCTGATACTGGCAAGCTTGAGTCTCGTAGAGGGGGGTAGAATTCCAGGTGTAGCGGTGAAATGCGTAGAGATCTGGAGGAATACCGGTGGCGAAGGCGGCCCCCTGGACGAAGACTGACGCTCAGGTGCGAAAGCGTGGGGAGCAAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGTCGACTTGGAGGTTGTGCCCTTGAGGCGTGGCTTCCGGAGCTAACGCGTTAAGTCGACCGCCTGGGGAGTACGGCCGCAAGGTTAAAACTCAAATGAATTGACGGGGGCCCGCACAAGCGGTGGAGCATGTGGTTTAATTCGATGCAACGCGAAGAACCTTACCTGGTCTTGACATCCACGGAAGTTTTCAGAGATGAGAATGTGCCTTCGGGAACCGTGAGACAGGTGCTGCATGGCTGTCGTCAGCTCGTGTTGTGAAATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTTATCCTTTGTTGCCAGCGGCCCGGCCGGGAACTCAAAGGAGACTGCCAGTGATAAACTGGAGGAAGGTGGGGATGACGTCAAGTCATCATGGCCCTTACGACCAGGGCTACACACGTGCTACAATGGCGCATACAAAGAGAAGCGACCTCGCGAGAGCAAGCGGACCTCATAAAGTGCGTCGTAGTCCGGATTGGAGTCTGCAACTCGACTCCATGAAGTCGGAATCGCTAGTAATCGTGGATCAGAATGCCACGGTGAATACGTTCCCGGGCCTTGTACACACCGCCCGTCACACCATGGGAGTGGGTTGCAAAAGAAGTAGGTAGCTTAACCTTCGGGAGGGCGCTTACCACTTTGTGATTCATGACTGGGGTGAAGTCGTAACAAGGTAACCGTAGGGGAACCTGCGGTTGGATCACCTCCTT\" \nseq2 &lt;- \"TTGAAGAGTTTGATCATGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAACGGTAACAGGAAGAAGCTTGCTTCTTTGCTGACGAGTGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAACGTCGCAAGACCAAAGAGGGGGACCTTCGGGCCTCTTGCCATCGGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAACGGCTCACCTAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGGAGTAAAGTTAATACCTTTACTCATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGCAGCCGCGGTAATACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGCACGCAGGCGGTTTGTTAAGTCAGATGTGAAATCCCCGGGCTCAACCTGGGAACTGCATCTGATACTGGCAAGCTTGAGTCTCGTAGAGGGGGGTAGAATTCCAGGTGTAGCGGTGAAATGCGTAGAGATCTGGAGGAATACCGGTGGCGAAGGCGGCCCCCTGGACGAAGACTGACGCTCAGGTGCGAAAGCGTGGGGAGCAAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGTCGACTTGGAGGTTGTGCCCTTGAGGCGTGGCTTCCGGAGCTAACGCGTTAAGTCGACCGCCTGGGGAGTACGGCCGCAAGGTTAAAACTCAAATGAATTGACGGGGGCCCGCACAAGCGGTGGAGCATGTGGTTTAATTCGATGCAACGCGAAGAACCTTACCTGGTCTTGACATCCACGGAAGTTTTCAGAGATGAGAATGTGCCTTCGGGAACCGTGAGACAGGTGCTGCATGGCTGTCGTCAGCTCGTGTTGTGAAATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTTATCCTTTGTTGCCAGCGGTCCGGCCGGGAACTCAAAGGAGACTGCCAGTGATAAACTGGAGGAAGGTGGGGATGACGTCAAGTCATCATGGCCCTTACGACCAGGGCTACACACGTGCTACAATGGCGCATACAAAGAGAAGCGACCTCGCGAGAGCAAGCGGACCTCATAAAGTGCGTCGTAGTCCGGATTGGAGTCTGCAACTCGACTCCATGAAGTCGGAATCGCTAGTAATCGTGGATCAGAATGCCACGGTGAATACGTTCCCGGGCCTTGTACACACCGCCCGTCACACCATGGGAGTGGGTTGCAAAAGAAGTAGGTAGCTTAACCTTCGGGAGGGCGCTTACCACTTTGTGATTCATGACTGGGGTGAAGTCGTAACAAGGTAACCGTAGGGGAACCTGCGGTTGGATCACCTCCTT\"\n\nseq_list &lt;- ken_tedious_alignment(seq1,seq2)\nidx &lt;- which((seq1 |&gt; str_split_1(\"\"))!=(seq2 |&gt; str_split_1(\"\")))\n\nfor (i in idx) {\nprint(DNAString(paste(seq_list[[1]][(i-3):(i+3)],collapse=\"\")))\nprint(DNAString(paste(seq_list[[2]][(i-3):(i+3)],collapse=\"\")))\ncat(\"------------------\\n\\n\")\n}\n</pre><p align=\"center\">\n<img alt=\"image\" data-lazy-src=\"https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/ecoli1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/ecoli1.png?w=450&amp;ssl=1\"/></noscript>\n</p>\n<p align=\"center\">\n<img alt=\"image\" data-lazy-src=\"https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/ecoli2.png?w=40%25&amp;ssl=1\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image\" data-recalc-dims=\"1\" height=\"auto\" loading=\"lazy\" src=\"https://i1.wp.com/www.kenkoonwong.com/blog/dynamic-programming/ecoli2.png?w=40%25&amp;ssl=1\"/></noscript>\n</p>\n<p>The above are the differences of the 2 strains and how our algorithm aligned them. Pretty neat!</p>\n<h2 id=\"final-thoughts\">Final Thoughts\n  <a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#final-thoughts\" rel=\"nofollow\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"anchor-symbol\" height=\"26\" viewbox=\"0 0 22 22\" width=\"26\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M0 0h24v24H0z\" fill=\"currentColor\"></path>\n<path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z\"></path>\n</svg></a>\n</h2>\n<p>Wow, that was quite rewarding to go through the dynamic programming procedure. It was tedious but well worth the effort. I‚Äôm curious what other problems would benefit from this method? ü§î Let me know if you have used this on non-bioinformatic related field!</p>\n<br/>\n<h2 id=\"opportunity\">Opportunity for Improvement\n  <a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#opportunity\" rel=\"nofollow\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"anchor-symbol\" height=\"26\" viewbox=\"0 0 22 22\" width=\"26\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M0 0h24v24H0z\" fill=\"currentColor\"></path>\n<path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z\"></path>\n</svg></a>\n</h2>\n<ul>\n<li>Learn more about local alignment, clustering, blast, etc</li>\n<li>Learn how <code>DECIPHER</code> aligns</li>\n<li>Learn how to make this more efficient</li>\n<li>Next stop would be distance calculation after alignment, and then growing tree üå≤</li>\n</ul>\n<h2 id=\"lessons\">Lessons Learnt\n  <a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/#lessons\" rel=\"nofollow\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"anchor-symbol\" height=\"26\" viewbox=\"0 0 22 22\" width=\"26\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M0 0h24v24H0z\" fill=\"currentColor\"></path>\n<path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z\"></path>\n</svg></a>\n</h2>\n<ul>\n<li>Learnt the basics of DNA sequence alignment</li>\n<li>Coded the algorithm from scratch really helped me understand the procedure</li>\n</ul>\n<br/>\n<p>If you like this article:</p>\n<ul>\n<li>please feel free to send me a \n<a href=\"https://www.kenkoonwong.com/blog/\" rel=\"nofollow\" target=\"_blank\">comment or visit my other blogs</a></li>\n<li>please feel free to follow me on \n<a href=\"https://bsky.app/profile/kenkoonwong.bsky.social\" rel=\"nofollow\" target=\"_blank\">BlueSky</a>, \n<a href=\"https://twitter.com/kenkoonwong/\" rel=\"nofollow\" target=\"_blank\">twitter</a>, \n<a href=\"https://github.com/kenkoonwong/\" rel=\"nofollow\" target=\"_blank\">GitHub</a> or \n<a href=\"https://med-mastodon.com/@kenkoonwong\" rel=\"nofollow\" target=\"_blank\">Mastodon</a></li>\n<li>if you would like collaborate please feel free to \n<a href=\"https://www.kenkoonwong.com/contact/\" rel=\"nofollow\" target=\"_blank\">contact me</a></li>\n</ul>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://www.kenkoonwong.com/blog/dynamic-programming/\"> r on Everyday Is A School Day</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
      "main_text": "Building DNA Sequence Alignment With Needleman-Wunsch Algorithm From Scratch ‚Äì A Note To My Self\nPosted on\nSeptember 6, 2025\nby\nr on Everyday Is A School Day\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nr on Everyday Is A School Day\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nEver wondered how DNA alignment actually works under the hood? üß¨ We coded the Needleman-Wunsch algorithm from scratch, working through scoring matrices by hand with simple examples like ‚ÄúCAT‚Äù vs ‚ÄúCT‚Äù before testing on real E. coli sequences. Pretty neat to see the magic happen! ‚ú®\nMotivations\nWe‚Äôve looked at\ndetecting AMR genes\nand\nphylogenetic analysis workflow\npreviously. As we like to look under the hood to see how things work, today, let‚Äôs look at how the alignment actually works.\nDisclaimer:\nI am not a bioinformatician and do not work with genes directly, the articles and method presented is my attempt to get a better understanding on the method behind the aligment. Please take this with a grain of salt. Verify the information presented. If you noted some error in this article, please let me know so that I can learn! Also, these codes were not run during rmarkdown knitting because of significant delay for each knitting, however, the results posted here should be reprodicuble. Please again let me know if they are not\nObjectives\nWhat is Alignment\nWhat method can be used for Alignment?\nLet‚Äôs work through an example\nStep 1: Set Up Scores\nStep 2: Calculate Scoring Matrix\nStep 3: Traceback To Find Optimal Alingment\nLet‚Äôs Try Our Code With More Examples\nOpportunity for improvement\nLessons Learnt\nWhat Is Alignment?\nSequence alignment is a fundamental technique in bioinformatics that arranges two or more biological sequences (like DNA, RNA, or protein sequences) to identify regions of similarity and difference. By introducing gaps represented by dashes, alignment algorithms position corresponding characters from different sequences in the same columns, revealing evolutionary relationships, functional similarities, and structural conservation. For example, aligning ‚ÄúCCCCCGGGGG‚Äù with ‚ÄúCCCGGG‚Äù might show that the shorter sequence is missing certain bases but shares a common core with the longer one.\nWhat Method Can Be Used For Alignment?\nSequence alignment methods include dynamic programming algorithms like\nNeedleman-Wunsch\n(global) and Smith-Waterman (local) that provide optimal but slow results, fast heuristic methods like BLAST and FASTA for database searching, progressive approaches like ClustalW for multiple sequences, and specialized techniques including dot-matrix visualization, structural alignment using 3D protein information, and profile-based methods with hidden Markov models.\nsource\nGlobal alignment method such as\nNeedleman-Wunsch\nshould be a good one to learn from scratch with dynamic programming. This\nyoutube tutorial by Professor Hendrix\nis very helpful in creating\nscoring matrix\n,\ntraceback matrix\nand\noptimal alignment\n.\nLet‚Äôs Work Through An Example\nWhat we‚Äôll do here is we‚Äôll go through a simple example by hand, then write code that reresents that. I wouldn‚Äôt be surprised if some of these are confusing, because they are, and it took me quite a few days working on paper to follow the procedure. If you find it confusing, please look at\nyoutube tutorial by Professor Hendrix\n, I found it very helpful.\nLet‚Äôs set an example. We have 2 very simple sequences and having the end in mind will be beneficial IMO.\nAs you can see above, we have 2 sequences. The first row is\nCAT\n, and the second row is\nCT\n. The\n-\nis what we call a\ngap\n. If the algorithm works, we will see the dynamic programming do its magic and automatically insert a gap on our second sequence\nStep 1: Set Up Scores\nMatch = +2\nMismatch = -1\nGap = -2\nWhat the above mean is that, when we compare our first and second sequence for element, we will use these score to form our scoring matrix below. For example, if it‚Äôs a match (e.g.\nA-A\n), we will\n+2\nfrom a diagonal score. If it‚Äôs a mismatch, we will\n-1\nfrom diagonal score. Then we will just\n-2\nfor the score above and on the left. Confusing? I‚Äôm with you. See below example for better visual procedure.\nStep 2: Calculate Scoring Matrix\nHaving the end in mind, we should have this scoring matrix for our above sequences.\nBut of course, when we first begin, we will have an empty matrix, like so.\nLet‚Äôs view the steps all at a time, like so.\nNotice that the\nmatrix[1,1]\nis always\n0\nand we name the column and row as\n.\n. Then, we fill\nmatrix[1,1:3]\nwith cumulative\n-2\n. Same goes to\nmatrix[1:4,1]\n. Then, we start filling our first score on\nmatrix[2,2]\nby finding the\nmaximum\nof 3 calculations (\ndiagonal\n,\nup\n,\nleft\n), see picture for actual calculation above. To be explicit, for\nmatrix[2,2]\n, we first assess if\ncolumn name\nand\nrow name\nof\nmatrix[2,2]\nis a match or a mismatch. What do you think?\nMatrix[2,2]\nis\nC-C\n, hence a match! On diagonal (meaning\nmatrix[1,1]\n), we all use\nmatrix[1,1]\nscore and\n+2\n. For the one above (up)\nmatrix[1,2]\n, we will\n-2\n. Same goes with left\nmatrix[2,1]\n, we will\n-2\n, since these are gaps. One thing that got me really confused are these ups and lefts. But remember, we will ALWAYS use these score and subtract by our gap penalty (in our case\n-2\n). After all these calculation, the max of these 3 (diag, up, left) is 2, which is from diag. Hence\nmatrix[2,2]\nis\n2\n. Then, we‚Äôll move next to\nmatrix[3,2]\netc.\nCode: click to expand\nnrow <- nchar(seq1)+1\nncol <- nchar(seq2)+1\n\nmat <- matrix(nrow = nrow, ncol = ncol, dimnames = list(c(\".\",str_split_1(seq1,\"\")),c(\".\",str_split_1(seq2,\"\"))))\n                                                  \n# gap penalty\nmat[1,1:ncol] <- seq(0,-2*(ncol-1),-2)\nmat[1:nrow,1] <- seq(0,-2*(nrow-1),-2)\n\n# calc score\ncolname <- colnames(mat)\nrowname <- rownames(mat)\n\nrow_list <- 2:nrow\ncol_list <- 2:ncol\n\nfor (i in row_list) {\n  for (j in col_list) {\nsame <- ifelse(rowname[i]==colname[j], T, F)\n\n## calc diag\nif (same) {\n  score_diag <- mat[i-1,j-1] + 2\n} else {\n  score_diag <- mat[i-1,j-1] - 1\n}\n\n## calc up\nscore_up <- mat[i-1,j] - 2 \n\n## calc left\nscore_left <- mat[i,j-1] - 2\n\nscore_i <- max(score_diag, score_up, score_left)\n\nmat[i,j] <- score_i\n# print(mat)\n\n  }\n}\nStep 3: Traceback To Get Optimal Alignment\nAlright, our final scoring matrix is as such.\nWe first start at the bottom right grid, then follow the maximum score grid like so.\nSo, we first start off with bottom right grid. First assess if the column name and row name is the same, in this case it is, hence we align them up\nT-T\n. Next, we look at\ndiag\n,\nup\n, and\nleft\nand see which is the\nmaximum\n. In this case,\n1\nis the highest, hence we move\nup\n. When we move\nup\n, it means, the\nrow name\npersists while we place a\ngap\non column name for our alignment. This took me a while to get the intuition, but notice that there is one row index reduction but the column index remains the same. That‚Äôs why we insert a\ngap\non our new column name sequence. Next, you do the same thing, and the max is the move diagonally to\nmatrix[2,2]\n, and since the column namd and row name are the same\nC-C\n, we align them as such.\nThere you go! That‚Äôs the basics of Needleman-Wunsch Algorithm! üôå\nclick to expand\nlibrary(tidyverse)\nlibrary(Biostrings)\n\nken_tedious_alignment <- function(seq1,seq2) {\n{\nnrow <- nchar(seq1)+1\nncol <- nchar(seq2)+1\n\nmat <- matrix(nrow = nrow, ncol = ncol, dimnames = list(c(\".\",str_split_1(seq1,\"\")),c(\".\",str_split_1(seq2,\"\"))))\n                                                  \n# gap penalty\nmat[1,1:ncol] <- seq(0,-2*(ncol-1),-2)\nmat[1:nrow,1] <- seq(0,-2*(nrow-1),-2)\n\n# calc score\ncolname <- colnames(mat)\nrowname <- rownames(mat)\n\nrow_list <- 2:nrow\ncol_list <- 2:ncol\n\nfor (i in row_list) {\n  for (j in col_list) {\nsame <- ifelse(rowname[i]==colname[j], T, F)\n\n## calc diag\nif (same) {\n  score_diag <- mat[i-1,j-1] + 2\n} else {\n  score_diag <- mat[i-1,j-1] - 1\n}\n\n## calc up\nscore_up <- mat[i-1,j] - 2 \n\n## calc left\nscore_left <- mat[i,j-1] - 2\n\nscore_i <- max(score_diag, score_up, score_left)\n\nmat[i,j] <- score_i\n# print(mat)\n\n  }\n}\n\n}\n\n## now walk back - start where?\n{\nrow_i <- nrow\ncol_i <- ncol\n\nseq_instruct <- c()\nsame <- F\n\nfor (repeat_i in 1:(nrow-1)) {\n  # print(paste(\"row: \",rowname[row_i],\" \",row_i, \" col: \",colname[col_i],\" \",col_i))\nif (colname[col_i]==rowname[row_i]) { \n  same <- T \n  \n} else { same <- F }\n# print(same)\n  \n\nif (is.null(seq_instruct)) { \n  if (same) {\n  seq_instruct <- c(seq_instruct, \"S\")\n  next}\n  if (!same && (nrow>ncol)) {\n    seq_instruct <- c(seq_instruct, \"A\")\n  }\n  if (!same && (ncol>nrow)) {\n    seq_instruct <- c(seq_instruct, \"-\")\n    # print(\"ncol>nrow\")\n  }\n  # print(\"this should only show once\")\n  } \n\n## find max \ndiag <- mat[row_i-1,col_i-1] #1\nup <- mat[row_i-1,col_i] #2\nleft <- mat[row_i, col_i-1] #3\n\n# print(seq_instruct)\n\nmax_score <- max(diag,up,left)\nmax_score_location <- which(c(diag,up,left) == max_score)\n# print(max_score_location)\nif (length(max_score_location) > 1) { max_score_location <- sample(max_score_location, 1) }\n\n## match and find location for new start\nif (max_score_location==1) { \n  row_i <- row_i - 1\n  col_i <- col_i - 1\n  # seq_instruct <- c(seq_instruct, \"S\")\n  } \nif (max_score_location==2) {\n  row_i <- row_i - 1\n  # seq_instruct <- c(seq_instruct, \"A\")\n} \nif (max_score_location==3) {\n  col_i <- col_i - 1\n  # seq_instruct <- c(seq_instruct, \"-\")\n}\n\nif (repeat_i!=1) {\n  if (max_score_location==1) { seq_instruct <- c(seq_instruct, \"S\") }\n  if (max_score_location==2) { seq_instruct <- c(seq_instruct, \"A\") }\n  if (max_score_location==3) { seq_instruct <- c(seq_instruct, \"-\") }\n}\n# print(seq_instruct)\n}\nprint(mat)\n}\n\n## turn instruction back to sequence\n{\n# seq_instruct\n# max_length <- max(nrow-1,ncol-1)\nseq1_align <- seq2_align <- vector(mode = \"character\", length=length(seq_instruct))\nmax_i <- length(seq_instruct)\ni <- nrow\nj <- ncol\n\nfor (count in 1:length(seq_instruct)) {\n    if (seq_instruct[count]==\"S\") {\n      seq1_align[max_i] <- rowname[i]\n      seq2_align[max_i] <- colname[j]\n      i <- i - 1\n      j <- j - 1\n    }\n    if (seq_instruct[count]==\"A\") {\n      seq1_align[max_i] <- rowname[i]\n      seq2_align[max_i] <- \"-\"\n      i <- i - 1\n    }\n    if (seq_instruct[count]==\"-\") {\n      seq1_align[max_i] <- \"-\"\n      seq2_align[max_i] <- colname[j]\n      j <- j -1\n    }\n    max_i <- max_i - 1\n}\n}\n  tryCatch(expr = {\n  print(DNAString(seq1_align |> paste(collapse=\"\")))\n  print(DNAString(seq2_align |> paste(collapse=\"\"))) \n  return(list(seq1_align, seq2_align))}\n  , error=function(e) {\n    print(seq1_align)\n    print(seq2_align)}\n  )\n}\n\n## Some examples, uncomment to try\n# seq1 <- \"dogcathorse\"\n# seq2 <- \"dogcthrs\"\n# \n# seq1 <- \"CCAGCCAGGACTACGTAAGTCA\"\n# seq2 <- \"CCGCGGACTCGTATCA\"\n# ken_ted ious_alignment(seq1,seq2)\nLet‚Äôs Try Our Code With More Sequences\nseq1 <- \"CCAGCCAGGACTACGTAAGTCA\"\nseq2 <- \"CCGCGGACTCGTATCA\"\nken_tedious_alignment(seq1,seq2)\nThe first example with longer sequence. Not bad. Looks like it works.\nseq1 <- \"AAATCCATATGCCACAGA\"\nseq2 <- \"AATTCGATCCATATATTTGCCAAATTCCAGA\"\nken_tedious_alignment(seq1,seq2)\nSecond example, we made seq1 shorter. Not bad too! It works!\nseq1 <- \"GATATAGCGGGTTTAACCGTTAAA\"\nseq2 <- \"GATATAGCGGGTTTAACCGTT\"\nken_tedious_alignment(seq1,seq2)\nThirds example, we want to make sure we can have gaps towards the end. Yes, it works too!\nseq1 <- \"dogcathorse\"\nseq2 <- \"dgcthrs\"\nken_tedious_alignment(seq1,seq2)\nLet‚Äôs try just regular words and see if it works? Yes it does!\nNow, here are a few examples that don‚Äôt quite work that might be a good opportunity to debug\nseq1 <- \"GATATAGCGGGTTTAACCGTTAAA\"\nseq2 <- \"AGCGGGTTTAACCGTT\"\nken_tedious_alignment(seq1,seq2)\nYea, that looks really wrong. üòë Might be good to debug some other time! Now since the above sequences were just letters and randomly entered, let‚Äôs check 2 Ecoli 16s rRNA sequences.\nseq1 <- \"TTGAAGAGTTTGATCATGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAACGGTAACAGAAAGCAGCTTGCTGCTTTGCTGACGAGTGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAACGTCGCAAGACCAAAGAGGGGGACCTTCGGGCCTCTTGCCATCGGATGTGCCCAGATGGGATTAGCTTGTTGGTGGGGTAACGGCTCACCAAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGGAGTAAAGTTAATACCTTTACTCATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGCAGCCGCGGTAATACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGCACGCAGGCGGTTTGTTAAGTCAGATGTGAAATCCCCGGGCTCAACCTGGGAACTGCATCTGATACTGGCAAGCTTGAGTCTCGTAGAGGGGGGTAGAATTCCAGGTGTAGCGGTGAAATGCGTAGAGATCTGGAGGAATACCGGTGGCGAAGGCGGCCCCCTGGACGAAGACTGACGCTCAGGTGCGAAAGCGTGGGGAGCAAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGTCGACTTGGAGGTTGTGCCCTTGAGGCGTGGCTTCCGGAGCTAACGCGTTAAGTCGACCGCCTGGGGAGTACGGCCGCAAGGTTAAAACTCAAATGAATTGACGGGGGCCCGCACAAGCGGTGGAGCATGTGGTTTAATTCGATGCAACGCGAAGAACCTTACCTGGTCTTGACATCCACGGAAGTTTTCAGAGATGAGAATGTGCCTTCGGGAACCGTGAGACAGGTGCTGCATGGCTGTCGTCAGCTCGTGTTGTGAAATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTTATCCTTTGTTGCCAGCGGCCCGGCCGGGAACTCAAAGGAGACTGCCAGTGATAAACTGGAGGAAGGTGGGGATGACGTCAAGTCATCATGGCCCTTACGACCAGGGCTACACACGTGCTACAATGGCGCATACAAAGAGAAGCGACCTCGCGAGAGCAAGCGGACCTCATAAAGTGCGTCGTAGTCCGGATTGGAGTCTGCAACTCGACTCCATGAAGTCGGAATCGCTAGTAATCGTGGATCAGAATGCCACGGTGAATACGTTCCCGGGCCTTGTACACACCGCCCGTCACACCATGGGAGTGGGTTGCAAAAGAAGTAGGTAGCTTAACCTTCGGGAGGGCGCTTACCACTTTGTGATTCATGACTGGGGTGAAGTCGTAACAAGGTAACCGTAGGGGAACCTGCGGTTGGATCACCTCCTT\" \nseq2 <- \"TTGAAGAGTTTGATCATGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAACGGTAACAGGAAGAAGCTTGCTTCTTTGCTGACGAGTGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAACGTCGCAAGACCAAAGAGGGGGACCTTCGGGCCTCTTGCCATCGGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAACGGCTCACCTAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGGAGTAAAGTTAATACCTTTACTCATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGCAGCCGCGGTAATACGGAGGGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGCACGCAGGCGGTTTGTTAAGTCAGATGTGAAATCCCCGGGCTCAACCTGGGAACTGCATCTGATACTGGCAAGCTTGAGTCTCGTAGAGGGGGGTAGAATTCCAGGTGTAGCGGTGAAATGCGTAGAGATCTGGAGGAATACCGGTGGCGAAGGCGGCCCCCTGGACGAAGACTGACGCTCAGGTGCGAAAGCGTGGGGAGCAAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGTCGACTTGGAGGTTGTGCCCTTGAGGCGTGGCTTCCGGAGCTAACGCGTTAAGTCGACCGCCTGGGGAGTACGGCCGCAAGGTTAAAACTCAAATGAATTGACGGGGGCCCGCACAAGCGGTGGAGCATGTGGTTTAATTCGATGCAACGCGAAGAACCTTACCTGGTCTTGACATCCACGGAAGTTTTCAGAGATGAGAATGTGCCTTCGGGAACCGTGAGACAGGTGCTGCATGGCTGTCGTCAGCTCGTGTTGTGAAATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTTATCCTTTGTTGCCAGCGGTCCGGCCGGGAACTCAAAGGAGACTGCCAGTGATAAACTGGAGGAAGGTGGGGATGACGTCAAGTCATCATGGCCCTTACGACCAGGGCTACACACGTGCTACAATGGCGCATACAAAGAGAAGCGACCTCGCGAGAGCAAGCGGACCTCATAAAGTGCGTCGTAGTCCGGATTGGAGTCTGCAACTCGACTCCATGAAGTCGGAATCGCTAGTAATCGTGGATCAGAATGCCACGGTGAATACGTTCCCGGGCCTTGTACACACCGCCCGTCACACCATGGGAGTGGGTTGCAAAAGAAGTAGGTAGCTTAACCTTCGGGAGGGCGCTTACCACTTTGTGATTCATGACTGGGGTGAAGTCGTAACAAGGTAACCGTAGGGGAACCTGCGGTTGGATCACCTCCTT\"\n\nseq_list <- ken_tedious_alignment(seq1,seq2)\nidx <- which((seq1 |> str_split_1(\"\"))!=(seq2 |> str_split_1(\"\")))\n\nfor (i in idx) {\nprint(DNAString(paste(seq_list[[1]][(i-3):(i+3)],collapse=\"\")))\nprint(DNAString(paste(seq_list[[2]][(i-3):(i+3)],collapse=\"\")))\ncat(\"------------------\\n\\n\")\n}\nThe above are the differences of the 2 strains and how our algorithm aligned them. Pretty neat!\nFinal Thoughts\nWow, that was quite rewarding to go through the dynamic programming procedure. It was tedious but well worth the effort. I‚Äôm curious what other problems would benefit from this method? ü§î Let me know if you have used this on non-bioinformatic related field!\nOpportunity for Improvement\nLearn more about local alignment, clustering, blast, etc\nLearn how\nDECIPHER\naligns\nLearn how to make this more efficient\nNext stop would be distance calculation after alignment, and then growing tree üå≤\nLessons Learnt\nLearnt the basics of DNA sequence alignment\nCoded the algorithm from scratch really helped me understand the procedure\nIf you like this article:\nplease feel free to send me a\ncomment or visit my other blogs\nplease feel free to follow me on\nBlueSky\n,\ntwitter\n,\nGitHub\nor\nMastodon\nif you would like collaborate please feel free to\ncontact me\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nr on Everyday Is A School Day\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Ever wondered how DNA alignment actually works under the hood? üß¨ We coded the Needleman-Wunsch algorithm from scratch, working through scoring matrices by hand with simple examples like ‚ÄúCAT‚Äù vs ‚ÄúCT‚Äù before testing on real E. c...",
      "meta_keywords": null,
      "og_description": "Ever wondered how DNA alignment actually works under the hood? üß¨ We coded the Needleman-Wunsch algorithm from scratch, working through scoring matrices by hand with simple examples like ‚ÄúCAT‚Äù vs ‚ÄúCT‚Äù before testing on real E. c...",
      "og_image": "https://www.kenkoonwong.com/blog/dynamic-programming/endinmind.png",
      "og_title": "Building DNA Sequence Alignment With Needleman-Wunsch Algorithm From Scratch ‚Äì A Note To My Self | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 10.8,
      "sitemap_lastmod": null,
      "twitter_description": "Ever wondered how DNA alignment actually works under the hood? üß¨ We coded the Needleman-Wunsch algorithm from scratch, working through scoring matrices by hand with simple examples like ‚ÄúCAT‚Äù vs ‚ÄúCT‚Äù before testing on real E. c...",
      "twitter_title": "Building DNA Sequence Alignment With Needleman-Wunsch Algorithm From Scratch ‚Äì A Note To My Self | R-bloggers",
      "url": "https://www.r-bloggers.com/2025/09/building-dna-sequence-alignment-with-needleman-wunsch-algorithm-from-scratch-a-note-to-my-self/",
      "word_count": 2161
    }
  }
}