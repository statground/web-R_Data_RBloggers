{
  "uuid": "0880a4ce-75ba-44e0-88d5-346a7830ec40",
  "created_at": "2025-11-17 20:39:01",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2023/12/chi-square-distribution-and-test-in-r/",
    "crawled_at": "2025-11-17T09:42:06.488571",
    "external_links": [
      {
        "href": "https://www.codingthepast.com/2023/12/04/Chi-square-distribution-in-R.html",
        "text": "coding-the-past"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://www.codingthepast.com/2023/11/15/Change-Fonts-in-ggplot.html",
        "text": "‘How to Change Fonts in ggplot2 with Google Fonts’"
      },
      {
        "href": "https://github.com/sharonhoward/ll-coroners",
        "text": "dataset"
      },
      {
        "href": "https://sharonhoward.org/index.html",
        "text": "Sharon Howard"
      },
      {
        "href": "https://www.codingthepast.com/2023/11/15/Change-Fonts-in-ggplot.html",
        "text": "‘How to Change Fonts in ggplot2 with Google Fonts’"
      },
      {
        "href": "https://en.wikipedia.org/wiki/Gamma_function",
        "text": "gamma function"
      },
      {
        "href": "https://www.codingthepast.com/2023/01/24/Historical-Weather-Data.html",
        "text": "‘Climate data visualization with ggplot2’"
      },
      {
        "href": "https://statisticsbyjim.com/basics/contingency-table/",
        "text": "Read more here."
      },
      {
        "href": "https://www.codingthepast.com/2023/11/15/Change-Fonts-in-ggplot.html",
        "text": "‘How to Change Fonts in ggplot2 with Google Fonts’"
      },
      {
        "href": "https://www.codingthepast.com/2023/12/04/Chi-square-distribution-in-R.html",
        "text": "coding-the-past"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Chi-square distribution and test in R | R-bloggers",
    "images": [
      {
        "alt": "Chi-square distribution curves with different degrees of freedom",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Chi-square distribution curves with different degrees of freedom",
        "base64": null,
        "src": "https://i0.wp.com/www.codingthepast.com/assets/images/lesson_18_01.png?w=578&ssl=1"
      },
      {
        "alt": "Contingency table of gender versus verdict",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Contingency table of gender versus verdict",
        "base64": null,
        "src": "https://i1.wp.com/www.codingthepast.com/assets/images/lesson_18_02.png?w=578&ssl=1"
      },
      {
        "alt": "Probability of two independent events happening",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Probability of two independent events happening",
        "base64": null,
        "src": "https://i2.wp.com/www.codingthepast.com/assets/images/lesson_18_03.png?w=578&ssl=1"
      },
      {
        "alt": "Expected value calculation example",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Expected value calculation example",
        "base64": null,
        "src": "https://i1.wp.com/www.codingthepast.com/assets/images/lesson_18_04.png?w=578&ssl=1"
      },
      {
        "alt": "Test statistic highlighted in the chi square distribution",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Test statistic highlighted in the chi square distribution",
        "base64": null,
        "src": "https://i2.wp.com/www.codingthepast.com/assets/images/lesson_18_05.png?w=578&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/ponne-bruno/",
        "text": "Ponne, Bruno"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-380508 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Chi-square distribution and test in R</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 3, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/ponne-bruno/\">Ponne, Bruno</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://www.codingthepast.com/2023/12/04/Chi-square-distribution-in-R.html\"> coding-the-past</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><p><br/></p>\n<p><strong>Greetings, humanists, social and data scientists!</strong></p>\n<p><br/></p>\n<p>Was there an association or relationship between gender and the verdicts in investigations in 18th-century London? If an inquest concerned a man, did this fact influence the final verdict of the investigation?</p>\n<p><br/></p>\n<p>In this lesson we will answer these questions employing a chi-square test and the data explored in the lesson <a href=\"https://www.codingthepast.com/2023/11/15/Change-Fonts-in-ggplot.html\" rel=\"nofollow\" target=\"_blank\">‘How to Change Fonts in ggplot2 with Google Fonts’</a>. You will learn what degrees of freedom are and how to harness the power of the chi-square distribution to infer relationships in historical London.</p>\n<p><br/></p>\n<hr>\n<p><br/></p>\n<h2 id=\"1-data-source\">1. Data source</h2>\n<p>The <a href=\"https://github.com/sharonhoward/ll-coroners\" rel=\"nofollow\" target=\"_blank\">dataset</a> used in this lesson is made available by <a href=\"https://sharonhoward.org/index.html\" rel=\"nofollow\" target=\"_blank\">Sharon Howard</a>. This dataset documents a range of Westminster inquests conducted between 1760 and 1799. Inquests were mostly investigations into deaths under circumstances that were sudden, unexplained, or suspicious. Please, check the lesson <a href=\"https://www.codingthepast.com/2023/11/15/Change-Fonts-in-ggplot.html\" rel=\"nofollow\" target=\"_blank\">‘How to Change Fonts in ggplot2 with Google Fonts’</a> for more information.</p>\n<p><br/></p>\n<hr/>\n<p><br/></p>\n<h2 id=\"2-why-is-the-chi-square-distribution-useful-for-us\">2. Why is the chi-square distribution useful for us?</h2>\n<p>The chi-square distribution is useful because it is the basis for testing the independence of two categorical variables. When we perform this test, the statistic we calculate follows a chi-square distribution. This enables us to determine the probability of observing a specific test statistic in our analytical sample under a certain hypothesis.</p>\n<p><br/></p>\n<div class=\"text-note\">\n<span class=\"material-symbols-outlined\">\n        tips_and_updates\n    </span>\n<span class=\"text-note-title\">  </span>\n<div class=\"text-note-content\"> A test statistic is a summary of your sample, reducing your dataset to a single value that enables hypothesis testing.\n        \n    </div>\n</div>\n<p><br/></p>\n<p>It’s not essential to know the function below, but understanding that the probability density function of a chi-square distribution follows this formula is beneficial. In the following steps we will write R code to generate a chi-square curve with <em>n</em> degrees of freedom and now you know that actually what R will compute is the function below with the <em>n</em> and <em>x</em> interval that you pass to the function. Note that f(0) = 0 and that  \\(\\Gamma\\) is the <a href=\"https://en.wikipedia.org/wiki/Gamma_function\" rel=\"nofollow\" target=\"_blank\">gamma function</a>.</p>\n<p><br/></p>\n\n\\[f(x) = \\frac{1}{2^{\\frac{n}{2}} \\Gamma(\\frac{n}{2})}x^{\\frac{n}{2}-1}e^{-\\frac{x}{2}}\\]\n\n<p><br/></p>\n<p>The area under this function gives us the probability of an interval of chi-squares happening. Fortunately, R has a function <code>dchisq(x, df)</code> that provides the chi-square density function. In the code below, we plot three chi-square distributions with 4, 8 and 16 degrees of freedom:</p>\n<p><br/></p>\n<ul class=\"conclusion-list\">\n<li>to make it easier to plot the curves with color depending on the degrees of freedom, we create a data frame with three variables: x (from 0 to 50 in 0.1 steps); y (the result of the function f(n,x) above) and df (n degrees of freedom);</li>\n<li>in R, the chi-square density function is calculated with <code>dchisq</code>;</li>\n<li>color aesthetic is mapped to df (degrees of freedom) and to make sure ggplot uses discrete colors we transform degrees of freedom into a factor;</li>\n<li><code>scale_color_discrete</code> is used to give a name to the legend and <code>theme_coding_the_past()</code> is our theme available here: <a href=\"https://www.codingthepast.com/2023/01/24/Historical-Weather-Data.html\" rel=\"nofollow\" target=\"_blank\">‘Climate data visualization with ggplot2’</a>.</li>\n</ul>\n<p><br/></p>\n<p><span class=\"material-symbols-outlined\" data-cf-modified-a1355b68835fd3a3f3663fe4-=\"\" id=\"copy-button\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; copyCode('code-18-1')\">\n  content_copy\n  <span class=\"tooltiptext\">Copy</span>\n</span></p>\n<div id=\"code-18-1\">\n<figure class=\"highlight\"><pre>library(ggplot2)\n\n\nx &lt;- seq(0, 50, 0.1)\n\ny1 &lt;- dchisq(x, df = 4)\ny2 &lt;- dchisq(x, df = 8)\ny3 &lt;- dchisq(x, df = 16)\n\ndf1 &lt;- data.frame(x = x, y = y1, df = 4)\ndf2 &lt;- data.frame(x = x, y = y2, df = 8)\ndf3 &lt;- data.frame(x = x, y = y3, df = 16)\n\ndf &lt;- rbind(df1, df2, df3)\n\nggplot(data=df, aes(x = x, y = y, color = as.factor(df)))+\n  geom_line(linewidth=1)+\n  scale_color_discrete(name = \"DF\")+\n  labs(y = \"Density Function\",\n       x = \"Chi-square\")+\n  theme_coding_the_past()</pre></figure>\n</div>\n<p><br/></p>\n<p class=\"larger\"><img alt=\"Chi-square distribution curves with different degrees of freedom\" data-lazy-src=\"https://i0.wp.com/www.codingthepast.com/assets/images/lesson_18_01.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"Chi-square distribution curves with different degrees of freedom\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/www.codingthepast.com/assets/images/lesson_18_01.png?w=578&amp;ssl=1\"/></noscript></p>\n<p><br/></p>\n<p>Note that as the degrees of freedom increase, the chi-square distribution increasingly resembles a normal distribution. With fewer degrees of freedom, the distribution exhibits more asymmetry.</p>\n<p><br/></p>\n<hr/>\n<p><br/></p>\n<h2 id=\"3-degrees-of-freedom-in-a-chi-square-test\">3. Degrees of freedom in a chi-square test</h2>\n<p>As the plot above demonstrates, degrees of freedom are crucial as they determine the shape of our chi-square distribution. But what exactly are degrees of freedom?</p>\n<p><br/></p>\n<p>Essentially, they represent the number of independent pieces of information allowed to vary in a system. For instance, in a contingency table, the degrees of freedom refer to the number of cells that can be varied, considering the total values observed in our sample. Is this concept a bit complex? I have created a video to illustrate this concept more clearly.</p>\n<p><br/></p>\n<iframe allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen=\"\" frameborder=\"0\" src=\"https://www.youtube.com/embed/HWYepBHFDwk?si=rhmShSTV22EaHg2S\" title=\"YouTube video player\" width=\"450\"></iframe>\n<p><br/></p>\n<p>In a contingency table, degrees of freedom (DF) are calculated with the expression below, where <em>nrows</em> and <em>ncolumns</em> are the numbers of rows and columns, respectively.</p>\n<p><br/></p>\n<div class=\"text-note\">\n<span class=\"material-symbols-outlined\">\n        tips_and_updates\n    </span>\n<span class=\"text-note-title\">  </span>\n<div class=\"text-note-content\"> A contingency table, or crosstab, presents the counts for the combination of two categorical variables.\n        \n        <a href=\"https://statisticsbyjim.com/basics/contingency-table/\" rel=\"nofollow\" target=\"_blank\"> Read more here.</a>\n</div>\n</div>\n<p><br/></p>\n\n\\[DF = (nrows - 1)(ncolumns - 1)\\]\n\n<p><br/></p>\n<hr/>\n<p><br/></p>\n<h2 id=\"4-how-to-estimate-a-contingency-table-under-the-null-hypothesis\">4. How to estimate a contingency table under the null hypothesis?</h2>\n<p>Now that you’re familiar with the chi-square distribution and understand how to calculate degrees of freedom for a chi-square test, let’s explore how to derive our test statistic. Our aim is to determine if there’s an association between two categorical variables. Therefore, our alternative hypothesis (<em>H1</em>) posits that these two variables are dependent. Conversely, the <em>null</em> hypothesis (<em>H0</em>) suggests that the variables are independent.</p>\n<p><br/></p>\n<p>In our case, we’re investigating the potential association between gender and verdict variables. To examine our contingency table, please run the following code. For an in-depth explanation of what this code accomplishes, refer to the lesson <a href=\"https://www.codingthepast.com/2023/11/15/Change-Fonts-in-ggplot.html\" rel=\"nofollow\" target=\"_blank\">‘How to Change Fonts in ggplot2 with Google Fonts’</a></p>\n<p><br/></p>\n<p><em>H0</em>: There is no association between gender and verdict.</p>\n<p><em>H1</em>: There is association between gender and verdict.</p>\n<p><br/></p>\n<p><span class=\"material-symbols-outlined\" data-cf-modified-a1355b68835fd3a3f3663fe4-=\"\" id=\"copy-button\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; copyCode('code-18-2')\">\n  content_copy\n  <span class=\"tooltiptext\">Copy</span>\n</span></p>\n<div id=\"code-18-2\">\n<figure class=\"highlight\"><pre>library(readr)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(showtext)\n\ndf &lt;- read_tsv(\"wa_coroners_inquests_v1-1.tsv\")\n\ndf_prep &lt;- df %&gt;% \n  filter(verdict != \"-\") %&gt;% \n  mutate(verdict = recode(verdict, \"suicide (delirious)\" = \"suicide\",\n                          \"suicide (felo de se)\" = \"suicide\",\n                          \"suicide (insane)\" = \"suicide\"))\n\ntable_ver &lt;- data.frame(table(df_prep$verdict))</pre></figure>\n</div>\n<p><br/></p>\n<p><img alt=\"Contingency table of gender versus verdict\" data-lazy-src=\"https://i1.wp.com/www.codingthepast.com/assets/images/lesson_18_02.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"Contingency table of gender versus verdict\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/www.codingthepast.com/assets/images/lesson_18_02.png?w=578&amp;ssl=1\"/></noscript></p>\n<p><br/></p>\n<p><br/></p>\n<p>What would the above table appear like if the null hypothesis were true? In other words, if gender and verdict were truly independent, how would we calculate the expected values for each cell in that table? It’s important to remember that when events are independent, their probabilities are not influenced by each other. This principle is key to calculating the expected values in such a scenario.</p>\n<p><br/></p>\n<p><img alt=\"Probability of two independent events happening\" data-lazy-src=\"https://i2.wp.com/www.codingthepast.com/assets/images/lesson_18_03.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"Probability of two independent events happening\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/www.codingthepast.com/assets/images/lesson_18_03.png?w=578&amp;ssl=1\"/></noscript></p>\n<p><br/></p>\n<p>For instance, if we assume that the cause of death and gender are independent, we can calculate the probability of observing a case where a woman had an accidental death by multiplying the probability of the individual being a woman by the probability of an accidental death occurring.  Once you’ve determined this probability, you can then multiply it by the total number of individuals in the sample to estimate the expected count for that specific cell in the table. This procedure is shown below.</p>\n<p><br/></p>\n<p><img alt=\"Expected value calculation example\" data-lazy-src=\"https://i1.wp.com/www.codingthepast.com/assets/images/lesson_18_04.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"Expected value calculation example\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/www.codingthepast.com/assets/images/lesson_18_04.png?w=578&amp;ssl=1\"/></noscript></p>\n<p><br/></p>\n<p>The calculation for the other cells in the table follows the same methodology. It’s worth noting that many textbooks present the following formula to calculate the expected values, which is based on the logic we’ve just discussed. In this formula, <em>RT</em> stands for row total; <em>CT</em> for column total; and <em>TT</em> for table total. You do not have to know this formula if you understood the underlying logic we explained earlier.</p>\n<p><br/></p>\n\n\\[E = \\frac{RT \\times CT}{TT}\\]\n\n<p><br/></p>\n<p>After you calculate all the expected values, it is time to calculate our test statistic.</p>\n<p><br/></p>\n<hr/>\n<p><br/></p>\n<h2 id=\"5-calculating-chi-square-in-r\">5. Calculating chi-square in R</h2>\n<p>With both the observed and expected tables at hand, calculating the chi-square statistic becomes a straightforward process. For each cell, subtract the expected value (E) from the observed value (O), square this difference, and then divide by the expected value. Once you complete this calculation for every cell in the table, sum up these individual results. This sum is your chi-square statistic!</p>\n<p><br/></p>\n<p>The next step is to determine how unusual this statistic is within the context of the chi-square distribution. It’s important to remember that this test statistic operates under the assumption that the null hypothesis is true. Therefore, the chi-square distribution will indicate the probability of encountering a chi-square statistic as large as, or larger than, the one you’ve calculated, under the assumption of the <em>null</em> hypothesis.</p>\n<p><br/></p>\n\n\\[\\chi^{2} = \\sum \\frac{(O-E)^{2}}{E}\\]\n\n<p>If you calculate it, you should find something around 59.3. We can plot a chi-square distribution with 4 degrees of freedom and estimate visually the probability of it. The code below does that and highlights the test statistic with a white dashed line. It is clear that a test statistic as large or larger than the one we obtained is extremely unlikely under the <em>null</em> hypothesis.</p>\n<p><br/></p>\n<p><span class=\"material-symbols-outlined\" data-cf-modified-a1355b68835fd3a3f3663fe4-=\"\" id=\"copy-button\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; copyCode('code-18-3')\">\n  content_copy\n  <span class=\"tooltiptext\">Copy</span>\n</span></p>\n<div id=\"code-18-3\">\n<figure class=\"highlight\"><pre>x &lt;- seq(0, 70, 0.1)\n\ny &lt;- dchisq(x, df = 4)\n\ndf_4 &lt;- data.frame(x = x, y = y, df = 4)\n\nggplot(data=df_4, aes(x = x, y = y))+\n  geom_line(linewidth=1, color = \"#C84848\")+\n  geom_vline(xintercept = 59.3, size = 0.4, color = \"white\", linetype = \"dashed\")+\n  labs(y = \"Density Function\",\n       x = \"Chi-squared\")+\n  theme_coding_the_past()</pre></figure>\n</div>\n<p><br/></p>\n<p class=\"larger\"><img alt=\"Test statistic highlighted in the chi square distribution\" data-lazy-src=\"https://i2.wp.com/www.codingthepast.com/assets/images/lesson_18_05.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"Test statistic highlighted in the chi square distribution\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/www.codingthepast.com/assets/images/lesson_18_05.png?w=578&amp;ssl=1\"/></noscript></p>\n<p><br/></p>\n<p>The good news is that the <code>chisq.test</code> function does all this work for us! In only one line of code you perform the test! With the code below you also get a numerical p-value to evaluate your hypotheses.</p>\n<p><br/></p>\n<p><span class=\"material-symbols-outlined\" data-cf-modified-a1355b68835fd3a3f3663fe4-=\"\" id=\"copy-button\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; copyCode('code-18-4')\">\n  content_copy\n  <span class=\"tooltiptext\">Copy</span>\n</span></p>\n<div id=\"code-18-4\">\n<figure class=\"highlight\"><pre>chi_test &lt;- chisq.test(table(df_prep$verdict, df_prep$gender))\n\nchi_test$statistic\nchi_test$p.value\nchi_test$expected</pre></figure>\n</div>\n<p><br/></p>\n<p>The result of <code>chisq.test</code> is stored in a list that I called <code>chi_test</code>. This list has several elements. Some of them are the chi-square statistic, the p-value and even the expected contingency table that we estimated above.</p>\n<p><br/></p>\n<p>Now we can confirm analytically what we showed graphically above. The p-value tells us that the probability of observing a chi-square equal or larger than 59.3 is \\(4.13 \\times 10^{-12}\\) under the <em>null</em> hypothesis. Our data is extremely unlikely under the <em>null</em> and therefore we can reject it. We can then accept the hypothesis that indeed gender and verdict are associated. Nevertheless, keep in mind that association does not mean causation.</p>\n<p><br/></p>\n<p><strong>These findings offer valuable insights into the distinct experiences of men and women in 18th-century London inquests. The results of our chi-square test suggest a relationship between the gender of the deceased and the outcome of an investigation. To further enrich our understanding of this statistical finding, a qualitative analysis could provide deeper context and detail. Your comments and questions are highly welcomed, so please feel free to share your thoughts and inquiries below!</strong></p>\n<p><br/></p>\n<hr/>\n<p><br/></p>\n<h2 id=\"6-conclusions\">6. Conclusions</h2>\n<p><br/></p>\n<ul class=\"conclusion-list\">\n<li>You can easily perform a chi-square test in R with the <code>chisq.test</code> function;</li>\n<li>Degrees of freedom play a crucial role in shaping the chi-square distribution, influencing the accuracy and reliability of our statistical inferences;</li>\n<li>The chi-square test reveals a significant association between gender and the verdicts of 18th-century London inquests, suggesting gender-based differences in investigation outcomes;</li>\n</ul>\n<p><br/></p>\n<hr/>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://www.codingthepast.com/2023/12/04/Chi-square-distribution-in-R.html\"> coding-the-past</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div> </hr></div>\n</article>",
    "main_text": "Chi-square distribution and test in R\nPosted on\nDecember 3, 2023\nby\nPonne, Bruno\nin\nR bloggers\n| 0 Comments\n[This article was first published on\ncoding-the-past\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nGreetings, humanists, social and data scientists!\nWas there an association or relationship between gender and the verdicts in investigations in 18th-century London? If an inquest concerned a man, did this fact influence the final verdict of the investigation?\nIn this lesson we will answer these questions employing a chi-square test and the data explored in the lesson\n‘How to Change Fonts in ggplot2 with Google Fonts’\n. You will learn what degrees of freedom are and how to harness the power of the chi-square distribution to infer relationships in historical London.\n1. Data source\nThe\ndataset\nused in this lesson is made available by\nSharon Howard\n. This dataset documents a range of Westminster inquests conducted between 1760 and 1799. Inquests were mostly investigations into deaths under circumstances that were sudden, unexplained, or suspicious. Please, check the lesson\n‘How to Change Fonts in ggplot2 with Google Fonts’\nfor more information.\n2. Why is the chi-square distribution useful for us?\nThe chi-square distribution is useful because it is the basis for testing the independence of two categorical variables. When we perform this test, the statistic we calculate follows a chi-square distribution. This enables us to determine the probability of observing a specific test statistic in our analytical sample under a certain hypothesis.\ntips_and_updates\nA test statistic is a summary of your sample, reducing your dataset to a single value that enables hypothesis testing.\nIt’s not essential to know the function below, but understanding that the probability density function of a chi-square distribution follows this formula is beneficial. In the following steps we will write R code to generate a chi-square curve with\nn\ndegrees of freedom and now you know that actually what R will compute is the function below with the\nn\nand\nx\ninterval that you pass to the function. Note that f(0) = 0 and that  \\(\\Gamma\\) is the\ngamma function\n.\n\\[f(x) = \\frac{1}{2^{\\frac{n}{2}} \\Gamma(\\frac{n}{2})}x^{\\frac{n}{2}-1}e^{-\\frac{x}{2}}\\]\nThe area under this function gives us the probability of an interval of chi-squares happening. Fortunately, R has a function\ndchisq(x, df)\nthat provides the chi-square density function. In the code below, we plot three chi-square distributions with 4, 8 and 16 degrees of freedom:\nto make it easier to plot the curves with color depending on the degrees of freedom, we create a data frame with three variables: x (from 0 to 50 in 0.1 steps); y (the result of the function f(n,x) above) and df (n degrees of freedom);\nin R, the chi-square density function is calculated with\ndchisq\n;\ncolor aesthetic is mapped to df (degrees of freedom) and to make sure ggplot uses discrete colors we transform degrees of freedom into a factor;\nscale_color_discrete\nis used to give a name to the legend and\ntheme_coding_the_past()\nis our theme available here:\n‘Climate data visualization with ggplot2’\n.\ncontent_copy\nCopy\nlibrary(ggplot2)\n\nx <- seq(0, 50, 0.1)\n\ny1 <- dchisq(x, df = 4)\ny2 <- dchisq(x, df = 8)\ny3 <- dchisq(x, df = 16)\n\ndf1 <- data.frame(x = x, y = y1, df = 4)\ndf2 <- data.frame(x = x, y = y2, df = 8)\ndf3 <- data.frame(x = x, y = y3, df = 16)\n\ndf <- rbind(df1, df2, df3)\n\nggplot(data=df, aes(x = x, y = y, color = as.factor(df)))+\n  geom_line(linewidth=1)+\n  scale_color_discrete(name = \"DF\")+\n  labs(y = \"Density Function\",\n       x = \"Chi-square\")+\n  theme_coding_the_past()\nNote that as the degrees of freedom increase, the chi-square distribution increasingly resembles a normal distribution. With fewer degrees of freedom, the distribution exhibits more asymmetry.\n3. Degrees of freedom in a chi-square test\nAs the plot above demonstrates, degrees of freedom are crucial as they determine the shape of our chi-square distribution. But what exactly are degrees of freedom?\nEssentially, they represent the number of independent pieces of information allowed to vary in a system. For instance, in a contingency table, the degrees of freedom refer to the number of cells that can be varied, considering the total values observed in our sample. Is this concept a bit complex? I have created a video to illustrate this concept more clearly.\nIn a contingency table, degrees of freedom (DF) are calculated with the expression below, where\nnrows\nand\nncolumns\nare the numbers of rows and columns, respectively.\ntips_and_updates\nA contingency table, or crosstab, presents the counts for the combination of two categorical variables.\nRead more here.\n\\[DF = (nrows - 1)(ncolumns - 1)\\]\n4. How to estimate a contingency table under the null hypothesis?\nNow that you’re familiar with the chi-square distribution and understand how to calculate degrees of freedom for a chi-square test, let’s explore how to derive our test statistic. Our aim is to determine if there’s an association between two categorical variables. Therefore, our alternative hypothesis (\nH1\n) posits that these two variables are dependent. Conversely, the\nnull\nhypothesis (\nH0\n) suggests that the variables are independent.\nIn our case, we’re investigating the potential association between gender and verdict variables. To examine our contingency table, please run the following code. For an in-depth explanation of what this code accomplishes, refer to the lesson\n‘How to Change Fonts in ggplot2 with Google Fonts’\nH0\n: There is no association between gender and verdict.\nH1\n: There is association between gender and verdict.\ncontent_copy\nCopy\nlibrary(readr)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(showtext)\n\ndf <- read_tsv(\"wa_coroners_inquests_v1-1.tsv\")\n\ndf_prep <- df %>% \n  filter(verdict != \"-\") %>% \n  mutate(verdict = recode(verdict, \"suicide (delirious)\" = \"suicide\",\n                          \"suicide (felo de se)\" = \"suicide\",\n                          \"suicide (insane)\" = \"suicide\"))\n\ntable_ver <- data.frame(table(df_prep$verdict))\nWhat would the above table appear like if the null hypothesis were true? In other words, if gender and verdict were truly independent, how would we calculate the expected values for each cell in that table? It’s important to remember that when events are independent, their probabilities are not influenced by each other. This principle is key to calculating the expected values in such a scenario.\nFor instance, if we assume that the cause of death and gender are independent, we can calculate the probability of observing a case where a woman had an accidental death by multiplying the probability of the individual being a woman by the probability of an accidental death occurring.  Once you’ve determined this probability, you can then multiply it by the total number of individuals in the sample to estimate the expected count for that specific cell in the table. This procedure is shown below.\nThe calculation for the other cells in the table follows the same methodology. It’s worth noting that many textbooks present the following formula to calculate the expected values, which is based on the logic we’ve just discussed. In this formula,\nRT\nstands for row total;\nCT\nfor column total; and\nTT\nfor table total. You do not have to know this formula if you understood the underlying logic we explained earlier.\n\\[E = \\frac{RT \\times CT}{TT}\\]\nAfter you calculate all the expected values, it is time to calculate our test statistic.\n5. Calculating chi-square in R\nWith both the observed and expected tables at hand, calculating the chi-square statistic becomes a straightforward process. For each cell, subtract the expected value (E) from the observed value (O), square this difference, and then divide by the expected value. Once you complete this calculation for every cell in the table, sum up these individual results. This sum is your chi-square statistic!\nThe next step is to determine how unusual this statistic is within the context of the chi-square distribution. It’s important to remember that this test statistic operates under the assumption that the null hypothesis is true. Therefore, the chi-square distribution will indicate the probability of encountering a chi-square statistic as large as, or larger than, the one you’ve calculated, under the assumption of the\nnull\nhypothesis.\n\\[\\chi^{2} = \\sum \\frac{(O-E)^{2}}{E}\\]\nIf you calculate it, you should find something around 59.3. We can plot a chi-square distribution with 4 degrees of freedom and estimate visually the probability of it. The code below does that and highlights the test statistic with a white dashed line. It is clear that a test statistic as large or larger than the one we obtained is extremely unlikely under the\nnull\nhypothesis.\ncontent_copy\nCopy\nx <- seq(0, 70, 0.1)\n\ny <- dchisq(x, df = 4)\n\ndf_4 <- data.frame(x = x, y = y, df = 4)\n\nggplot(data=df_4, aes(x = x, y = y))+\n  geom_line(linewidth=1, color = \"#C84848\")+\n  geom_vline(xintercept = 59.3, size = 0.4, color = \"white\", linetype = \"dashed\")+\n  labs(y = \"Density Function\",\n       x = \"Chi-squared\")+\n  theme_coding_the_past()\nThe good news is that the\nchisq.test\nfunction does all this work for us! In only one line of code you perform the test! With the code below you also get a numerical p-value to evaluate your hypotheses.\ncontent_copy\nCopy\nchi_test <- chisq.test(table(df_prep$verdict, df_prep$gender))\n\nchi_test$statistic\nchi_test$p.value\nchi_test$expected\nThe result of\nchisq.test\nis stored in a list that I called\nchi_test\n. This list has several elements. Some of them are the chi-square statistic, the p-value and even the expected contingency table that we estimated above.\nNow we can confirm analytically what we showed graphically above. The p-value tells us that the probability of observing a chi-square equal or larger than 59.3 is \\(4.13 \\times 10^{-12}\\) under the\nnull\nhypothesis. Our data is extremely unlikely under the\nnull\nand therefore we can reject it. We can then accept the hypothesis that indeed gender and verdict are associated. Nevertheless, keep in mind that association does not mean causation.\nThese findings offer valuable insights into the distinct experiences of men and women in 18th-century London inquests. The results of our chi-square test suggest a relationship between the gender of the deceased and the outcome of an investigation. To further enrich our understanding of this statistical finding, a qualitative analysis could provide deeper context and detail. Your comments and questions are highly welcomed, so please feel free to share your thoughts and inquiries below!\n6. Conclusions\nYou can easily perform a chi-square test in R with the\nchisq.test\nfunction;\nDegrees of freedom play a crucial role in shaping the chi-square distribution, influencing the accuracy and reliability of our statistical inferences;\nThe chi-square test reveals a significant association between gender and the verdicts of 18th-century London inquests, suggesting gender-based differences in investigation outcomes;\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\ncoding-the-past\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "Greetings, humanists, social and data scientists! Was there an association or relationship between gender and the verdicts in investigations in 18th-century London? If an inquest concerned a man, did this fact influence the final verdict of the in...",
    "meta_keywords": null,
    "og_description": "Greetings, humanists, social and data scientists! Was there an association or relationship between gender and the verdicts in investigations in 18th-century London? If an inquest concerned a man, did this fact influence the final verdict of the in...",
    "og_image": "https://www.codingthepast.com/assets/images/lesson_18_01.png",
    "og_title": "Chi-square distribution and test in R | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 9.6,
    "sitemap_lastmod": "2023-12-04T00:00:00+00:00",
    "twitter_description": "Greetings, humanists, social and data scientists! Was there an association or relationship between gender and the verdicts in investigations in 18th-century London? If an inquest concerned a man, did this fact influence the final verdict of the in...",
    "twitter_title": "Chi-square distribution and test in R | R-bloggers",
    "url": "https://www.r-bloggers.com/2023/12/chi-square-distribution-and-test-in-r/",
    "word_count": 1911
  }
}