{
  "uuid": "f15e693c-8cdf-470f-969e-67c1390a2e74",
  "created_at": "2025-11-17 20:38:45",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2023/12/r-solution-for-excel-puzzles-5/",
    "crawled_at": "2025-11-17T09:26:12.267450",
    "external_links": [
      {
        "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-2aa4c5de1a5f",
        "text": "Numbers around us - Medium"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://www.linkedin.com/in/excelbi/",
        "text": "ExcelBI"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7142362853029703680-SlPO",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dEMCnCc8",
        "text": "file"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7142725252798746624-gCaN",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dnKsnb67",
        "text": "file"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7143087621236326400-G4lH",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dhrfGPyD",
        "text": "file"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7143450016412585984-Y-NB",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dBd2Urab",
        "text": "file"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7143812402743078912-mMir",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dKBreGvx",
        "text": "file"
      },
      {
        "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-2aa4c5de1a5f",
        "text": "R Solution for Excel Puzzles"
      },
      {
        "href": "https://medium.com/number-around-us",
        "text": "Numbers around us"
      },
      {
        "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-2aa4c5de1a5f",
        "text": "Numbers around us - Medium"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "R Solution for Excel Puzzles | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*ctMpVHrPKbsJdOBTzgBJdg.jpeg?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*xsWEZLF99X45YWF8vaXzOw.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*6GDWAHxmvhlHS7DOfOcq6w.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*4y4Dxw8qSGM-3-7pLlOblg.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*EoMZ_aZQmZUKMwCHoBiOIw.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*ERYP0L3MEe4YluhxVIWGew.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:application/octet-stream;base64,R0lGODlhAQABAO+/vQAA77+977+977+9AAAAIe+/vQQBAAAAACwAAAAAAQABAAACAkQBADs=",
        "src": "https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=2aa4c5de1a5f"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/numbers-around-us/",
        "text": "Numbers around us"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-381105 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">R Solution for Excel Puzzles</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 25, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/numbers-around-us/\">Numbers around us</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-2aa4c5de1a5f\"> Numbers around us - Medium</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><p>Puzzles no. 349–353</p><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*ctMpVHrPKbsJdOBTzgBJdg.jpeg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*ctMpVHrPKbsJdOBTzgBJdg.jpeg?w=578&amp;ssl=1\"/></noscript></figure><h3>Puzzles</h3><p>Author: <a href=\"https://www.linkedin.com/in/excelbi/\" rel=\"nofollow\" target=\"_blank\">ExcelBI</a></p><p>Puzzles:<br/>#349: <a href=\"https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7142362853029703680-SlPO\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dEMCnCc8\" rel=\"nofollow\" target=\"_blank\">file</a><br/>#350: <a href=\"https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7142725252798746624-gCaN\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dnKsnb67\" rel=\"nofollow\" target=\"_blank\">file</a><br/>#351: <a href=\"https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7143087621236326400-G4lH\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dhrfGPyD\" rel=\"nofollow\" target=\"_blank\">file</a><br/>#352: <a href=\"https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7143450016412585984-Y-NB\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dBd2Urab\" rel=\"nofollow\" target=\"_blank\">file</a><br/>#353: <a href=\"https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7143812402743078912-mMir\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dKBreGvx\" rel=\"nofollow\" target=\"_blank\">file</a></p><p>Let dig in those numbers.</p><h3>Puzzle #349</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*xsWEZLF99X45YWF8vaXzOw.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*xsWEZLF99X45YWF8vaXzOw.png?w=578&amp;ssl=1\"/></noscript></figure><p>In this puzzle we have to translate “normal” (Arabic) numbers into Roman numerals. With one twist… Historically roman numerals has its limit (3899 if I recall properly), and we have some bigger numbers, so M (thousands) would be un-naturally repeated. Lets do it.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Numbers to Roman.xlsx\", range = \"A1:A10\")\ntest = read_excel(\"Numbers to Roman.xlsx\", range = \"B1:B10\")</pre><h4>Transformation</h4><pre>to_roman &lt;- function(number) {\n if (!is.numeric(number) || number &lt;= 0 || number != as.integer(number)) {\n return(NA)\n }\n \n roman_symbols &lt;- c(\"M\", \"CM\", \"D\", \"CD\", \"C\", \"XC\", \"L\", \"XL\", \"X\", \"IX\", \"V\", \"IV\", \"I\")\n arabic_values &lt;- c(1000, 900, 500, 400, 100, 90, 50, 40, 10, 9, 5, 4, 1)\n \n numeral &lt;- \"\"\n for (i in seq_along(roman_symbols)) {\n while (number &gt;= arabic_values[i]) {\n numeral &lt;- paste0(numeral, roman_symbols[i])\n number &lt;- number - arabic_values[i]\n }\n }\n \n return(numeral)\n}\n\nresult = input %&gt;%\n mutate(Roman = map_chr(Number, to_roman))</pre><h4>Validation</h4><pre>identical(result$Roman, test$Roman)\n#&gt; [1] TRUE</pre><h3>Puzzle #350</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*6GDWAHxmvhlHS7DOfOcq6w.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*6GDWAHxmvhlHS7DOfOcq6w.png?w=578&amp;ssl=1\"/></noscript></figure><p>Today we have insolite numbers. Wait what? What kind of number our host dug up from voids of maths? Insolite numbers are such numbers that are divisible by both sum of squares of digits and product of squares of digits. Just another interesting property of number. Can we extract them from given column? Why not.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Insolite Number.xlsx\", range = \"A1:A10\") %&gt;% janitor::clean_names()\ntest = read_excel(\"Insolite Number.xlsx\", range = \"B1:B6\") %&gt;% janitor::clean_names()</pre><h4>Transformation</h4><pre>is_insolite = function(number) {\n digits = strsplit(as.character(number), \"\")[[1]]\n digits = as.numeric(digits)\n \n sum_of_squares = sum(digits^2)\n product_of_squares = prod(digits^2) \n \n div_by_sum = number %% sum_of_squares == 0\n div_by_prod = number %% product_of_squares == 0\n \n return(div_by_sum &amp; div_by_prod)\n}\n\nresult = input %&gt;%\n mutate(answer_expected = map(numbers, is_insolite)) %&gt;%\n filter(answer_expected == TRUE) %&gt;%\n select(numbers)</pre><h4>Verification</h4><pre>identical(result$numbers, test$answer_expected)\n#&gt; [1] TRUE</pre><h3>Puzzle #351</h3><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*4y4Dxw8qSGM-3-7pLlOblg.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*4y4Dxw8qSGM-3-7pLlOblg.png?w=578&amp;ssl=1\"/></noscript></figure><p>Mixing words again, but not all. What we have to do is mix or rather change order of words into reverse one in part of sentence. We get two numbers that point to start and end of reversed section. Results looks little bit like Yoda’s talks.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Reverse Words between Positions.xlsx\", range = \"A1:C9\")\ntest  = read_excel(\"Reverse Words between Positions.xlsx\", range = \"D1:D9\")</pre><h4>Transform</h4><pre>reverse_words &lt;- function(text, start_pos, end_pos) {\n  words &lt;- str_split(text, \" \")[[1]]\n  words[start_pos:end_pos] &lt;- rev(words[start_pos:end_pos])\n  words &lt;- words[!is.na(words)]\n  paste(words, collapse = \" \")\n}\n\nresult = input %&gt;% \n  mutate(reversed = pmap_chr(list(text = Sentence, \n                                  start_pos = `Word No1`, \n                                  end_pos = `Word No2`), reverse_words)) %&gt;%\n  select(reversed)</pre><h4>Validation</h4><pre>identical(test$`Answer Expected`, result$reversed)\n#&gt; [1] TRUE</pre><h3>Puzzle #352</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*EoMZ_aZQmZUKMwCHoBiOIw.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*EoMZ_aZQmZUKMwCHoBiOIw.png?w=578&amp;ssl=1\"/></noscript></figure><p>There are more numbers with interesting properties and today we have interprimes. How do we describe them? Numbers that are equally distant from neighbouring primes or if it will be easier to understand, this number is a mean of two consecutive primes</p><p>I’ve done this two ways: one with dedicated function, one more in base R syntax involved.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(numbers)\n\ninput = read_excel(\"Excel/352 Interprime Numbers.xlsx\", range = \"A1:A10\") %&gt;% janitor::clean_names()\ntest  = read_excel(\"Excel/352 Interprime Numbers.xlsx\", range = \"B1:B6\") %&gt;% janitor::clean_names()</pre><h4>Transformation</h4><pre># Version using ready numbers package functions\nis_interprime &lt;- function(n) {\n  if (!is.integer(n)) {return(FALSE)}\n  prev_prime &lt;- previousPrime(n)\n  next_prime &lt;- nextPrime(n)\n  return(n == (prev_prime + next_prime) / 2)\n}\n\n# version with own functions (we are gonna use only is_prime from numbers package)  \nnext_prime = function(n) {\n  repeat {\n    n = n + 1\n    if (isPrime(n)) {return(n)}\n  }\n}\nprevious_prime = function(n) {\n  while (n &gt; 2) {\n    n = n - 1\n    if (isPrime(n)) {return(n)}\n  }\n}\nis_interprime_2 &lt;- function(n) {\n  if (!is.integer(n)) {return(FALSE)}\n  prev_prime &lt;- previous_prime(n)\n  next_prime &lt;- next_prime(n)\n\n  return(n == (prev_prime + next_prime) / 2)\n}\n\nresult = input %&gt;%\n  mutate(number = as.integer(number)) %&gt;%\n  mutate(is_interprime = map_lgl(number, is_interprime),\n         is_interprime_2 = map_lgl(number, is_interprime_2)) %&gt;%\n  filter(is_interprime) %&gt;%\n  bind_cols(test)</pre><h4>Validation</h4><pre>identical(as.numeric(result$number), result$answer_expected)\n#&gt; [1] TRUE</pre><h3>Puzzle #353</h3><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*ERYP0L3MEe4YluhxVIWGew.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*ERYP0L3MEe4YluhxVIWGew.png?w=578&amp;ssl=1\"/></noscript></figure><p>We lost some letters, and there are some holes in it. We have to find what letters are missing in every sequence and give only missing ones.</p><p>Try it.</p><h4>Loading library and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/353 Missing Letters.xlsx\", range = \"A1:A10\")\ntest  = read_excel(\"Excel/353 Missing Letters.xlsx\", range = \"B1:B10\")</pre><h4>Transformation</h4><pre>result = input %&gt;%\n  mutate(let = strsplit(Letters, \", \")) %&gt;%\n  mutate(let = map(let, sort)) %&gt;%\n  mutate(min = map(let, min),\n         max = map(let, max),\n         min_index = map_int(min, ~ which(letters == .x)),\n         max_index = map_int(max, ~ which(letters == .x)), \n         seq = map2(min_index, max_index, ~ letters[.x:.y]),\n         diff = map2(seq, let, ~ setdiff(.x, .y)),\n         answer = map_chr(diff, ~ paste(.x, collapse = \", \"))\n         ) %&gt;%\n  select(Letters, answer) %&gt;%\n  mutate(answer = ifelse(answer == \"\", NA, answer))</pre><h4>Validation</h4><pre>identical(result$answer, test$`Expected Answer`)\n# [1] TRUE</pre><p>Feel free to comment, share and contact me with advices, questions and your ideas how to improve anything.</p><img alt=\"\" data-lazy-src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=2aa4c5de1a5f\" height=\"1\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"1\"/><noscript><img alt=\"\" height=\"1\" loading=\"lazy\" src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=2aa4c5de1a5f\" width=\"1\"/></noscript><hr/><p><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-2aa4c5de1a5f\" rel=\"nofollow\" target=\"_blank\">R Solution for Excel Puzzles</a> was originally published in <a href=\"https://medium.com/number-around-us\" rel=\"nofollow\" target=\"_blank\">Numbers around us</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-2aa4c5de1a5f\"> Numbers around us - Medium</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
    "main_text": "R Solution for Excel Puzzles\nPosted on\nDecember 25, 2023\nby\nNumbers around us\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nNumbers around us - Medium\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nPuzzles no. 349–353\nPuzzles\nAuthor:\nExcelBI\nPuzzles:\n#349:\ncontent\nfile\n#350:\ncontent\nfile\n#351:\ncontent\nfile\n#352:\ncontent\nfile\n#353:\ncontent\nfile\nLet dig in those numbers.\nPuzzle #349\nIn this puzzle we have to translate “normal” (Arabic) numbers into Roman numerals. With one twist… Historically roman numerals has its limit (3899 if I recall properly), and we have some bigger numbers, so M (thousands) would be un-naturally repeated. Lets do it.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Numbers to Roman.xlsx\", range = \"A1:A10\")\ntest = read_excel(\"Numbers to Roman.xlsx\", range = \"B1:B10\")\nTransformation\nto_roman <- function(number) {\n if (!is.numeric(number) || number <= 0 || number != as.integer(number)) {\n return(NA)\n }\n \n roman_symbols <- c(\"M\", \"CM\", \"D\", \"CD\", \"C\", \"XC\", \"L\", \"XL\", \"X\", \"IX\", \"V\", \"IV\", \"I\")\n arabic_values <- c(1000, 900, 500, 400, 100, 90, 50, 40, 10, 9, 5, 4, 1)\n \n numeral <- \"\"\n for (i in seq_along(roman_symbols)) {\n while (number >= arabic_values[i]) {\n numeral <- paste0(numeral, roman_symbols[i])\n number <- number - arabic_values[i]\n }\n }\n \n return(numeral)\n}\n\nresult = input %>%\n mutate(Roman = map_chr(Number, to_roman))\nValidation\nidentical(result$Roman, test$Roman)\n#> [1] TRUE\nPuzzle #350\nToday we have insolite numbers. Wait what? What kind of number our host dug up from voids of maths? Insolite numbers are such numbers that are divisible by both sum of squares of digits and product of squares of digits. Just another interesting property of number. Can we extract them from given column? Why not.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Insolite Number.xlsx\", range = \"A1:A10\") %>% janitor::clean_names()\ntest = read_excel(\"Insolite Number.xlsx\", range = \"B1:B6\") %>% janitor::clean_names()\nTransformation\nis_insolite = function(number) {\n digits = strsplit(as.character(number), \"\")[[1]]\n digits = as.numeric(digits)\n \n sum_of_squares = sum(digits^2)\n product_of_squares = prod(digits^2) \n \n div_by_sum = number %% sum_of_squares == 0\n div_by_prod = number %% product_of_squares == 0\n \n return(div_by_sum & div_by_prod)\n}\n\nresult = input %>%\n mutate(answer_expected = map(numbers, is_insolite)) %>%\n filter(answer_expected == TRUE) %>%\n select(numbers)\nVerification\nidentical(result$numbers, test$answer_expected)\n#> [1] TRUE\nPuzzle #351\nMixing words again, but not all. What we have to do is mix or rather change order of words into reverse one in part of sentence. We get two numbers that point to start and end of reversed section. Results looks little bit like Yoda’s talks.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Reverse Words between Positions.xlsx\", range = \"A1:C9\")\ntest  = read_excel(\"Reverse Words between Positions.xlsx\", range = \"D1:D9\")\nTransform\nreverse_words <- function(text, start_pos, end_pos) {\n  words <- str_split(text, \" \")[[1]]\n  words[start_pos:end_pos] <- rev(words[start_pos:end_pos])\n  words <- words[!is.na(words)]\n  paste(words, collapse = \" \")\n}\n\nresult = input %>% \n  mutate(reversed = pmap_chr(list(text = Sentence, \n                                  start_pos = `Word No1`, \n                                  end_pos = `Word No2`), reverse_words)) %>%\n  select(reversed)\nValidation\nidentical(test$`Answer Expected`, result$reversed)\n#> [1] TRUE\nPuzzle #352\nThere are more numbers with interesting properties and today we have interprimes. How do we describe them? Numbers that are equally distant from neighbouring primes or if it will be easier to understand, this number is a mean of two consecutive primes\nI’ve done this two ways: one with dedicated function, one more in base R syntax involved.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(numbers)\n\ninput = read_excel(\"Excel/352 Interprime Numbers.xlsx\", range = \"A1:A10\") %>% janitor::clean_names()\ntest  = read_excel(\"Excel/352 Interprime Numbers.xlsx\", range = \"B1:B6\") %>% janitor::clean_names()\nTransformation\n# Version using ready numbers package functions\nis_interprime <- function(n) {\n  if (!is.integer(n)) {return(FALSE)}\n  prev_prime <- previousPrime(n)\n  next_prime <- nextPrime(n)\n  return(n == (prev_prime + next_prime) / 2)\n}\n\n# version with own functions (we are gonna use only is_prime from numbers package)  \nnext_prime = function(n) {\n  repeat {\n    n = n + 1\n    if (isPrime(n)) {return(n)}\n  }\n}\nprevious_prime = function(n) {\n  while (n > 2) {\n    n = n - 1\n    if (isPrime(n)) {return(n)}\n  }\n}\nis_interprime_2 <- function(n) {\n  if (!is.integer(n)) {return(FALSE)}\n  prev_prime <- previous_prime(n)\n  next_prime <- next_prime(n)\n\n  return(n == (prev_prime + next_prime) / 2)\n}\n\nresult = input %>%\n  mutate(number = as.integer(number)) %>%\n  mutate(is_interprime = map_lgl(number, is_interprime),\n         is_interprime_2 = map_lgl(number, is_interprime_2)) %>%\n  filter(is_interprime) %>%\n  bind_cols(test)\nValidation\nidentical(as.numeric(result$number), result$answer_expected)\n#> [1] TRUE\nPuzzle #353\nWe lost some letters, and there are some holes in it. We have to find what letters are missing in every sequence and give only missing ones.\nTry it.\nLoading library and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/353 Missing Letters.xlsx\", range = \"A1:A10\")\ntest  = read_excel(\"Excel/353 Missing Letters.xlsx\", range = \"B1:B10\")\nTransformation\nresult = input %>%\n  mutate(let = strsplit(Letters, \", \")) %>%\n  mutate(let = map(let, sort)) %>%\n  mutate(min = map(let, min),\n         max = map(let, max),\n         min_index = map_int(min, ~ which(letters == .x)),\n         max_index = map_int(max, ~ which(letters == .x)), \n         seq = map2(min_index, max_index, ~ letters[.x:.y]),\n         diff = map2(seq, let, ~ setdiff(.x, .y)),\n         answer = map_chr(diff, ~ paste(.x, collapse = \", \"))\n         ) %>%\n  select(Letters, answer) %>%\n  mutate(answer = ifelse(answer == \"\", NA, answer))\nValidation\nidentical(result$answer, test$`Expected Answer`)\n# [1] TRUE\nFeel free to comment, share and contact me with advices, questions and your ideas how to improve anything.\nR Solution for Excel Puzzles\nwas originally published in\nNumbers around us\non Medium, where people are continuing the conversation by highlighting and responding to this story.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nNumbers around us - Medium\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "Puzzles no. 349–353PuzzlesAuthor: ExcelBIPuzzles:#349: content file#350: content file#351: content file#352: content file#353: content fileLet dig in those numbers.Puzzle #349In this puzzle we have to translate “normal” (Arabic) numbers into Roman nume...",
    "meta_keywords": null,
    "og_description": "Puzzles no. 349–353PuzzlesAuthor: ExcelBIPuzzles:#349: content file#350: content file#351: content file#352: content file#353: content fileLet dig in those numbers.Puzzle #349In this puzzle we have to translate “normal” (Arabic) numbers into Roman nume...",
    "og_image": "https://cdn-images-1.medium.com/max/1024/1*ctMpVHrPKbsJdOBTzgBJdg.jpeg",
    "og_title": "R Solution for Excel Puzzles | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 4.9,
    "sitemap_lastmod": "2023-12-25T12:05:38+00:00",
    "twitter_description": "Puzzles no. 349–353PuzzlesAuthor: ExcelBIPuzzles:#349: content file#350: content file#351: content file#352: content file#353: content fileLet dig in those numbers.Puzzle #349In this puzzle we have to translate “normal” (Arabic) numbers into Roman nume...",
    "twitter_title": "R Solution for Excel Puzzles | R-bloggers",
    "url": "https://www.r-bloggers.com/2023/12/r-solution-for-excel-puzzles-5/",
    "word_count": 978
  }
}