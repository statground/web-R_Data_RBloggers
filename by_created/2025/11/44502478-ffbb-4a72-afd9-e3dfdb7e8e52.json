{
  "uuid": "44502478-ffbb-4a72-afd9-e3dfdb7e8e52",
  "created_at": "2025-11-17 20:38:55",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2023/12/powerquery-puzzle-solved-with-r-4/",
    "crawled_at": "2025-11-17T09:37:19.956738",
    "external_links": [
      {
        "href": "https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-238bd9134a7b",
        "text": "Numbers around us - Medium"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_challenge-powerquerychallenge-daxchallenge-activity-7139101359873716224-MtwR",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/deRqzY23",
        "text": "file"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_challenge-powerquerychallenge-daxchallenge-activity-7139463742718746624-9vTx",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/du6z5w-v",
        "text": "file"
      },
      {
        "href": "https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-238bd9134a7b",
        "text": "PowerQuery Puzzle solved with R"
      },
      {
        "href": "https://medium.com/number-around-us",
        "text": "Numbers around us"
      },
      {
        "href": "https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-238bd9134a7b",
        "text": "Numbers around us - Medium"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "PowerQuery Puzzle solved with R | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*H-ZnrcMOgrXvkzGrMY8LxA.jpeg?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*I4Xr8FKW9pu5pTpPhg7fxA.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*FkjIYsPaRj7cG_IzersnGQ.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:application/octet-stream;base64,R0lGODlhAQABAO+/vQAA77+977+977+9AAAAIe+/vQQBAAAAACwAAAAAAQABAAACAkQBADs=",
        "src": "https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=238bd9134a7b"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/numbers-around-us/",
        "text": "Numbers around us"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-380813 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">PowerQuery Puzzle solved with R</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 12, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/numbers-around-us/\">Numbers around us</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-238bd9134a7b\"> Numbers around us - Medium</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><p># 137–138</p><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*H-ZnrcMOgrXvkzGrMY8LxA.jpeg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*H-ZnrcMOgrXvkzGrMY8LxA.jpeg?w=578&amp;ssl=1\"/></noscript></figure><h3>Puzzles:</h3><p>PQ_137: <a href=\"https://www.linkedin.com/posts/excelbi_challenge-powerquerychallenge-daxchallenge-activity-7139101359873716224-MtwR\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/deRqzY23\" rel=\"nofollow\" target=\"_blank\">file</a><br/>PQ_138: <a href=\"https://www.linkedin.com/posts/excelbi_challenge-powerquerychallenge-daxchallenge-activity-7139463742718746624-9vTx\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/du6z5w-v\" rel=\"nofollow\" target=\"_blank\">file</a></p><h3>PQ_137</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*I4Xr8FKW9pu5pTpPhg7fxA.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*I4Xr8FKW9pu5pTpPhg7fxA.png?w=578&amp;ssl=1\"/></noscript></figure><p>Our goal today is to find out some data properties in table, but unfortunatelly they are weirdly nested in cells. It doesn’t look scary because we already know that many structured are nested like JSONs or XMLs. So today we have to unfold bowels of one table and join it with the second one to get proper data. Let’s do it.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\nT1 = read_excel(\"PQ_Challenge_137.xlsx\", range = \"A1:B5\")\nT2 = read_excel(\"PQ_Challenge_137.xlsx\", range = \"A9:B21\")\n\ntest = read_excel(\"PQ_Challenge_137.xlsx\", range = \"E1:H9\")</pre><h4>Data transformation</h4><pre>T1_1 = T1 %&gt;%\n  separate_rows(Company, sep = \";|,\") %&gt;%\n  mutate(Company = str_remove_all(Company, \"[:space:]\")) %&gt;%\n  separate(Company, into = c(\"ID\",\"Company\"),sep = \":\") %&gt;%\n  mutate(ID = as.numeric(ID)) \n\nresult = T1_1 %&gt;%\n  left_join(T2, by = \"Company\") %&gt;%\n  arrange(Group, Company)</pre><h4>Validation</h4><pre>identical(result, test)\n#&gt; [1] TRUE</pre><h3>PQ_138</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*FkjIYsPaRj7cG_IzersnGQ.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*FkjIYsPaRj7cG_IzersnGQ.png?w=578&amp;ssl=1\"/></noscript></figure><p>We have something like tape of letters with corresponding numbers. I don’t know what is the sense and purpose of it, but I know what we need to achieve. We are gonna take letters and cutting it by 10 make them columns. Whats weirder after transposition we need letters to be by letters and number by numbers. Some cyphers are really interesting. <br/>Lets tranform this tables as our host wanted.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"PQ_Challenge_138.xlsx\", range = \"A1:F9\")\ntest  = read_excel(\"PQ_Challenge_138.xlsx\", range = \"H1:K10\")</pre><h4>Data transformation</h4><pre>result &lt;- input %&gt;%\n  group_by(group_id = (row_number() - 1) %/% 2) %&gt;%\n  group_map(~ .x) %&gt;%\n  set_names(seq_along(.))\n\na1 = result %&gt;%\n  map(., ~ as_tibble(t(.))) %&gt;%\n  bind_rows() %&gt;%\n  drop_na() %&gt;%\n  add_row(V1 = NA_character_, V2 = NA_character_) \n\na2_L = matrix(a1$V1, ncol=2, byrow = TRUE)\na2_D = matrix(a1$V2, ncol=2, byrow = TRUE)\n\na2 = bind_cols(a2_L, a2_D) %&gt;%\n  as_tibble() %&gt;%\n  rename(Group1 = ...1, Group2 = ...2, Value1 = ...3, Value2 = ...4) %&gt;%\n  mutate(Value1 = as.numeric(Value1),\n         Value2 = as.numeric(Value2))</pre><h4>Validation</h4><pre>identical(a2, test)  \n#&gt; [1] TRUE</pre><p>We’ve seen some nice puzzles considering time changes and it shows little bit out of the box thinking. Feel free to ask, like and share.<br/>Lets be in touch for next article about the functions.</p><img alt=\"\" data-lazy-src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=238bd9134a7b\" height=\"1\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"1\"/><noscript><img alt=\"\" height=\"1\" loading=\"lazy\" src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=238bd9134a7b\" width=\"1\"/></noscript><hr/><p><a href=\"https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-238bd9134a7b\" rel=\"nofollow\" target=\"_blank\">PowerQuery Puzzle solved with R</a> was originally published in <a href=\"https://medium.com/number-around-us\" rel=\"nofollow\" target=\"_blank\">Numbers around us</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-238bd9134a7b\"> Numbers around us - Medium</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
    "main_text": "PowerQuery Puzzle solved with R\nPosted on\nDecember 12, 2023\nby\nNumbers around us\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nNumbers around us - Medium\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\n# 137–138\nPuzzles:\nPQ_137:\ncontent\nfile\nPQ_138:\ncontent\nfile\nPQ_137\nOur goal today is to find out some data properties in table, but unfortunatelly they are weirdly nested in cells. It doesn’t look scary because we already know that many structured are nested like JSONs or XMLs. So today we have to unfold bowels of one table and join it with the second one to get proper data. Let’s do it.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\nT1 = read_excel(\"PQ_Challenge_137.xlsx\", range = \"A1:B5\")\nT2 = read_excel(\"PQ_Challenge_137.xlsx\", range = \"A9:B21\")\n\ntest = read_excel(\"PQ_Challenge_137.xlsx\", range = \"E1:H9\")\nData transformation\nT1_1 = T1 %>%\n  separate_rows(Company, sep = \";|,\") %>%\n  mutate(Company = str_remove_all(Company, \"[:space:]\")) %>%\n  separate(Company, into = c(\"ID\",\"Company\"),sep = \":\") %>%\n  mutate(ID = as.numeric(ID)) \n\nresult = T1_1 %>%\n  left_join(T2, by = \"Company\") %>%\n  arrange(Group, Company)\nValidation\nidentical(result, test)\n#> [1] TRUE\nPQ_138\nWe have something like tape of letters with corresponding numbers. I don’t know what is the sense and purpose of it, but I know what we need to achieve. We are gonna take letters and cutting it by 10 make them columns. Whats weirder after transposition we need letters to be by letters and number by numbers. Some cyphers are really interesting.\nLets tranform this tables as our host wanted.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"PQ_Challenge_138.xlsx\", range = \"A1:F9\")\ntest  = read_excel(\"PQ_Challenge_138.xlsx\", range = \"H1:K10\")\nData transformation\nresult <- input %>%\n  group_by(group_id = (row_number() - 1) %/% 2) %>%\n  group_map(~ .x) %>%\n  set_names(seq_along(.))\n\na1 = result %>%\n  map(., ~ as_tibble(t(.))) %>%\n  bind_rows() %>%\n  drop_na() %>%\n  add_row(V1 = NA_character_, V2 = NA_character_) \n\na2_L = matrix(a1$V1, ncol=2, byrow = TRUE)\na2_D = matrix(a1$V2, ncol=2, byrow = TRUE)\n\na2 = bind_cols(a2_L, a2_D) %>%\n  as_tibble() %>%\n  rename(Group1 = ...1, Group2 = ...2, Value1 = ...3, Value2 = ...4) %>%\n  mutate(Value1 = as.numeric(Value1),\n         Value2 = as.numeric(Value2))\nValidation\nidentical(a2, test)  \n#> [1] TRUE\nWe’ve seen some nice puzzles considering time changes and it shows little bit out of the box thinking. Feel free to ask, like and share.\nLets be in touch for next article about the functions.\nPowerQuery Puzzle solved with R\nwas originally published in\nNumbers around us\non Medium, where people are continuing the conversation by highlighting and responding to this story.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nNumbers around us - Medium\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "# 137–138Puzzles:PQ_137: content filePQ_138: content filePQ_137Our goal today is to find out some data properties in table, but unfortunatelly they are weirdly nested in cells. It doesn’t look scary because we already know that many structured are nest...",
    "meta_keywords": null,
    "og_description": "# 137–138Puzzles:PQ_137: content filePQ_138: content filePQ_137Our goal today is to find out some data properties in table, but unfortunatelly they are weirdly nested in cells. It doesn’t look scary because we already know that many structured are nest...",
    "og_image": "https://cdn-images-1.medium.com/max/1024/1*H-ZnrcMOgrXvkzGrMY8LxA.jpeg",
    "og_title": "PowerQuery Puzzle solved with R | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 2.6,
    "sitemap_lastmod": "2023-12-12T10:20:32+00:00",
    "twitter_description": "# 137–138Puzzles:PQ_137: content filePQ_138: content filePQ_137Our goal today is to find out some data properties in table, but unfortunatelly they are weirdly nested in cells. It doesn’t look scary because we already know that many structured are nest...",
    "twitter_title": "PowerQuery Puzzle solved with R | R-bloggers",
    "url": "https://www.r-bloggers.com/2023/12/powerquery-puzzle-solved-with-r-4/",
    "word_count": 512
  }
}