{
  "uuid": "23c888d0-2287-420f-a1d1-0087d5ebb5a0",
  "created_at": "2025-11-22 19:59:31",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2025/01/just-got-a-paper-on-conformal-prediction-rejected-by-international-journal-of-forecasting-despite-evidence-on-30000-time-series-and-more-whats-going-on-part2-1311-time-series-from-the-tourism/",
    "crawled_at": "2025-11-22T10:56:02.713456",
    "external_links": [
      {
        "href": "https://thierrymoudiki.github.io//blog/2025/01/20/r/forecasting/python/misc/ijf-benchmark-rejection-pt2",
        "text": "T. Moudiki's Webpage - R"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://thierrymoudiki.github.io/blog/2025/01/05/r/forecasting/python/misc/ijf-benchmark-rejection/",
        "text": "#182"
      },
      {
        "href": "https://www.researchgate.net/publication/379643443_Conformalized_predictive_simulations_for_univariate_time_series",
        "text": "sequential split conformal method"
      },
      {
        "href": "https://github.com/Techtonique/ahead",
        "text": "my R packageahead"
      },
      {
        "href": "https://www.otexts.com/fpp3/distaccuracy.html#winkler-score",
        "text": "https://www.otexts.com/fpp3/distaccuracy.html#winkler-score"
      },
      {
        "href": "https://computo.sfds.asso.fr/published-202407-susmann-adaptive-conformal/",
        "text": "https://computo.sfds.asso.fr/published-202407-susmann-adaptive-conformal/"
      },
      {
        "href": "https://thierrymoudiki.github.io//blog/2025/01/20/r/forecasting/python/misc/ijf-benchmark-rejection-pt2",
        "text": "T. Moudiki's Webpage - R"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Just got a paper on conformal prediction REJECTED by International Journal of Forecasting despite evidence on 30,000 time series (and more). What’s going on? Part2: 1311 time series from the Tourism competition | R-bloggers",
    "images": [
      {
        "alt": "img1",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "img1",
        "base64": null,
        "src": "https://i2.wp.com/thierrymoudiki.github.io/images/2025-01-20/2025-01-20-image1.png?w=578&ssl=1"
      },
      {
        "alt": "img2",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "img2",
        "base64": null,
        "src": "https://i1.wp.com/thierrymoudiki.github.io/images/2025-01-20/2025-01-20-image2.png?w=578&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/t-moudiki/",
        "text": "T. Moudiki"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-389981 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Just got a paper on conformal prediction REJECTED by International Journal of Forecasting despite evidence on 30,000 time series (and more). What’s going on? Part2: 1311 time series from the Tourism competition</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">January 19, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/t-moudiki/\">T. Moudiki</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://thierrymoudiki.github.io//blog/2025/01/20/r/forecasting/python/misc/ijf-benchmark-rejection-pt2\"> T. Moudiki's Webpage - R</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47--><p>In <a href=\"https://thierrymoudiki.github.io/blog/2025/01/05/r/forecasting/python/misc/ijf-benchmark-rejection/\" rel=\"nofollow\" target=\"_blank\">#182</a>, I presented a benchmark based on 30,000 time series, comparing the <a href=\"https://www.researchgate.net/publication/379643443_Conformalized_predictive_simulations_for_univariate_time_series\" rel=\"nofollow\" target=\"_blank\">sequential split conformal method</a>  to the state of the art in Conformal prediction for Forecast.</p>\n<p>In this post, I’ll present a benchmark based on 1311 time series from the Tourism competition, comparing the sequential split conformal method to the state of the art. Theta method from the <code>forecast</code> package is used as the base model, along with <a href=\"https://github.com/Techtonique/ahead\" rel=\"nofollow\" target=\"_blank\">my R package <code>ahead</code></a> for conformalizing the base model. 2 target coverage levels are considered: 80% and 95%. The benchmarking errors are measured by:</p>\n<ul>\n<li>Achieved test set coverage rate (percentage of future values that are within the prediction intervals) for 80% and 95% prediction intervals.</li>\n<li>Test set Winkler score (see <a href=\"https://www.otexts.com/fpp3/distaccuracy.html#winkler-score\" rel=\"nofollow\" target=\"_blank\">https://www.otexts.com/fpp3/distaccuracy.html#winkler-score</a> for more details).</li>\n</ul>\n<h1 id=\"0---required-packages\">0 – Required packages</h1>\n<pre>utils::install.packages(c('foreach', 'forecast', 'fpp', 'fpp2', 'remotes', 'Tcomp'),\n                        repos=\"https://cran.r-project.org\")\nremotes::install_github(\"Techtonique/ahead\")\nremotes::install_github(\"thierrymoudiki/simulatetimeseries\")\nremotes::install_github(\"herbps10/AdaptiveConformal\", force=TRUE)\nremotes::install_github(\"thierrymoudiki/misc\")\n\nsuppressWarnings(library(datasets))\nsuppressWarnings(library(forecast))\nsuppressWarnings(library(foreach))\nsuppressWarnings(library(fpp2))\nsuppressWarnings(library(ahead))\nsuppressWarnings(library(AdaptiveConformal))\nsuppressWarnings(library(misc))\nsuppressWarnings(library(Tcomp))\n</pre>\n<h1 id=\"1---useful-functions\">1 – Useful functions</h1>\n<pre>coverage_score &lt;- function(obj, actual) {\n  if (is.null(obj$lower))\n  {\n    return(mean((obj$intervals[, 1] &lt;= actual)*(actual &lt;= obj$intervals[, 2]))*100)\n  }\n  return(mean((obj$lower &lt;= actual)*(actual &lt;= obj$upper))*100)\n}\n\nwinkler_score &lt;- function(obj, actual, level = 95) {\n  alpha &lt;- 1 - level / 100\n  lt &lt;- try(obj$lower, silent = TRUE)\n  ut &lt;- try(obj$upper, silent = TRUE)\n  actual &lt;- as.numeric(actual)\n  if (is.null(lt) || is.null(ut))\n  {\n    lt &lt;- as.numeric(obj$intervals[, 1])\n    ut &lt;- as.numeric(obj$intervals[, 2])\n  }\n  n_points &lt;- length(actual)\n  stopifnot((n_points == length(lt)) &amp;&amp; (n_points == length(ut)))\n  diff_lt &lt;- lt - actual\n  diff_bounds &lt;- ut - lt\n  diff_ut &lt;- actual - ut\n  score &lt;- diff_bounds\n  score &lt;- score + (2 / alpha) * (pmax(diff_lt, 0) + pmax(diff_ut, 0))\n  return(mean(score))\n}\n\nget_error &lt;- function(obj, actual, level = 95)\n{\n  actual &lt;- as.numeric(actual)\n  mean_prediction &lt;- as.numeric(obj$mean)\n  me &lt;- mean(mean_prediction - actual)\n  rmse &lt;- sqrt(mean((mean_prediction - actual)**2))\n  mae &lt;- mean(abs(mean_prediction - actual))\n  mpe &lt;- mean(mean_prediction/actual-1)\n  mape &lt;- mean(abs(mean_prediction/actual-1))\n  coverage &lt;- as.numeric(coverage_score(obj, actual))\n  winkler &lt;- winkler_score(obj, actual, level = level)\n  res &lt;- c(me, rmse, mae, mpe, \n           mape, coverage, winkler)\n  names(res) &lt;- c(\"me\", \"rmse\", \"mae\", \"mpe\", \n                  \"mape\", \"coverage\", \"winkler\")\n  return(res)\n}\n</pre>\n<h1 id=\"2---benchmarking-loop\">2 - Benchmarking loop</h1>\n<pre>ahead_methods &lt;- c(\"block-bootstrap\", \"surrogate\", \n                   \"kde\", \"bootstrap\")\n\naci_methods &lt;- c('ACI', 'SCP', 'AgACI', \n                 'DtACI', 'SF-OGD', 'SAOCP')\n\ni &lt;- 3\nlevel &lt;- 95\nnsim &lt;- 250\nahead_method &lt;- ahead_methods[1]\naci_method &lt;- aci_methods[1]\n\n# base model \nobj &lt;- forecast::thetaf(y=Tcomp::tourism[[i]]$x, \n                        h=Tcomp::tourism[[i]]$h, \n                        level=level) \nprint(get_error(obj, Tcomp::tourism[[i]]$xx))\n\n# conformalized ahead                             \nobj_ahead &lt;- ahead::conformalize(FUN=forecast::thetaf, \n                           y=Tcomp::tourism[[i]]$x, \n                           h=Tcomp::tourism[[i]]$h, \n                           level=level, \n                           nsim = nsim, \n                           method=ahead_method)\nprint(get_error(obj_ahead, Tcomp::tourism[[i]]$xx))\n\n# AdaptiveConformal\n(obj_aci &lt;- AdaptiveConformal::aci(Y = as.vector(Tcomp::tourism[[i]]$xx),\n                                   predictions = as.vector(obj$mean),\n                                   method = \"ACI\",\n                                   alpha = level/100))\nobj_aci$mean &lt;- as.vector(obj$mean)\nprint(get_error(obj_aci, Tcomp::tourism[[i]]$xx))\n\n\n## -----------------------------------------------------------------------------------\nahead_methods &lt;- c(\"block-bootstrap\", \"surrogate\", \n                   \"kde\", \"bootstrap\")\n\naci_methods &lt;- c('ACI', 'SCP', 'AgACI', \n                 'DtACI', 'SF-OGD', 'SAOCP')\n\nn_series &lt;- length(tourism)\n\nfor (level in c(80, 95))\n{\n  pb &lt;- utils::txtProgressBar(min=0, max=n_series, style = 3)\n  benchmark &lt;- foreach::foreach(i=1:n_series, .combine = rbind)%do%\n  {\n    results &lt;- matrix(NA, \n                      nrow= 1 + length(ahead_methods) + length(aci_methods), \n                      ncol=9)\n    colnames(results) &lt;- c(\"series\", \"method\", \n                           \"me\", \"rmse\", \"mae\", \"mpe\", \"mape\", \n                           \"coverage\", \"winkler\")\n    results_index &lt;- 1\n    # base model \n    obj &lt;- forecast::thetaf(y=Tcomp::tourism[[i]]$x, \n                            h=Tcomp::tourism[[i]]$h, \n                            level=level) \n    results[results_index, ] &lt;- c(i, \"none\", \n                                  get_error(obj, Tcomp::tourism[[i]]$xx))\n    results_index &lt;- results_index + 1\n    # conformalized ahead\n    for (j in 1:length(ahead_methods))\n    {\n      obj_ahead &lt;- try(ahead::conformalize(FUN=forecast::thetaf, \n                               y=Tcomp::tourism[[i]]$x, \n                               h=Tcomp::tourism[[i]]$h, \n                               level=level, \n                               nsim = nsim, \n                               method=ahead_methods[j]), silent = TRUE)\n      if (inherits(obj_ahead, \"try-error\"))\n      {\n        results[results_index, ] &lt;- c(i, paste0(\"conformal-\", ahead_methods[j]), rep(NA, 7))\n      } else {\n       results[results_index, ] &lt;- c(i, paste0(\"conformal-\", ahead_methods[j]), \n                                    get_error(obj_ahead, Tcomp::tourism[[i]]$xx)) \n      }\n      results_index &lt;- results_index + 1\n    }\n    # AdaptiveConformal\n    for (j in 1:length(aci_methods))\n    {\n      obj_aci &lt;- try(AdaptiveConformal::aci(Y = as.vector(Tcomp::tourism[[i]]$xx),\n                                         predictions = as.vector(obj$mean),\n                                         method = aci_methods[j],\n                                         alpha = level/100), silent = TRUE)\n      if (inherits(obj_ahead, \"try-error\"))\n      {\n        results[results_index, ] &lt;- c(i, paste0(\"conformal-\", aci_methods[j]), \n                                      rep(NA, 7))\n      } else {\n        obj_aci$mean &lt;- as.vector(obj$mean)\n        results[results_index, ] &lt;- c(i, paste0(\"conformal-\", aci_methods[j]), \n                                    get_error(obj_aci, Tcomp::tourism[[i]]$xx))\n      }\n      results_index &lt;- results_index + 1\n    }\n    \n    utils::setTxtProgressBar(pb, i)\n    results \n  }\n  close(pb)\n  \n  benchmark &lt;- cbind.data.frame(benchmark[, c(1, 2)], \n                                apply(benchmark[, -c(1, 2)], c(1, 2), as.numeric))\n  \n  benchmark$method &lt;- sapply(1:length(benchmark$method), \n                             function(i) gsub(pattern = \"conformal-\",\n                                              replacement = \"\",\n                               x=benchmark$method[i]))\n  \n  saveRDS(benchmark, paste0(\"2025-01-20-tourism-benchmark\", level, \".rds\"))\n}\n</pre>\n<h1 id=\"3---plot-results\">3 - Plot Results</h1>\n<p>Coverage rates and Winkler scores for the 80% and 95% prediction intervals are presented, along with boxplots of the log-error rates (the lower the better).</p>\n<pre>tourism_benchmark80 &lt;- readRDS(\"2025-01-20-tourism-benchmark80.rds\")\ntourism_benchmark95 &lt;- readRDS(\"2025-01-20-tourism-benchmark95.rds\")\n\nbenchmark_medians80 &lt;- cbind.data.frame(tapply(tourism_benchmark80$coverage, \n                                             tourism_benchmark80$method, median),\n                                    tapply(tourism_benchmark80$winkler, \n                                           tourism_benchmark80$method, median))\ncolnames(benchmark_medians80) &lt;- c(\"coverage\", \"winkler_score\")\nmisc::sort_df(benchmark_medians80, by=\"winkler_score\")\n\nbenchmark_medians95 &lt;- cbind.data.frame(tapply(tourism_benchmark95$coverage, \n                                               tourism_benchmark95$method, median),\n                                        tapply(tourism_benchmark95$winkler, \n                                               tourism_benchmark95$method, median))\ncolnames(benchmark_medians95) &lt;- c(\"coverage\", \"winkler_score\")\nmisc::sort_df(benchmark_medians95, by=\"winkler_score\")\n\npar(mfrow=c(2, 1))\nboxplot(log(100-coverage) ~ method, data = tourism_benchmark80, \n        main=\"log-error rates\")\nboxplot(log(100-coverage) ~ method, data = tourism_benchmark95, \n        main=\"log-error rates\")\n\n                coverage winkler_score\nsurrogate       83.33333      9339.212\nblock-bootstrap 83.33333      9372.207\nkde             87.50000      9419.847\nbootstrap       79.16667     10110.819\nnone            75.00000     11582.445\nAgACI           62.50000     17010.164\nDtACI           62.50000     17031.145\nACI             62.50000     17165.020\nSCP             50.00000     18008.067\nSAOCP            0.00000     47472.648\nSF-OGD           0.00000     47535.205\n\n                 coverage winkler_score\nsurrogate        95.83333      9453.619\nblock-bootstrap  95.83333      9625.191\nkde             100.00000      9705.674\nnone             87.50000      9845.460\nbootstrap        91.66667     10042.757\nAgACI            62.50000     16564.417\nACI              62.50000     16649.422\nDtACI            62.50000     16649.422\nSCP              62.50000     16649.422\nSAOCP             0.00000     47472.648\nSF-OGD            0.00000     47535.205\n</pre>\n<p><img alt=\"img1\" class=\"img-responsive\" data-lazy-src=\"https://i2.wp.com/thierrymoudiki.github.io/images/2025-01-20/2025-01-20-image1.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"img1\" class=\"img-responsive\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/thierrymoudiki.github.io/images/2025-01-20/2025-01-20-image1.png?w=578&amp;ssl=1\"/></noscript></p>\n<p><img alt=\"img2\" class=\"img-responsive\" data-lazy-src=\"https://i1.wp.com/thierrymoudiki.github.io/images/2025-01-20/2025-01-20-image2.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"img2\" class=\"img-responsive\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/thierrymoudiki.github.io/images/2025-01-20/2025-01-20-image2.png?w=578&amp;ssl=1\"/></noscript></p>\n<h1 id=\"conclusion\">Conclusion</h1>\n<p>So, based on these extensive experiments against the state of the art (and assuming the implementations of the state of the art methods are correct, which I’m sure they are, see <a href=\"https://computo.sfds.asso.fr/published-202407-susmann-adaptive-conformal/\" rel=\"nofollow\" target=\"_blank\">https://computo.sfds.asso.fr/published-202407-susmann-adaptive-conformal/</a>, and assuming I’m using them well), <strong>how cool is this contribution to the science of forecasting</strong>?</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://thierrymoudiki.github.io//blog/2025/01/20/r/forecasting/python/misc/ijf-benchmark-rejection-pt2\"> T. Moudiki's Webpage - R</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
    "main_text": "Just got a paper on conformal prediction REJECTED by International Journal of Forecasting despite evidence on 30,000 time series (and more). What’s going on? Part2: 1311 time series from the Tourism competition\nPosted on\nJanuary 19, 2025\nby\nT. Moudiki\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nT. Moudiki's Webpage - R\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nIn\n#182\n, I presented a benchmark based on 30,000 time series, comparing the\nsequential split conformal method\nto the state of the art in Conformal prediction for Forecast.\nIn this post, I’ll present a benchmark based on 1311 time series from the Tourism competition, comparing the sequential split conformal method to the state of the art. Theta method from the\nforecast\npackage is used as the base model, along with\nmy R package\nahead\nfor conformalizing the base model. 2 target coverage levels are considered: 80% and 95%. The benchmarking errors are measured by:\nAchieved test set coverage rate (percentage of future values that are within the prediction intervals) for 80% and 95% prediction intervals.\nTest set Winkler score (see\nhttps://www.otexts.com/fpp3/distaccuracy.html#winkler-score\nfor more details).\n0 – Required packages\nutils::install.packages(c('foreach', 'forecast', 'fpp', 'fpp2', 'remotes', 'Tcomp'),\n                        repos=\"https://cran.r-project.org\")\nremotes::install_github(\"Techtonique/ahead\")\nremotes::install_github(\"thierrymoudiki/simulatetimeseries\")\nremotes::install_github(\"herbps10/AdaptiveConformal\", force=TRUE)\nremotes::install_github(\"thierrymoudiki/misc\")\n\nsuppressWarnings(library(datasets))\nsuppressWarnings(library(forecast))\nsuppressWarnings(library(foreach))\nsuppressWarnings(library(fpp2))\nsuppressWarnings(library(ahead))\nsuppressWarnings(library(AdaptiveConformal))\nsuppressWarnings(library(misc))\nsuppressWarnings(library(Tcomp))\n1 – Useful functions\ncoverage_score <- function(obj, actual) {\n  if (is.null(obj$lower))\n  {\n    return(mean((obj$intervals[, 1] <= actual)*(actual <= obj$intervals[, 2]))*100)\n  }\n  return(mean((obj$lower <= actual)*(actual <= obj$upper))*100)\n}\n\nwinkler_score <- function(obj, actual, level = 95) {\n  alpha <- 1 - level / 100\n  lt <- try(obj$lower, silent = TRUE)\n  ut <- try(obj$upper, silent = TRUE)\n  actual <- as.numeric(actual)\n  if (is.null(lt) || is.null(ut))\n  {\n    lt <- as.numeric(obj$intervals[, 1])\n    ut <- as.numeric(obj$intervals[, 2])\n  }\n  n_points <- length(actual)\n  stopifnot((n_points == length(lt)) && (n_points == length(ut)))\n  diff_lt <- lt - actual\n  diff_bounds <- ut - lt\n  diff_ut <- actual - ut\n  score <- diff_bounds\n  score <- score + (2 / alpha) * (pmax(diff_lt, 0) + pmax(diff_ut, 0))\n  return(mean(score))\n}\n\nget_error <- function(obj, actual, level = 95)\n{\n  actual <- as.numeric(actual)\n  mean_prediction <- as.numeric(obj$mean)\n  me <- mean(mean_prediction - actual)\n  rmse <- sqrt(mean((mean_prediction - actual)**2))\n  mae <- mean(abs(mean_prediction - actual))\n  mpe <- mean(mean_prediction/actual-1)\n  mape <- mean(abs(mean_prediction/actual-1))\n  coverage <- as.numeric(coverage_score(obj, actual))\n  winkler <- winkler_score(obj, actual, level = level)\n  res <- c(me, rmse, mae, mpe, \n           mape, coverage, winkler)\n  names(res) <- c(\"me\", \"rmse\", \"mae\", \"mpe\", \n                  \"mape\", \"coverage\", \"winkler\")\n  return(res)\n}\n2 - Benchmarking loop\nahead_methods <- c(\"block-bootstrap\", \"surrogate\", \n                   \"kde\", \"bootstrap\")\n\naci_methods <- c('ACI', 'SCP', 'AgACI', \n                 'DtACI', 'SF-OGD', 'SAOCP')\n\ni <- 3\nlevel <- 95\nnsim <- 250\nahead_method <- ahead_methods[1]\naci_method <- aci_methods[1]\n\n# base model \nobj <- forecast::thetaf(y=Tcomp::tourism[[i]]$x, \n                        h=Tcomp::tourism[[i]]$h, \n                        level=level) \nprint(get_error(obj, Tcomp::tourism[[i]]$xx))\n\n# conformalized ahead                             \nobj_ahead <- ahead::conformalize(FUN=forecast::thetaf, \n                           y=Tcomp::tourism[[i]]$x, \n                           h=Tcomp::tourism[[i]]$h, \n                           level=level, \n                           nsim = nsim, \n                           method=ahead_method)\nprint(get_error(obj_ahead, Tcomp::tourism[[i]]$xx))\n\n# AdaptiveConformal\n(obj_aci <- AdaptiveConformal::aci(Y = as.vector(Tcomp::tourism[[i]]$xx),\n                                   predictions = as.vector(obj$mean),\n                                   method = \"ACI\",\n                                   alpha = level/100))\nobj_aci$mean <- as.vector(obj$mean)\nprint(get_error(obj_aci, Tcomp::tourism[[i]]$xx))\n\n## -----------------------------------------------------------------------------------\nahead_methods <- c(\"block-bootstrap\", \"surrogate\", \n                   \"kde\", \"bootstrap\")\n\naci_methods <- c('ACI', 'SCP', 'AgACI', \n                 'DtACI', 'SF-OGD', 'SAOCP')\n\nn_series <- length(tourism)\n\nfor (level in c(80, 95))\n{\n  pb <- utils::txtProgressBar(min=0, max=n_series, style = 3)\n  benchmark <- foreach::foreach(i=1:n_series, .combine = rbind)%do%\n  {\n    results <- matrix(NA, \n                      nrow= 1 + length(ahead_methods) + length(aci_methods), \n                      ncol=9)\n    colnames(results) <- c(\"series\", \"method\", \n                           \"me\", \"rmse\", \"mae\", \"mpe\", \"mape\", \n                           \"coverage\", \"winkler\")\n    results_index <- 1\n    # base model \n    obj <- forecast::thetaf(y=Tcomp::tourism[[i]]$x, \n                            h=Tcomp::tourism[[i]]$h, \n                            level=level) \n    results[results_index, ] <- c(i, \"none\", \n                                  get_error(obj, Tcomp::tourism[[i]]$xx))\n    results_index <- results_index + 1\n    # conformalized ahead\n    for (j in 1:length(ahead_methods))\n    {\n      obj_ahead <- try(ahead::conformalize(FUN=forecast::thetaf, \n                               y=Tcomp::tourism[[i]]$x, \n                               h=Tcomp::tourism[[i]]$h, \n                               level=level, \n                               nsim = nsim, \n                               method=ahead_methods[j]), silent = TRUE)\n      if (inherits(obj_ahead, \"try-error\"))\n      {\n        results[results_index, ] <- c(i, paste0(\"conformal-\", ahead_methods[j]), rep(NA, 7))\n      } else {\n       results[results_index, ] <- c(i, paste0(\"conformal-\", ahead_methods[j]), \n                                    get_error(obj_ahead, Tcomp::tourism[[i]]$xx)) \n      }\n      results_index <- results_index + 1\n    }\n    # AdaptiveConformal\n    for (j in 1:length(aci_methods))\n    {\n      obj_aci <- try(AdaptiveConformal::aci(Y = as.vector(Tcomp::tourism[[i]]$xx),\n                                         predictions = as.vector(obj$mean),\n                                         method = aci_methods[j],\n                                         alpha = level/100), silent = TRUE)\n      if (inherits(obj_ahead, \"try-error\"))\n      {\n        results[results_index, ] <- c(i, paste0(\"conformal-\", aci_methods[j]), \n                                      rep(NA, 7))\n      } else {\n        obj_aci$mean <- as.vector(obj$mean)\n        results[results_index, ] <- c(i, paste0(\"conformal-\", aci_methods[j]), \n                                    get_error(obj_aci, Tcomp::tourism[[i]]$xx))\n      }\n      results_index <- results_index + 1\n    }\n    \n    utils::setTxtProgressBar(pb, i)\n    results \n  }\n  close(pb)\n  \n  benchmark <- cbind.data.frame(benchmark[, c(1, 2)], \n                                apply(benchmark[, -c(1, 2)], c(1, 2), as.numeric))\n  \n  benchmark$method <- sapply(1:length(benchmark$method), \n                             function(i) gsub(pattern = \"conformal-\",\n                                              replacement = \"\",\n                               x=benchmark$method[i]))\n  \n  saveRDS(benchmark, paste0(\"2025-01-20-tourism-benchmark\", level, \".rds\"))\n}\n3 - Plot Results\nCoverage rates and Winkler scores for the 80% and 95% prediction intervals are presented, along with boxplots of the log-error rates (the lower the better).\ntourism_benchmark80 <- readRDS(\"2025-01-20-tourism-benchmark80.rds\")\ntourism_benchmark95 <- readRDS(\"2025-01-20-tourism-benchmark95.rds\")\n\nbenchmark_medians80 <- cbind.data.frame(tapply(tourism_benchmark80$coverage, \n                                             tourism_benchmark80$method, median),\n                                    tapply(tourism_benchmark80$winkler, \n                                           tourism_benchmark80$method, median))\ncolnames(benchmark_medians80) <- c(\"coverage\", \"winkler_score\")\nmisc::sort_df(benchmark_medians80, by=\"winkler_score\")\n\nbenchmark_medians95 <- cbind.data.frame(tapply(tourism_benchmark95$coverage, \n                                               tourism_benchmark95$method, median),\n                                        tapply(tourism_benchmark95$winkler, \n                                               tourism_benchmark95$method, median))\ncolnames(benchmark_medians95) <- c(\"coverage\", \"winkler_score\")\nmisc::sort_df(benchmark_medians95, by=\"winkler_score\")\n\npar(mfrow=c(2, 1))\nboxplot(log(100-coverage) ~ method, data = tourism_benchmark80, \n        main=\"log-error rates\")\nboxplot(log(100-coverage) ~ method, data = tourism_benchmark95, \n        main=\"log-error rates\")\n\n                coverage winkler_score\nsurrogate       83.33333      9339.212\nblock-bootstrap 83.33333      9372.207\nkde             87.50000      9419.847\nbootstrap       79.16667     10110.819\nnone            75.00000     11582.445\nAgACI           62.50000     17010.164\nDtACI           62.50000     17031.145\nACI             62.50000     17165.020\nSCP             50.00000     18008.067\nSAOCP            0.00000     47472.648\nSF-OGD           0.00000     47535.205\n\n                 coverage winkler_score\nsurrogate        95.83333      9453.619\nblock-bootstrap  95.83333      9625.191\nkde             100.00000      9705.674\nnone             87.50000      9845.460\nbootstrap        91.66667     10042.757\nAgACI            62.50000     16564.417\nACI              62.50000     16649.422\nDtACI            62.50000     16649.422\nSCP              62.50000     16649.422\nSAOCP             0.00000     47472.648\nSF-OGD            0.00000     47535.205\nConclusion\nSo, based on these extensive experiments against the state of the art (and assuming the implementations of the state of the art methods are correct, which I’m sure they are, see\nhttps://computo.sfds.asso.fr/published-202407-susmann-adaptive-conformal/\n, and assuming I’m using them well),\nhow cool is this contribution to the science of forecasting\n?\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nT. Moudiki's Webpage - R\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "Extensive benchmark based on 1311 time series from the Tourism competition, comparing the splitconformal method to the state of the art.",
    "meta_keywords": null,
    "og_description": "Extensive benchmark based on 1311 time series from the Tourism competition, comparing the splitconformal method to the state of the art.",
    "og_image": "https://thierrymoudiki.github.io/images/2025-01-20/2025-01-20-image1.png",
    "og_title": "Just got a paper on conformal prediction REJECTED by International Journal of Forecasting despite evidence on 30,000 time series (and more). What’s going on? Part2: 1311 time series from the Tourism competition | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 6.3,
    "sitemap_lastmod": null,
    "twitter_description": "Extensive benchmark based on 1311 time series from the Tourism competition, comparing the splitconformal method to the state of the art.",
    "twitter_title": "Just got a paper on conformal prediction REJECTED by International Journal of Forecasting despite evidence on 30,000 time series (and more). What’s going on? Part2: 1311 time series from the Tourism competition | R-bloggers",
    "url": "https://www.r-bloggers.com/2025/01/just-got-a-paper-on-conformal-prediction-rejected-by-international-journal-of-forecasting-despite-evidence-on-30000-time-series-and-more-whats-going-on-part2-1311-time-series-from-the-tourism/",
    "word_count": 1266
  }
}