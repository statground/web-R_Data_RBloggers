{
  "id": "c45159d9ab9a98cab8952a4b5a6435cf599bf347",
  "url": "https://www.r-bloggers.com/2025/07/health-technology-notes-copilot-tips-and-guidance/",
  "created_at_utc": "2025-11-22T19:57:59Z",
  "data": null,
  "raw_original": {
    "uuid": "3b90b197-6e6a-4185-a237-e04510d21179",
    "created_at": "2025-11-22 19:57:59",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2025/07/health-technology-notes-copilot-tips-and-guidance/",
      "crawled_at": "2025-11-22T10:44:56.352685",
      "external_links": [
        {
          "href": "https://rworks.dev/posts/healthcare-part2-copilot-supplement/",
          "text": "R Works"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://rworks.dev/posts/healthcare-part1/",
          "text": "introduced"
        },
        {
          "href": "https://towardsdatascience.com/recap-of-all-types-of-llm-agents/",
          "text": "technique"
        },
        {
          "href": "https://datacamp.pxf.io/15bPYD",
          "text": "few-shot"
        },
        {
          "href": "https://docs.posit.co/ide/user/ide/guide/tools/copilot.html",
          "text": "here"
        },
        {
          "href": "https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/Copilot_start.png?ssl=1",
          "text": null
        },
        {
          "href": "https://github.com/VidishaVac/healthcare-analytics/blob/main/cleanDiabetic_data.R",
          "text": "snippet"
        },
        {
          "href": "https://i0.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk21-1.png?ssl=1",
          "text": null
        },
        {
          "href": "https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/convo.png?ssl=1",
          "text": null
        },
        {
          "href": "https://i0.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk3-1.png?ssl=1",
          "text": null
        },
        {
          "href": "https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk4-1.png?ssl=1",
          "text": null
        },
        {
          "href": "https://rworks.dev/posts/healthcare-part2-copilot-supplement/",
          "text": "R Works"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Health Technology notes: Copilot tips and guidance | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/Copilot_start.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk21-1.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/convo.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk3-1.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk4-1.png?w=450&ssl=1"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/vidisha-vachharajani/",
          "text": "Vidisha Vachharajani"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-394429 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Health Technology notes: Copilot tips and guidance</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">July 29, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/vidisha-vachharajani/\">Vidisha Vachharajani</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://rworks.dev/posts/healthcare-part2-copilot-supplement/\"> R Works</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<section class=\"level2\" id=\"introduction\">\n<h2 class=\"anchored\" data-anchor-id=\"introduction\">1. Introduction</h2>\n<section class=\"level3\" id=\"the-use-of-ai-agents-and-the-case-for-prompt-choices\">\n<h3 class=\"anchored\" data-anchor-id=\"the-use-of-ai-agents-and-the-case-for-prompt-choices\">1.1. The use of AI agents and the case for ‚Äúprompt‚Äù choices</h3>\n<p>We <a href=\"https://rworks.dev/posts/healthcare-part1/\" rel=\"nofollow\" target=\"_blank\">introduced</a> the use of the AI pair programmer, Copilot, while working with <code>tidyverse</code>. In this post, we walk the reader through the fundamental driver of successfully using AI agents ‚Äì prompting. Prompting is the method of instructing an LLM to perform a task by carefully designing an input text. Our prompting will be the ‚Äúregular‚Äù or ‚Äúzero-shot‚Äù prompting, the most commonly used prompting <a href=\"https://towardsdatascience.com/recap-of-all-types-of-llm-agents/\" rel=\"nofollow\" target=\"_blank\">technique</a> where you simply ask the agent a question and receive an answer. Typically, while using this, iteration is recommended to get to a more exact answer, especially with coding outputs. This technique is flexible and easy to use, but in my other more complex coding and analytics workflows, I have also used <a href=\"https://datacamp.pxf.io/15bPYD\" rel=\"nofollow\" target=\"_blank\">few-shot</a> prompting, where you provide the LLM with examples and/or context in your prompt. In this post, we will focus on iterative zero-shot prompting.</p>\n</section>\n<section class=\"level3\" id=\"a-recap-of-getting-started-with-copilot-in-rstudio\">\n<h3 class=\"anchored\" data-anchor-id=\"a-recap-of-getting-started-with-copilot-in-rstudio\">1.2. A recap of getting started with Copilot in RStudio</h3>\n<blockquote class=\"blockquote\">\n<p><em><strong>Setting up Copilot in RStudio:</strong> Adding Copilot as a pair programmer to your RStudio is simple, and has a seamless interface.</em> <em>Take a look at the Posit documentation <a href=\"https://docs.posit.co/ide/user/ide/guide/tools/copilot.html\" rel=\"nofollow\" target=\"_blank\"><strong>here</strong></a></em><strong>.</strong> <em>Make sure to enable it! See below.</em></p>\n</blockquote>\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-1\" href=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/Copilot_start.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid\" data-lazy-src=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/Copilot_start.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/Copilot_start.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</section>\n</section>\n<section class=\"level2\" id=\"using-copilot-to-get-data-summaries\">\n<h2 class=\"anchored\" data-anchor-id=\"using-copilot-to-get-data-summaries\">2. Using Copilot to get data summaries</h2>\n<p>After cleaning our data like we do in this <a href=\"https://github.com/VidishaVac/healthcare-analytics/blob/main/cleanDiabetic_data.R\" rel=\"nofollow\" target=\"_blank\">snippet</a>, we will now use Copilot for our first task ‚Äì to get some useful summaries of the fields we think are likely to impact patient care outcomes. We do this in section 2 of our analytics post. Note that to give the right guidance to Copilot for these summaries, we would need to know what fields we are summarizing, and their underlying <code>class</code> within your R workspace, all of which we will specify in our prompt.</p>\n<p>These are the fields we will summarize.</p>\n<table class=\"caption-top table\">\n<colgroup>\n<col style=\"width: 19%\"/>\n<col style=\"width: 19%\"/>\n<col style=\"width: 61%\"/>\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th>Field name</th>\n<th>Field type</th>\n<th>Field description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><code>primary_diag</code></td>\n<td>initial admission covariate</td>\n<td>primary diagnosis upon admission</td>\n</tr>\n<tr class=\"even\">\n<td><code>a1c</code></td>\n<td>initial admission covariate</td>\n<td>whether a patient was given the A1c test or not</td>\n</tr>\n<tr class=\"odd\">\n<td><code>diabetesMed</code></td>\n<td>intermediate response</td>\n<td>whether a patient was given any diabetes medication</td>\n</tr>\n<tr class=\"even\">\n<td><code>acarbose:troglitazone</code></td>\n<td>intermediate response</td>\n<td>individual 23 diabetes medications that were prescribed or not, and if prescribed, were held steady, increased or decreased</td>\n</tr>\n<tr class=\"odd\">\n<td><code>readmitted</code></td>\n<td>final response</td>\n<td>whether the patient was readmitted early (&lt;30 days)</td>\n</tr>\n</tbody>\n</table>\n<p>Table 1: Important data fields and their descriptions</p>\n<blockquote class=\"blockquote\">\n<p><em><strong>Notes:</strong> Take a look at the clip where I show the prompt I wrote to get to the summary code. Note the following ‚Äì</em></p>\n<ol type=\"1\">\n<li><em>The ghost text auto-complete that is typical of Copilot once you begin materializing the initial line of the code.</em></li>\n<li><em>The specifics of the prompt ‚Äì the field names and that they are <code>factor</code> fields, etc.</em></li>\n</ol>\n<p><em>Note that I went back and modified the prompt since I forgot to ask it to include frequency percentages. I also went back and added <code>arrange()</code> myself in order to enable sorting for a neater look. Right after the video, see the final code that was used in the analysis. Note that this does not get us to the final kable outputs and table formatting, which were done manually.</em></p>\n</blockquote>\n<div class=\"quarto-video\"><video class=\"video-js vjs-default-skin vjs-fluid\" controls=\"\" data-setup=\"{}\" id=\"video_shortcode_videojs_video1\" preload=\"auto\" title=\"\"><source src=\"summaryMovie.mov\"/></video></div>\n<p>Click on ‚ÄúShow the code‚Äù to see the Copilot code output from the above interaction.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre># ---------- ---------- ---------- ---------- #\n# Final code output after iterating with Copilot \n# ---------- ---------- ---------- ---------- #\nsummary_a1c &lt;- D %&gt;%\n  group_by(a1c) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))\nsummary_primary_diag &lt;- D %&gt;% \n  group_by(primary_diag) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))\nsummary_readmitted &lt;- D %&gt;% \n  group_by(readmitted) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))\nsummary_change &lt;- D %&gt;% \n  group_by(change) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))\nsummary_diabetesMed &lt;- D %&gt;% \n  group_by(diabetesMed) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))</pre>\n</details>\n</div>\n<p>Click on ‚ÄúShow the code‚Äù to see the final code used to clean the data and generate the summaries.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre># --------------------------------------------- #\n# Load necessary libraries\n# --------------------------------------------- #\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(kableExtra)\nlibrary(gridExtra)\nlibrary(grid)\nlibrary(lattice)\n\n# --------------------------------------------- #\n# Read in the data\n# --------------------------------------------- #\n\nD &lt;- read.csv(\"https://raw.githubusercontent.com/VidishaVac/healthcare-analytics/refs/heads/main/dataset_diabetes/diabetic_data.csv\", sep=\",\")\n\n# -------------------------------------------------------- #\n# Clean and re-define HbA1c and primary diag\n# -------------------------------------------------------- #\n\nD &lt;- D %&gt;%\n  mutate(a1c=ifelse(A1Cresult==\"None\", \"not measured\", \"measured\"), \n         primary_diag = case_when(\n    diag_1 %in% c(390:459, 785) ~ \"Circulatory\",\n    diag_1 %in% c(460:519, 786) ~ \"Respiratory\",\n    diag_1 %in% c(520:579, 787) ~ \"Digestive\",\n    diag_1 %in% c(580:629, 788) ~ \"Genitourinary\",\n    diag_1 %in% c(630:679) ~ \"Pregnancy\",\n    diag_1 %in% c(680:709, 782) ~ \"Skin\",\n    diag_1 %in% c(710:739) ~ \"Musculoskeletal\",\n    diag_1 %in% c(740:759) ~ \"Congenital\",\n    diag_1 %in% c(800:999) ~ \"Injury\",\n    grepl(\"^250\", diag_1) ~ \"Diabetes\",\n    is.na(diag_1) ~ \"Missing\",\n    TRUE ~ \"Other\"\n  ))\n\n# Remove columns not used, patients with a discharge disposition of \"expired\" or \"hospice\"\nD &lt;- D %&gt;% select(1,2,7:9,25:52) %&gt;% \n  filter(!discharge_disposition_id %in% c('11','13','14','19','20','21'))\n\n# Summarize\nsummary_a1c &lt;- D %&gt;%\n  group_by(a1c) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))\nsummary_primary_diag &lt;- D %&gt;% \n  group_by(primary_diag) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))\nsummary_readmitted &lt;- D %&gt;% \n  group_by(readmitted) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))\nsummary_change &lt;- D %&gt;% \n  group_by(change) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))\nsummary_diabetesMed &lt;- D %&gt;% \n  group_by(diabetesMed) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))\n\n# summary_primary_diag %&gt;% \n#   kable(digits = 1, format.args = list(big.mark = \",\"), \n#         caption = \"Breakdown of the primary patient diagnosis upon admission for a diabetic encounter\") %&gt;%\n#           row_spec(1, background = \"yellow\", font_size = \"larger\")</pre>\n</details>\n</div>\n<p>We show an example summary for patient primary diagnosis on admission ‚Äì notice how circulatory diagnoses account for the most common reason for hospital admissions in diabetic encounters. This is a vital insight and an important theme that will run through our analyses.</p>\n<p>To make the summary data easier to consume, we use a circular bar plot. While I did not use Copilot for the actual bar plot, I used GPT-4o (directly in a browser) to achieve this clean 2-column look for the plot and its notes to the right. See here for the full conversation.</p>\n<p>Finally, see ‚ÄúPlot notes‚Äù for details on the design.</p>\n<div class=\"columns\">\n<div class=\"column\" style=\"width:65%;\">\n<div class=\"cell\">\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-2\" href=\"https://i0.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk21-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk21-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk21-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n</div><div class=\"column\" style=\"width:35%;\">\n<div class=\"callout callout-style-default callout-note callout-titled\" title=\"Plot notes\">\n<div class=\"callout-header d-flex align-content-center\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nPlot notes\n</div>\n</div>\n<div class=\"callout-body-container callout-body\">\n<p><span style=\"font-size: 0.8em;\"><em>The circular bar plot offers a visually engaging and effective way to convey categorical comparisons, combining aesthetic appeal with immediate interpretability. One of the strengths of the design here is its ability to simultaneously emphasize both absolute and relative differences through clear axis labeling and proportional arc length. For instance, circulatory disease accounts for 30% of the sample ‚Äî roughly 30,000 encounters ‚Äî while diabetes as a primary admission diagnosis represents just 9%, or fewer than 10,000. These contrasts are instantly evident not only in the numbers but also in the visual impact of the plot. The minimalist style, paired with concise explanatory text above the chart, makes each visual a self-contained and accessible summary ‚Äî both analytically rich and reader-friendly.</em></span></p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>df &lt;- summary_primary_diag\ndf &lt;- df %&gt;% mutate(\n  label=c(paste(round(df$percent[1:5]), \"%\", sep=\"\"),rep(NA,nrow(df)-5)))\n\n\np0 &lt;- ggplot(data=df, aes(x=reorder(primary_diag,count), y=count, fill=percent)) +\n  geom_bar(stat=\"identity\", color=\"black\") + \n  coord_polar() +\n  scale_fill_gradientn(\n    \"Percent\",\n    colours = c( \"#6C5B7B\",\"#C06C84\",\"#F67280\",\"#F8B195\")) +\n  geom_text(aes(x=primary_diag, y=count/2,label = label), size=3.5, \n            color=\"black\",\n            fontface=\"bold\") +\nscale_y_continuous(breaks = seq(0, 40000, by = 10000),\n                  limits = c(-10000, 40000),\n                  expand = c(0, 0)) +\n  annotate(\"text\", x = 11.95, y = 12000, label = \"10,000\", size = 2.5, color = \"black\") +\n  annotate(\"text\", x = 11.95, y = 22000, label = \"20,000\", size = 2.5, color = \"black\") +\n  annotate(\"text\", x = 11.95, y = 32000, label = \"30,000\", size = 2.5, color = \"black\") +\n    theme(\n    # Remove axis ticks and text\n    axis.title = element_blank(),\n    axis.ticks = element_blank(),\n    axis.text.y = element_blank(),\n    # Use gray text for the region names\n    axis.text.x = element_text(color = \"gray12\", size = 10),\n    legend.position = \"none\",\n    plot.title = element_text(face = \"bold\", size = 15),\n    plot.subtitle = element_text(size = 9)) +\n  # Add labels\n  labs(\n    title = \"\\nPatient primary diagnoses\",\n    subtitle = paste(\n      \"\\nPrimary diagnoses of admitted patients vary considerably.\",\n      \"Even for diabetic encounters, the most common admitting diagnosis\",\n      \"is circulatory or heart disease. We will call this out in our analysis,\",\n      \"comparing patient outcomes for these high-risk but non-diabetic\",\n      \"admissions with diabetic admissions (which are only 9% of the\",\n      \"admitting or primary diagnoses).\",\n      sep = \"\\n\"\n    )) </pre>\n</details>\n</div>\n</section>\n<section class=\"level2\" id=\"prompting-pitfalls-what-you-ask-is-what-you-get\">\n<h2 class=\"anchored\" data-anchor-id=\"prompting-pitfalls-what-you-ask-is-what-you-get\">3. Prompting pitfalls: What You Ask Is What You Get</h2>\n<p>Copilot is powerful and easy to use, but in this section, we‚Äôll dive a little more into the importance of iteration ‚Äì how effective prompting often requires fine-tuning, and how insufficient or non-specific guidance can lead you astray.</p>\n<p>Consider the 23 medication prescriptions, each categorized into one of four levels: ùòïùò∞, ùòöùòµùò¶ùò¢ùò•ùò∫, ùòúùò±, or ùòãùò∞ùò∏ùòØ., where the medications include well-known drugs like insulin and metformin. I wanted a strong visual for looking at all 23 in 1 plot, and I started with my own code for a bar plot. Next, I wanted to explore alternate plot types that could reveal more nuanced insights.</p>\n<p>üñºÔ∏è In the image below, you can follow my conversation with Copilot: I began with a vague prompt (‚ÄúCan you fix this blank plot?‚Äù) Then refined it a little (‚ÄúCan you use a different kind of plot?‚Äù) Finally, I gave it the specific guidance it needed (which variables to use and how to specify its aesthetics)</p>\n<p>üîç Only when I provided clear, well-scoped instructions did Copilot return a useful, meaningful visualization.</p>\n<p>üí° Takeaway: The quality of your output depends on the quality of your prompt. Copilot is powerful, but only if you guide it with precision.</p>\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-3\" href=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/convo.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid\" data-lazy-src=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/convo.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/convo.png?w=450&amp;ssl=1\"/></noscript></a></p>\n<p>Click on ‚ÄúShow the code‚Äù to see the actual back-and-forth conversation with Copilot that was the basis of the final visualization.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre># ---------- # \n# Prompt 1\n# ---------- # \n\n# Consider \"meds\" and \"p0\" above. \n# Can you recommend a plot that is not geom_col \n# or geom_bar but that will capture how they are \n# being prescribed, using \"freq\"?\n\n# ---------- # \n# Output 1\n# ---------- # \n\np1 &lt;- ggplot(data=meds, aes(x=medication, y=freq, fill=value)) + \n  geom_area(position = \"fill\") + \n  theme_minimal() + \n  coord_flip() +\n  labs(title = \"Proportion of Medication Prescriptions\", y = \"Proportion (%)\", x = \"Medication\")\n\n# ---------- # \n# Prompt 2\n# ---------- # \n\n# This plot above is blank, can you fix this?\n\n# ---------- # \n# Output 2\n# ---------- # \n\np1 &lt;- ggplot(data=meds, aes(x=medication, y=freq, fill=value)) + \n  geom_area(position = \"fill\") + \n  theme_minimal() + \n  coord_flip() +\n  labs(title = \"Proportion of Medication Prescriptions\", y = \"Proportion (%)\", x = \"Medication\") +\n  scale_y_continuous(labels = scales::percent_format(scale = 1))\n\n# ---------- # \n# Prompt 3\n# ---------- # \n\n# It is still blank, can you use a different type of plot?\n\n# ---------- # \n# Output 3\n# ---------- # \n\np2 &lt;- ggplot(data=meds, aes(x=medication, y=freq, fill=value)) + \n  geom_tile() + \n  theme_minimal() + \n  coord_flip() +\n  labs(title = \"Medication Prescription Frequency\", y = \"Frequency (%)\", x = \"Medication\") +\n  scale_y_continuous(labels = scales::percent_format(scale = 1))\n\n# ---------- # \n# Prompt 4\n# ---------- # \n\n# Do you think geom_tile needs \"medication\" and \"value\" to be on the axes and \"freq\"\n# to be the fill?\n\n# ---------- # \n# Output 4\n# ---------- # \n\np3 &lt;- ggplot(data=meds, aes(x=value, y=medication, fill=freq)) + \n  geom_tile() + \n  theme_minimal() + \n  labs(title = \"Medication Prescription Frequency\", y = \"Medication\", x = \"Value\") +\n  scale_fill_gradient(low = \"blue\", high = \"red\") +\n  scale_x_continuous(labels = scales::percent_format(scale = 1))\n\n# ---------- # \n# Final tweak -- Prompt 5\n# ---------- # \n\n# It seems discrete values have been supplied to continuous scale, can you fix?\n\n# ---------- # \n# Output 5\n# ---------- # \n\np4 &lt;- ggplot(data=meds, aes(x=value, y=medication, fill=freq)) + \n  geom_tile() + \n  theme_minimal() + \n  labs(title = \"Medication Prescription Frequency\", y = \"Medication\", x = \"Value\") +\n  scale_fill_gradient(low = \"blue\", high = \"red\") +\n  scale_x_discrete(labels = scales::percent_format(scale = 1))</pre>\n</details>\n</div>\n<p>Let‚Äôs see the final code used for the visualization outputs, generated from the Copilot conversation above. See plot design notes below for the motivation behind the original bar plot and the crucial difference between the specifications of the 2 plots, and how it relates back to the Copilot iteration above. Click on ‚ÄúShow the code‚Äù to see the underlying plot generating code.</p>\n<section class=\"level3\" id=\"plot-1-original-barplot-with-flipped-coordinates\">\n<h3 class=\"anchored\" data-anchor-id=\"plot-1-original-barplot-with-flipped-coordinates\">Plot 1: Original barplot with flipped coordinates</h3>\n<div class=\"columns\">\n<div class=\"column\" style=\"width:50%;\">\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre># Reshaping wide to get a better view of medications\nmeds &lt;- D %&gt;%\n  select(metformin:metformin.pioglitazone) %&gt;%\n  gather(key = \"medication\", value = \"value\") %&gt;%\n  group_by(medication, value) %&gt;% summarise(n=n()) %&gt;% mutate(pct = (n / sum(n))*100)\n\n# My original barplot with flipped coordinates\np0 &lt;- ggplot(data=meds, aes(x=medication, y=pct, fill=value)) + geom_col() + \n  labs(title = \"Diabetes medications bar plot\",\n       x = \"Medication name\",\n       y = \"Percent prescribed\", fill=\"Medication value\") + theme_minimal() + coord_flip() +\n  theme(plot.title = element_text(hjust = 0.5))\n\np0</pre>\n</details>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-4\" href=\"https://i0.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk3-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk3-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk3-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n</div><div class=\"column\" style=\"width:50%;\">\n<div class=\"callout callout-style-default callout-note callout-titled\" title=\"Plot notes\">\n<div class=\"callout-header d-flex align-content-center\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nPlot notes\n</div>\n</div>\n<div class=\"callout-body-container callout-body\">\n<p><em><strong>Plot notes:</strong> The original barplot on the left is a slightly different use of <code>geom_col()</code>. While it is normally used for a bar chart use case, in this plot, it has a quite useful ‚Äúheatmap‚Äù look. By using <code>coord_flip()</code>, we are able to clearly see the full name of each medication. In my mind, this is a slightly better look than having the medication names be on the x-axis at a 45-degree angle. We enhanced this further by also using <code>geom_tile()</code>.</em></p>\n</div>\n</div>\n</div>\n</div>\n</section>\n<section class=\"level3\" id=\"plot-2-heatmap-with-improved-palette-and-labels\">\n<h3 class=\"anchored\" data-anchor-id=\"plot-2-heatmap-with-improved-palette-and-labels\">Plot 2: Heatmap with improved palette and labels</h3>\n<div class=\"columns\">\n<div class=\"column\" style=\"width:50%;\">\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre># Heatmap with improved color palette and labels\np1 &lt;- ggplot(data=meds, aes(x=value, y=medication, fill=pct)) + geom_tile() + \n  labs(title = \"Diabetes medication heatmap\",\n       x = \"Medication value\",\n       y = \"Medication name\", fill=\"Percent prescribed\") + theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5)) + \n  scale_fill_gradientn(colors = palette.colors(9), \n                       limits = c(0, 100)) +\n  geom_text(aes(label = paste(round(pct, 1), \"%\", sep=\"\")), color = \"white\", size = 3) \n\np1</pre>\n</details>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-5\" href=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk4-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk4-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2-copilot-supplement/index_files/figure-html/Chunk4-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n</div><div class=\"column\" style=\"width:50%;\">\n<div class=\"callout callout-style-default callout-note callout-titled\" title=\"Plot notes\">\n<div class=\"callout-header d-flex align-content-center\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nPlot notes\n</div>\n</div>\n<div class=\"callout-body-container callout-body\">\n<p><span style=\"font-size: 0.95em;\"><em><strong>Plot notes</strong>: Upon switching to a <code>geom_tile()</code></em></span> <em>heatmap plot, the more nuanced prescription variations become much more evident. However, the default color parameters from Copilot output 4 does not offer this as clearly. I adjust these color parameters to make them more robust under color vision deficiencies, making them easily distinguishable for all viewers, and surfacing the actual variations across medications prescribed. I also add data labels to the final plot.</em></p>\n</div>\n</div>\n</div>\n</div>\n<p>Finally, notice the very important difference in the <code>aes()</code> specifications between the 2 plots, which is where the Copilot output 3 from the conversation goes awry, and needs a fine-tuned prompt ‚Äì for the left hand side <code>geom_col()</code>, the <code>fill</code> parameter is the <code>value</code> or the levels of the medication, while for the right hand side <code>geom_tile()</code>, its the actual percent. The legend to the right of each plot shows this.</p>\n</section>\n</section>\n<section class=\"level2\" id=\"whats-next\">\n<h2 class=\"anchored\" data-anchor-id=\"whats-next\">4. What‚Äôs next</h2>\n<p>We will continue showcasing the use of AI agents in our healthcare analytics workflow while using <code>tidyverse</code>, to demonstrate how health technology can benefit stakeholders in this industry, especially given the richness of the data sitting in our health systems. Effectively mining this data using the right tools in order to extract insights that impact care delivery decisions is not just our end goal, but also crucial for the advancement of the use of technology in healthcare.</p>\n</section>\n<section class=\"level2\" id=\"about-the-author\">\n<h2 class=\"anchored\" data-anchor-id=\"about-the-author\">About the Author</h2>\n<p><em>Vidisha writes: ‚ÄúI am a statistician and data science professional. For practitioners like me, ‚Äòtidyverse‚Äô is a household word. I‚Äôve used it for complex data wrangling, visualization, and advanced analytics work, especially where I needed clarity on how to leverage my data so that it allows for story-telling that informs business decisions, recasting my work into actionable insights. I recently began exploring GPT-4o mini and GitHub Copilot to help me speed up my workflows, especially within Healthcare Analytics. I am excited to share this post series to help readers understand the role of RStudio and AI in Healthcare Analytics!‚Äù</em></p>\n</section>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://rworks.dev/posts/healthcare-part2-copilot-supplement/\"> R Works</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
      "main_text": "Health Technology notes: Copilot tips and guidance\nPosted on\nJuly 29, 2025\nby\nVidisha Vachharajani\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nR Works\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\n1. Introduction\n1.1. The use of AI agents and the case for ‚Äúprompt‚Äù choices\nWe\nintroduced\nthe use of the AI pair programmer, Copilot, while working with\ntidyverse\n. In this post, we walk the reader through the fundamental driver of successfully using AI agents ‚Äì prompting. Prompting is the method of instructing an LLM to perform a task by carefully designing an input text. Our prompting will be the ‚Äúregular‚Äù or ‚Äúzero-shot‚Äù prompting, the most commonly used prompting\ntechnique\nwhere you simply ask the agent a question and receive an answer. Typically, while using this, iteration is recommended to get to a more exact answer, especially with coding outputs. This technique is flexible and easy to use, but in my other more complex coding and analytics workflows, I have also used\nfew-shot\nprompting, where you provide the LLM with examples and/or context in your prompt. In this post, we will focus on iterative zero-shot prompting.\n1.2. A recap of getting started with Copilot in RStudio\nSetting up Copilot in RStudio:\nAdding Copilot as a pair programmer to your RStudio is simple, and has a seamless interface.\nTake a look at the Posit documentation\nhere\n.\nMake sure to enable it! See below.\n2. Using Copilot to get data summaries\nAfter cleaning our data like we do in this\nsnippet\n, we will now use Copilot for our first task ‚Äì to get some useful summaries of the fields we think are likely to impact patient care outcomes. We do this in section 2 of our analytics post. Note that to give the right guidance to Copilot for these summaries, we would need to know what fields we are summarizing, and their underlying\nclass\nwithin your R workspace, all of which we will specify in our prompt.\nThese are the fields we will summarize.\nField name\nField type\nField description\nprimary_diag\ninitial admission covariate\nprimary diagnosis upon admission\na1c\ninitial admission covariate\nwhether a patient was given the A1c test or not\ndiabetesMed\nintermediate response\nwhether a patient was given any diabetes medication\nacarbose:troglitazone\nintermediate response\nindividual 23 diabetes medications that were prescribed or not, and if prescribed, were held steady, increased or decreased\nreadmitted\nfinal response\nwhether the patient was readmitted early (<30 days)\nTable 1: Important data fields and their descriptions\nNotes:\nTake a look at the clip where I show the prompt I wrote to get to the summary code. Note the following ‚Äì\nThe ghost text auto-complete that is typical of Copilot once you begin materializing the initial line of the code.\nThe specifics of the prompt ‚Äì the field names and that they are\nfactor\nfields, etc.\nNote that I went back and modified the prompt since I forgot to ask it to include frequency percentages. I also went back and added\narrange()\nmyself in order to enable sorting for a neater look. Right after the video, see the final code that was used in the analysis. Note that this does not get us to the final kable outputs and table formatting, which were done manually.\nClick on ‚ÄúShow the code‚Äù to see the Copilot code output from the above interaction.\nShow the code\n# ---------- ---------- ---------- ---------- #\n# Final code output after iterating with Copilot \n# ---------- ---------- ---------- ---------- #\nsummary_a1c <- D %>%\n  group_by(a1c) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\nsummary_primary_diag <- D %>% \n  group_by(primary_diag) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\nsummary_readmitted <- D %>% \n  group_by(readmitted) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\nsummary_change <- D %>% \n  group_by(change) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\nsummary_diabetesMed <- D %>% \n  group_by(diabetesMed) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\nClick on ‚ÄúShow the code‚Äù to see the final code used to clean the data and generate the summaries.\nShow the code\n# --------------------------------------------- #\n# Load necessary libraries\n# --------------------------------------------- #\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(kableExtra)\nlibrary(gridExtra)\nlibrary(grid)\nlibrary(lattice)\n\n# --------------------------------------------- #\n# Read in the data\n# --------------------------------------------- #\n\nD <- read.csv(\"https://raw.githubusercontent.com/VidishaVac/healthcare-analytics/refs/heads/main/dataset_diabetes/diabetic_data.csv\", sep=\",\")\n\n# -------------------------------------------------------- #\n# Clean and re-define HbA1c and primary diag\n# -------------------------------------------------------- #\n\nD <- D %>%\n  mutate(a1c=ifelse(A1Cresult==\"None\", \"not measured\", \"measured\"), \n         primary_diag = case_when(\n    diag_1 %in% c(390:459, 785) ~ \"Circulatory\",\n    diag_1 %in% c(460:519, 786) ~ \"Respiratory\",\n    diag_1 %in% c(520:579, 787) ~ \"Digestive\",\n    diag_1 %in% c(580:629, 788) ~ \"Genitourinary\",\n    diag_1 %in% c(630:679) ~ \"Pregnancy\",\n    diag_1 %in% c(680:709, 782) ~ \"Skin\",\n    diag_1 %in% c(710:739) ~ \"Musculoskeletal\",\n    diag_1 %in% c(740:759) ~ \"Congenital\",\n    diag_1 %in% c(800:999) ~ \"Injury\",\n    grepl(\"^250\", diag_1) ~ \"Diabetes\",\n    is.na(diag_1) ~ \"Missing\",\n    TRUE ~ \"Other\"\n  ))\n\n# Remove columns not used, patients with a discharge disposition of \"expired\" or \"hospice\"\nD <- D %>% select(1,2,7:9,25:52) %>% \n  filter(!discharge_disposition_id %in% c('11','13','14','19','20','21'))\n\n# Summarize\nsummary_a1c <- D %>%\n  group_by(a1c) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\nsummary_primary_diag <- D %>% \n  group_by(primary_diag) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\nsummary_readmitted <- D %>% \n  group_by(readmitted) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\nsummary_change <- D %>% \n  group_by(change) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\nsummary_diabetesMed <- D %>% \n  group_by(diabetesMed) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\n\n# summary_primary_diag %>% \n#   kable(digits = 1, format.args = list(big.mark = \",\"), \n#         caption = \"Breakdown of the primary patient diagnosis upon admission for a diabetic encounter\") %>%\n#           row_spec(1, background = \"yellow\", font_size = \"larger\")\nWe show an example summary for patient primary diagnosis on admission ‚Äì notice how circulatory diagnoses account for the most common reason for hospital admissions in diabetic encounters. This is a vital insight and an important theme that will run through our analyses.\nTo make the summary data easier to consume, we use a circular bar plot. While I did not use Copilot for the actual bar plot, I used GPT-4o (directly in a browser) to achieve this clean 2-column look for the plot and its notes to the right. See here for the full conversation.\nFinally, see ‚ÄúPlot notes‚Äù for details on the design.\nPlot notes\nThe circular bar plot offers a visually engaging and effective way to convey categorical comparisons, combining aesthetic appeal with immediate interpretability. One of the strengths of the design here is its ability to simultaneously emphasize both absolute and relative differences through clear axis labeling and proportional arc length. For instance, circulatory disease accounts for 30% of the sample ‚Äî roughly 30,000 encounters ‚Äî while diabetes as a primary admission diagnosis represents just 9%, or fewer than 10,000. These contrasts are instantly evident not only in the numbers but also in the visual impact of the plot. The minimalist style, paired with concise explanatory text above the chart, makes each visual a self-contained and accessible summary ‚Äî both analytically rich and reader-friendly.\nShow the code\ndf <- summary_primary_diag\ndf <- df %>% mutate(\n  label=c(paste(round(df$percent[1:5]), \"%\", sep=\"\"),rep(NA,nrow(df)-5)))\n\np0 <- ggplot(data=df, aes(x=reorder(primary_diag,count), y=count, fill=percent)) +\n  geom_bar(stat=\"identity\", color=\"black\") + \n  coord_polar() +\n  scale_fill_gradientn(\n    \"Percent\",\n    colours = c( \"#6C5B7B\",\"#C06C84\",\"#F67280\",\"#F8B195\")) +\n  geom_text(aes(x=primary_diag, y=count/2,label = label), size=3.5, \n            color=\"black\",\n            fontface=\"bold\") +\nscale_y_continuous(breaks = seq(0, 40000, by = 10000),\n                  limits = c(-10000, 40000),\n                  expand = c(0, 0)) +\n  annotate(\"text\", x = 11.95, y = 12000, label = \"10,000\", size = 2.5, color = \"black\") +\n  annotate(\"text\", x = 11.95, y = 22000, label = \"20,000\", size = 2.5, color = \"black\") +\n  annotate(\"text\", x = 11.95, y = 32000, label = \"30,000\", size = 2.5, color = \"black\") +\n    theme(\n    # Remove axis ticks and text\n    axis.title = element_blank(),\n    axis.ticks = element_blank(),\n    axis.text.y = element_blank(),\n    # Use gray text for the region names\n    axis.text.x = element_text(color = \"gray12\", size = 10),\n    legend.position = \"none\",\n    plot.title = element_text(face = \"bold\", size = 15),\n    plot.subtitle = element_text(size = 9)) +\n  # Add labels\n  labs(\n    title = \"\\nPatient primary diagnoses\",\n    subtitle = paste(\n      \"\\nPrimary diagnoses of admitted patients vary considerably.\",\n      \"Even for diabetic encounters, the most common admitting diagnosis\",\n      \"is circulatory or heart disease. We will call this out in our analysis,\",\n      \"comparing patient outcomes for these high-risk but non-diabetic\",\n      \"admissions with diabetic admissions (which are only 9% of the\",\n      \"admitting or primary diagnoses).\",\n      sep = \"\\n\"\n    ))\n3. Prompting pitfalls: What You Ask Is What You Get\nCopilot is powerful and easy to use, but in this section, we‚Äôll dive a little more into the importance of iteration ‚Äì how effective prompting often requires fine-tuning, and how insufficient or non-specific guidance can lead you astray.\nConsider the 23 medication prescriptions, each categorized into one of four levels: ùòïùò∞, ùòöùòµùò¶ùò¢ùò•ùò∫, ùòúùò±, or ùòãùò∞ùò∏ùòØ., where the medications include well-known drugs like insulin and metformin. I wanted a strong visual for looking at all 23 in 1 plot, and I started with my own code for a bar plot. Next, I wanted to explore alternate plot types that could reveal more nuanced insights.\nüñºÔ∏è In the image below, you can follow my conversation with Copilot: I began with a vague prompt (‚ÄúCan you fix this blank plot?‚Äù) Then refined it a little (‚ÄúCan you use a different kind of plot?‚Äù) Finally, I gave it the specific guidance it needed (which variables to use and how to specify its aesthetics)\nüîç Only when I provided clear, well-scoped instructions did Copilot return a useful, meaningful visualization.\nüí° Takeaway: The quality of your output depends on the quality of your prompt. Copilot is powerful, but only if you guide it with precision.\nClick on ‚ÄúShow the code‚Äù to see the actual back-and-forth conversation with Copilot that was the basis of the final visualization.\nShow the code\n# ---------- # \n# Prompt 1\n# ---------- # \n\n# Consider \"meds\" and \"p0\" above. \n# Can you recommend a plot that is not geom_col \n# or geom_bar but that will capture how they are \n# being prescribed, using \"freq\"?\n\n# ---------- # \n# Output 1\n# ---------- # \n\np1 <- ggplot(data=meds, aes(x=medication, y=freq, fill=value)) + \n  geom_area(position = \"fill\") + \n  theme_minimal() + \n  coord_flip() +\n  labs(title = \"Proportion of Medication Prescriptions\", y = \"Proportion (%)\", x = \"Medication\")\n\n# ---------- # \n# Prompt 2\n# ---------- # \n\n# This plot above is blank, can you fix this?\n\n# ---------- # \n# Output 2\n# ---------- # \n\np1 <- ggplot(data=meds, aes(x=medication, y=freq, fill=value)) + \n  geom_area(position = \"fill\") + \n  theme_minimal() + \n  coord_flip() +\n  labs(title = \"Proportion of Medication Prescriptions\", y = \"Proportion (%)\", x = \"Medication\") +\n  scale_y_continuous(labels = scales::percent_format(scale = 1))\n\n# ---------- # \n# Prompt 3\n# ---------- # \n\n# It is still blank, can you use a different type of plot?\n\n# ---------- # \n# Output 3\n# ---------- # \n\np2 <- ggplot(data=meds, aes(x=medication, y=freq, fill=value)) + \n  geom_tile() + \n  theme_minimal() + \n  coord_flip() +\n  labs(title = \"Medication Prescription Frequency\", y = \"Frequency (%)\", x = \"Medication\") +\n  scale_y_continuous(labels = scales::percent_format(scale = 1))\n\n# ---------- # \n# Prompt 4\n# ---------- # \n\n# Do you think geom_tile needs \"medication\" and \"value\" to be on the axes and \"freq\"\n# to be the fill?\n\n# ---------- # \n# Output 4\n# ---------- # \n\np3 <- ggplot(data=meds, aes(x=value, y=medication, fill=freq)) + \n  geom_tile() + \n  theme_minimal() + \n  labs(title = \"Medication Prescription Frequency\", y = \"Medication\", x = \"Value\") +\n  scale_fill_gradient(low = \"blue\", high = \"red\") +\n  scale_x_continuous(labels = scales::percent_format(scale = 1))\n\n# ---------- # \n# Final tweak -- Prompt 5\n# ---------- # \n\n# It seems discrete values have been supplied to continuous scale, can you fix?\n\n# ---------- # \n# Output 5\n# ---------- # \n\np4 <- ggplot(data=meds, aes(x=value, y=medication, fill=freq)) + \n  geom_tile() + \n  theme_minimal() + \n  labs(title = \"Medication Prescription Frequency\", y = \"Medication\", x = \"Value\") +\n  scale_fill_gradient(low = \"blue\", high = \"red\") +\n  scale_x_discrete(labels = scales::percent_format(scale = 1))\nLet‚Äôs see the final code used for the visualization outputs, generated from the Copilot conversation above. See plot design notes below for the motivation behind the original bar plot and the crucial difference between the specifications of the 2 plots, and how it relates back to the Copilot iteration above. Click on ‚ÄúShow the code‚Äù to see the underlying plot generating code.\nPlot 1: Original barplot with flipped coordinates\nShow the code\n# Reshaping wide to get a better view of medications\nmeds <- D %>%\n  select(metformin:metformin.pioglitazone) %>%\n  gather(key = \"medication\", value = \"value\") %>%\n  group_by(medication, value) %>% summarise(n=n()) %>% mutate(pct = (n / sum(n))*100)\n\n# My original barplot with flipped coordinates\np0 <- ggplot(data=meds, aes(x=medication, y=pct, fill=value)) + geom_col() + \n  labs(title = \"Diabetes medications bar plot\",\n       x = \"Medication name\",\n       y = \"Percent prescribed\", fill=\"Medication value\") + theme_minimal() + coord_flip() +\n  theme(plot.title = element_text(hjust = 0.5))\n\np0\nPlot notes\nPlot notes:\nThe original barplot on the left is a slightly different use of\ngeom_col()\n. While it is normally used for a bar chart use case, in this plot, it has a quite useful ‚Äúheatmap‚Äù look. By using\ncoord_flip()\n, we are able to clearly see the full name of each medication. In my mind, this is a slightly better look than having the medication names be on the x-axis at a 45-degree angle. We enhanced this further by also using\ngeom_tile()\n.\nPlot 2: Heatmap with improved palette and labels\nShow the code\n# Heatmap with improved color palette and labels\np1 <- ggplot(data=meds, aes(x=value, y=medication, fill=pct)) + geom_tile() + \n  labs(title = \"Diabetes medication heatmap\",\n       x = \"Medication value\",\n       y = \"Medication name\", fill=\"Percent prescribed\") + theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5)) + \n  scale_fill_gradientn(colors = palette.colors(9), \n                       limits = c(0, 100)) +\n  geom_text(aes(label = paste(round(pct, 1), \"%\", sep=\"\")), color = \"white\", size = 3) \n\np1\nPlot notes\nPlot notes\n: Upon switching to a\ngeom_tile()\nheatmap plot, the more nuanced prescription variations become much more evident. However, the default color parameters from Copilot output 4 does not offer this as clearly. I adjust these color parameters to make them more robust under color vision deficiencies, making them easily distinguishable for all viewers, and surfacing the actual variations across medications prescribed. I also add data labels to the final plot.\nFinally, notice the very important difference in the\naes()\nspecifications between the 2 plots, which is where the Copilot output 3 from the conversation goes awry, and needs a fine-tuned prompt ‚Äì for the left hand side\ngeom_col()\n, the\nfill\nparameter is the\nvalue\nor the levels of the medication, while for the right hand side\ngeom_tile()\n, its the actual percent. The legend to the right of each plot shows this.\n4. What‚Äôs next\nWe will continue showcasing the use of AI agents in our healthcare analytics workflow while using\ntidyverse\n, to demonstrate how health technology can benefit stakeholders in this industry, especially given the richness of the data sitting in our health systems. Effectively mining this data using the right tools in order to extract insights that impact care delivery decisions is not just our end goal, but also crucial for the advancement of the use of technology in healthcare.\nAbout the Author\nVidisha writes: ‚ÄúI am a statistician and data science professional. For practitioners like me, ‚Äòtidyverse‚Äô is a household word. I‚Äôve used it for complex data wrangling, visualization, and advanced analytics work, especially where I needed clarity on how to leverage my data so that it allows for story-telling that informs business decisions, recasting my work into actionable insights. I recently began exploring GPT-4o mini and GitHub Copilot to help me speed up my workflows, especially within Healthcare Analytics. I am excited to share this post series to help readers understand the role of RStudio and AI in Healthcare Analytics!‚Äù\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nR Works\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "1. Introduction 1.1. The use of AI agents and the case for ‚Äúprompt‚Äù choices We introduced the use of the AI pair programmer, Copilot, while working with tidyverse. In this post, we walk the reader through the fundamental driver of successfully...",
      "meta_keywords": null,
      "og_description": "1. Introduction 1.1. The use of AI agents and the case for ‚Äúprompt‚Äù choices We introduced the use of the AI pair programmer, Copilot, while working with tidyverse. In this post, we walk the reader through the fundamental driver of successfully...",
      "og_image": "https://rworks.dev/posts/healthcare-part2-copilot-supplement/Copilot_start.png",
      "og_title": "Health Technology notes: Copilot tips and guidance | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 13.2,
      "sitemap_lastmod": null,
      "twitter_description": "1. Introduction 1.1. The use of AI agents and the case for ‚Äúprompt‚Äù choices We introduced the use of the AI pair programmer, Copilot, while working with tidyverse. In this post, we walk the reader through the fundamental driver of successfully...",
      "twitter_title": "Health Technology notes: Copilot tips and guidance | R-bloggers",
      "url": "https://www.r-bloggers.com/2025/07/health-technology-notes-copilot-tips-and-guidance/",
      "word_count": 2631
    }
  }
}