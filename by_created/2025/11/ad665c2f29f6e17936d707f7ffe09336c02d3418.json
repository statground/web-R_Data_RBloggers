{
  "id": "ad665c2f29f6e17936d707f7ffe09336c02d3418",
  "url": "https://www.r-bloggers.com/2009/11/design-of-experiments-%e2%80%93-optimal-designs",
  "created_at_utc": "2025-11-17T20:39:54Z",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2009/11/design-of-experiments-%e2%80%93-optimal-designs/",
    "crawled_at": "2025-11-17T10:15:18.561044",
    "external_links": [
      {
        "href": "http://www.wekaleamstudios.co.uk/?p=610",
        "text": "Software for Exploratory Data Analysis and Statistical Modelling"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "http://www.wekaleamstudios.co.uk/?p=610",
        "text": "Software for Exploratory Data Analysis and Statistical Modelling"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Design of Experiments – Optimal Designs | R-bloggers",
    "images": [],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/ralph/",
        "text": "Ralph"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/tag/algdesign/",
        "text": "AlgDesign"
      },
      {
        "href": "https://www.r-bloggers.com/tag/candidate-list/",
        "text": "Candidate List"
      },
      {
        "href": "https://www.r-bloggers.com/tag/d-optimality/",
        "text": "D Optimality"
      },
      {
        "href": "https://www.r-bloggers.com/tag/design-of-experiments/",
        "text": "Design of Experiments"
      },
      {
        "href": "https://www.r-bloggers.com/tag/expand-grid/",
        "text": "expand.grid"
      },
      {
        "href": "https://www.r-bloggers.com/tag/factor/",
        "text": "factor"
      },
      {
        "href": "https://www.r-bloggers.com/tag/federov/",
        "text": "Federov"
      },
      {
        "href": "https://www.r-bloggers.com/tag/optfederov/",
        "text": "optFederov"
      },
      {
        "href": "https://www.r-bloggers.com/tag/optimal-designs/",
        "text": "Optimal Designs"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-430 post type-post status-publish format-standard hentry category-r-bloggers tag-algdesign tag-candidate-list tag-d-optimality tag-design-of-experiments tag-expand-grid tag-factor tag-federov tag-optfederov tag-optimal-designs\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Design of Experiments – Optimal Designs</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">November 29, 2009</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/ralph/\">Ralph</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<p class=\"syndicated-attribution\"><!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"http://www.wekaleamstudios.co.uk/?p=610\"> Software for Exploratory Data Analysis and Statistical Modelling</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div></p>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.0--><p>When designing an experiment it is not always possible to generate a regular, balanced design such as a full or fractional factorial design plan. There are usually restrictions of the total number of experiments that can be undertaken or constraints on the factor settings both individually or in combination with each other.<span id=\"more-610\"></span></p>\n<p>In these scenarios computer generated designs, the optimal designs of a given size, can be identified from a list of candidate factor combinations. The library <strong>AlgDesign</strong> in <strong>R</strong> has facilities for optimal design searches based on the Federov exchange algorithm. An optimality criterion has to be selected by the investigator, currently <strong>D</strong>, <strong>A</strong> or <strong>I</strong>, and this criterion is minimise by searching for an optimal subset of a given size from the candidate design list.</p>\n<p>Given the total number of treatment runs for an experiment and a specified model, the computer algorithm chooses the optimal set of design runs from a candidate set of possible design treatment runs. This candidate set of treatment runs usually consists of all possible combinations of various factor levels that one wishes to use in the experiment.</p>\n<p>First stage, as always, is to make the package available for use:</p>\n<pre>library(AlgDesign)</pre>\n<p>For illustrative purposes consider a four factor experiment, where the factors have 4, 3, 2, and 2 levels each respectively. Using the <strong>expand.grid</strong> function we can create a data frame of all possible combinations of the factor settings:</p>\n<pre>cand.list = expand.grid(Factor1 = c(\"A\", \"B\", \"C\", \"D\"),\n  Factor2 = c(\"I\", \"II\", \"III\"),\n  Factor3 = c(\"Low\", \"High\"),\n  Factor4 = c(\"Yes\", \"No\"))</pre>\n<p>The random number seed is set so that the algorithm can run:</p>\n<pre>set.seed(69)</pre>\n<p>The function <strong>optFederov</strong> <em>calculates an exact or approximate algorithmic design for one of three criteria, using Federov’s exchange algorithm</em>. The first argument to the function is a formula for the intended model for the data and the <strong>data</strong> argument specifies the list of candidate points:</p>\n<pre>optFederov( ~ ., data = cand.list, nTrials = 13)</pre>\n<p>In this example all of the factors in the candidate list appear in the model with a linear term. Quadratic or cubic terms can be included in this formula. The argument <strong>nTrials</strong> specifies the number of design points to select from the candidate list. The output from this function is:</p>\n<pre>$D\n[1] 0.226687\n \n$A\n[1] 7.022811\n \n$Ge\n[1] 0.718\n \n$Dea\n[1] 0.676\n \n$design\n   Factor1 Factor2 Factor3 Factor4\n3        C       I     Low     Yes\n6        B      II     Low     Yes\n12       D     III     Low     Yes\n16       D       I    High     Yes\n19       C      II    High     Yes\n21       A     III    High     Yes\n25       A       I     Low      No\n26       B       I     Low      No\n29       A      II     Low      No\n35       C     III     Low      No\n39       C       I    High      No\n44       D      II    High      No\n46       B     III    High      No\n \n$rows\n [1]  3  6 12 16 19 21 25 26 29 35 39 44 46</pre>\n<p>This provides details of the values of the optimality criteria for the design points selected from the candidate list, the row numbers and the levels for the factors for the chosen design points.</p>\n\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->\n<p class=\"syndicated-attribution\"><div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"http://www.wekaleamstudios.co.uk/?p=610\"> Software for Exploratory Data Analysis and Statistical Modelling</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div></p> </div>\n<div class=\"post-tags clearfix\"><ul><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/algdesign/\" rel=\"tag\">AlgDesign</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/candidate-list/\" rel=\"tag\">Candidate List</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/d-optimality/\" rel=\"tag\">D Optimality</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/design-of-experiments/\" rel=\"tag\">Design of Experiments</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/expand-grid/\" rel=\"tag\">expand.grid</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/factor/\" rel=\"tag\">factor</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/federov/\" rel=\"tag\">Federov</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/optfederov/\" rel=\"tag\">optFederov</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/optimal-designs/\" rel=\"tag\">Optimal Designs</a></li></ul></div></article>",
    "main_text": "Design of Experiments – Optimal Designs\nPosted on\nNovember 29, 2009\nby\nRalph\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nSoftware for Exploratory Data Analysis and Statistical Modelling\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nWhen designing an experiment it is not always possible to generate a regular, balanced design such as a full or fractional factorial design plan. There are usually restrictions of the total number of experiments that can be undertaken or constraints on the factor settings both individually or in combination with each other.\nIn these scenarios computer generated designs, the optimal designs of a given size, can be identified from a list of candidate factor combinations. The library\nAlgDesign\nin\nR\nhas facilities for optimal design searches based on the Federov exchange algorithm. An optimality criterion has to be selected by the investigator, currently\nD\n,\nA\nor\nI\n, and this criterion is minimise by searching for an optimal subset of a given size from the candidate design list.\nGiven the total number of treatment runs for an experiment and a specified model, the computer algorithm chooses the optimal set of design runs from a candidate set of possible design treatment runs. This candidate set of treatment runs usually consists of all possible combinations of various factor levels that one wishes to use in the experiment.\nFirst stage, as always, is to make the package available for use:\nlibrary(AlgDesign)\nFor illustrative purposes consider a four factor experiment, where the factors have 4, 3, 2, and 2 levels each respectively. Using the\nexpand.grid\nfunction we can create a data frame of all possible combinations of the factor settings:\ncand.list = expand.grid(Factor1 = c(\"A\", \"B\", \"C\", \"D\"),\n  Factor2 = c(\"I\", \"II\", \"III\"),\n  Factor3 = c(\"Low\", \"High\"),\n  Factor4 = c(\"Yes\", \"No\"))\nThe random number seed is set so that the algorithm can run:\nset.seed(69)\nThe function\noptFederov\ncalculates an exact or approximate algorithmic design for one of three criteria, using Federov’s exchange algorithm\n. The first argument to the function is a formula for the intended model for the data and the\ndata\nargument specifies the list of candidate points:\noptFederov( ~ ., data = cand.list, nTrials = 13)\nIn this example all of the factors in the candidate list appear in the model with a linear term. Quadratic or cubic terms can be included in this formula. The argument\nnTrials\nspecifies the number of design points to select from the candidate list. The output from this function is:\n$D\n[1] 0.226687\n \n$A\n[1] 7.022811\n \n$Ge\n[1] 0.718\n \n$Dea\n[1] 0.676\n \n$design\n   Factor1 Factor2 Factor3 Factor4\n3        C       I     Low     Yes\n6        B      II     Low     Yes\n12       D     III     Low     Yes\n16       D       I    High     Yes\n19       C      II    High     Yes\n21       A     III    High     Yes\n25       A       I     Low      No\n26       B       I     Low      No\n29       A      II     Low      No\n35       C     III     Low      No\n39       C       I    High      No\n44       D      II    High      No\n46       B     III    High      No\n \n$rows\n [1]  3  6 12 16 19 21 25 26 29 35 39 44 46\nThis provides details of the values of the optimality criteria for the design points selected from the candidate list, the row numbers and the levels for the factors for the chosen design points.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nSoftware for Exploratory Data Analysis and Statistical Modelling\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nAlgDesign\nCandidate List\nD Optimality\nDesign of Experiments\nexpand.grid\nfactor\nFederov\noptFederov\nOptimal Designs",
    "meta_description": "When designing an experiment it is not always possible to generate a regular, balanced design such as a full or fractional factorial design plan. There are usually restrictions of the total number of experiments that can be undertaken or constraints on the factor settings both individually or in combination with each other. In these scenarios computer [...]",
    "meta_keywords": "algdesign,candidate list,d optimality,design of experiments,expand.grid,factor,federov,optfederov,optimal designs",
    "og_description": "When designing an experiment it is not always possible to generate a regular, balanced design such as a full or fractional factorial design plan. There are usually restrictions of the total number of experiments that can be undertaken or constraints on the factor settings both individually or in combination with each other. In these scenarios computer [...]",
    "og_image": "https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png",
    "og_title": "Design of Experiments – Optimal Designs | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 3.4,
    "sitemap_lastmod": "2009-11-29T22:28:03+00:00",
    "twitter_description": "When designing an experiment it is not always possible to generate a regular, balanced design such as a full or fractional factorial design plan. There are usually restrictions of the total number of experiments that can be undertaken or constraints on the factor settings both individually or in combination with each other. In these scenarios computer [...]",
    "twitter_title": "Design of Experiments – Optimal Designs | R-bloggers",
    "url": "https://www.r-bloggers.com/2009/11/design-of-experiments-%E2%80%93-optimal-designs/",
    "word_count": 676
  }
}