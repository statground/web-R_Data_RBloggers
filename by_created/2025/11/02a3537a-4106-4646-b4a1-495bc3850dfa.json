{
  "uuid": "02a3537a-4106-4646-b4a1-495bc3850dfa",
  "created_at": "2025-11-22 19:58:35",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2025/05/cost-effectiveness-analysis/",
    "crawled_at": "2025-11-22T10:48:48.879568",
    "external_links": [
      {
        "href": "https://rworks.dev/posts/ESDM-2/",
        "text": "R Works"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://rworks.dev/posts/evidence-synthesis/",
        "text": "previous post"
      },
      {
        "href": "https://bcs.wiley.com/he-bcs/Books?action=index&bcsId=7268&itemId=047006109X",
        "text": "Welton et al. (2012)"
      },
      {
        "href": "http://mcmc-jags.sourceforge.net/",
        "text": "http://mcmc-jags.sourceforge.net/"
      },
      {
        "href": "https://cran.r-project.org/web/packages/rjags/index.html",
        "text": "https://cran.r-project.org/web/packages/rjags/index.html"
      },
      {
        "href": "https://en.wikipedia.org/wiki/Quality-adjusted_life_year",
        "text": "QALYS"
      },
      {
        "href": "https://i2.wp.com/rworks.dev/posts/ESDM-2/decision_tree.png?ssl=1",
        "text": null
      },
      {
        "href": "https://i1.wp.com/rworks.dev/posts/ESDM-2/deterministic.png?ssl=1",
        "text": null
      },
      {
        "href": "https://pubmed.ncbi.nlm.nih.gov/8051377/",
        "text": "Bibi et al., (1994)"
      },
      {
        "href": "https://pubmed.ncbi.nlm.nih.gov/2511938/",
        "text": "Mugford et al., 1989"
      },
      {
        "href": "https://i0.wp.com/rworks.dev/posts/ESDM-2/stochastic.png?ssl=1",
        "text": null
      },
      {
        "href": "https://i2.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-11-1.png?ssl=1",
        "text": null
      },
      {
        "href": "https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-12-1.png?ssl=1",
        "text": null
      },
      {
        "href": "https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-14-1.png?ssl=1",
        "text": null
      },
      {
        "href": "https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-15-1.png?ssl=1",
        "text": null
      },
      {
        "href": "https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-16-1.png?ssl=1",
        "text": null
      },
      {
        "href": "https://i0.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-21-1.png?ssl=1",
        "text": null
      },
      {
        "href": "https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-23-1.png?ssl=1",
        "text": null
      },
      {
        "href": "https://rworks.dev/posts/ESDM-2/",
        "text": "R Works"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Cost-Effectiveness Analysis | R-bloggers",
    "images": [
      {
        "alt": "The decision tree.",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "The decision tree.",
        "base64": null,
        "src": "https://i2.wp.com/rworks.dev/posts/ESDM-2/decision_tree.png?w=578&ssl=1"
      },
      {
        "alt": "Deterministic DAG.",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Deterministic DAG.",
        "base64": null,
        "src": "https://i1.wp.com/rworks.dev/posts/ESDM-2/deterministic.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAMsAAAAsBAMAAAA5lFE6AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAid2ZuxCrzWZUMiJ270Sf5u5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEbklEQVRYCa1WXYgbVRg9k2SSzM9Oatcf1n3QB0XYBxtp/dkHYXxoqSAaFJU+yMYHYx8KpiBYfZCLtrDVUoNY2N2umKIoVWSnKvogtHkQpFRrXoTaggQF9UHbQBHUfdBz781kJmbs2pl8hLnnO/fe70zuzzcfMCnLA2YnKZibRKbmTgDFscnOMwHM6hidgZgFzo5PXyO1NE6nZ3ygGZtd03g/m1KMzgrtDiwRC3JY4z1sjFaMzwjzAQpBLMZA5ntSXj3Gp4dfrTB+AZhiCPf0BzqQlnH+XOVf6aaPHc0siGIT+AXIkduJp+My5Qv4FuhHg9Oj/ShuAp4CPgPKPp6My7CHy0al7HYOUz2gDrzHdRMyLPKNxnONBsXZ8xdwa3YROOvg5bBawMPAqcAerJDemwVY9LsTkGHcLzyVAHgE1uD6PRVUy3yEYmcyMuiae8t4jLFLNR62xzcJQkDL5PAz4PiS2Hx5+r6aBNhcVc2/H8aWO7ZdF5L2Q3ps6AM/Lr99QEV1W/DmV+7R/VrGm+nwXAg5uFBHvikBSi3V4FHgB430cwdw95D6Ld4zxD6RUx+64b9RREEJVwQsHgdaRb8IHgBOKmLw+AN4qx1S18d7QuxUJdoeumz5qqF9qsBaAPd3hcK/oEXDUbDXgW8GbwDsG/Ix4Lal83GMicE7Ff4aeEIoNK377K5uw6fbhXkudOQ9GDemGprXGu/h1rQVuwO7HuTBP9iRL8qc5N2wVxyv4njVvMBvxarcPPONHn1gcTHw+vah8WCOpoLxHm6ZJi8vbasBe3ARXByZkwrCbJ3nDy+i2PF6qMy/vB3St4QhDP/9D+W8uxq0QWKR/kbGlXebKN+MWa+rc1Il8Jy+x2t3Bi/BCMDN+xKkYLxgonRjb9dGIZP6ufLlPnL3H+oZdZ2TeGSNKugJ3LJ0FuDmvaYoZ8t3qHCBR6zy98bW19emiwUua0nonMQjO9VGrgdhchkBXpt7FQXnJlw65o+o/F+H1ybXNBc4vPJ5W+WkfWbrdY+XyA5MvgbAa3MbaqSeZzK5FrfbkrzavbnURsk/mWtjZaGsc9Kci2vKlCkDc7DaHo/ws06PVB2/8jTOWVLmKs3YOg97t3BmlmrGYZ2TVo/i2BFYMwI4sXwA01tbeHdRUheXBb8d8rObYPn/Kgc7CYPTU4nlIPDO+iPpYybMnE0sB+F1LZEwOjXlj5SDtTCOWx+pEkM6bWt3mCSiyfpzQ78gMBPRmVF+tBwcylQC/JQ5uApgHTzKt+YFpqcw24GMe/pNzU9AabeszQbloMKRzE40eO0noMFvRxNHwnJQ46FM2Wfmx9TwPGTRY7ai1VU5qHFUDQqcZ9E7EZlTMorV0uVgGFHvja4O5Z5ltzVmmagcJJamZXR1OBmZXIBXw3JQ4UhGV4efKOGsD5l1w3JQ4UhGV4eLWRWi+T6hU4/84fUkFS/fohFpkFOVs2LxYtVgXD1N7NicK5WD+fD0xcanhFcqB19JGTNh2qDkCxK6IMl/AEQ5Mc9nYZBVAAAAAElFTkSuQmCC",
        "src": "https://latex.codecogs.com/png.latex?%20Relative%20Risk%20=%20%5Cfrac%7Ba/(a+b)%7D%7Bc/(c+d)%7D"
      },
      {
        "alt": "Stochastic Model DAG.",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Stochastic Model DAG.",
        "base64": null,
        "src": "https://i0.wp.com/rworks.dev/posts/ESDM-2/stochastic.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAKIAAAATBAMAAADhSsv4AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAid2ZzVQQRGYi76sydrteOEbCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADBElEQVQ4EXWTT4gURxTGf/One7p3t2dXNwb1NIp4yMVddJfgYTOn4CHoHERWSLRRxCUQZhRCdpND2oiYoCENEf8QcIcIq3gaDwYvhhE8qeAcFEVZnBw0iBdBmLhgIF/19M70dvAxU/V933v1qurVa+iZ3erBCKRo3/lVH6aRZ4TVY7E8aMib0b98MlvGpz7kYKz3ptVL2J/8DQ2wjoU9OQlskyxfiaVHmosNcmV4BduwgtixPHmXQNt6NTjmtpfVlfO06LAfa2VDAqx38Bb2NzFC0pz1MKMjgFviddLTx3JyNKbRke6HeB2GluCZz5p+YITuzVeYAx2j2LLfkzGjG4/G64qhwBP4MsCrY1+B71IZg3ybFryEqu++J2OhATuwHs+cajJg1r/ikEpfbNj7anSVRNaW1TEZ6/AAp2Qc1uL54xyZW1vDOtHSf2/kXeLcncBqkzUhb6anfFVz4vgLkWGjWB+NaJCIsv1LACXYuOoDnQUOVYNcsHdDpsFNvuEG11B9C3UqP+A1OKMIFdArg6r5QGzA13D7wp+QEcCtsb0Q4pbhH7KBkWrfkrl+eKEQ6sjrtHIPLKD8jDPY4rYiVEDndVTNX8SyvoZJcm2KAjjaala7lnE7zBsFnjI4mRlT6POfa+oT2WbyAVxmOOSAqGnHetSO28Wiyip86ux1MfQ9ZG+CXTL3it/zOQMV09DVEOZ9E1Vn+EJT77a7EK3XNtmybdpxE343Y6BUV1smVhk9ebTGLdkLRoGOmq/qK6Pwfe1mvFUHp8y4Q16O75vk2+cK6vGdqtpFhSVMN7bl4VM9zmAN9w9VoMNn7JaWbfJ5NuQn9C1lTuIF3NqDVyGzdYKhG8Ho1gp3fwT9Epb7Xbcbk/AQZvXFDl3RmT/+ImRRmrtm2jd/nKC/xG30cRe9SAtd/lssW6p7kA4p+gklneD/W3SDlxcpox40ZcvbRfKvKWfOTwkxdc3VZZXoMbq4N072kEBBIUk7nSRJ/HWXVCjsGknqwk5zhRCuYKRo3+n2YRrJ9R+BC7H29e15gwAAAABJRU5ErkJggg==",
        "src": "https://latex.codecogs.com/png.latex?%20ln(RR)%5Csim%20N(%5Ctheta,%20prec)"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJ0AAAAsBAMAAACNnqc1AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVGaJIrvddhDNq0TvmTJ+KqhmAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEYElEQVRIDZVXT4gbVRz+kkwykz/d2exBQaSOFd1CpZtF6UFUBtQeiiWhKBZPafXgpZAVRASRAQ+tsCVBD649De1BGi8roqAoDb0KkkpRLAg5WHqSjbJgQVC/33vzXibuJpP+IL/3/f7Mt2/mvXnfLJBtq7ZlCJy3QRp0ACdOJ+bgHFm0OQ0gNoEdT+wCFxl9aTPzwde2XAjhbtvIgKUxkAuAfIxFzHvDdhWBsg0AT+N8i2OPv8up2mxYDGztDrBiA05Iz7XSYW6dv80wVZwJ75tUbgIvTSLDVxPab/grxKniTHhWKu7Gb/QtYMDh7YMhvZ1fs74B1Bh7/6j0fJcbS/0UrgLVAGgDxaDSk5yZ3+NhLYIviafEZVi5wQY+8itAJYJDpkdRkZzluwLeMSmBrrgMa4ZsqAX4nnzAEvmuy/XArf7VS33+FVb8EUoRUblDl2HHpN4Ml8ZAnY+oDWcXO/oavb7eGA/p5we3rQvz/Dkp7sBtbatXYwAyv1VVV2g+p41PEz4ne0G8P+TSGj5oBF5MtMUl9j7KS9KsR7vKh/CCylwXv/KkwsYdGxokY+6u+OqNgz9GajrcGt/Vfz8sScP3xf3Eh1TmVck2NLdK0JWXDZKxMLBRUdAJG1o+lTmt/E/0x/XesX1+ZCFBkfeS2EkZi1EScfAmODms1ph9Bd1JC9FXU1EptuF7gpypp2FrByIFd0bw7qJp0wKemYpqDRu2FPrcxmlwVAfNZbg9PJau4EMuwpvPAu8fusC8H9hiqJBj4zTQNXQDlF574hIrt/o02e3gafszXoSz5cnqp/ikmGF+B/42zqa7qgPke3yDuMxkRnc5XczCfgPNyBmn23iI1QJ0R9dAZr5piu/fBUxIakN8i8JQoLFywLcVa3hHH4879zQ/8h3HZkQu+/z850d83T/GryCzmR/BQsb7LeGzqdZuHqURpeoBrIUscMXuwbge1dXtqQsKR+Cs820sPPyu5NmRMj6Z86nQQtPkL9vUXqBOb97BxPbXc9zevZj0NLcnzXvQGcmUhqn8/nrOjZALdNe1kR73ereX60k2kR7dwBMmpeeRTlL8YiXnDNdsztTMmLvxiILu2GQ43pnS8yOmQsVf1/hpk5o5VtV5mpRvTum55fNDJedsenkmjy38rdFKPbR6rjCQ8LkbDybyAfxlL5sJzqlKJaDmJnquMLMJ3yn0ua1U11K2HkHtQr59ucjoucKWj1Iv8hYJoTsQP9+6I6n/KS7Rc4UP9Puf9PsNMgX4gdsqkoYi4yxT3xaOWpW61nOzQvp+tdTL55DIvhrmuuqAZfk6iBATKT0npmk+LfWa7xdJZ5k6bV9HPvRitm4BgokSPiX1Ws4X+l7jAUl7rn5Yyzf1XLCYnp+Sei3nbkvlM1yxkzT8X8+T/aKqp8VvhgpnOPs9flIai5Ftv2ARnFjw5UliHjL/L8zRcyXnPIQXsvxQt+mns6+eH5WO2wuxsWlVN4Zq2FfPpaTv+T//YQcpwlTZJQAAAABJRU5ErkJggg==",
        "src": "https://latex.codecogs.com/png.latex?%20%5Ctheta%20=%20log%5Cleft(%5Cfrac%7Ba/(a+b)%7D%7Bc/(c+d)%7D%5Cright)%20"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAWQAAAAqBAMAAAB2EDy7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVHYiZpkQRO+Jq7vdMs3/9KjfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE10lEQVRYCe1YTWhcVRg9895kXjr5mUkNwU1gahEXUnkIXUSLnWppF0WIWFy4eggKitiIiqIQRhS7EhKKCAFhKCo4m45YuulmQHAdBFeCGTdCF0okRXHhz/nuz3v33jezG8IUcyHv+znnO9/37nuZ3AxwOGtz93D6TK7Lo3v33MhoHI08uRdgrNLRLo/dmgkCR7s8wc0cK3W0y2O3ZoJAY2OCYoci9fKNO/fe35JD2ZmjJv/vHTh+8vx68unaRVTOtfhz3/TvRm3lLi5Xzmzt4Drexuf4iiM/3+MSZzpXknSws/JO9kZ1gGvRECvTOaY3VdTFF9knwPzXT2402h4E/DuFC5hr4n38DFxJgbNZMPJ0ho0sGdT+4Mgcbw+o0Uz5u4y9bHG3MuSLsYvV+RRPTefGelM9eO4kohYQby9n8uOBwAs2nlFOZEPfrjtEFwnpgVrL5Rq/Jkk2U7aEC4ibpbSX6NpoTTk1Dlde8RbQDdPxjRQhPSdptRfDGsZ1yRFWNsB/PFAVB0HaD6MNQH9tck0Dyz6e/CrxsRRCDBZ/M+DTQ7VK2ytRYg9Jis2U9WAg6UjFwn6Q9sNFwHxt0tcAE86KT/0t0Rzg5jPNuERj0iZTUhtqpr5qMZViMwfKNA5EXUlv/mXjkVZ2Sf0TtNDS+LGmz1Mjf+9v50VNuU5j6CZTUtsuiamNZzP3AZhqbk0bQYVfr6JveFUjz6QaTbra2qsa+VlAiHaZFlcZG7rJlNTetSXaUmxO+rCZsgbNR26kCCr8ehV1eFUj89njgVXqScZZauS+TiucmG4R/368aemmaYdgrra8lGLWUaJLMZVhM7H2kGaqoxP3G9yvCqIBY9XkTXks9SGw7zNk5KQNDCzOWLeofoCPLN00JSlXq7frW2gw4SyKzUvIZmL1Ic3q8bOtx3KHPtKNh0yrkb8ELoFNZAx3ycj1DELUOGM9IMlXLV1nPLVHUMkwm5FeLIo9IRGb0Ub2kKarq30eNsOKotZ6C0N6auQu8CFmN4DvmHnvNtdNOupZykeoEDU+0+v91uvx3kjmCKTnGU/trlTPZ3xGIna7LSH5P4ntKqsPaXn1bBsf6wqhjF21ASEZudJEfCBnkFHv8hL/Vg0sTorelSuo7Fu6zpBUqPFYU3ozOfKrzLKZ2PyQpqvPpvKBHLz9IhKsDmMZWTZyHw8ndoacxi6yKbwTg9PXLc6g3rJ0nVG3W6ghCwegmIzEZmLNIc3q7SHqb4QVZIbrFybka5NXaDu1O1XEfZ/yJ3e4yxSJChdUDziPTZ5cNN2M7Kp9i2qKx4VeLIotZroZbX5I09WzeG2rHVYUtbl3AlBfm0jVW0s/XEC1nWN0ajv/fIYqbwkkKlxQ3SLZbsHSzciu2trSBeC80O1SYlFT19PmhzSj98zq5cyvsJWefcxEerMYzGUeLoF8ZMMSxTcDimvoJmNJudot4Xgr7gICi7XL0UO5wrKsNS3jdZuwXW1Me1p891ZeKkBDN5lQzZ3L1tyCbubM5uiNqrCVxppZo12bf846hT0lbnFTBUDPp4dqM5lHVsFp6GZqI0rwqIqQ9LpKqGcvXjWfvSDKcwQ0scgqL6QHak8HdAmTpm6WNEeAGFUR8mKV0Fe6uePwUp/iICV6oKYr3QL6qekxGgT+A5xFs5PZ7f9dAAAAAElFTkSuQmCC",
        "src": "https://latex.codecogs.com/png.latex?%20prec%20=%20%5Cfrac%7B1%7D%7B(1/a)%20-%201%20/%20(a%20+%20b)%20%20+%20(1/c)%20-%201(/(c%20+%20d)%7D%20%5C%5C"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHwAAAATBAMAAACgknQCAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVHYiZpkQRO+Jq7vdMs3/9KjfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACLklEQVQ4EY2TS2gTURSGv2QmMw15NIYSF1KZUHQ9ICgGMRMfoBuJWArSzSiCOxNXxY2OoNZlRIUqLqLQhRUkPkCKCBFBXA6IUBBtURDcaKUquBB67sxgMlnYHC73/uf/z3/mPhgYOk4OViYHiV5+59et6WYvVagdS08VC0Y9xvQnmTbm34Aw3JBPxroZDp8Z63fE8IgDfwImY4VCPlyiWTb+jDjVr1dttB8BMeqHfPxTu+AK6UK/pR8fgkwnIJYi+km/jEPKwmxDceJAPaYEyQKnH0OiZp37doNk+S14whcP2lGps/BVkIdR+smksSVgE29aYnEVvrzp8DG4xwxPkfEQupBqGZ6uVHBm3su8iml63E5sDbiPOx5AWkFtDS7YepfrrKF3uI+2Akfg5YegMmeTKqjjk2wzz96AnCLVIaOg7sGolX20rynd5RVmya3AJfhkoUL2kBL0Wm6owMXILncwvfOukqUNVadhy2baVO3cKkYX7Tc8F0pC7PkmePIR1+xGdkf2ctUSlazMc25DUN45sUyy05RSacKiUoMT7pHFg2U370d2JYTR8NFnyfqMZ31rhDMthy/wCnPRoOLCO4wXckMd2FabYNCe/n785ryLdm3MTZRt8+j4pEsZdm8uVbaz5ECpVpQmuiB5GFA72SAq//QCyJDIuMjDgDm3X6X/DVUbhnidAElHdR9DhVaPyhJyaD/AU3A+/K+G6HC2Z5cOEnrYJKI3WrTBAiHWAcsXb422TKPGAAAAAElFTkSuQmCC",
        "src": "https://latex.codecogs.com/png.latex?%20p_1%20%5Csim%20Beta(%20%5Calpha,%20%5Cbeta)"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAMBAMAAADMqMPsAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVHZmmSKJEO/N3TK7RKv0AsdGAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAr0lEQVQYGWNgwA14Z+OWY2Bg1f6NT5qBgQhpRmVXVDOuXU2+wMBoKArR7cZQwWDAwMDyDgQSgCpFl7E9YHjM8AwszTyBgUt6A5J+xtp23gCmCQziYGkOAwZOJSRZBnY2BwYGfqB5YOn4Agaeo8jSDJwCDAxAUYj0fgYGngQgE2F3PVAKKMoO1s0VwHAnAawWpB4EJIEYKGrKwPAXGDaJF0sfoUiDXMKaKFzAnvczGwClBC79uFZUcAAAAABJRU5ErkJggg==",
        "src": "https://latex.codecogs.com/png.latex?%5Calpha%20=%20rc1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAG4AAAARBAMAAADOAYTcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAEGZUds0iu0TvmauJMt2G7x8SAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABIElEQVQoFWNgYGBUdmYgBwgxsCZg18cRi0/cgYG9Aas8m+9fPOJsDQycAljlGRiw64OIMzEwLMGhDb8+7q0HUPSZKCrtZWBgVjZDt6+n7VADQpyJo7cAqI9rNwgATWDrncRgzsCwiWEPuj6zNzwbEOLXGBgWI9vHzPSAwZuBJYDBEE0fs8REjgSEuAK6/7gOMGxh4AcKQ/W1lwNBETCeeRYwIIkDFUSA1MABZwPDN4Z8cBCjhierAQOS+AEGtgdAPXD/MeQzMAc03Aeaj+ZOBnmgWXBx3gUM4hfgdoEYqgxcBxT4EhjUGBh+oEiYAnlwcWYhY0cUWQYnBt7DAmyHjQQYT389iyzlAuTAxZmRZUhgA5MLWSCXLF0MDMCwJQcAAGNrToMWFxvOAAAAAElFTkSuQmCC",
        "src": "https://latex.codecogs.com/png.latex?%5Cbeta%20=%20nc1%20-%20rc1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAAAVBAMAAABLWfZ5AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVHYiZpkQRO+Jq7vdMs3/9KjfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABZ0lEQVQ4EYWQv0vDQBzFX5t6V6tpaykuBZEWkQ5icRNE6w8E0aGCOPdPiJuT1MXZOKmToIIKhQ4FJ6EuLiJkclBQ/wRBFye9711z6UFSD/Lyvu/7eYELEHV2K7RhV0tHSqI4nSeVKyOdhRS9iTAvKr9F0oOUCE7HRVbe2QYOLLcrehNh7hIZz4V1X3CURGBB3MArmkjU7I6SYBPu7BaKaCBV5R0l4ViQJlw0+bkzXIl/KAlW4c7aRItdsOmq1X4m8TSWK63U9OCbfM53+u1zbPQbW7E16gzc0DkULjXOHU0qIzlWADhv4HQG18Z+A4MVI+hysTGRxs9w+YZ1Y/+YnzRmGojDvDBDWewDJ70A++qdul5yVMjUxZ9mD8LpO7DPkILkqPBeT3tIeQbyhJgZ+BwVJhZLwJRlFGZHVo2ZBslRoS0e7sQp63uIw5x46IILvz809j3E8eNl2GEXDGlqbu//b8u6z/0B6GxWK/hmz1gAAAAASUVORK5CYII=",
        "src": "https://latex.codecogs.com/png.latex?p_2%20=%20e%5E%7BlnRR%7D%20p_1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAOsAAAATBAMAAACD5eeSAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAid2ZzVQQRGYi76sydrteOEbCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADVElEQVRIDZWVW2gcVRjHf3uZnZlt9kI1eIlg3gQpuC+VIFT3xcuDwoAaojYyoIVSkIyXUusFRulli41O+iDEirsogVb6EBGh4IV50Bct7YBUGnzZF7W+rS+hKxX8n4SYzGxMNgdmv+/8L9935syZWdjJeGkn4v/VJobZ3RjkL/fT2O4+pYf+gMU0PJQ3Y+Fy/wUDFb0sAXYnjVU+g11QCdLwUN6MRbWtUFjNzxKqn7kt5044qBVmlcN4sx7Vbgp7JYtrXg3T4KW2x1GYSqPDebMe1R4VdksW17wWpcGw2CWBP9PocN6sR7XfFPYYWNfuglYr+qHB3tJ5KlefzWgTa9m07cDsidY3B56LmVZc8U6/E+O0To08ScE7FP3nnV5qNezb5k5iHU90PZPiyyqvQ7uPj7DC3AlvDxd4lOt8bdpa99b145s04R9CGMd96xxPeVbXxOeNt5C4HW3+7QfycTkuBmve0uQNJqwz9TG+5QgX+SLF11YOrdOkFuceL9luz+2x5HSl1fh+/jvImcwNeMCOcJtYzjjv6sSZ+Ks58MfgJrfGftCmTSVa89qixibf8I9Kd0elyWSKL/vkFimHzMTufQvKZQs1vWCa3U+hS9VkDlx5HUaaUKhrTdVkNcp7jtJNzvztMcb70q15zbvwpa9jk/9tNqiFqrGRz/sUQ9oRH+iW7iYf7EoI29FITzoa8OCHX5msIrs2oDQO5UBrmolM7FMM3T6OxHM97tFyHJVa9VL1WOBhjJS2rxobeT3b2nx8BZ6QpKxXOB+4mla6gYSh+n2eKDFtKzcUOyqBnsMxW9FqBrX5Sz2KiT44HZZV+GPWvCplj5eW1VY21S+leLWdccjHzqK+e29Tjg552iherIdSrw9tsLYSHkHP0umyz1Es1EN59/Cevl92wvnSgha64j3rq5VfjK2mdilmfz7i1EaeT3RmTuKOtuDI0yH2xOmLv2Dv3T8h4/oofOqtbDlX4Ro5j5c9xZFRX965KdkOT8GrrZ9m/VXvjyH8fHyJirbKHZ3yzbWRR+12Ms4OKdYqr28l/X0rcpCr+oPYZojaZv7CUip3MTXdduI2tpUYgaV3rbeFsuBvQW5GHd4MHMDU9rW/BtB14PR6OlzmDifbRhXBvyUaAPj/9U+WAAAAAElFTkSuQmCC",
        "src": "https://latex.codecogs.com/png.latex?loswd%20%5Csim%20N(mnloswd,%20precwd)"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAPsAAAAsBAMAAABRZ9MCAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVHYiZpkQRO+Jq7vdMs3/9KjfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEFElEQVRYCe1WXYgTVxT+5icz2WQnydq4thRhrJaCIsxDRVbUXHW74g81ghT6UBihD6UVnVKLvigRRZ+ELK4IAUtYtFCpsK3iq/vSCkJhXiyi0IzQFx+EQETtw3Z77kzi3jjJZrLs5KUeSO493/nOOTN37txvgGU3/dmyl+yjoLJxrg92DNS37WNY1Kgl3y5+1JWKgff/XvyXy7Kixl1rKXW0yr9Xl5IXyjkZQgYKrB9ot1Cz2yFkoEBjEN1WrB0v6lfGdkPaYdLvHWMlErmvLHwwUhpAe230OQ5JW8sVTOMEruGnw8Nu0s04aZaqUvvEDW7l2C5E10uojJ60v1NncUn2MOoUUIBs7UPKjK2pUFiu4rp9GRj+ZaeTZRSoYB9UnEPSFVhAdn75rQ6kcziDJ8AxOmQKNnW8R49BVRqotXWPy8na+qz2gtpTA+qo4QVdwDajjg06IXE/e9TsjCt5tPguVg9b2IWz2hkwlLSnalx3LNb9cMdayCagTOZt/sP344920v/IgwmR1ufcOLDoTqGH3rR4zra03arfY4x+tmlmj1IUTjQpDxanyhTO0+sG2mNRLdUiPm4M/daaL4y+QI81/VsLeHj2uKEVoZipMnD6n3C4C/JRC6eTit7UkHGBvhSgRjUUFQDKz8Pw1BkB6z31WhQ6qehNDRkX6GbFlBWKCgDlZ8gdoruPbhJrcdNMn23NhZE2sWEG/hYBDk/TDEM54IgdDnVH0q/vKGsNFTvwaBMnmpwvOoQXoKwFvQrcXEAizJLEUcd3QV7zLjIMWLHH5X6bQKeDOtoMhSfGb4KCUlFd9+XeP0d8h0s5zwdKkN3X9xNkLf4/TOE8pnAbN0DXnzAVvoOm2gT6OK2/R4vgQjl1Du/jcNJNmZsfMukJdwIp5/lAneTdpDGybSfmD65N+3UatMk/Bea43ybQPwLHnwPfABIJ+Ho4NRLO3H4Eji/lH/N84LwyP1+O3JuIf9Fv66tckuEiiTIpsjbH/TaBrhLnZ+AKDYkyb1Ohjwd8zr8dfm1KuZ8P/E6UvuwIZ4/VCxadVH+DFFmtc18UaClHlJrDHz2SDmgv3qOPB1ygJdB8h6Tcz+fPvk+jrZfJoVSDPOM0uCJnTO6LAp3iJTOezK+iAMlzKDgtKXVyVN8hKffzl9A+YyMF3UziaHmizvAH9vq+KNBf8/b6HD9TaG8kygx17cJm1aMlSJgsYPJ8BoUvUF9G96R/m4d+cPUhe8rBWJ75vijQu/2C99fwYR2MSRufrHqPyQyT0CcRMP18qIwofZlS7UkPbumA15OItN2b8wbjzht+yFWKPkR7u6ctfip3TN/UERVA2fUdQ4C6TT/rFuiO67nuMT/SPHJ7sHhYDS40AlOgWMK801TpBHbEWsz/AErncfmR0cWdAAAAAElFTkSuQmCC",
        "src": "https://latex.codecogs.com/png.latex?precwd%20=%20%5Cfrac%7B1%7D%7B(sdloswd/%5Csqrt%7Bnumwd%7D)%5E2%7D"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAQsAAAATBAMAAAB1iTUjAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAid2ZzVQQRGYi76sydrteOEbCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADjElEQVRIDZVUSWgUWxQ93Z0a05UOSoOioCIiqKAulCD4iQvRhUPBN6LiUDiguOlSF2JUeP9/hxanAsXhI7974zeKi3ahCA6UOIAK2hs1Kmo2ihsxGyPZiOdVTFJVdLrsB1XvvnvvOffUe7ce0PBQqw1D6gMCvlGzRkjKfvUikdRMD5t+uGiOeIHU5JhjcBknGPRH52f9m6SjyY66h1edw2ZgvaHgCvAq5sbCuGNwHScY9EdmrawIOnJOxBtavA3Z0vyrDFUA7dIOj77wImzHCcKxIduqBIw7hxxx43PUkX38DZqHQHs4ok0Mr8J2jCAcGrZbBPJcjR72xKz+6FrHMlhAS7Rj2Bs8q9ojRlA7KedhLyOLAaV7PFAseusOFW8j+ycy9nYP7zrKUZyFDQ5lmIDeve3oo47bxG076qNJ1CVQ3p37Bzv2jHGhHKzyWT2AejgLc9TLsF6sCShByfPxL/c6dWRfF9ZjS9o3/Sa3RTSzHaFMa+XLocWdyFV1IA2cfSKUhUyVcw/4OXUIsKUgMmL1pFQFd7AbN3EtQKn2DFzFInzGLbYnoJWhtyPnp5aoij4Rb+GWUILlnUBzlbUfnL/LbZcqcBaZ8h7gNGD/jSCVMxussy4B3E6krm/9X/MIGWu1Y2WA0oxeoxev9R6Kg+mAKk2Bgm/MvIhMq3SOwwno6ILps/ZcZHrQIlVAIPtdUBjN2VLjl1/zuLoE4Jc1z5X9k/543M2RYACdqlCCYOmrjDhoEih5OAkYE2C68oimUotu9OM5ESD8jzPXpQVuznQ+G2leokaVqZfkiSyuSwB8hGnLy6ngASUnQBOVdvklouRle4PeyJ33WW8p7yCTh6G0u+ijkAuMvtcIEeyJKyzOwfcHLtmi3M4ST8LlvEJD/4V6BCDfThQcyiAHM9UBVM5JuwZLWz2upCzoSPt6hdfjfhzgsQhcVi+yelldwH4MDU0w2eet61ABzy1TFZxn62qvGJHAuAFk+7AEK0iU9rE27eFIgILpbbd1CtjMiv+x/Q7DyBeB3R0C3cjmHewqPj3Od8f9QyERwLwpQIYey4YlbxwtL+d7KzHGHZEg28X8tnX8+wk08qsc+QygtLZjN19Cm7O2zQHLNzyMSgMQhdedSMz/lJhRI6EREGWwHRNGQx82xHVqyEo27KArE/IyTkJCzbBG7t8dNrTlrUnJx5ISascTd7k2bEQv+X4CGzohwuyG4JUAAAAASUVORK5CYII=",
        "src": "https://latex.codecogs.com/png.latex?losnwd%20%5Csim%20N(mnlosnwd,%20precnwd)"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAREAAAAsBAMAAACwKZF6AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVHYiZpkQRO+Jq7vdMs3/9KjfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAESklEQVRYCe1WW2gcVRj+5rIze99JbYMoLVsTfUgpLPqg9cJO06XBS9Ok5KWCMBULQcFMbUujqGxowadAQpViUBxKFVoUVgy+micLgjg+FNSCWUUsfSgEUio+1Pqd2ckmuzuz2d2y+5Qfdub8//edc/79z2U+oGum3+ra0O0NrOy9216HLrK3Mmks7lZNtmrSWIHGyNY+aazJP42h+4lcX+2wt7bw36cddg3upheD472Pyk7v5wyeMWEGx3sfzeR6Nue2gcKYfmHfCKT9Wf4ekAZfe8HFz2MY185C3v1gzxLR+m9jQnp2bgEXcQaXcPnJX0yppBk/YhY3sIgrIpOXr9AudzknnYdjoX/aOqku4bxcRr/xEmRHV1aUFQyoJebXM+Ph+Nz6CEh+PWxnTE57FPEsYg6zMKMmK1Nj97plK0DCwAz+AKa4NfMWp/0A3KVJm+mY+VyKjF5ZxtKXtDvMhBMuAxpXZZeOjJW0FXcZcslmvCf7BMtW2pXKXB0XO5M5HFDLOKoimps0+MSbcyYz6Y09un8AchZQ5rdb4ieb+LUf+sShS49BH985YeE+LdV8a62Pvrje7E4rYbU4brvf2ldbHBcRn3iteYcsID0/Rk7bh8PxB059l/tEDBBkxIB9PvJNEGMtdn31OPA4xK35/r9rwdbesjhLnk0jbay169/TDJyvBFNOPbjR14uSid/x4sZYi+10lTfEo1516hpD9EuVWJzlCTfeq2WiH4czQpHtVWQR71bb9Q0eg1S2Eny6HqvxKTrmeYl9XxNszVlf9VXwGxFiPAYRvxavhFAqYV7n7wBxtykpGCwyXCjk8EhfEX9x2w9SrNLfdrDwFVI7EDEmKxgSlf5aiRxfZ+zAMGnHHqoVHVFgrxI8WdPoEmc3Y2bCjDvgPz+Cp4R/4L1zeBjHkm7UTdsehlNcoDJL48LXGbO4qJC2y6gTHRnottx0zkBQ4eCxWxo3ezyrF6GWkXHpS9QUQ7DzyEPOCQz4Ajh1G3gDqOgMXhezgtYgOqJW/l6bB1ikJv6m8tMMziHqxhxQNky5wo/MCSWzwAxVDwMcsr8ELvDl6wx+Wz1aolZ0JC1S2jdtiX2Uz5RVfrfTJvI5HBY+orZYq6tMR/UwSAaJyza3SVVnqCVBmxX6Y6Po4D7pyIqgmImy1Hv0zBOUDfhT+FwVqWzjDnN5zsMQF6OnyzITWtMZ8ayRF85orejoNJO/Rd3fQlG7qU6plBKq4/mjLLyJs9oMTA/D6yIT/a64CLmZqDMymDxpj4KFOVIrOp4RzA5sN3Cmz8TpvmsHYyOUEoWKP4jUvIXThd+G+SSGEW/sH0iH7OkMdfzEhxhEzMDbRo3o4AgdWfMrc31IsT+Aw2Xv1fTxbVM0HExY4dgGRBnzHJ6tzUxxNmOE4P4UIWg1LLteM1UNhDYiVii0CXBiE7wC+3d9C9xDLXCCKa19IlpjiRly/jT/A0KEiDTLze+hAAAAAElFTkSuQmCC",
        "src": "https://latex.codecogs.com/png.latex?precnwd%20=%20%5Cfrac%7B1%7D%7B(sdlosnwd/%5Csqrt%7Bnumwd%7D)%5E2%7D"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAATBAMAAADlvxvFAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVGYiq4l2zRAy3e9Eu5nBLpnJAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACoklEQVQ4EZ2TQWgTQRSG/51NNtlm06b1YD0oo/UgghhQQURIFKT2oDTVIkWRbRHBgxAPot62gnqTBS1VKjY3BUGWQkGph/TgoYgSK3hso1DoRQnkoMUe/Gc3m6yklzgwO9/7971/9s0kwH+P++2VRrtExVzNbqk3RP3ivGuuDgH59qxkNaIlnTD4EAKsUhNbkBoGHgJGmdIUJ4d1h3PiEtAXxP4zbYfBlRCgl5vYghzFJSChlNe+rF/bAKaRyAairwE9bgOwHMLW60HKdvAx4mwjhYafYVQRz7RqZppYb9KWMEiVXX/h8vRnI4OGG7A8WHlA270NYs/A+1sjMMYfAVd7PTFxd++T3iGYu6ARm58eVM8DSQl4jGTL0KzD/O2rJ3GKZzmiGl3GINIylj8+I7Ub2InJlKuwooy0V/wqzQH0TV4A9ygBAi1Di4ZsrQajiH5ccB3UISr0PoCYndkPUcIVlHMgGnn6YfrQGSBOEDXeMH2L7DhiSDd64g16JJOO/cnwAFIS7zCHlIs1uuIrcBkBMmUd3RWkCTE60djkIiOG+gY0tvwSOYdJOFKL55HLmjW9jlnQN+Umud9bhT1ZlVEFfhw9QUiTnvEYSxBroy/GqHDwUjaheeoMWZ5MZOAl5OQsjMpSDdctvYYcRLGslcrE7ZYqkWx0wSZ0V/1L9i8FKxTUoOGyfzYeurIYiMGyu1w7hQfD0kveFKLIo+y2ZXxYEtdEUNR46iXcc8i3VbwC/bRaeVEf1Q9br0Av9DnWYh+08az1bcd351Pv832GRAFWAWbBIU71q5LWeDwqVTDOObVwzpxji+d/jdGAfz3hv1KvOx+HGyVatDTtRKPOOKz9xzDcpTOrIFuvBmsmWrweDTrlxXZD4XZqEs3Xo0HAlP4Cr7mg3KIqX0kAAAAASUVORK5CYII=",
        "src": "https://latex.codecogs.com/png.latex?cstadmin%20%5Csim%20U(4,%2010)"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAxAAAAATBAMAAADyq/b9AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVGYiq4l2zRAy3e9Eu5nBLpnJAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAIbklEQVRYCcVYbYhcZxV+5t6dmTszd3dnN5AmiPV20480pDqg8TO6Q0ms/tHdECkV1MlHowUrk2KtBX/c+kPFipmiUqXEXZBCAoVuEpEW+mOiRqnRsqyi9Yd0G40Ioo5dP1IU9Dnvx73vvXMnO4lgX5j7nvec55zzvOfce9+7C4w1gk4RrCJKMX2hyHqtOsbJjOKcFtIR4ep5CVEMBemM/z/hpE4Oi1TsFNNMAa404S4SOVinKKY2f+koP335T79Ol4XSyY0h9VdzGgb+8HpOZ5cnNxS6bdcFs4Iohjnj9RGuvdTKxcGYhGsvvX2drsUlxDDNIJZEX5ILh531Cp8EwoeN7EyzlGmq9DmbIY6/AN4wRFvZk7DhinVAuKzFUgTMHe3oBa8MXG0mq6wQrpSi4bwZjIYIw9y4JsJBbL0vWuGaCV+EqZONkAZlWdVOXJqTHcH90oDtbJZd+Pe9amRnqlLusl6OShxfAU5ERhc4tjQ8Ku1E7/eN2EU5wj+40D4MPB0bU36ie0HeDMqBZDkUOLqEkcmpqyKBjybRr5XwUVUgprUjDcqbaWgn0z3B2WrbWfuWIsekVepabqIUQTVcrXmhY42/paZReH1rkTkJOxm5ai0voryK71JWPqUI+Ik2DF/pvjiUNwvTEDI08ay1FA05Zghjt0XKrKsi0ppcsmNMwmswdbLeaVDAoWnMT8hcW9ErOxvbZItCUkSj5BS2Iaafpxpx9AbAH2OjyzQiDTstEXPjh1wHvDl1IyTwR3OIZEl3onN5E6sSNIQMc43YjHC2EaoqKt7woSYUxiG8Yeuk4vCSBmWn1U6EZummLfDmdlx46AALe/eD0YUfHOjLbL1kbsglbcTWI3ProgFWlInFx+xMC3Nze8VxYhXhswhv3PvG2BbBsR7b3kLl0OvgHf78zd+ceT9qN6JEsaezVLqMpZonOR8Att7SE3oa8tg6Xg7OKXdJnM27deecijbVfFRnSLipeJa0xM06GsI4/9vv/4FG9UQ4Vakc+hpwbGZlTMKlw/fwrJtrGa7iaeuUBuWmh2jeif18txzQjx4flC1PlnmfR2Q0tU/GAqU6f2kjgm2v4JJogIEyLfObIJpYKEXlSBwba7feG+Ox2lq9b4rqWCejiS5z7cPeJ6LScbwejzR6Iq7y5iD6zwyqGyE5NzDV8VeEnoIEzdN4Fp9T7oJedvP6z5+VaPVeo1ftJxAy1PES0hI342gJ15ono6do3M0fnKqs4S7WY6I9HmH8Hu8CK7HTcBVPW6c0aAFN3oLbcHcv5qY5plulrzwTtuSBccfbZJE8ESE/eQ6Wblmn7hnQ5HeBj6MUlx8OlON8nxZ0alc8TupudKx3YGLBW8V70dwFb5lHYH9exEqb9YgJf9H6MDDz3CZ5SU9BQn/gD3BEuROdzVuy0eZRaVmIMNQcEtIjCVewFEdESyOcqjDUfpB1ZzzCXpfnCithuCpPUycnKDedpzktud/5r6b+nryIoLxOxUX+nPG4yGzEz37DsSZV+8BbSQ84BZpqbIS82v2nzyjHNwlafQ/gd/vu+vS+/a71LBr9RsQbG5e5OflK40GgRNRjev3K+jBwuY2zCF4VehpSbrMskXavx7m8UwtsLw5y6x4sRBgaDpb0aMLyYcS3wEN8CzhVYajnSKPRG48w4Sd6UgnNVXvqOjlBC2jOy+6xZ8BNcxw03+6c3fFlWSRPBCabOPM4NyzvPpqCZfhXBOF/TALwSVaj2pTJ61OfWv0NLGG+VRuA22v0Aj6H7Mlz6klqYKKHv8TmKWLgakS4R+iegYbU++xdpN0b+byNvjzVT7EbnslgjwPhkJAeTRjHCdNPhFMVyaZYj0WYmcEbkZXQXLWnrpMTtIDmEgvJkq1Uo0dI4oGgeSLWs3tGyI6cRkzH8kfYh6izh7UUNj7O05EB8KSg+cqJ5U97KYJj3T7A/eESKqt9f8Cn0+v2S8si3hDKYT3fxAeNj5y002/+1gDVjtDTkOm43vd7yl3sK27k5jxK3T6ucI/vYLOZQSDEmMZa0lrpULKEQ94vHaLl1eRURUI9L6zHIkxy+Aw72oDmyjz3c2uqTk7QApr1FnZMIOzUex3/fThdwQ3kIbM7qjFX/040S3G1h+AUG78KMX0W+A68Vhs/Ekf/rwL0lnfFO2Tu8+JYV4IHvQa+uBDxZXoHz+KorMTLPE/ejXIcfM/6MPAJD6dxM4Qe0YQ0Wo82eRV3onN5b8MU1eeCM4hSCBkaDpb0KMLY5Z3yWkRLI5yqqGzCejzC9Z7XhlRCc4V4mjo5QQto+ouzcXh+FqVDrdo5bN2CY+QhszsqTQQH/3mPVX3qpiP8XulxhxFowiG+PGZ24qczkTh+5G9UwV/cu0iEboRjfWHm2zvDl7dfiivyN1m4iNqiiN/Yxm8+4N6j4quax8Dl3dgzG0HoaUh46fY7PwHlLuhs3sMSCi/Mff3WOIWQoYlnSY8ijD1bLmwnWDXCqYrKJqzHI+wvkphUQnOFeJo6OUELaUryTYbfzgDWZHWfz/duDDG9JWPNLlRRs6pRqxetQfnkclpbMhN9tbyCI4QMTSMs6c0Iq0aI9+ZjbMKmTiMiWpojzBl1klJpeSYi7PPtJZXYJEwQK5cxLmnltU82Zz6AoFWV84Z0nZRcxUtIb0I4///ONF5eGp+wqVM+gF4nNIvNWe173KUcdJj/z98B+UOUJn/dNV+vPBVnPTM5syauBL1JXoEIQzVS0q8BYVMnyyU7Z2hmTcOrUF7ddvyYLVDD63ES03mj+J+m23PemZw5G6DQV89LiGKofBPSrwHhpE5DuxBFhmYhwlW23IWVeUpw0KQFq77OeSjFkMINrIxXzzuK2Ci9G34ceYjfkMJESepUGFXT+S+jFe+UiuiBUQAAAABJRU5ErkJggg==",
        "src": "https://latex.codecogs.com/png.latex?cst.trt%20=%20(1-p_2)((cstPx%20+%20cstadmin)3%20+%20(losnwd)(cstnwd))%20+%20p_2((cstPx%20+%20cstadmin)3%20+%20(loswd)(cstwd))"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,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",
        "src": "https://latex.codecogs.com/png.latex?cst.ctl%20=%20(1-p_1)(losnwd)(cstnwd)%20+%20p_1(loswd)(cstwd)"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAANUAAAARBAMAAAC4F/QSAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMrsiRO92q2ZUEM2Jmd0gkiEXAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACqElEQVQ4EbVTP2gTURj/tbkkl0tsDqWDILQ4iOOBBZdgg1pBqZLiok6Z1OKSqRXp8KCiqTpEijWtUE5wqQqtW8UOHQQr1VondWtxVDClCuLk73vvktwFs5kP8r3v+/35Xu7dOwDYu8vEuFphSkzp+v+njU2ZaRVwjos9usV8a54pEo4faeuNgZ+ato0mYAHyaXkSJEoY4NKzL8+8LWUkuouRtt4Y+JBp22gCFiCf9UXarSRjUFKsJjkSWTfS1hsD75i2jSZgAfJydCw8vTySnFrSdTj1hptmreGuggH+ramzAPn3VCZGH2D/JvD822ue68ZKXtzVWQ8z91zY5cnhV2uCNCI1Nd2ArfUVNXxiLd+qEXu5PECWNhqEX2Z5GONOZUQXTOY8kyq5uqcYK6CKNQoYn8YZE1Jdx0QTpnz6e6ZkNMLqEHtKZZQZJgbO4GW3+zFm6bck+yHuSr6GlH8X2MG664soFIklzDXhrJd6csnyWjRiz7xwzMvRhl257IgrjCDDM3RqMnFRj/3NfAHODo79qogoFFnFpgEPwRGv0Rw/yJBTEHvsx0UMcYUYyPPhMeh11fTTWFvC6NsS+0PtLmzunquJKBSDvjR1+A30dxPViJ0DPoAsN/AhG6UV0IdEf37e0l8ZmSv8gbvjcQ3pYrqCQlotEGq8rz6eQBNediqLPvfTGrFKiN1/iTjIygY0qIXsEZfIs1X1zgaSRdGN8Q/dwFfY3jZuIwmr2ONqQkiJHg+TAUzhdgLyqbRoxF7CKWGP+mIgv8gtrC/3P/sH5uq3ghek6zxys3eQqypYp6tIjXp6kyDF3lb9AKZwZhqXSbRoxH5yVgnb64mBfOZmaIq+FeaChNCOlGcecqy1UOrI8JahPz8SyJ51W+COtGXFsXa5I7ODoX8BshW/nmUZhQAAAAAASUVORK5CYII=",
        "src": "https://latex.codecogs.com/png.latex?diff.cost%20=%20cst.trt%20-%20cst.ctl"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-11-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-12-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-14-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-15-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-16-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAOBAMAAADkjZCYAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVM0iq7tEEO9mmTJ23YmxseOzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAARklEQVQIHWNgYFRmAAFXMJlfAKI4JoBIrgAQyf0dRDJ0gghGJRAps9+AgYHNgfcAA0MSA88FBrZ2BubPDLwbGBjiQNIMDABYVAnj3M3uXwAAAABJRU5ErkJggg==",
        "src": "https://latex.codecogs.com/png.latex?%5Clambda"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-21-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-23-1.png?w=450&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/robert-horton-and-joseph-rickert/",
        "text": "Robert Horton and Joseph Rickert"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-392524 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Cost-Effectiveness Analysis</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">May 18, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/robert-horton-and-joseph-rickert/\">Robert Horton and Joseph Rickert</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://rworks.dev/posts/ESDM-2/\"> R Works</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<p>In a <a href=\"https://rworks.dev/posts/evidence-synthesis/\" rel=\"nofollow\" target=\"_blank\">previous post</a>, we presented an <code>rjags</code> version of a Bayesian model from Chapter 2 of the textbook: <em>Evidence Synthesis for Decision Making in Healthcare</em> by <a href=\"https://bcs.wiley.com/he-bcs/Books?action=index&amp;bcsId=7268&amp;itemId=047006109X\" rel=\"nofollow\" target=\"_blank\">Welton et al. (2012)</a>. In this post, we continue our project to present <code>rjags</code> versions of the <code>WinBugs</code> models in the text by presenting the economic decision model from Chapter 3. Note that to run the code below, you must first install the <code>JAGS</code> program which is available from <a class=\"uri\" href=\"http://mcmc-jags.sourceforge.net/\" rel=\"nofollow\" target=\"_blank\">http://mcmc-jags.sourceforge.net/</a>, and the <code>rjags</code> package is available from <a class=\"uri\" href=\"https://cran.r-project.org/web/packages/rjags/index.html\" rel=\"nofollow\" target=\"_blank\">https://cran.r-project.org/web/packages/rjags/index.html</a>.</p>\n<p>Chapter 3 of the text explores the health economics decision of whether or not a healthcare system should adopt the practice of prophylactically administering an antibiotic to women who are about to give birth by Cesarean section. Two versions of a decision model are presented: a deterministic model and a stochastic model. The deterministic model lays out the decision framework and calculates the expected costs of the two options: administering the antibiotic or not. The stochastic model adds uncertainty to the decision framework by assigning probability distributions to the parameters in the deterministic model. The stochastic model is then used to conduct a cost-effectiveness analysis of the two options.</p>\n<p>Note that cost effectiveness decision frameworks in healthcare are typically presented as a Cost-Utility analysis, conducted from a systems perspective that measures utility of medical effects in Quality Adjusted Life Years using ICERs <em>(Incremental Cost Effectiveness Ratio) = (Additional Costs) / (Additional Benefits)</em>.</p>\n<p>The final decision often comes down to examining the equation: Net Benefit = Uλ – C where:</p>\n<ul>\n<li>U = Lifetime utility of intervention (usually measured in <a href=\"https://en.wikipedia.org/wiki/Quality-adjusted_life_year\" rel=\"nofollow\" target=\"_blank\">QALYS</a>)</li>\n<li>λ = money value attributed to a unit of health gain: i.e., the exchange rate</li>\n<li>C = lifetime cost</li>\n</ul>\n<p>The following figure depicts the decision as a tree. The decision of whether or not to prescribe prophylactic antibiotics is represented by the square node labelled <code>Px</code>. The two branches from this node represent the treatment and control groups. These groups are represented as circles because they are “chance nodes”; people in those groups may or may not go on to get a wound infection. The probability of infection is different for each group (p1 and p2). The four leaves of the tree are the four possible outcomes: getting a wound infection or not in either the treatment or the control. We can compute a cost for each outcome. For example, the most expensive outcome is for patients who received the antibiotic and got an infection anyway because they have both the costs of providing the prophylaxis and the costs of treating the wound. Though not shown on the diagram, we can also compute a utility (in QALYs) for each outcome (e.g., time a patient spends in the hospital is not as valuable as time spent otherwise). The expected cost and utility of each main branch are a probability-weighted average of the costs and utilities of the leaves of that branch.</p>\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-1\" href=\"https://i2.wp.com/rworks.dev/posts/ESDM-2/decision_tree.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img alt=\"The decision tree.\" class=\"img-fluid\" data-lazy-src=\"https://i2.wp.com/rworks.dev/posts/ESDM-2/decision_tree.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"The decision tree.\" class=\"img-fluid\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/rworks.dev/posts/ESDM-2/decision_tree.png?w=578&amp;ssl=1\"/></noscript></a></p>\n<section class=\"level1\" id=\"deterministic-decision-analysis\">\n<h1>Deterministic Decision Analysis</h1>\n<p>In this section, we will present a deterministic model of the problem that can be described by means of the following directed graph. Variables in blue on the right side if the diagram represent cost data (see the table in the section “Resource Use and Cost Data” below). The costs of the four leaves of our decision tree are computed from these values. A patient with an infected wound will have a different cost per day of care than a patient without a wound infection and presumably a different length of stay in the hospital. In addition, the treatment group has costs associated with buying and administering multiple doses of the prophylactic antibiotic.</p>\n<p>The variables <code>nc1</code> and <code>rc1</code> are the total number of Caesarean sections and wound infections in the health system making the decision. Since they do not yet use prophylactic antibiotics for the operation, these values let us estimate the prevalence of wound infections in the untreated group (<code>p1</code>).</p>\n<p>The green variables in the upper left (a through d) represent data from a clinical trial (see the table in the “Clinical Data” section below). Since the prevalence of wound infection in the hospitals where the study was done is different from that in the target health system, we need to compute the relative risk for treated vs. control patients in the study. This is just the proportion of patients getting an infection in the treatment group, divided by the proportion in the control group:</p>\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-2\" href=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/deterministic.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img alt=\"Deterministic DAG.\" class=\"img-fluid\" data-lazy-src=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/deterministic.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"Deterministic DAG.\" class=\"img-fluid\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/deterministic.png?w=578&amp;ssl=1\"/></noscript></a></p>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?%20Relative%20Risk%20=%20%5Cfrac%7Ba/(a+b)%7D%7Bc/(c+d)%7D\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?%20Relative%20Risk%20=%20%5Cfrac%7Ba/(a+b)%7D%7Bc/(c+d)%7D\"/></noscript> where:</p>\n<ul>\n<li>a is the number of women who received antibiotics and subsequently developed infections</li>\n<li>b is the number of women who received antibiotics who did not develop infections</li>\n<li>c is the number of women who received the placebo and subsequently became infected</li>\n<li>d is the number of women who received the placebo who did not become infected</li>\n</ul>\n<p>The deterministic model presented in this section may be found on page 56 in section 3.4 of the text.</p>\n<p>The deterministic model simply computes the products and sums, and displays the results. There is nothing Bayesian here yet; this model just does some simple math in JAGS to lay the foundation for subsequent probabilistic refinements.</p>\n<section class=\"level2\" id=\"the-clinical-data\">\n<h2 class=\"anchored\" data-anchor-id=\"the-clinical-data\">The Clinical Data</h2>\n<p>The data for the effectiveness of prophylactic antibiotics to reduce infection in women delivering by cesarean section comes from a study by <a href=\"https://pubmed.ncbi.nlm.nih.gov/8051377/\" rel=\"nofollow\" target=\"_blank\">Bibi et al., (1994)</a>.</p>\n</section>\n<section class=\"level2\" id=\"preparations-for-running-the-model.\">\n<h2 class=\"anchored\" data-anchor-id=\"preparations-for-running-the-model.\">Preparations for running the model.</h2>\n<p>This section of code loads the necessary libraries and contains a couple of helper functions that are used later in the code. The first function, <code>coda_sample_2_df</code>, extracts data from a coda sample into a dataframe. The second function, <code>plot_densities_from_coda_df</code>, makes comparative density plots for the given variables.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre># libraries\nlibrary(coda, verbose = FALSE)\nlibrary(rjags, verbose = FALSE) # coda.samples\nlibrary(jagsUI, verbose = FALSE) # wrapper for rjags\nlibrary(mcmcplots) # caterplot\nlibrary(tidyverse, verbose = FALSE)\nlibrary(gridExtra)\n\n# A couple of helper functions\n#| message: FALSE\n#| warning: FALSE\n#| echo: FALSE\n# functions\ncoda_sample_2_df &lt;- function(my_coda_sample) {\n  # Extract data from a coda sample into a dataframe\n  seq_along(my_coda_sample) %&gt;%\n    lapply(function(chain) {\n      df &lt;- my_coda_sample[[chain]] %&gt;%\n        as.matrix() %&gt;%\n        as.data.frame()\n      df[\"chain\"] &lt;- chain\n      df\n    }) %&gt;%\n    bind_rows() %&gt;%\n    mutate(chain = factor(chain))\n}\n\nplot_densities_from_coda_df &lt;- function(vars, coda_df) {\n  # Make comparative density plots for the given variables\n  coda_df %&gt;%\n    select(all_of(vars)) %&gt;%\n    pivot_longer(cols = vars) %&gt;%\n    ggplot(aes(x = value, col = name, fill = name)) +\n    geom_density(alpha = 0.6)\n}</pre>\n</details>\n</div>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>effectiveness_df &lt;- data.frame(\n  Description = c(\"Prophylactic antibiotics\", \"Placebo\"),\n  Infection = c(4, 28),\n  No_infection = c(129, 108),\n  row.names = c(\"Treatment\", \"Control\")\n) %&gt;% mutate(Total = Infection + No_infection)\n\neffectiveness_df</pre>\n</details>\n<div class=\"cell-output cell-output-stdout\">\n<pre>                       Description Infection No_infection Total\nTreatment Prophylactic antibiotics         4          129   133\nControl                    Placebo        28          108   136</pre>\n</div>\n</div>\n</section>\n<section class=\"level2\" id=\"resource-use-and-cost-data\">\n<h2 class=\"anchored\" data-anchor-id=\"resource-use-and-cost-data\">Resource Use and Cost Data</h2>\n<p>The resource use and cost data comes from Table 3.3, p55. Data is from <a href=\"https://pubmed.ncbi.nlm.nih.gov/2511938/\" rel=\"nofollow\" target=\"_blank\">Mugford et al., 1989</a>, except for the cost of administering antibiotic which was estimated by Welton et al.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>cost_df &lt;- data.frame(\n  Parameter = c(\n    \"Length of stay: infection\",\n    \"Length of stay: no infection\",\n    \"Cost per day: infection\",\n    \"Cost per day: no infection\",\n    \"Cost per dose: cephaslosporin\",\n    \"Cost per administering antibiotic\",\n    \"Doses administered\",\n    \"Total number of Caesarians\",\n    \"Number infections: no antibiotics\"\n  ),\n  Estimate = c(8.80, 6.70, 163.03, 107.26, 5.67, 7.00, 3, 486, 41),\n  Units = c(\"days\", \"days\", \"£\", \"£\", \"£\", \"£\", \"count\", \"count\", \"count\"),\n  Variable_name = c(\"loswd\", \"losnwd\", \"cstwd\", \"cstnwd\", \"cstPx\", \"cstadmin\", \"dose\", \"nc1\", \"rc1\")\n)\n\ncost_df</pre>\n</details>\n<div class=\"cell-output cell-output-stdout\">\n<pre>                          Parameter Estimate Units Variable_name\n1         Length of stay: infection     8.80  days         loswd\n2      Length of stay: no infection     6.70  days        losnwd\n3           Cost per day: infection   163.03     £         cstwd\n4        Cost per day: no infection   107.26     £        cstnwd\n5     Cost per dose: cephaslosporin     5.67     £         cstPx\n6 Cost per administering antibiotic     7.00     £      cstadmin\n7                Doses administered     3.00 count          dose\n8        Total number of Caesarians   486.00 count           nc1\n9 Number infections: no antibiotics    41.00 count           rc1</pre>\n</div>\n</div>\n</section>\n<section class=\"level2\" id=\"the-deterministic-model\">\n<h2 class=\"anchored\" data-anchor-id=\"the-deterministic-model\">The Deterministic Model</h2>\n<p>The following code builds a model in the <code>BUGS</code> language for specifying probability distributions that will be evaluated by the <code>rjags</code> interface to the <code>JAGS</code> MCMC engine.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>model_code &lt;- \"\nmodel {\n  cost_nwdpx &lt;- losnwd * cstnwd + dose * (cstPx + cstadmin) # Cost (No infection/Px)\n  cost_wdpx &lt;- loswd * cstwd + dose * (cstPx + cstadmin)    # Cost (Infection/Px)\n  cost_nwd &lt;- losnwd * cstnwd                               # Cost (No infection/no Px)\n  cost_wd &lt;- loswd * cstwd                                  # Cost (Infection/no Px)\n  \n  RR &lt;- (a/(a+b))/(c/(c+d))                                 # Relative risk using \n                                                            # data from table 3.2\n                                                            \n  p1 &lt;- rc1/nc1\n  p2 &lt;- RR * p1\n  \n  costtrt &lt;- ((1-p2) * cost_nwdpx) + p2 * cost_wdpx         # Total cost (payoff) Px\n  costctl &lt;- ((1-p1) * cost_nwd) + p1 * cost_wd             # Total cost (payoff) No Px\n\n}\"\n\ncost_data &lt;- with(cost_df, setNames(as.list(Estimate), nm = Variable_name))\neffectiveness_data &lt;- list(\n  a = effectiveness_df[\"Treatment\", \"Infection\"],\n  b = effectiveness_df[\"Treatment\", \"No_infection\"],\n  c = effectiveness_df[\"Control\", \"Infection\"],\n  d = effectiveness_df[\"Control\", \"No_infection\"]\n)\ndeterministic_data &lt;- append(cost_data, effectiveness_data)</pre>\n</details>\n</div>\n<p>This next block of code executes the model and displays the results. Notice that the expected costs of the treatment and control branches match those in the text on p56.</p>\n<p>We expect the rate of infection in the treated group (p2) to be lower than in the untreated group (p1) and the overall cost of treatment to be lower than the cost of not treating.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>results </pre>\n</details>\n<div class=\"cell-output cell-output-stdout\">\n<pre>JAGS output for model '5', generated by jagsUI.\nEstimates based on 1 chains of 1 iterations,\nadaptation = 100 iterations (sufficient),\nburn-in = 0 iterations and thin rate = 1,\nyielding 1 total samples from the joint posterior. \nMCMC ran for 0.004 minutes at time 2025-05-19 10:23:22.849254.\n\n           mean sd    2.5%     50%   97.5% overlap0 f\np1        0.084 NA   0.084   0.084   0.084    FALSE 1\np2        0.012 NA   0.012   0.012   0.012    FALSE 1\ncosttrt 765.476 NA 765.476 765.476 765.476    FALSE 1\ncostctl 779.047 NA 779.047 779.047 779.047    FALSE 1\n\noverlap0 checks if 0 falls in the parameter's 95% credible interval.\nf is the proportion of the posterior with the same sign as the mean;\ni.e., our confidence that the parameter is positive or negative.</pre>\n</div>\n</div>\n</section>\n</section>\n<section class=\"level1\" id=\"stochastic-decision-analysis\">\n<h1>Stochastic Decision Analysis</h1>\n<p>Having established a deterministic baseline model, the next step is to account for the uncertainty in the modeling assumptions by developing a Bayesian stochastic model that uses probability distributions rather than point estimates to represent uncertain parameters.</p>\n<p>This diagram shows the relationships between variables in the stochastic model. The red nodes are stochastic variables, as is the orange outcome node (differential cost). These depend on parameterized random distributions. For example, the relative risk (RR) and prevalence of infection in the target hospital (p1) are no longer simple point estimates as they were in the deterministic model; instead, they are modeled by statistical distributions parameterized by the observed data (see equations below). The cost of administering the drug is now randomly taken from a range, and the length of stay estimates are described as Normal distributions with a given mean and precision. Variables computed from these stochastic variables are stochastic as well, so ‘p2’, ‘cst.trt’, and ‘cst.ctl’ are also red, and the outcome of all this ‘diff.cost’ is, in turn, estimated stochastically.</p>\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-3\" href=\"https://i0.wp.com/rworks.dev/posts/ESDM-2/stochastic.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img alt=\"Stochastic Model DAG.\" class=\"img-fluid\" data-lazy-src=\"https://i0.wp.com/rworks.dev/posts/ESDM-2/stochastic.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"Stochastic Model DAG.\" class=\"img-fluid\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/rworks.dev/posts/ESDM-2/stochastic.png?w=578&amp;ssl=1\"/></noscript></a></p>\n</section>\n<section class=\"level1\" id=\"model-with-distributions\">\n<h1>Model with Distributions</h1>\n<p>The next step towards working our way up to a full Bayesian model is to assign probability distributions to the clinical variables for which there is uncertainty. These are:</p>\n<section class=\"level2\" id=\"distribution-of-lnrelative-risk\">\n<h2 class=\"anchored\" data-anchor-id=\"distribution-of-lnrelative-risk\">Distribution of ln(Relative Risk):</h2>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?%20ln(RR)%5Csim%20N(%5Ctheta,%20prec)\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?%20ln(RR)%5Csim%20N(%5Ctheta,%20prec)\"/></noscript> <img data-lazy-src=\"https://latex.codecogs.com/png.latex?%20%5Ctheta%20=%20log%5Cleft(%5Cfrac%7Ba/(a+b)%7D%7Bc/(c+d)%7D%5Cright)%20\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?%20%5Ctheta%20=%20log%5Cleft(%5Cfrac%7Ba/(a+b)%7D%7Bc/(c+d)%7D%5Cright)%20\"/></noscript> <img data-lazy-src=\"https://latex.codecogs.com/png.latex?%20prec%20=%20%5Cfrac%7B1%7D%7B(1/a)%20-%201%20/%20(a%20+%20b)%20%20+%20(1/c)%20-%201(/(c%20+%20d)%7D%20%5C%5C\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?%20prec%20=%20%5Cfrac%7B1%7D%7B(1/a)%20-%201%20/%20(a%20+%20b)%20%20+%20(1/c)%20-%201(/(c%20+%20d)%7D%20%5C%5C\"/></noscript></p>\n<p>where as above:</p>\n<ul>\n<li>a is the number of women who received antibiotics and subsequently developed infections</li>\n<li>b is the number of women who received antibiotics who did not develop infections</li>\n<li>c is the number of women who received the placebo and subsequently became infected</li>\n<li>d is the number of women who received the placebo who did not become infected</li>\n</ul>\n</section>\n<section class=\"level2\" id=\"distribution-of-probinfection-no-antibiotic\">\n<h2 class=\"anchored\" data-anchor-id=\"distribution-of-probinfection-no-antibiotic\">Distribution of Prob[infection | no antibiotic]</h2>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?%20p_1%20%5Csim%20Beta(%20%5Calpha,%20%5Cbeta)\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?%20p_1%20%5Csim%20Beta(%20%5Calpha,%20%5Cbeta)\"/></noscript></p>\n<p>where:</p>\n<ul>\n<li><img data-lazy-src=\"https://latex.codecogs.com/png.latex?%5Calpha%20=%20rc1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?%5Calpha%20=%20rc1\"/></noscript></li>\n<li><img data-lazy-src=\"https://latex.codecogs.com/png.latex?%5Cbeta%20=%20nc1%20-%20rc1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?%5Cbeta%20=%20nc1%20-%20rc1\"/></noscript></li>\n<li>rc1 = Number infections: no antibiotics</li>\n<li>nc1 = Total number of Carnelians</li>\n</ul>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?p_2%20=%20e%5E%7BlnRR%7D%20p_1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?p_2%20=%20e%5E%7BlnRR%7D%20p_1\"/></noscript></p>\n<p>is the distribution for the probability of an infection with the antibiotic.</p>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?loswd%20%5Csim%20N(mnloswd,%20precwd)\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?loswd%20%5Csim%20N(mnloswd,%20precwd)\"/></noscript></p>\n<p>is the distribution of the length of a hospital stay with an infected wound where:</p>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?precwd%20=%20%5Cfrac%7B1%7D%7B(sdloswd/%5Csqrt%7Bnumwd%7D)%5E2%7D\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?precwd%20=%20%5Cfrac%7B1%7D%7B(sdloswd/%5Csqrt%7Bnumwd%7D)%5E2%7D\"/></noscript></p>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?losnwd%20%5Csim%20N(mnlosnwd,%20precnwd)\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?losnwd%20%5Csim%20N(mnlosnwd,%20precnwd)\"/></noscript></p>\n<p>is the distribution for length of hospital stay without infection, where:</p>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?precnwd%20=%20%5Cfrac%7B1%7D%7B(sdlosnwd/%5Csqrt%7Bnumwd%7D)%5E2%7D\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?precnwd%20=%20%5Cfrac%7B1%7D%7B(sdlosnwd/%5Csqrt%7Bnumwd%7D)%5E2%7D\"/></noscript></p>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?cstadmin%20%5Csim%20U(4,%2010)\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?cstadmin%20%5Csim%20U(4,%2010)\"/></noscript> is the distribution of the antibiotic dose administered.</p>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?cst.trt%20=%20(1-p_2)((cstPx%20+%20cstadmin)3%20+%20(losnwd)(cstnwd))%20+%20p_2((cstPx%20+%20cstadmin)3%20+%20(loswd)(cstwd))\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?cst.trt%20=%20(1-p_2)((cstPx%20+%20cstadmin)3%20+%20(losnwd)(cstnwd))%20+%20p_2((cstPx%20+%20cstadmin)3%20+%20(loswd)(cstwd))\"/></noscript></p>\n<p>is the total cost for the antibiotic arm of the decision tree.</p>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?cst.ctl%20=%20(1-p_1)(losnwd)(cstnwd)%20+%20p_1(loswd)(cstwd)\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?cst.ctl%20=%20(1-p_1)(losnwd)(cstnwd)%20+%20p_1(loswd)(cstwd)\"/></noscript></p>\n<p>is the total cost for the no antibiotic arm of the decision tree.</p>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?diff.cost%20=%20cst.trt%20-%20cst.ctl\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?diff.cost%20=%20cst.trt%20-%20cst.ctl\"/></noscript> is the differential cost.</p>\n</section>\n<section class=\"level2\" id=\"code-for-the-stochastic-model\">\n<h2 class=\"anchored\" data-anchor-id=\"code-for-the-stochastic-model\">Code for the Stochastic Model</h2>\n<p>This next block of <code>BUGS</code> code implements the stochastic model described above. The code is similar to the deterministic model, but with the addition of the distributions for the parameters that are uncertain.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>stochastic_model_code &lt;- \"\nmodel{\n  lnRR ~ dnorm(theta, prec)   # Distribution for ln(Relative Risk)\n  theta &lt;- log( (a/(a+b)) / (c/(c+d)) )\n  prec &lt;- 1/( (1/a) - (1/(a+b)) + (1/c) - (1/(c+d)) )\n  \n  p1 ~ dbeta(alpha, beta) # Distribution for Prob(Infection/NoPx)\n  alpha &lt;- rc1\n  beta &lt;- nc1 - rc1\n  \n  p2 &lt;- exp(lnRR) * p1  # Distribution for Prob(Infection/Px)\n  \n  loswd ~ dnorm(mnloswd, precwd)  # Distribution for length of stay with infection\n  precwd &lt;- 1/pow(sdloswd/sqrt(numwd), 2)\n  \n  losnwd ~ dnorm(mnlosnwd, precnwd)  # Distribution for length of stay w/o infection\n  precnwd &lt;- 1/pow(sdlosnwd/sqrt(numnwd), 2)\n  \n  cstadmin ~ dunif(4, 10) # Px administration\n  \n  cst.trt &lt;- (1-p2)*((cstPx + cstadmin)*3 + (losnwd*cstnwd)) + p2*((cstPx + cstadmin)*3 + (loswd*cstwd)) # Total cost (payoff) Px\n  \n  cst.ctl &lt;- (1-p1)*(losnwd*cstnwd) + p1*(loswd*cstwd) # Total cost (payoff) No Rx\n  \n  diff.cost &lt;- cst.trt - cst.ctl  # Difference in cost\n}\" %&gt;% textConnection()</pre>\n</details>\n</div>\n</section>\n<section class=\"level2\" id=\"data-for-the-stochastic-model\">\n<h2 class=\"anchored\" data-anchor-id=\"data-for-the-stochastic-model\">Data for the Stochastic Model</h2>\n<p>This block of R code provides parameter values for the stochastic model. The values are taken from the text, but some of them have been changed to reflect the fact that we are now using a stochastic model. The changes are indicated in the comments.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>stochastic_data &lt;- list(\n  rc1 = 41, nc1 = 486, cstwd = 163.03, cstnwd = 107.26,\n  mnloswd = 8.8, sdloswd = 3.5,\n  mnlosnwd = 6.7, sdlosnwd = 7.1,\n  numwd = 41, numnwd = 445, # !!! numwd == rc1; numnwd == (nc1 - rc1)\n  cstPx = 5.67,\n  # rt=4, nt=133, rc=28, nc=136,  # !!! Unused variables\n  a = 4, b = 129, c = 28, d = 108\n)\n\n# Here I code the changes from the data for the deterministic model to the \n# data for the stochastic one, in case that makes the differences easier to see.\n\n    # Add these:\n    # setdiff(names(stochastic_data), names(deterministic_data))\n    # \"mnloswd\"  \"sdloswd\"  \"mnlosnwd\" \"sdlosnwd\"\n    # \"numwd\" ==  rc1;\n    # \"numnwd\" == (nc1 - rc1)\n    # \n    # Remove or rename these:\n    # setdiff(names(deterministic_data), names(stochastic_data))\n    #  \"loswd\" -&gt; \"mnloswd\"\n    #  \"losnwd\" -&gt; \"mnlosnwd\"\n    #  \"cstadmin\" hard-coded uniform distribution\n    #  \"dose\": hard-coded !!!\n\n# uncertainty &lt;- c(sdloswd=3.5, sdlosnwd=7.1) # standard deviations from Table 3.4\n# rename_me &lt;- c(\"loswd\"=\"mnloswd\", \"losnwd\"=\"mnlosnwd\")\n# \n# stochastic_data &lt;- append(deterministic_data, uncertainty)\n# for (old_name in names(rename_me)){\n#   new_name &lt;- rename_me[[old_name]]\n#   names(stochastic_data)[names(stochastic_data) == old_name] &lt;- new_name\n# }\n# stochastic_data[\"cstadmin\"] &lt;- NULL # now coded as uniform random\n# stochastic_data[\"dose\"] &lt;- NULL # the 3 is hard coded now\n# \n# stochastic_data[\"numwd\"] &lt;- stochastic_data[\"rc1\"]; \n# stochastic_data[\"numnwd\"] &lt;-  with(stochastic_data, (nc1 - rc1))\n\n\nparameters_to_save &lt;- c(\"cst.trt\", \"cst.ctl\", \"diff.cost\")</pre>\n</details>\n</div>\n</section>\n<section class=\"level2\" id=\"code-to-run-the-stochastic-model\">\n<h2 class=\"anchored\" data-anchor-id=\"code-to-run-the-stochastic-model\">Code to Run the Stochastic Model</h2>\n<p>This code runs the stochastic model. The code is similar to the deterministic model, but with the addition of the distributions for the parameters that are uncertain.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>stochastic_results &lt;- jags(\n  data = stochastic_data,\n  parameters.to.save = parameters_to_save,\n  model.file = stochastic_model_code,\n  n.chains = 4,\n  n.adapt = 100,\n  n.iter = 50000,\n  n.burnin = 20000,\n  verbose = FALSE\n)</pre>\n</details>\n</div>\n</section>\n<section class=\"level2\" id=\"model-results\">\n<h2 class=\"anchored\" data-anchor-id=\"model-results\">Model Results</h2>\n<p>The following table shows a summary of the model results. These include the mean, standard deviations, and quantiles for the posterior distributions of the cost of treatment and control, the differential cost and the relative risk, along with information on some diagnostic statistics. The results are similar to those in the text on p 66.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>stochastic_results_summary &lt;- summary(stochastic_results) |&gt;\n  as.data.frame() |&gt;\n  select(!c(3, 4))\n\nround(stochastic_results_summary, 3)</pre>\n</details>\n<div class=\"cell-output cell-output-stdout\">\n<pre>             mean     sd     50%     75%   97.5% Rhat  n.eff overlap0     f\ncst.trt   766.945 36.390 767.034 791.444 838.007    1 120000        0 1.000\ncst.ctl   779.238 35.095 779.353 802.934 848.135    1 120000        0 1.000\ndiff.cost -12.292 12.803 -11.779  -3.518  11.234    1 120000        1 0.835</pre>\n</div>\n</div>\n<p>The diagnostic statistics are interpreted as follows:</p>\n<ul>\n<li>Rhat, the Gelman-Rubin Statistic, is a diagnostic that compares the variance within chains to the variance between chains. Values close to 1 (typically less than 1.1) indicate that the chains have converged.</li>\n<li>n.eff: provides an estimate of how many independent samples the samples in the chain are equivalent to. A higher number suggests more reliable estimates.</li>\n<li>overlap0 = 0 indicates that the 95% credible interval does not include 0, suggesting a statistically significant effect.</li>\n<li>f is the proportion of the posterior with the same sign as the mean.</li>\n</ul>\n</section>\n<section class=\"level2\" id=\"diagnostic-plots\">\n<h2 class=\"anchored\" data-anchor-id=\"diagnostic-plots\">Diagnostic Plots</h2>\n<p>In this section, we will plot the results of the MCMC sampling. The first plot in each row shows the trace history for the parameters of interest, and the second shows the density. Multiple colors indicate the four independent MCMC chains. Since they are on top of each other and mixing well, we can see that the chains have converged to a common distribution.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>plot(stochastic_results)</pre>\n</details>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-4\" href=\"https://i2.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-11-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-11-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-11-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n</section>\n<section class=\"level2\" id=\"prior-distributions\">\n<h2 class=\"anchored\" data-anchor-id=\"prior-distributions\">Prior Distributions</h2>\n<p>Here, we plot the Prior distributions that were described above.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>## Prior Distribution for log Relative Risk\na &lt;- stochastic_data$a\nb &lt;- stochastic_data$b\nc &lt;- stochastic_data$c\nd &lt;- stochastic_data$d\ntheta &lt;- log((a / (a + b)) / (c / (c + d)))\n# theta\nprec &lt;- 1 / ((1 / a) - (1 / (a + b)) + (1 / c) - (1 / (c + d)))\n# prec\nvar &lt;- 1 / prec\n# var\n# Generate a sequence of x values\nx &lt;- seq(-15, 15, length.out = 100)\n\n# Compute the corresponding beta density values\nlnRR &lt;- dnorm(x, theta, prec)\n\n# Create a data frame for ggplot2\nnorm_data &lt;- data.frame(x = x, y = lnRR)\n\n# Plot the beta distribution\nq1 &lt;- ggplot(norm_data, aes(x = x, y = lnRR)) +\n  geom_line(color = \"brown\", linewidth = 1) +\n  geom_area(fill = \"brown\", alpha = 0.2) +\n  labs(\n    title = \"Prior: Log Relative Risk\",\n    x = \"Log(RR)\",\n    y = \"Density\"\n  )\n\n### Prior Distribution for p1\n# Define the beta distribution parameters\nalpha &lt;- stochastic_data$rc1\nbeta &lt;- stochastic_data$nc1 - stochastic_data$rc1\n\n# Generate a sequence of x values\nx &lt;- seq(0, .2, length.out = 100)\n\n# Compute the corresponding beta density values\ny &lt;- dbeta(x, alpha, beta)\n\n# Create a data frame for ggplot2\nbeta_data &lt;- data.frame(x = x, y = y)\n\n# Plot the beta distribution\nq2 &lt;- ggplot(beta_data, aes(x = x, y = y)) +\n  geom_line(color = \"blue\", linewidth = 1) +\n  geom_area(fill = \"blue\", alpha = 0.2) +\n  labs(\n    title = \"Prior: Infection | no antibiotic\",\n    x = \"p1\",\n    y = \"Density\"\n  )\n\n### Prior distribution for length of stay, wound infection\n# Define the normal distribution parameters\nmean &lt;- stochastic_data$mnloswd\nsd &lt;- stochastic_data$sdlosnwd / sqrt(stochastic_data$numwd)\n\n# Generate a sequence of x values\nx &lt;- seq(5, 15, length.out = 100)\n\n# Compute the corresponding beta density values\ny &lt;- dnorm(x, mean, sd)\n\n# Create a data frame for ggplot2\nnorm_data &lt;- data.frame(x = x, y = y)\n\n# Plot the beta distribution\nq3 &lt;- ggplot(norm_data, aes(x = x, y = y)) +\n  geom_line(color = \"red\", linewidth = 1) +\n  geom_area(fill = \"red\", alpha = 0.2) +\n  xlim(5, 13) +\n  labs(\n    title = \"Prior: length of stay | infection\",\n    x = \"Length of Stay (days) \",\n    y = \"Density\"\n  )\n\n\n## Prior distribution for length of stay, no wound infection\n# Define the normal distribution parameters\nmean &lt;- stochastic_data$mnlosnwd\nsd &lt;- stochastic_data$sdlosnwd / sqrt(stochastic_data$numnwd)\n\n# Generate a sequence of x values\nx &lt;- seq(5, 10, length.out = 100)\n\n# Compute the corresponding beta density values\ny &lt;- dnorm(x, mean, sd)\n\n# Create a data frame for ggplot2\nnorm_data &lt;- data.frame(x = x, y = y)\n\n# Plot the beta distribution\nq4 &lt;- ggplot(norm_data, aes(x = x, y = y)) +\n  geom_line(color = \"darkgreen\", linewidth = 1) +\n  geom_area(fill = \"green\", alpha = 0.2) +\n  xlim(5, 13) +\n  labs(\n    title = \"Prior: length of stay | no infection\",\n    x = \"Length of Stay (days)\",\n    y = \"Density\"\n  )\n\ngrid.arrange(q1, q3, q2, q4)</pre>\n</details>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-5\" href=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-12-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-12-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-12-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n</section>\n<section class=\"level2\" id=\"posterior-distributions\">\n<h2 class=\"anchored\" data-anchor-id=\"posterior-distributions\">Posterior Distributions</h2>\n<p>Here we re-sample an existing model and plot densities of several variables using the R functions defined at the beginning of this document.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>my_vars &lt;- c(\"p1\", \"p2\", \"cst.trt\", \"cst.ctl\", \"diff.cost\")\ncoda_df &lt;- coda.samples(stochastic_results$model,\n  variable.names = my_vars,\n  n.iter = 10000\n) %&gt;%\n  coda_sample_2_df() %&gt;%\n  sample_frac(1L) # randomly scramble chain order</pre>\n</details>\n</div>\n<p>Plot the posterior densities for the cost of treatment</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>w1 &lt;- plot_densities_from_coda_df(c(\"cst.trt\", \"cst.ctl\"), coda_df) + ggtitle(\"Posterior Densities for Cost of Treatment\")\nw1</pre>\n</details>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-6\" href=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-14-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-14-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-14-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n<p>Plot the posterior density for Differential Cost</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>w2 &lt;- coda_df %&gt;% ggplot(aes(x = diff.cost)) +\n  geom_density(fill = \"blue\", alpha = 0.5) +\n  ggtitle(\"Posterior Density for Differential Cost\")\nw2</pre>\n</details>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-7\" href=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-15-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-15-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-15-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n<p>Plot the densities for P1 and P2</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>w3 &lt;- plot_densities_from_coda_df(c(\"p1\", \"p2\"), coda_df) + ggtitle(\"Posterior Densities for P1 and P2\")\nw3</pre>\n</details>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-8\" href=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-16-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-16-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-16-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n</section>\n</section>\n<section class=\"level1\" id=\"the-economic-model\">\n<h1>The Economic Model</h1>\n<p>This next section of code integrates the computations for cost-effectiveness into the model model presented above. You can find this code on page 65 of the text.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>economic_model_code &lt;- \"\nmodel{\n  lnRR ~ dnorm(theta, prec) # Distribution for ln(Relative Risk)\n  theta &lt;- log( (a/(a+b)) / (c/(c+d)) )\n  prec &lt;- 1/( (1/a) - (1/(a+b)) + (1/c) - (1/(c+d)) )\n  \n  p1 ~ dbeta(alpha, beta)  # Distribution for Prob(Infection/NoPx)\n  alpha &lt;- rc1\n  beta &lt;- nc1 - rc1\n  \n  p2 &lt;- exp(lnRR) * p1   # Distribution for Prob(Infection/Px)\n  \n  loswd ~ dnorm(mnloswd, precwd)   # Distribution for length of stay with infection\n  precwd &lt;- 1/pow(sdloswd/sqrt(numwd), 2)\n  \n  losnwd ~ dnorm(mnlosnwd, precnwd) # Distribution for length of stay w/o infection\n  precnwd &lt;- 1/pow(sdlosnwd/sqrt(numnwd), 2)\n  \n  cstadmin ~ dunif(4, 10)   # Px administration\n  \n  cst.trt &lt;- (1-p2)*((cstPx + cstadmin)*3 + (losnwd*cstnwd)) + p2*((cstPx + cstadmin)*3 + (loswd*cstwd)) # Total cost (payoff) Px\n  \n  cst.ctl &lt;- (1-p1)*(losnwd*cstnwd) + p1*(loswd*cstwd) # Total cost (payoff) No Rx\n  \n  diff.cost &lt;- cst.trt - cst.ctl   # Difference in cost\n\n  \n  # Economic evaluation code from pp 65-66\n  \n  totQALYs.wd &lt;- ((QALYwd/365)*loswd) + ((Fullhealth/365)*(fllwupdays-loswd)) # QALYs (infection)\n  totQALYs.nwd &lt;- ((QALYnwd/365)*losnwd) + ((Fullhealth/365)*(fllwupdays-losnwd)) # QALYs (No infection)\n\n  QALYs.trt &lt;- (1-p2) * totQALYs.nwd + p2 * totQALYs.wd  # QALYs (Px)\n  QALYs.ctl &lt;- (1-p1) * totQALYs.nwd + p1 * totQALYs.wd  # QALYs (no px)\n  diff.QALYs &lt;- (QALYs.trt - QALYs.ctl)                  # Difference in QALYs\n  \n  for (k in 1:M)\n  {\n    lambda[k] &lt;- (k-1) * 2000\n    INB[k] &lt;- lambda[k] * diff.QALYs - diff.cost  # !!! not `delta.Qalys` or `delta.cost`\n    ProbCE[k] &lt;- step(INB[k])\n  }\n}\n\" %&gt;% textConnection()\n\n# economic_data &lt;- list(\n#   rc1=41, nc1=486, cstwd=163.03, cstnwd=107.26,\n#   mnloswd=8.8, sdloswd=3.5,\n#   mnlosnwd=6.7, sdlosnwd=7.1,\n#   numwd=41, numnwd=445,\n#   cstPx=5.67,\n#   a=4, b=129, c=28, d=108,\n#   # additional data for economic evaluation\n#   M=21, QALYwd=0.68, QALYnwd=0.88, Fullhealth=1, fllwupdays=20\n# )\neconomic_data &lt;- append(\n  stochastic_data,\n  # additional data for economic evaluation\n  list(M = 21, QALYwd = 0.68, QALYnwd = 0.88, Fullhealth = 1, fllwupdays = 20)\n)\n\nparameters_to_save &lt;- c( # \"ProbCE\",\n  \"QALYs.trt\", \"QALYs.ctl\", \"diff.QALYs\"\n)</pre>\n</details>\n</div>\n<section class=\"level2\" id=\"run-the-economic-model\">\n<h2 class=\"anchored\" data-anchor-id=\"run-the-economic-model\">Run the Economic Model</h2>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>economic_results &lt;- jags(\n  data = economic_data,\n  parameters.to.save = parameters_to_save,\n  model.file = economic_model_code,\n  n.chains = 1,\n  n.adapt = 100,\n  n.iter = 50000,\n  n.burnin = 20000,\n  verbose = FALSE\n)</pre>\n</details>\n</div>\n<p>And now, the economic results</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>economic_results_summary &lt;- summary(economic_results) %&gt;% as.data.frame()\n\nround(economic_results_summary, 5) |&gt; select(!c(3, 4))</pre>\n</details>\n<div class=\"cell-output cell-output-stdout\">\n<pre>              mean      sd     50%     75%   97.5% Rhat n.eff overlap0       f\nQALYs.trt  0.05251 0.00012 0.05252 0.05259 0.05274   NA     1        0 1.00000\nQALYs.ctl  0.05213 0.00013 0.05213 0.05221 0.05238   NA     1        0 1.00000\ndiff.QALYs 0.00039 0.00008 0.00038 0.00044 0.00055   NA     1        0 0.99997</pre>\n</div>\n</div>\n</section>\n<section class=\"level2\" id=\"the-economic-decision-cost-effectiveness\">\n<h2 class=\"anchored\" data-anchor-id=\"the-economic-decision-cost-effectiveness\">The Economic Decision: Cost-Effectiveness</h2>\n<p>The effectiveness of a healthcare intervention is often expressed <em>QALYS</em>, Quality-Adjusted Life Year, which combine mortality and morbidity from treatment outcomes into a single value. By putting diverse medical outcomes on the same scale, it makes it possible to allocate funds among very different programs (cancer care, prenatal care, vaccine programs, etc.).</p>\n<p>The following figure plots the results of many simulations of the economic model on the cost-effectiveness plane. This is the major tool for facilitating the decision as to whether to adopt the practice of prophylactically administering antibiotics. The x-axis represents the incremental QALYs and the y-axis represents the incremental costs. The dashed lines represent different values for <img data-lazy-src=\"https://latex.codecogs.com/png.latex?%5Clambda\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?%5Clambda\"/></noscript> the cut-off cost.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>XLIM &lt;- c(0, 7e-4) # use same limits as chapter 3\nYLIM &lt;- c(-75, 50)\nLAMBDAS &lt;- 10000 * (1:3)\nCE_1 &lt;- ce_df %&gt;%\n  ggplot(aes(x = diff.QALYs, y = diff.cost, col = chain)) +\n  geom_point(size = 0.5, alpha = 0.1) +\n  geom_abline(slope = 0, intercept = 0, linetype = \"solid\") +\n  geom_abline(slope = LAMBDAS, intercept = 0, linetype = \"dotted\") +\n  theme(legend.position = \"none\") +\n  labs(x = \"Incremental QALYs\", y = \"Incremental costs\", title = \"Cost-effectiveness plane for Caesarian section example\") +\n  coord_cartesian(xlim = XLIM, ylim = YLIM) +\n  annotate(\"text\",\n    x = XLIM[2], y = LAMBDAS * XLIM[2],\n    size = 3, hjust = 0.8, vjust = -0.25,\n    label = paste(\"lambda ==\", LAMBDAS), parse = TRUE\n  )\nCE_1</pre>\n</details>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-9\" href=\"https://i0.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-21-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-21-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-21-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n<p>Our final plot shows the expected incremental net benefit and 95% credible interval for a range of lambda values. The x-axis represents the value of lambda and the y-axis represents the expected incremental net benefit. The dashed lines represent the 2.5% and 97.5% quantiles of the posterior distribution of the incremental net benefit.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>inb_df_long %&gt;%\n  group_by(metric, lambda) %&gt;%\n  filter(metric == \"INB\") %&gt;%\n  summarize(\n    mean_INB = mean(value),\n    lo_end = quantile(value, probs = 0.025),\n    hi_end = quantile(value, probs = 0.975)\n  ) %&gt;%\n  ggplot(aes(x = lambda, group = metric)) +\n  geom_line(aes(y = mean_INB)) +\n  geom_line(aes(y = lo_end), linetype = \"dashed\") +\n  geom_line(aes(y = hi_end), linetype = \"dashed\")</pre>\n</details>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-10\" href=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-23-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-23-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/rworks.dev/posts/ESDM-2/index_files/figure-html/unnamed-chunk-23-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n</section>\n</section>\n<section class=\"level1\" id=\"closing-remarks\">\n<h1>Closing Remarks</h1>\n<p>Chapter 3 from Welton et al. presents an analysis of a classic healthcare technology assessment decision informed by a Bayesian statistical analysis and a decision structure that includes economic analysis and utility measured in QALYs. The decision is from the point of view of a public health system concerned with providing the best outcome for a population, given their budgetary constraints. The Quality-Adjusted Life Year (QALY) metric combines mortality and morbidity from treatment outcomes into a single value. By putting diverse medical outcomes on the same scale, it makes it possible to allocate funds among very different programs (cancer care, prenatal care, vaccine programs, etc.). However, the framework and the methodology can easily be reframed for decisions to be made in other contexts.</p>\n<p>A truly elegant feature of this model is that the uncertainties in the model parameters supporting the clinical calculations are expressed as probability distributions, which propagate through to compute the expected costs and benefits of each alternative. This integrated treatment of uncertainty is much more sophisticated than models that are limited to using point estimates to drive the economic decisions.</p>\n</section>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://rworks.dev/posts/ESDM-2/\"> R Works</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
    "main_text": "Cost-Effectiveness Analysis\nPosted on\nMay 18, 2025\nby\nRobert Horton and Joseph Rickert\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nR Works\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nIn a\nprevious post\n, we presented an\nrjags\nversion of a Bayesian model from Chapter 2 of the textbook:\nEvidence Synthesis for Decision Making in Healthcare\nby\nWelton et al. (2012)\n. In this post, we continue our project to present\nrjags\nversions of the\nWinBugs\nmodels in the text by presenting the economic decision model from Chapter 3. Note that to run the code below, you must first install the\nJAGS\nprogram which is available from\nhttp://mcmc-jags.sourceforge.net/\n, and the\nrjags\npackage is available from\nhttps://cran.r-project.org/web/packages/rjags/index.html\n.\nChapter 3 of the text explores the health economics decision of whether or not a healthcare system should adopt the practice of prophylactically administering an antibiotic to women who are about to give birth by Cesarean section. Two versions of a decision model are presented: a deterministic model and a stochastic model. The deterministic model lays out the decision framework and calculates the expected costs of the two options: administering the antibiotic or not. The stochastic model adds uncertainty to the decision framework by assigning probability distributions to the parameters in the deterministic model. The stochastic model is then used to conduct a cost-effectiveness analysis of the two options.\nNote that cost effectiveness decision frameworks in healthcare are typically presented as a Cost-Utility analysis, conducted from a systems perspective that measures utility of medical effects in Quality Adjusted Life Years using ICERs\n(Incremental Cost Effectiveness Ratio) = (Additional Costs) / (Additional Benefits)\n.\nThe final decision often comes down to examining the equation: Net Benefit = Uλ – C where:\nU = Lifetime utility of intervention (usually measured in\nQALYS\n)\nλ = money value attributed to a unit of health gain: i.e., the exchange rate\nC = lifetime cost\nThe following figure depicts the decision as a tree. The decision of whether or not to prescribe prophylactic antibiotics is represented by the square node labelled\nPx\n. The two branches from this node represent the treatment and control groups. These groups are represented as circles because they are “chance nodes”; people in those groups may or may not go on to get a wound infection. The probability of infection is different for each group (p1 and p2). The four leaves of the tree are the four possible outcomes: getting a wound infection or not in either the treatment or the control. We can compute a cost for each outcome. For example, the most expensive outcome is for patients who received the antibiotic and got an infection anyway because they have both the costs of providing the prophylaxis and the costs of treating the wound. Though not shown on the diagram, we can also compute a utility (in QALYs) for each outcome (e.g., time a patient spends in the hospital is not as valuable as time spent otherwise). The expected cost and utility of each main branch are a probability-weighted average of the costs and utilities of the leaves of that branch.\nDeterministic Decision Analysis\nIn this section, we will present a deterministic model of the problem that can be described by means of the following directed graph. Variables in blue on the right side if the diagram represent cost data (see the table in the section “Resource Use and Cost Data” below). The costs of the four leaves of our decision tree are computed from these values. A patient with an infected wound will have a different cost per day of care than a patient without a wound infection and presumably a different length of stay in the hospital. In addition, the treatment group has costs associated with buying and administering multiple doses of the prophylactic antibiotic.\nThe variables\nnc1\nand\nrc1\nare the total number of Caesarean sections and wound infections in the health system making the decision. Since they do not yet use prophylactic antibiotics for the operation, these values let us estimate the prevalence of wound infections in the untreated group (\np1\n).\nThe green variables in the upper left (a through d) represent data from a clinical trial (see the table in the “Clinical Data” section below). Since the prevalence of wound infection in the hospitals where the study was done is different from that in the target health system, we need to compute the relative risk for treated vs. control patients in the study. This is just the proportion of patients getting an infection in the treatment group, divided by the proportion in the control group:\nwhere:\na is the number of women who received antibiotics and subsequently developed infections\nb is the number of women who received antibiotics who did not develop infections\nc is the number of women who received the placebo and subsequently became infected\nd is the number of women who received the placebo who did not become infected\nThe deterministic model presented in this section may be found on page 56 in section 3.4 of the text.\nThe deterministic model simply computes the products and sums, and displays the results. There is nothing Bayesian here yet; this model just does some simple math in JAGS to lay the foundation for subsequent probabilistic refinements.\nThe Clinical Data\nThe data for the effectiveness of prophylactic antibiotics to reduce infection in women delivering by cesarean section comes from a study by\nBibi et al., (1994)\n.\nPreparations for running the model.\nThis section of code loads the necessary libraries and contains a couple of helper functions that are used later in the code. The first function,\ncoda_sample_2_df\n, extracts data from a coda sample into a dataframe. The second function,\nplot_densities_from_coda_df\n, makes comparative density plots for the given variables.\nShow the code\n# libraries\nlibrary(coda, verbose = FALSE)\nlibrary(rjags, verbose = FALSE) # coda.samples\nlibrary(jagsUI, verbose = FALSE) # wrapper for rjags\nlibrary(mcmcplots) # caterplot\nlibrary(tidyverse, verbose = FALSE)\nlibrary(gridExtra)\n\n# A couple of helper functions\n#| message: FALSE\n#| warning: FALSE\n#| echo: FALSE\n# functions\ncoda_sample_2_df <- function(my_coda_sample) {\n  # Extract data from a coda sample into a dataframe\n  seq_along(my_coda_sample) %>%\n    lapply(function(chain) {\n      df <- my_coda_sample[[chain]] %>%\n        as.matrix() %>%\n        as.data.frame()\n      df[\"chain\"] <- chain\n      df\n    }) %>%\n    bind_rows() %>%\n    mutate(chain = factor(chain))\n}\n\nplot_densities_from_coda_df <- function(vars, coda_df) {\n  # Make comparative density plots for the given variables\n  coda_df %>%\n    select(all_of(vars)) %>%\n    pivot_longer(cols = vars) %>%\n    ggplot(aes(x = value, col = name, fill = name)) +\n    geom_density(alpha = 0.6)\n}\nShow the code\neffectiveness_df <- data.frame(\n  Description = c(\"Prophylactic antibiotics\", \"Placebo\"),\n  Infection = c(4, 28),\n  No_infection = c(129, 108),\n  row.names = c(\"Treatment\", \"Control\")\n) %>% mutate(Total = Infection + No_infection)\n\neffectiveness_df\nDescription Infection No_infection Total\nTreatment Prophylactic antibiotics         4          129   133\nControl                    Placebo        28          108   136\nResource Use and Cost Data\nThe resource use and cost data comes from Table 3.3, p55. Data is from\nMugford et al., 1989\n, except for the cost of administering antibiotic which was estimated by Welton et al.\nShow the code\ncost_df <- data.frame(\n  Parameter = c(\n    \"Length of stay: infection\",\n    \"Length of stay: no infection\",\n    \"Cost per day: infection\",\n    \"Cost per day: no infection\",\n    \"Cost per dose: cephaslosporin\",\n    \"Cost per administering antibiotic\",\n    \"Doses administered\",\n    \"Total number of Caesarians\",\n    \"Number infections: no antibiotics\"\n  ),\n  Estimate = c(8.80, 6.70, 163.03, 107.26, 5.67, 7.00, 3, 486, 41),\n  Units = c(\"days\", \"days\", \"£\", \"£\", \"£\", \"£\", \"count\", \"count\", \"count\"),\n  Variable_name = c(\"loswd\", \"losnwd\", \"cstwd\", \"cstnwd\", \"cstPx\", \"cstadmin\", \"dose\", \"nc1\", \"rc1\")\n)\n\ncost_df\nParameter Estimate Units Variable_name\n1         Length of stay: infection     8.80  days         loswd\n2      Length of stay: no infection     6.70  days        losnwd\n3           Cost per day: infection   163.03     £         cstwd\n4        Cost per day: no infection   107.26     £        cstnwd\n5     Cost per dose: cephaslosporin     5.67     £         cstPx\n6 Cost per administering antibiotic     7.00     £      cstadmin\n7                Doses administered     3.00 count          dose\n8        Total number of Caesarians   486.00 count           nc1\n9 Number infections: no antibiotics    41.00 count           rc1\nThe Deterministic Model\nThe following code builds a model in the\nBUGS\nlanguage for specifying probability distributions that will be evaluated by the\nrjags\ninterface to the\nJAGS\nMCMC engine.\nShow the code\nmodel_code <- \"\nmodel {\n  cost_nwdpx <- losnwd * cstnwd + dose * (cstPx + cstadmin) # Cost (No infection/Px)\n  cost_wdpx <- loswd * cstwd + dose * (cstPx + cstadmin)    # Cost (Infection/Px)\n  cost_nwd <- losnwd * cstnwd                               # Cost (No infection/no Px)\n  cost_wd <- loswd * cstwd                                  # Cost (Infection/no Px)\n  \n  RR <- (a/(a+b))/(c/(c+d))                                 # Relative risk using \n                                                            # data from table 3.2\n                                                            \n  p1 <- rc1/nc1\n  p2 <- RR * p1\n  \n  costtrt <- ((1-p2) * cost_nwdpx) + p2 * cost_wdpx         # Total cost (payoff) Px\n  costctl <- ((1-p1) * cost_nwd) + p1 * cost_wd             # Total cost (payoff) No Px\n\n}\"\n\ncost_data <- with(cost_df, setNames(as.list(Estimate), nm = Variable_name))\neffectiveness_data <- list(\n  a = effectiveness_df[\"Treatment\", \"Infection\"],\n  b = effectiveness_df[\"Treatment\", \"No_infection\"],\n  c = effectiveness_df[\"Control\", \"Infection\"],\n  d = effectiveness_df[\"Control\", \"No_infection\"]\n)\ndeterministic_data <- append(cost_data, effectiveness_data)\nThis next block of code executes the model and displays the results. Notice that the expected costs of the treatment and control branches match those in the text on p56.\nWe expect the rate of infection in the treated group (p2) to be lower than in the untreated group (p1) and the overall cost of treatment to be lower than the cost of not treating.\nShow the code\nresults\nJAGS output for model '5', generated by jagsUI.\nEstimates based on 1 chains of 1 iterations,\nadaptation = 100 iterations (sufficient),\nburn-in = 0 iterations and thin rate = 1,\nyielding 1 total samples from the joint posterior. \nMCMC ran for 0.004 minutes at time 2025-05-19 10:23:22.849254.\n\n           mean sd    2.5%     50%   97.5% overlap0 f\np1        0.084 NA   0.084   0.084   0.084    FALSE 1\np2        0.012 NA   0.012   0.012   0.012    FALSE 1\ncosttrt 765.476 NA 765.476 765.476 765.476    FALSE 1\ncostctl 779.047 NA 779.047 779.047 779.047    FALSE 1\n\noverlap0 checks if 0 falls in the parameter's 95% credible interval.\nf is the proportion of the posterior with the same sign as the mean;\ni.e., our confidence that the parameter is positive or negative.\nStochastic Decision Analysis\nHaving established a deterministic baseline model, the next step is to account for the uncertainty in the modeling assumptions by developing a Bayesian stochastic model that uses probability distributions rather than point estimates to represent uncertain parameters.\nThis diagram shows the relationships between variables in the stochastic model. The red nodes are stochastic variables, as is the orange outcome node (differential cost). These depend on parameterized random distributions. For example, the relative risk (RR) and prevalence of infection in the target hospital (p1) are no longer simple point estimates as they were in the deterministic model; instead, they are modeled by statistical distributions parameterized by the observed data (see equations below). The cost of administering the drug is now randomly taken from a range, and the length of stay estimates are described as Normal distributions with a given mean and precision. Variables computed from these stochastic variables are stochastic as well, so ‘p2’, ‘cst.trt’, and ‘cst.ctl’ are also red, and the outcome of all this ‘diff.cost’ is, in turn, estimated stochastically.\nModel with Distributions\nThe next step towards working our way up to a full Bayesian model is to assign probability distributions to the clinical variables for which there is uncertainty. These are:\nDistribution of ln(Relative Risk):\nwhere as above:\na is the number of women who received antibiotics and subsequently developed infections\nb is the number of women who received antibiotics who did not develop infections\nc is the number of women who received the placebo and subsequently became infected\nd is the number of women who received the placebo who did not become infected\nDistribution of Prob[infection | no antibiotic]\nwhere:\nrc1 = Number infections: no antibiotics\nnc1 = Total number of Carnelians\nis the distribution for the probability of an infection with the antibiotic.\nis the distribution of the length of a hospital stay with an infected wound where:\nis the distribution for length of hospital stay without infection, where:\nis the distribution of the antibiotic dose administered.\nis the total cost for the antibiotic arm of the decision tree.\nis the total cost for the no antibiotic arm of the decision tree.\nis the differential cost.\nCode for the Stochastic Model\nThis next block of\nBUGS\ncode implements the stochastic model described above. The code is similar to the deterministic model, but with the addition of the distributions for the parameters that are uncertain.\nShow the code\nstochastic_model_code <- \"\nmodel{\n  lnRR ~ dnorm(theta, prec)   # Distribution for ln(Relative Risk)\n  theta <- log( (a/(a+b)) / (c/(c+d)) )\n  prec <- 1/( (1/a) - (1/(a+b)) + (1/c) - (1/(c+d)) )\n  \n  p1 ~ dbeta(alpha, beta) # Distribution for Prob(Infection/NoPx)\n  alpha <- rc1\n  beta <- nc1 - rc1\n  \n  p2 <- exp(lnRR) * p1  # Distribution for Prob(Infection/Px)\n  \n  loswd ~ dnorm(mnloswd, precwd)  # Distribution for length of stay with infection\n  precwd <- 1/pow(sdloswd/sqrt(numwd), 2)\n  \n  losnwd ~ dnorm(mnlosnwd, precnwd)  # Distribution for length of stay w/o infection\n  precnwd <- 1/pow(sdlosnwd/sqrt(numnwd), 2)\n  \n  cstadmin ~ dunif(4, 10) # Px administration\n  \n  cst.trt <- (1-p2)*((cstPx + cstadmin)*3 + (losnwd*cstnwd)) + p2*((cstPx + cstadmin)*3 + (loswd*cstwd)) # Total cost (payoff) Px\n  \n  cst.ctl <- (1-p1)*(losnwd*cstnwd) + p1*(loswd*cstwd) # Total cost (payoff) No Rx\n  \n  diff.cost <- cst.trt - cst.ctl  # Difference in cost\n}\" %>% textConnection()\nData for the Stochastic Model\nThis block of R code provides parameter values for the stochastic model. The values are taken from the text, but some of them have been changed to reflect the fact that we are now using a stochastic model. The changes are indicated in the comments.\nShow the code\nstochastic_data <- list(\n  rc1 = 41, nc1 = 486, cstwd = 163.03, cstnwd = 107.26,\n  mnloswd = 8.8, sdloswd = 3.5,\n  mnlosnwd = 6.7, sdlosnwd = 7.1,\n  numwd = 41, numnwd = 445, # !!! numwd == rc1; numnwd == (nc1 - rc1)\n  cstPx = 5.67,\n  # rt=4, nt=133, rc=28, nc=136,  # !!! Unused variables\n  a = 4, b = 129, c = 28, d = 108\n)\n\n# Here I code the changes from the data for the deterministic model to the \n# data for the stochastic one, in case that makes the differences easier to see.\n\n    # Add these:\n    # setdiff(names(stochastic_data), names(deterministic_data))\n    # \"mnloswd\"  \"sdloswd\"  \"mnlosnwd\" \"sdlosnwd\"\n    # \"numwd\" ==  rc1;\n    # \"numnwd\" == (nc1 - rc1)\n    # \n    # Remove or rename these:\n    # setdiff(names(deterministic_data), names(stochastic_data))\n    #  \"loswd\" -> \"mnloswd\"\n    #  \"losnwd\" -> \"mnlosnwd\"\n    #  \"cstadmin\" hard-coded uniform distribution\n    #  \"dose\": hard-coded !!!\n\n# uncertainty <- c(sdloswd=3.5, sdlosnwd=7.1) # standard deviations from Table 3.4\n# rename_me <- c(\"loswd\"=\"mnloswd\", \"losnwd\"=\"mnlosnwd\")\n# \n# stochastic_data <- append(deterministic_data, uncertainty)\n# for (old_name in names(rename_me)){\n#   new_name <- rename_me[[old_name]]\n#   names(stochastic_data)[names(stochastic_data) == old_name] <- new_name\n# }\n# stochastic_data[\"cstadmin\"] <- NULL # now coded as uniform random\n# stochastic_data[\"dose\"] <- NULL # the 3 is hard coded now\n# \n# stochastic_data[\"numwd\"] <- stochastic_data[\"rc1\"]; \n# stochastic_data[\"numnwd\"] <-  with(stochastic_data, (nc1 - rc1))\n\nparameters_to_save <- c(\"cst.trt\", \"cst.ctl\", \"diff.cost\")\nCode to Run the Stochastic Model\nThis code runs the stochastic model. The code is similar to the deterministic model, but with the addition of the distributions for the parameters that are uncertain.\nShow the code\nstochastic_results <- jags(\n  data = stochastic_data,\n  parameters.to.save = parameters_to_save,\n  model.file = stochastic_model_code,\n  n.chains = 4,\n  n.adapt = 100,\n  n.iter = 50000,\n  n.burnin = 20000,\n  verbose = FALSE\n)\nModel Results\nThe following table shows a summary of the model results. These include the mean, standard deviations, and quantiles for the posterior distributions of the cost of treatment and control, the differential cost and the relative risk, along with information on some diagnostic statistics. The results are similar to those in the text on p 66.\nShow the code\nstochastic_results_summary <- summary(stochastic_results) |>\n  as.data.frame() |>\n  select(!c(3, 4))\n\nround(stochastic_results_summary, 3)\nmean     sd     50%     75%   97.5% Rhat  n.eff overlap0     f\ncst.trt   766.945 36.390 767.034 791.444 838.007    1 120000        0 1.000\ncst.ctl   779.238 35.095 779.353 802.934 848.135    1 120000        0 1.000\ndiff.cost -12.292 12.803 -11.779  -3.518  11.234    1 120000        1 0.835\nThe diagnostic statistics are interpreted as follows:\nRhat, the Gelman-Rubin Statistic, is a diagnostic that compares the variance within chains to the variance between chains. Values close to 1 (typically less than 1.1) indicate that the chains have converged.\nn.eff: provides an estimate of how many independent samples the samples in the chain are equivalent to. A higher number suggests more reliable estimates.\noverlap0 = 0 indicates that the 95% credible interval does not include 0, suggesting a statistically significant effect.\nf is the proportion of the posterior with the same sign as the mean.\nDiagnostic Plots\nIn this section, we will plot the results of the MCMC sampling. The first plot in each row shows the trace history for the parameters of interest, and the second shows the density. Multiple colors indicate the four independent MCMC chains. Since they are on top of each other and mixing well, we can see that the chains have converged to a common distribution.\nShow the code\nplot(stochastic_results)\nPrior Distributions\nHere, we plot the Prior distributions that were described above.\nShow the code\n## Prior Distribution for log Relative Risk\na <- stochastic_data$a\nb <- stochastic_data$b\nc <- stochastic_data$c\nd <- stochastic_data$d\ntheta <- log((a / (a + b)) / (c / (c + d)))\n# theta\nprec <- 1 / ((1 / a) - (1 / (a + b)) + (1 / c) - (1 / (c + d)))\n# prec\nvar <- 1 / prec\n# var\n# Generate a sequence of x values\nx <- seq(-15, 15, length.out = 100)\n\n# Compute the corresponding beta density values\nlnRR <- dnorm(x, theta, prec)\n\n# Create a data frame for ggplot2\nnorm_data <- data.frame(x = x, y = lnRR)\n\n# Plot the beta distribution\nq1 <- ggplot(norm_data, aes(x = x, y = lnRR)) +\n  geom_line(color = \"brown\", linewidth = 1) +\n  geom_area(fill = \"brown\", alpha = 0.2) +\n  labs(\n    title = \"Prior: Log Relative Risk\",\n    x = \"Log(RR)\",\n    y = \"Density\"\n  )\n\n### Prior Distribution for p1\n# Define the beta distribution parameters\nalpha <- stochastic_data$rc1\nbeta <- stochastic_data$nc1 - stochastic_data$rc1\n\n# Generate a sequence of x values\nx <- seq(0, .2, length.out = 100)\n\n# Compute the corresponding beta density values\ny <- dbeta(x, alpha, beta)\n\n# Create a data frame for ggplot2\nbeta_data <- data.frame(x = x, y = y)\n\n# Plot the beta distribution\nq2 <- ggplot(beta_data, aes(x = x, y = y)) +\n  geom_line(color = \"blue\", linewidth = 1) +\n  geom_area(fill = \"blue\", alpha = 0.2) +\n  labs(\n    title = \"Prior: Infection | no antibiotic\",\n    x = \"p1\",\n    y = \"Density\"\n  )\n\n### Prior distribution for length of stay, wound infection\n# Define the normal distribution parameters\nmean <- stochastic_data$mnloswd\nsd <- stochastic_data$sdlosnwd / sqrt(stochastic_data$numwd)\n\n# Generate a sequence of x values\nx <- seq(5, 15, length.out = 100)\n\n# Compute the corresponding beta density values\ny <- dnorm(x, mean, sd)\n\n# Create a data frame for ggplot2\nnorm_data <- data.frame(x = x, y = y)\n\n# Plot the beta distribution\nq3 <- ggplot(norm_data, aes(x = x, y = y)) +\n  geom_line(color = \"red\", linewidth = 1) +\n  geom_area(fill = \"red\", alpha = 0.2) +\n  xlim(5, 13) +\n  labs(\n    title = \"Prior: length of stay | infection\",\n    x = \"Length of Stay (days) \",\n    y = \"Density\"\n  )\n\n## Prior distribution for length of stay, no wound infection\n# Define the normal distribution parameters\nmean <- stochastic_data$mnlosnwd\nsd <- stochastic_data$sdlosnwd / sqrt(stochastic_data$numnwd)\n\n# Generate a sequence of x values\nx <- seq(5, 10, length.out = 100)\n\n# Compute the corresponding beta density values\ny <- dnorm(x, mean, sd)\n\n# Create a data frame for ggplot2\nnorm_data <- data.frame(x = x, y = y)\n\n# Plot the beta distribution\nq4 <- ggplot(norm_data, aes(x = x, y = y)) +\n  geom_line(color = \"darkgreen\", linewidth = 1) +\n  geom_area(fill = \"green\", alpha = 0.2) +\n  xlim(5, 13) +\n  labs(\n    title = \"Prior: length of stay | no infection\",\n    x = \"Length of Stay (days)\",\n    y = \"Density\"\n  )\n\ngrid.arrange(q1, q3, q2, q4)\nPosterior Distributions\nHere we re-sample an existing model and plot densities of several variables using the R functions defined at the beginning of this document.\nShow the code\nmy_vars <- c(\"p1\", \"p2\", \"cst.trt\", \"cst.ctl\", \"diff.cost\")\ncoda_df <- coda.samples(stochastic_results$model,\n  variable.names = my_vars,\n  n.iter = 10000\n) %>%\n  coda_sample_2_df() %>%\n  sample_frac(1L) # randomly scramble chain order\nPlot the posterior densities for the cost of treatment\nShow the code\nw1 <- plot_densities_from_coda_df(c(\"cst.trt\", \"cst.ctl\"), coda_df) + ggtitle(\"Posterior Densities for Cost of Treatment\")\nw1\nPlot the posterior density for Differential Cost\nShow the code\nw2 <- coda_df %>% ggplot(aes(x = diff.cost)) +\n  geom_density(fill = \"blue\", alpha = 0.5) +\n  ggtitle(\"Posterior Density for Differential Cost\")\nw2\nPlot the densities for P1 and P2\nShow the code\nw3 <- plot_densities_from_coda_df(c(\"p1\", \"p2\"), coda_df) + ggtitle(\"Posterior Densities for P1 and P2\")\nw3\nThe Economic Model\nThis next section of code integrates the computations for cost-effectiveness into the model model presented above. You can find this code on page 65 of the text.\nShow the code\neconomic_model_code <- \"\nmodel{\n  lnRR ~ dnorm(theta, prec) # Distribution for ln(Relative Risk)\n  theta <- log( (a/(a+b)) / (c/(c+d)) )\n  prec <- 1/( (1/a) - (1/(a+b)) + (1/c) - (1/(c+d)) )\n  \n  p1 ~ dbeta(alpha, beta)  # Distribution for Prob(Infection/NoPx)\n  alpha <- rc1\n  beta <- nc1 - rc1\n  \n  p2 <- exp(lnRR) * p1   # Distribution for Prob(Infection/Px)\n  \n  loswd ~ dnorm(mnloswd, precwd)   # Distribution for length of stay with infection\n  precwd <- 1/pow(sdloswd/sqrt(numwd), 2)\n  \n  losnwd ~ dnorm(mnlosnwd, precnwd) # Distribution for length of stay w/o infection\n  precnwd <- 1/pow(sdlosnwd/sqrt(numnwd), 2)\n  \n  cstadmin ~ dunif(4, 10)   # Px administration\n  \n  cst.trt <- (1-p2)*((cstPx + cstadmin)*3 + (losnwd*cstnwd)) + p2*((cstPx + cstadmin)*3 + (loswd*cstwd)) # Total cost (payoff) Px\n  \n  cst.ctl <- (1-p1)*(losnwd*cstnwd) + p1*(loswd*cstwd) # Total cost (payoff) No Rx\n  \n  diff.cost <- cst.trt - cst.ctl   # Difference in cost\n\n  \n  # Economic evaluation code from pp 65-66\n  \n  totQALYs.wd <- ((QALYwd/365)*loswd) + ((Fullhealth/365)*(fllwupdays-loswd)) # QALYs (infection)\n  totQALYs.nwd <- ((QALYnwd/365)*losnwd) + ((Fullhealth/365)*(fllwupdays-losnwd)) # QALYs (No infection)\n\n  QALYs.trt <- (1-p2) * totQALYs.nwd + p2 * totQALYs.wd  # QALYs (Px)\n  QALYs.ctl <- (1-p1) * totQALYs.nwd + p1 * totQALYs.wd  # QALYs (no px)\n  diff.QALYs <- (QALYs.trt - QALYs.ctl)                  # Difference in QALYs\n  \n  for (k in 1:M)\n  {\n    lambda[k] <- (k-1) * 2000\n    INB[k] <- lambda[k] * diff.QALYs - diff.cost  # !!! not `delta.Qalys` or `delta.cost`\n    ProbCE[k] <- step(INB[k])\n  }\n}\n\" %>% textConnection()\n\n# economic_data <- list(\n#   rc1=41, nc1=486, cstwd=163.03, cstnwd=107.26,\n#   mnloswd=8.8, sdloswd=3.5,\n#   mnlosnwd=6.7, sdlosnwd=7.1,\n#   numwd=41, numnwd=445,\n#   cstPx=5.67,\n#   a=4, b=129, c=28, d=108,\n#   # additional data for economic evaluation\n#   M=21, QALYwd=0.68, QALYnwd=0.88, Fullhealth=1, fllwupdays=20\n# )\neconomic_data <- append(\n  stochastic_data,\n  # additional data for economic evaluation\n  list(M = 21, QALYwd = 0.68, QALYnwd = 0.88, Fullhealth = 1, fllwupdays = 20)\n)\n\nparameters_to_save <- c( # \"ProbCE\",\n  \"QALYs.trt\", \"QALYs.ctl\", \"diff.QALYs\"\n)\nRun the Economic Model\nShow the code\neconomic_results <- jags(\n  data = economic_data,\n  parameters.to.save = parameters_to_save,\n  model.file = economic_model_code,\n  n.chains = 1,\n  n.adapt = 100,\n  n.iter = 50000,\n  n.burnin = 20000,\n  verbose = FALSE\n)\nAnd now, the economic results\nShow the code\neconomic_results_summary <- summary(economic_results) %>% as.data.frame()\n\nround(economic_results_summary, 5) |> select(!c(3, 4))\nmean      sd     50%     75%   97.5% Rhat n.eff overlap0       f\nQALYs.trt  0.05251 0.00012 0.05252 0.05259 0.05274   NA     1        0 1.00000\nQALYs.ctl  0.05213 0.00013 0.05213 0.05221 0.05238   NA     1        0 1.00000\ndiff.QALYs 0.00039 0.00008 0.00038 0.00044 0.00055   NA     1        0 0.99997\nThe Economic Decision: Cost-Effectiveness\nThe effectiveness of a healthcare intervention is often expressed\nQALYS\n, Quality-Adjusted Life Year, which combine mortality and morbidity from treatment outcomes into a single value. By putting diverse medical outcomes on the same scale, it makes it possible to allocate funds among very different programs (cancer care, prenatal care, vaccine programs, etc.).\nThe following figure plots the results of many simulations of the economic model on the cost-effectiveness plane. This is the major tool for facilitating the decision as to whether to adopt the practice of prophylactically administering antibiotics. The x-axis represents the incremental QALYs and the y-axis represents the incremental costs. The dashed lines represent different values for\nthe cut-off cost.\nShow the code\nXLIM <- c(0, 7e-4) # use same limits as chapter 3\nYLIM <- c(-75, 50)\nLAMBDAS <- 10000 * (1:3)\nCE_1 <- ce_df %>%\n  ggplot(aes(x = diff.QALYs, y = diff.cost, col = chain)) +\n  geom_point(size = 0.5, alpha = 0.1) +\n  geom_abline(slope = 0, intercept = 0, linetype = \"solid\") +\n  geom_abline(slope = LAMBDAS, intercept = 0, linetype = \"dotted\") +\n  theme(legend.position = \"none\") +\n  labs(x = \"Incremental QALYs\", y = \"Incremental costs\", title = \"Cost-effectiveness plane for Caesarian section example\") +\n  coord_cartesian(xlim = XLIM, ylim = YLIM) +\n  annotate(\"text\",\n    x = XLIM[2], y = LAMBDAS * XLIM[2],\n    size = 3, hjust = 0.8, vjust = -0.25,\n    label = paste(\"lambda ==\", LAMBDAS), parse = TRUE\n  )\nCE_1\nOur final plot shows the expected incremental net benefit and 95% credible interval for a range of lambda values. The x-axis represents the value of lambda and the y-axis represents the expected incremental net benefit. The dashed lines represent the 2.5% and 97.5% quantiles of the posterior distribution of the incremental net benefit.\nShow the code\ninb_df_long %>%\n  group_by(metric, lambda) %>%\n  filter(metric == \"INB\") %>%\n  summarize(\n    mean_INB = mean(value),\n    lo_end = quantile(value, probs = 0.025),\n    hi_end = quantile(value, probs = 0.975)\n  ) %>%\n  ggplot(aes(x = lambda, group = metric)) +\n  geom_line(aes(y = mean_INB)) +\n  geom_line(aes(y = lo_end), linetype = \"dashed\") +\n  geom_line(aes(y = hi_end), linetype = \"dashed\")\nClosing Remarks\nChapter 3 from Welton et al. presents an analysis of a classic healthcare technology assessment decision informed by a Bayesian statistical analysis and a decision structure that includes economic analysis and utility measured in QALYs. The decision is from the point of view of a public health system concerned with providing the best outcome for a population, given their budgetary constraints. The Quality-Adjusted Life Year (QALY) metric combines mortality and morbidity from treatment outcomes into a single value. By putting diverse medical outcomes on the same scale, it makes it possible to allocate funds among very different programs (cancer care, prenatal care, vaccine programs, etc.). However, the framework and the methodology can easily be reframed for decisions to be made in other contexts.\nA truly elegant feature of this model is that the uncertainties in the model parameters supporting the clinical calculations are expressed as probability distributions, which propagate through to compute the expected costs and benefits of each alternative. This integrated treatment of uncertainty is much more sophisticated than models that are limited to using point estimates to drive the economic decisions.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nR Works\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "In a previous post, we presented an rjags version of a Bayesian model from Chapter 2 of the textbook: Evidence Synthesis for Decision Making in Healthcare by Welton et al. (2012). In this post, we continue our project to present rjags versi...",
    "meta_keywords": null,
    "og_description": "In a previous post, we presented an rjags version of a Bayesian model from Chapter 2 of the textbook: Evidence Synthesis for Decision Making in Healthcare by Welton et al. (2012). In this post, we continue our project to present rjags versi...",
    "og_image": "https://rworks.dev/posts/ESDM-2/decision_tree.png",
    "og_title": "Cost-Effectiveness Analysis | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 22.4,
    "sitemap_lastmod": null,
    "twitter_description": "In a previous post, we presented an rjags version of a Bayesian model from Chapter 2 of the textbook: Evidence Synthesis for Decision Making in Healthcare by Welton et al. (2012). In this post, we continue our project to present rjags versi...",
    "twitter_title": "Cost-Effectiveness Analysis | R-bloggers",
    "url": "https://www.r-bloggers.com/2025/05/cost-effectiveness-analysis/",
    "word_count": 4483
  }
}