{
  "id": "3faf371026ad3e27b68e27f0fdda0274dd4dfd4c",
  "url": "https://www.r-bloggers.com/2009/12/cru-graph-yet-again-with-r/",
  "created_at_utc": "2025-11-17T20:39:45Z",
  "data": null,
  "raw_original": {
    "uuid": "1b17eb3c-2c82-4d2e-97a7-d8d19b9d986a",
    "created_at": "2025-11-17 20:39:45",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2009/12/cru-graph-yet-again-with-r/",
      "crawled_at": "2025-11-17T10:11:53.091915",
      "external_links": [
        {
          "href": "http://www.win-vector.com/blog/2009/12/cru-graph-yet-again-with-r/?utm_source=rss&utm_medium=rss&utm_campaign=cru-graph-yet-again-with-r",
          "text": "Win-Vector Blog » R"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "http://iowahawk.typepad.com/iowahawk/2009/12/fables-of-the-reconstruction.html",
          "text": "Fables of the Reconstruction"
        },
        {
          "href": "http://cran.r-project.org/",
          "text": "R"
        },
        {
          "href": "http://www.win-vector.com/blog/wp-content/uploads/2009/12/jonesmannrogfig2c.txt",
          "text": "jonesmannrogfig2c.txt"
        },
        {
          "href": "http://www.win-vector.com/blog/wp-content/uploads/2009/12/data1400.dat_.txt",
          "text": "data1400.dat_.txt"
        },
        {
          "href": "http://www.win-vector.com/blog/2011/02/the-cranky-guide-to-trying-r-packages/",
          "text": "The cranky guide to trying R packages"
        },
        {
          "href": "http://www.win-vector.com/blog/2009/11/r-examine-objects-tutorial/",
          "text": "R examine objects tutorial"
        },
        {
          "href": "http://www.win-vector.com/blog/2010/03/r-annoyances/",
          "text": "R annoyances"
        },
        {
          "href": "http://www.win-vector.com/blog/2009/12/cru-graph-yet-again-with-r/?utm_source=rss&utm_medium=rss&utm_campaign=cru-graph-yet-again-with-r",
          "text": "Win-Vector Blog » R"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "CRU graph yet again (with R) | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pcomp.png?w=400"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pcomp.png?w=400"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pFitRegion.png?w=400"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pFitRegion.png?w=400"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pBoth.png?w=400"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pBoth.png?w=400"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pJacked.png?w=400"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pJacked.png?w=400"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/john-mount/",
          "text": "John Mount"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/tag/climate/",
          "text": "Climate"
        },
        {
          "href": "https://www.r-bloggers.com/tag/r/",
          "text": "R"
        },
        {
          "href": "https://www.r-bloggers.com/tag/rants/",
          "text": "Rants"
        },
        {
          "href": "https://www.r-bloggers.com/tag/regression/",
          "text": "regression"
        },
        {
          "href": "https://www.r-bloggers.com/tag/statistics/",
          "text": "statistics"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-58487 post type-post status-publish format-standard hentry category-r-bloggers tag-climate tag-r tag-rants tag-regression tag-statistics\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">CRU graph yet again (with R)</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 13, 2009</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/john-mount/\">John Mount</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<p class=\"syndicated-attribution\"><!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"http://www.win-vector.com/blog/2009/12/cru-graph-yet-again-with-r/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=cru-graph-yet-again-with-r\"> Win-Vector Blog » R</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div></p>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.0--><p>IowaHawk has a excellent article attempting to reproduce the infamous CRU climate graph using OpenOffice: <a href=\"http://iowahawk.typepad.com/iowahawk/2009/12/fables-of-the-reconstruction.html\" rel=\"nofollow\" target=\"_blank\">Fables of the Reconstruction</a>.   We thought we would show how to produced similarly bad results using R.<br/>\n<span id=\"more-1195\"></span></p>\n<p>If the re-constructed technique is close to what was originally done then so many bad moves were taken that you can’t learn much of anything from the original “result.”   This points out some of the pratfalls of not performing hold-out tests, not examining the modeling diagnostics and not remembering that linear regression models fail to low-variance models (i.e. when they fail they do a good job predicting the mean and vastly under-estimate variance).</p>\n<p>Our article not an article on global warming, but an article on analysis technique.  Human driven global warming is either happening or not happening independent of any bad analysis.  Finding the physical truth is a bigger harder job than eliminating some bad reports (the opposite of a bad report is not necessarily the truth). Bad analyses can have many different sources (mistakes, trying to jump ahead of your colleagues on something you believe is true, trying to fake something you believe is false or be figments of overly harsh critics) and we have not heard enough to make any accusations.</p>\n<p>First: load the data (I re-formatted it at bit so <a href=\"http://cran.r-project.org/\" rel=\"nofollow\" target=\"_blank\">R</a> can read it:<a href=\"http://www.win-vector.com/blog/wp-content/uploads/2009/12/jonesmannrogfig2c.txt\" rel=\"nofollow\" target=\"_blank\"> jonesmannrogfig2c.txt</a>,  <a href=\"http://www.win-vector.com/blog/wp-content/uploads/2009/12/data1400.dat_.txt\" rel=\"nofollow\" target=\"_blank\">data1400.dat_.txt</a>   ) , perform the principle components reduction and fit a first<br/>\nmodel.</p>\n<pre>\n&gt; library(lattice)\n&gt; d1400 &lt;- read.table('data1400.dat.txt',sep='\\t',header=FALSE)\n&gt; d1400r &lt;- as.matrix(d1400[,2:23])\n&gt; pcomp &lt;- prcomp(na.omit(d1400r))\n&gt; plot(pcomp)\n&gt; vars &lt;- data.frame(cbind(Year=d1400[,1],d1400r %*% pcomp$rotation),row.names=d1400[,1])\n&gt; jones &lt;- read.table('jonesmannrogfig2c.txt',sep='\\t',header=TRUE)\n&gt; datUnion &lt;- merge(vars,jones,all=TRUE)\n&gt; datUnion$avgTemp &lt;- with(datUnion,(NH+CET+Central.Europe+Fennoscandia)/4.0)\n&gt; model &lt;- lm(avgTemp ~ PC1 + PC2 + PC3 + PC4 + PC5 ,dat=datUnion)\n&gt; summary(model)\n\nCall:\nlm(formula = avgTemp ~ PC1 + PC2 + PC3 + PC4 + PC5, data = datUnion)\n\nResiduals:\n       Min         1Q     Median         3Q        Max\n-0.8811679 -0.2658117  0.0008174  0.2933058  1.0450044 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)\n(Intercept)  0.0065252  0.5750696   0.011   0.9910\nPC1         -0.0001683  0.0003912  -0.430   0.6679\nPC2         -0.0003678  0.0010114  -0.364   0.7168\nPC3          0.0003177  0.0014821   0.214   0.8307\nPC4          0.0044084  0.0019351   2.278   0.0246 *\nPC5          0.0188520  0.0205137   0.919   0.3601\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 \n\nResidual standard error: 0.4505 on 113 degrees of freedom\n  (484 observations deleted due to missingness)\nMultiple R-squared: 0.05223,\tAdjusted R-squared: 0.01029\nF-statistic: 1.245 on 5 and 113 DF,  p-value: 0.2927\n</pre>\n<p>We used only 5 principle components as modeling variables, because as is typical of principle component analysis- beyond the first few components the components become vanishingly small and unsuitable to use in modeling (see graph pcomp below).</p>\n<p><img class=\"jetpack-lazy-image\" data-lazy-src=\"https://i1.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pcomp.png?w=400&amp;is-pending-load=1\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pcomp.png?w=400\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/><noscript><img data-recalc-dims=\"1\" src=\"https://i1.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pcomp.png?w=400\"/></noscript></p>\n<p>However, this gave a model with far smaller R-squared than people are reporting, so lets add in a lot of components like everybody else does (bad!).</p>\n<pre>\n&gt; model &lt;- lm(avgTemp ~ PC1 + PC2 + PC3 + PC4 + PC5 + PC6 + PC7 + PC8 + PC9 +PC10 +PC11 +PC12 + PC13 ,dat=datUnion)\n&gt; summary(model)\n\nCall:\nlm(formula = avgTemp ~ PC1 + PC2 + PC3 + PC4 + PC5 + PC6 + PC7 +\n    PC8 + PC9 + PC10 + PC11 + PC12 + PC13, data = datUnion)\n\nResiduals:\n     Min       1Q   Median       3Q      Max\n-0.87249 -0.25951  0.03996  0.25055  0.99039 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)\n(Intercept)  7.431e-01  1.424e+00   0.522   0.6028\nPC1         -1.796e-04  3.665e-04  -0.490   0.6253\nPC2         -4.179e-04  9.759e-04  -0.428   0.6694\nPC3          3.306e-05  1.430e-03   0.023   0.9816\nPC4          3.416e-03  1.803e-03   1.894   0.0609 .\nPC5          4.032e-02  1.978e-02   2.039   0.0440 *\nPC6         -3.260e-03  2.660e-02  -0.123   0.9027\nPC7         -7.134e-02  3.620e-02  -1.971   0.0514 .\nPC8         -1.339e-01  7.895e-02  -1.696   0.0928 .\nPC9          7.577e-02  5.734e-02   1.321   0.1892\nPC10         2.700e-01  5.878e-02   4.594 1.22e-05 ***\nPC11         8.562e-02  6.741e-02   1.270   0.2068\nPC12        -8.057e-02  1.053e-01  -0.765   0.4461\nPC13        -4.099e-02  1.064e-01  -0.385   0.7008\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 \n\nResidual standard error: 0.4141 on 105 degrees of freedom\n  (484 observations deleted due to missingness)\nMultiple R-squared: 0.2558,\tAdjusted R-squared: 0.1637\nF-statistic: 2.777 on 13 and 105 DF,  p-value: 0.001961\n</pre>\n<p>This is a degenerate model that essentially didn’t fit (thought the significance on PC10 component fools the fitter, but PC10 can’t be usable- it is essentially noise).  Graphically we can see the fit is not very useful (despite having  a little bit of R-squared) by looking at the graph of the fit plotted in the region of fitting.  Notice how the fit variance is much smaller than the true data variance even in the region of training data, this is typical of bad regression fits.</p>\n<pre>\n&gt; dRange &lt;- datUnion[datUnion$Year&gt;=1856 &amp; datUnion$Year&lt;=1980,]\n&gt; xyplot(avgTemp + prediction ~Year,dat=dRange,type='l',auto.key=TRUE)\n</pre>\n<p><img class=\"jetpack-lazy-image\" data-lazy-src=\"https://i0.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pFitRegion.png?w=400&amp;is-pending-load=1\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pFitRegion.png?w=400\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/><noscript><img data-recalc-dims=\"1\" src=\"https://i0.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pFitRegion.png?w=400\"/></noscript></p>\n<p>Now the statement they wanted to make is that the present looks nothing like the past.  The past is only available through the fit model so what you would hope is that the model looks like the present and then the model itself separates the past and present.  Instead as you see in the graphs above and below this fails two ways: the model looks nothing like the present and the model’s past looks a lot like the model’s present.</p>\n<pre>\n&gt; datUnion$prediction &lt;- predict(model,newdata=datUnion)\n&gt; xyplot(avgTemp + prediction ~Year,dat=datUnion,type=c('p','smooth'),auto.key=TRUE)\n</pre>\n<p><img class=\"jetpack-lazy-image\" data-lazy-src=\"https://i0.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pBoth.png?w=400&amp;is-pending-load=1\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pBoth.png?w=400\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/><noscript><img data-recalc-dims=\"1\" src=\"https://i0.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pBoth.png?w=400\"/></noscript></p>\n<p>What we could do to falsely drive the conclusion (which itself may or may not be true, it just is not supported by this technique, model or data) is create the infamous graph where we switch from modeled data in the past to actual data in the present and then act surprised that the two did not line up (which they did at no step during the fitting).  I don’t have the heart to unify the colors or remove the legend, but here is the graph below:</p>\n<pre>\n&gt; datUnion$dinked &lt;- datUnion$prediction\n&gt; datUnion$dinked[!is.na(datUnion$avg)] &lt;- NA\n&gt; xyplot(avgTemp + dinked ~Year,dat=datUnion,type=c('p','smooth'),auto.key=TRUE)\n</pre>\n<p><img class=\"jetpack-lazy-image\" data-lazy-src=\"https://i2.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pJacked.png?w=400&amp;is-pending-load=1\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pJacked.png?w=400\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/><noscript><img data-recalc-dims=\"1\" src=\"https://i2.wp.com/www.win-vector.com/blog/wp-content/uploads/2009/12/pJacked.png?w=400\"/></noscript></p>\n<p>The reason the blue points look different than the others is they came from the average temperature data instead of the model (where everything else came from).  Switching the series is essentially assuming the conclusion that recent past looks very different than the far past.</p>\n<p>Essentially this methodology was so poor it could not have illustrated or contradicted recent global warming.  There are plenty of warning signs that the model fitting are problematic and the conclusion illustrated in the last graph can not actually be proved or disproved from this data (the proxy variables are too weak to be useful, that is not to say there are not other better proxy variables or modeling techniques).  The problems of the presentation are, of course, not essential problems in detecting global warming (which likely is occurring and likely will be a drain on future quality of life) but problems found in a single bad analysis.</p>\n<p>Related posts:<ol><li><a href=\"http://www.win-vector.com/blog/2011/02/the-cranky-guide-to-trying-r-packages/\" rel=\"nofollow\" target=\"_blank\" title=\"Permanent Link: The cranky guide to trying R packages\">The cranky guide to trying R packages</a></li>\n<li><a href=\"http://www.win-vector.com/blog/2009/11/r-examine-objects-tutorial/\" rel=\"nofollow\" target=\"_blank\" title=\"Permanent Link: R examine objects tutorial\">R examine objects tutorial</a></li>\n<li><a href=\"http://www.win-vector.com/blog/2010/03/r-annoyances/\" rel=\"nofollow\" target=\"_blank\" title=\"Permanent Link: R annoyances\">R annoyances</a></li>\n</ol></p>\n\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->\n<p class=\"syndicated-attribution\"><div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"http://www.win-vector.com/blog/2009/12/cru-graph-yet-again-with-r/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=cru-graph-yet-again-with-r\"> Win-Vector Blog » R</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div></p> </div>\n<div class=\"post-tags clearfix\"><ul><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/climate/\" rel=\"tag\">Climate</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/r/\" rel=\"tag\">R</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/rants/\" rel=\"tag\">Rants</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/regression/\" rel=\"tag\">regression</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/statistics/\" rel=\"tag\">statistics</a></li></ul></div></article>",
      "main_text": "CRU graph yet again (with R)\nPosted on\nDecember 13, 2009\nby\nJohn Mount\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nWin-Vector Blog » R\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nIowaHawk has a excellent article attempting to reproduce the infamous CRU climate graph using OpenOffice:\nFables of the Reconstruction\n.   We thought we would show how to produced similarly bad results using R.\nIf the re-constructed technique is close to what was originally done then so many bad moves were taken that you can’t learn much of anything from the original “result.”   This points out some of the pratfalls of not performing hold-out tests, not examining the modeling diagnostics and not remembering that linear regression models fail to low-variance models (i.e. when they fail they do a good job predicting the mean and vastly under-estimate variance).\nOur article not an article on global warming, but an article on analysis technique.  Human driven global warming is either happening or not happening independent of any bad analysis.  Finding the physical truth is a bigger harder job than eliminating some bad reports (the opposite of a bad report is not necessarily the truth). Bad analyses can have many different sources (mistakes, trying to jump ahead of your colleagues on something you believe is true, trying to fake something you believe is false or be figments of overly harsh critics) and we have not heard enough to make any accusations.\nFirst: load the data (I re-formatted it at bit so\nR\ncan read it:\njonesmannrogfig2c.txt\n,\ndata1400.dat_.txt\n) , perform the principle components reduction and fit a first\nmodel.\n> library(lattice)\n> d1400 <- read.table('data1400.dat.txt',sep='\\t',header=FALSE)\n> d1400r <- as.matrix(d1400[,2:23])\n> pcomp <- prcomp(na.omit(d1400r))\n> plot(pcomp)\n> vars <- data.frame(cbind(Year=d1400[,1],d1400r %*% pcomp$rotation),row.names=d1400[,1])\n> jones <- read.table('jonesmannrogfig2c.txt',sep='\\t',header=TRUE)\n> datUnion <- merge(vars,jones,all=TRUE)\n> datUnion$avgTemp <- with(datUnion,(NH+CET+Central.Europe+Fennoscandia)/4.0)\n> model <- lm(avgTemp ~ PC1 + PC2 + PC3 + PC4 + PC5 ,dat=datUnion)\n> summary(model)\n\nCall:\nlm(formula = avgTemp ~ PC1 + PC2 + PC3 + PC4 + PC5, data = datUnion)\n\nResiduals:\n       Min         1Q     Median         3Q        Max\n-0.8811679 -0.2658117  0.0008174  0.2933058  1.0450044 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)\n(Intercept)  0.0065252  0.5750696   0.011   0.9910\nPC1         -0.0001683  0.0003912  -0.430   0.6679\nPC2         -0.0003678  0.0010114  -0.364   0.7168\nPC3          0.0003177  0.0014821   0.214   0.8307\nPC4          0.0044084  0.0019351   2.278   0.0246 *\nPC5          0.0188520  0.0205137   0.919   0.3601\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 \n\nResidual standard error: 0.4505 on 113 degrees of freedom\n  (484 observations deleted due to missingness)\nMultiple R-squared: 0.05223,\tAdjusted R-squared: 0.01029\nF-statistic: 1.245 on 5 and 113 DF,  p-value: 0.2927\nWe used only 5 principle components as modeling variables, because as is typical of principle component analysis- beyond the first few components the components become vanishingly small and unsuitable to use in modeling (see graph pcomp below).\nHowever, this gave a model with far smaller R-squared than people are reporting, so lets add in a lot of components like everybody else does (bad!).\n> model <- lm(avgTemp ~ PC1 + PC2 + PC3 + PC4 + PC5 + PC6 + PC7 + PC8 + PC9 +PC10 +PC11 +PC12 + PC13 ,dat=datUnion)\n> summary(model)\n\nCall:\nlm(formula = avgTemp ~ PC1 + PC2 + PC3 + PC4 + PC5 + PC6 + PC7 +\n    PC8 + PC9 + PC10 + PC11 + PC12 + PC13, data = datUnion)\n\nResiduals:\n     Min       1Q   Median       3Q      Max\n-0.87249 -0.25951  0.03996  0.25055  0.99039 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)\n(Intercept)  7.431e-01  1.424e+00   0.522   0.6028\nPC1         -1.796e-04  3.665e-04  -0.490   0.6253\nPC2         -4.179e-04  9.759e-04  -0.428   0.6694\nPC3          3.306e-05  1.430e-03   0.023   0.9816\nPC4          3.416e-03  1.803e-03   1.894   0.0609 .\nPC5          4.032e-02  1.978e-02   2.039   0.0440 *\nPC6         -3.260e-03  2.660e-02  -0.123   0.9027\nPC7         -7.134e-02  3.620e-02  -1.971   0.0514 .\nPC8         -1.339e-01  7.895e-02  -1.696   0.0928 .\nPC9          7.577e-02  5.734e-02   1.321   0.1892\nPC10         2.700e-01  5.878e-02   4.594 1.22e-05 ***\nPC11         8.562e-02  6.741e-02   1.270   0.2068\nPC12        -8.057e-02  1.053e-01  -0.765   0.4461\nPC13        -4.099e-02  1.064e-01  -0.385   0.7008\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 \n\nResidual standard error: 0.4141 on 105 degrees of freedom\n  (484 observations deleted due to missingness)\nMultiple R-squared: 0.2558,\tAdjusted R-squared: 0.1637\nF-statistic: 2.777 on 13 and 105 DF,  p-value: 0.001961\nThis is a degenerate model that essentially didn’t fit (thought the significance on PC10 component fools the fitter, but PC10 can’t be usable- it is essentially noise).  Graphically we can see the fit is not very useful (despite having  a little bit of R-squared) by looking at the graph of the fit plotted in the region of fitting.  Notice how the fit variance is much smaller than the true data variance even in the region of training data, this is typical of bad regression fits.\n> dRange <- datUnion[datUnion$Year>=1856 & datUnion$Year<=1980,]\n> xyplot(avgTemp + prediction ~Year,dat=dRange,type='l',auto.key=TRUE)\nNow the statement they wanted to make is that the present looks nothing like the past.  The past is only available through the fit model so what you would hope is that the model looks like the present and then the model itself separates the past and present.  Instead as you see in the graphs above and below this fails two ways: the model looks nothing like the present and the model’s past looks a lot like the model’s present.\n> datUnion$prediction <- predict(model,newdata=datUnion)\n> xyplot(avgTemp + prediction ~Year,dat=datUnion,type=c('p','smooth'),auto.key=TRUE)\nWhat we could do to falsely drive the conclusion (which itself may or may not be true, it just is not supported by this technique, model or data) is create the infamous graph where we switch from modeled data in the past to actual data in the present and then act surprised that the two did not line up (which they did at no step during the fitting).  I don’t have the heart to unify the colors or remove the legend, but here is the graph below:\n> datUnion$dinked <- datUnion$prediction\n> datUnion$dinked[!is.na(datUnion$avg)] <- NA\n> xyplot(avgTemp + dinked ~Year,dat=datUnion,type=c('p','smooth'),auto.key=TRUE)\nThe reason the blue points look different than the others is they came from the average temperature data instead of the model (where everything else came from).  Switching the series is essentially assuming the conclusion that recent past looks very different than the far past.\nEssentially this methodology was so poor it could not have illustrated or contradicted recent global warming.  There are plenty of warning signs that the model fitting are problematic and the conclusion illustrated in the last graph can not actually be proved or disproved from this data (the proxy variables are too weak to be useful, that is not to say there are not other better proxy variables or modeling techniques).  The problems of the presentation are, of course, not essential problems in detecting global warming (which likely is occurring and likely will be a drain on future quality of life) but problems found in a single bad analysis.\nRelated posts:\nThe cranky guide to trying R packages\nR examine objects tutorial\nR annoyances\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nWin-Vector Blog » R\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nClimate\nR\nRants\nregression\nstatistics",
      "meta_description": "IowaHawk has a excellent article attempting to reproduce the infamous CRU climate graph using OpenOffice: Fables of the Reconstruction. We thought we would show how to produced similarly bad results using R. If the re-constructed technique is close to what was originally done then so many bad moves were taken that you can’t learn much [...] Related posts:The cranky guide to trying R packages R examine objects tutorial R annoyances",
      "meta_keywords": "climate,r,rants,regression,statistics",
      "og_description": "IowaHawk has a excellent article attempting to reproduce the infamous CRU climate graph using OpenOffice: Fables of the Reconstruction. We thought we would show how to produced similarly bad results using R. If the re-constructed technique is close to what was originally done then so many bad moves were taken that you can’t learn much [...] Related posts:The cranky guide to trying R packages R examine objects tutorial R annoyances",
      "og_image": "https://www.win-vector.com/blog/wp-content/uploads/2009/12/pcomp.png",
      "og_title": "CRU graph yet again (with R) | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 7.1,
      "sitemap_lastmod": "2009-12-13T19:25:00+00:00",
      "twitter_description": "IowaHawk has a excellent article attempting to reproduce the infamous CRU climate graph using OpenOffice: Fables of the Reconstruction. We thought we would show how to produced similarly bad results using R. If the re-constructed technique is close to what was originally done then so many bad moves were taken that you can’t learn much [...] Related posts:The cranky guide to trying R packages R examine objects tutorial R annoyances",
      "twitter_title": "CRU graph yet again (with R) | R-bloggers",
      "url": "https://www.r-bloggers.com/2009/12/cru-graph-yet-again-with-r/",
      "word_count": 1428
    }
  }
}