{
  "id": "80799bd6419e7e4c242aaca6a4e6c53c5813a7e5",
  "url": "https://www.r-bloggers.com/2025/02/two-way-repeated-measures-anova-in-r/",
  "created_at_utc": "2025-11-22T19:59:15Z",
  "data": null,
  "raw_original": {
    "uuid": "32069697-1447-4091-8472-8c087677d2b0",
    "created_at": "2025-11-22 19:59:15",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2025/02/two-way-repeated-measures-anova-in-r/",
      "crawled_at": "2025-11-22T10:54:10.670875",
      "external_links": [
        {
          "href": "https://www.statisticalaid.com/two-way-repeated-measures-anova-in-r/",
          "text": "R tutorials Archives - Statistical Aid: A School of Statistics %"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://www.statisticalaid.com/how-to-choose-the-right-statistical-test/",
          "text": "statistical test"
        },
        {
          "href": "https://www.statisticalaid.com/random-variable-and-its-types-with-properties/",
          "text": "variable"
        },
        {
          "href": "https://www.statisticalaid.com/normal-distribution-definition-exampleproperties-applications-and-special-cases/",
          "text": "normally distributed"
        },
        {
          "href": "https://www.statisticalaid.com/statistical-inference-definiton-types-and-estimation-procedures/",
          "text": "statistical inferences"
        },
        {
          "href": "https://www.statisticalaid.com/two-way-repeated-measures-anova-in-r/",
          "text": "Two Way Repeated Measures ANOVA in R"
        },
        {
          "href": "https://www.statisticalaid.com/",
          "text": "Statistical Aid: A School of Statistics"
        },
        {
          "href": "https://www.statisticalaid.com/two-way-repeated-measures-anova-in-r/",
          "text": "R tutorials Archives - Statistical Aid: A School of Statistics %"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Two Way Repeated Measures ANOVA in R | R-bloggers",
      "images": [
        {
          "alt": "two way repeated measures anova in R",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "two way repeated measures anova in R",
          "base64": null,
          "src": "https://i2.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-300x240.png?resize=300%2C240&ssl=1"
        },
        {
          "alt": "repeated measure",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "repeated measure",
          "base64": null,
          "src": "https://i0.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/repeated-measure-300x300.png?resize=343%2C343&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-300x240.png?resize=432%2C346&ssl=1"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/md-touhidul-islam/",
          "text": "MD TOUHIDUL ISLAM"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-390564 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Two Way Repeated Measures ANOVA in R</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">February 13, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/md-touhidul-islam/\">MD TOUHIDUL ISLAM</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://www.statisticalaid.com/two-way-repeated-measures-anova-in-r/\"> R tutorials Archives - Statistical Aid: A School of Statistics %</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<p>Two-way repeated measures ANOVA is a powerful <a href=\"https://www.statisticalaid.com/how-to-choose-the-right-statistical-test/\" rel=\"nofollow\" target=\"_blank\">statistical test</a> used to analyze datasets where two within-subject factors (independent variables) are measured multiple times for each subject. This test helps determine if there are significant differences between groups over time or across different conditions while accounting for individual variability.</p>\n<p>In this guide, we will cover:</p>\n<ul class=\"wp-block-list\">\n<li>What is a two-way repeated measures ANOVA?</li>\n<li>When to use it?</li>\n<li>How to perform a two-way repeated measures ANOVA in R?</li>\n<li>Interpretation of results.</li>\n</ul>\n<p>Two way repeated measures ANOVA is also known as:</p>\n<ul class=\"wp-block-list\">\n<li>Two factor repeated measures ANOVA</li>\n<li>Two factor or two way ANOVA with repeated measures</li>\n<li>Within within subjects ANOVA</li>\n</ul>\n<p>A two way repeated measures ANOVA is often used in studies where you have measured:</p>\n<ul class=\"wp-block-list\">\n<li>A dependent <a href=\"https://www.statisticalaid.com/random-variable-and-its-types-with-properties/\" rel=\"nofollow\" target=\"_blank\">variable</a> over two or more time points</li>\n<li>When subjects have undergone two or more conditions</li>\n</ul>\n<p>You should also know how to identify a two way repeated measures anova from mixed anova. Mixed anova is very similar to two way repeated measures anova because both tests involve two factors. In a mixed anova, subjects that undergo each condition are different. Whereas in two way repeated measures anova same subjects undergo both conditions.</p>\n<h2 class=\"wp-block-heading\">What is a Two Way Repeated Measures ANOVA?</h2>\n<p>A two-way repeated measures ANOVA examines the effects of two within-subject factors on a dependent variable. It extends the one-way repeated measures ANOVA by incorporating an additional factor, allowing for an understanding of both main effects and interaction effects.</p>\n<h3 class=\"wp-block-heading\">Key Components:</h3>\n<ul class=\"wp-block-list\">\n<li><strong>Within-Subjects Factors</strong>: Two categorical independent variables measured on the same subjects.</li>\n<li><strong>Dependent Variable</strong>: A continuous variable affected by the independent factors.</li>\n<li><strong>Subjects as Random Effects</strong>: Each participant is exposed to all conditions, reducing variability caused by individual differences.</li>\n</ul>\n<h2 class=\"wp-block-heading\">When to Use a Two Way Repeated Measures ANOVA?</h2>\n<p>Use this test when:</p>\n<ol class=\"wp-block-list\" start=\"1\">\n<li>You have two within-subject factors (e.g., time, condition).</li>\n<li>The same subjects participate in all combinations of factors.</li>\n<li>The dependent variable is continuous and <a href=\"https://www.statisticalaid.com/normal-distribution-definition-exampleproperties-applications-and-special-cases/\" rel=\"nofollow\" target=\"_blank\">normally distributed</a>.</li>\n<li>You aim to analyze both main and interaction effects.</li>\n</ol>\n<figure class=\"wp-block-image is-resized\"><img alt=\"two way repeated measures anova in R\" class=\"wp-image-770\" data-lazy-sizes=\"(max-width: 300px) 100vw, 300px\" data-lazy-src=\"https://i2.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-300x240.png?resize=300%2C240&amp;ssl=1\" data-recalc-dims=\"1\" decoding=\"async\" fetchpriority=\"high\" height=\"240\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i2.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-300x240.png?resize=300%2C240&amp;ssl=1 300w, https://www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-768x614.png 768w, https://www.statisticalaid.com/wp-content/uploads/2021/10/rm-2.png 960w\" style=\"width:820px;height:auto\" width=\"300\"/><noscript><img alt=\"two way repeated measures anova in R\" class=\"wp-image-770\" data-recalc-dims=\"1\" decoding=\"async\" fetchpriority=\"high\" height=\"240\" loading=\"lazy\" sizes=\"(max-width: 300px) 100vw, 300px\" src=\"https://i2.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-300x240.png?resize=300%2C240&amp;ssl=1\" srcset_temp=\"https://i2.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-300x240.png?resize=300%2C240&amp;ssl=1 300w, https://www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-768x614.png 768w, https://www.statisticalaid.com/wp-content/uploads/2021/10/rm-2.png 960w\" style=\"width:820px;height:auto\" width=\"300\"/></noscript></figure>\n<h3 class=\"wp-block-heading\">Description of data</h3>\n<p>The data file for analysis contains subject ID, condition, time interval, and response variable. Researchers recorded the response variable measurements from the same subjects at four different time intervals. The subjects included both male and female individuals. Instead of using different individuals, researchers repeatedly measured the same subjects across different time intervals. Since the same subjects were used repeatedly, we will perform a two-way repeated measures ANOVA in R Studio.</p>\n<h3 class=\"wp-block-heading\">Clear R environment</h3>\n<p>As a first step, I always recommend to clear data objects and values in global environment with <code>rm()</code> function. Set TRUE value for the argument <code>all</code> to remove objects and values if you have created earlier. Shut down all the graphic windows by using <code>graphics.off()</code> function. Putting the value “cls” in <code>shell()</code> function will clear the console environment.</p>\n<pre>rm(list = ls(all = TRUE))\ngraphics.off()\nshell(\"cls\")</pre>\n<h3 class=\"wp-block-heading\">Importing data</h3>\n<p>To import the data set I have placed the CSV data file in the project working directory. Create an object data and assign to it a function which I am calling as <code>read.csv()</code>. In argument file after equal sign within quotations just press tab button to access the files present in the working directory. Now we need to choose the respective CSV data file. In the next argument <code>header</code> type TRUE to indicate that the first row of the data file contains variable names or headings.</p>\n<p>In the next line we can use the <code>head()</code> function to print the first six rows of the data frame. Here I am converting the first 2 variables as factor variables by using <code>as.factor()</code> function. Use <code>attach()</code> function for data object to mask the components of the variables in the data frame.</p>\n<pre>data &lt;- read.csv(file = \"data.csv\", \n                 header = TRUE)\nhead(data)\n\ndata$group = as.factor(data$group)\ndata$time = as.factor(data$time)\nattach(data)\n#   subID  group time resp.var\n# 1     1   male day1       26\n# 2     2   male day1       27\n# 3     3   male day1       24\n# 4     4 female day1       18\n# 5     5 female day1       17\n# 6     6 female day1       16</pre>\n<h3 class=\"wp-block-heading\">Fitting ANOVA model</h3>\n<p>Let’s proceed with analysis of variance to see how the response variable changes as the function of condition and time applied to each participant. The <code>aov()</code> function is used to fit analysis of variance model. The function is same as used in two way anova with only difference in error argument. Here you need to define error as ratio between subject ID and interaction of group and time factor. For denominator you can also use group, time and interaction term combined with plus sign. <code>Summary()</code> function for model object will print the results.</p>\n<pre>model.aov &lt;- aov(resp.var ~ \n                           group * time + \n                           Error(subID/(group*time)))\n#OR\nmodel.aov &lt;- aov(resp.var ~\n                           group * time + \n                           Error(subID/(group + time + group:time)))\n\nsummary(model.aov)\n# \n# Error: subID\n#       Df Sum Sq Mean Sq\n# group  1    408     408\n# \n# Error: subID:group\n#       Df Sum Sq Mean Sq\n# group  1  67.25   67.25\n# \n# Error: subID:time\n#      Df Sum Sq Mean Sq\n# time  3  356.7   118.9\n# \n# Error: subID:group:time\n#      Df Sum Sq Mean Sq\n# time  3  49.94   16.65\n# \n# Error: Within\n#            Df Sum Sq Mean Sq F value  Pr(&gt;F)   \n# group       1  13.86  13.863   6.105 0.03866 * \n# time        3  52.79  17.596   7.749 0.00943 **\n# group:time  3   2.60   0.868   0.382 0.76887   \n# Residuals   8  18.17   2.271                   \n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</pre>\n<p>The results showed that the error function has decomposed the residuals into:</p>\n<ul class=\"wp-block-list\">\n<li>Subject ID</li>\n<li>Subject ID and group interaction</li>\n<li>Subject ID and time interaction</li>\n<li>Three way interaction of subject ID, group and time</li>\n</ul>\n<p>This decomposition of error term considerably reduce the residual source of variance for the calculation of F value. Both the time and group variables significantly influence the response variable. However, their interaction was non-significant.</p>\n<h3 class=\"wp-block-heading\">Mean comparison test</h3>\n<p>Now let’s compute mean comparisons to observe the differences between main effects.</p>\n<h4 class=\"wp-block-heading\">SNK test</h4>\n<p>SNK test is derived from Tukey, but it is less conservative. Tukey test controls the error for all comparisons, where SNK only controls for comparisons under consideration. Before using <code>SNK.test()</code> function, first define error degree of freedom and error mean square value that will be used in this function.</p>\n<pre>Edf &lt;- df.residual(model.aov$Within)\nEdf\n# [1] 8\nEMS &lt;- deviance(model.aov$Within)/Edf\nEMS\n# [1] 2.270833</pre>\n<p>To apply SNK test use <code>SNK.test()</code> function. This function requires:</p>\n<ul class=\"wp-block-list\">\n<li>Y argument that specify the response variable</li>\n<li>TRT argument that represents the treatment factor variable applied to each experimental unit as group and time in this example.</li>\n<li>DF error and MS error represents degree of freedom and mean square for error term as determined earlier</li>\n<li>Alpha shows the significance level. Default value is 5 percent.</li>\n<li>Group argument specify the formation of treatment groups. True value for group will result in treatment groups with lettering. False value for group will provide information regarding comparisons between treatments.</li>\n</ul>\n<pre>library(agricolae)\nSNK.test1 &lt;- SNK.test(y = resp.var,\n                     trt = group,\n                     DFerror = Edf,\n                     MSerror = EMS,\n                     alpha = 0.05,\n                     group = TRUE)\nprint(SNK.test1)\n# $statistics\n#    MSerror Df     Mean       CV\n#   2.270833  8 14.33333 10.51345\n# \n# $parameters\n#   test name.t ntr alpha\n#    SNK  group   2  0.05\n# \n# $snk\n#      Table CriticalRange\n# 2 3.261182      1.418656\n# \n# $means\n#         resp.var      std  r Min Max   Q25  Q50   Q75\n# female  9.833333 4.687184 12   4  18  6.75  9.0 11.50\n# male   18.833333 4.687184 12  13  27 15.75 17.5 21.75\n# \n# $comparison\n# NULL\n# \n# $groups\n#         resp.var groups\n# male   18.833333      a\n# female  9.833333      b\n# \n# attr(,\"class\")\n# [1] \"group\"</pre>\n<p>Similarly, for mean comparisons in time variable just replace group with time in <code>trt</code> argument.</p>\n<pre>SNK.test2 &lt;- SNK.test(y = resp.var,\n                     trt = time,\n                     DFerror = Edf,\n                     MSerror = EMS,\n                     alpha = 0.05,\n                     group = TRUE)\nprint(SNK.test2)\n# $statistics\n#    MSerror Df     Mean       CV\n#   2.270833  8 14.33333 10.51345\n# \n# $parameters\n#   test name.t ntr alpha\n#    SNK   time   4  0.05\n# \n# $snk\n#      Table CriticalRange\n# 2 3.261182      2.006283\n# 3 4.041036      2.486050\n# 4 4.528810      2.786128\n# \n# $means\n#       resp.var      std r Min Max   Q25  Q50   Q75\n# day1 21.333333 4.885352 6  16  27 17.25 21.0 25.50\n# day2 13.833333 6.145459 6   7  21  9.00 13.5 18.75\n# day3 12.500000 3.937004 6   8  17  9.25 12.5 15.75\n# day4  9.666667 5.240865 6   4  16  5.25  9.5 13.75\n# \n# $comparison\n# NULL\n# \n# $groups\n#       resp.var groups\n# day1 21.333333      a\n# day2 13.833333      b\n# day3 12.500000      b\n# day4  9.666667      c\n# \n# attr(,\"class\")\n# [1] \"group\"</pre>\n<h3 class=\"wp-block-heading\">Visualizing results</h3>\n<h4 class=\"wp-block-heading\">Barplot for time variable</h4>\n<p>You can plot bar graph with standard error at the top of each bar from the output of SNK test applied earlier. The below code shows how the plot will be drawn using <code>ggplot()</code> function.</p>\n<pre>library(ggplot2)\n\nSE1 = SNK.test1$means$std/sqrt(SNK.test1$means$r)\n\nggplot(data=SNK.test1$means, \n       aes(x= rownames(SNK.test1$means), \n           y= resp.var, \n           fill=rownames(SNK.test1$means))) +\n  geom_bar(stat=\"identity\") +\n  geom_errorbar(aes(ymax = resp.var + std/sqrt(r),\n                    ymin = resp.var - std/sqrt(r)), \n                position = position_dodge(width=0.9), \n                width = 0.25) +\n  labs(title = \"\",\n       x = \"group\",\n       y = \"Response variable\",\n       fill = \"group\") +\n  geom_text(data = SNK.test1$groups, \n            aes(x = rownames(SNK.test1$groups),\n                y = resp.var + SE1,\n                label = as.matrix(groups)),\n            position = position_dodge(width = 0.9),\n            vjust = -(0.5))</pre>\n<p><img alt=\"repeated measure\" class=\"alignnone wp-image-769\" data-lazy-sizes=\"(max-width: 343px) 100vw, 343px\" data-lazy-src=\"https://i0.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/repeated-measure-300x300.png?resize=343%2C343&amp;ssl=1\" data-recalc-dims=\"1\" decoding=\"async\" height=\"343\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/repeated-measure-300x300.png?resize=343%2C343&amp;ssl=1 300w, https://www.statisticalaid.com/wp-content/uploads/2021/10/repeated-measure-150x150.png 150w, https://www.statisticalaid.com/wp-content/uploads/2021/10/repeated-measure-230x230.png 230w, https://www.statisticalaid.com/wp-content/uploads/2021/10/repeated-measure-80x80.png 80w, https://www.statisticalaid.com/wp-content/uploads/2021/10/repeated-measure.png 768w\" width=\"343\"/><noscript><img alt=\"repeated measure\" class=\"alignnone wp-image-769\" data-recalc-dims=\"1\" decoding=\"async\" height=\"343\" loading=\"lazy\" sizes=\"(max-width: 343px) 100vw, 343px\" src=\"https://i0.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/repeated-measure-300x300.png?resize=343%2C343&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/repeated-measure-300x300.png?resize=343%2C343&amp;ssl=1 300w, https://www.statisticalaid.com/wp-content/uploads/2021/10/repeated-measure-150x150.png 150w, https://www.statisticalaid.com/wp-content/uploads/2021/10/repeated-measure-230x230.png 230w, https://www.statisticalaid.com/wp-content/uploads/2021/10/repeated-measure-80x80.png 80w, https://www.statisticalaid.com/wp-content/uploads/2021/10/repeated-measure.png 768w\" width=\"343\"/></noscript> <img alt=\"\" class=\"alignnone wp-image-770\" data-lazy-sizes=\"(max-width: 432px) 100vw, 432px\" data-lazy-src=\"https://i2.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-300x240.png?resize=432%2C346&amp;ssl=1\" data-recalc-dims=\"1\" decoding=\"async\" height=\"346\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i2.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-300x240.png?resize=432%2C346&amp;ssl=1 300w, https://www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-768x614.png 768w, https://www.statisticalaid.com/wp-content/uploads/2021/10/rm-2.png 960w\" width=\"432\"/><noscript><img alt=\"\" class=\"alignnone wp-image-770\" data-recalc-dims=\"1\" decoding=\"async\" height=\"346\" loading=\"lazy\" sizes=\"(max-width: 432px) 100vw, 432px\" src=\"https://i2.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-300x240.png?resize=432%2C346&amp;ssl=1\" srcset_temp=\"https://i2.wp.com/www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-300x240.png?resize=432%2C346&amp;ssl=1 300w, https://www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-768x614.png 768w, https://www.statisticalaid.com/wp-content/uploads/2021/10/rm-2.png 960w\" width=\"432\"/></noscript></p>\n<h3 class=\"wp-block-heading\">Interpreting Results</h3>\n<p>The output will include:</p>\n<ul class=\"wp-block-list\">\n<li><strong>Main Effects</strong>: Examining the effect of <strong>Time</strong> and <strong>Condition</strong> independently.</li>\n<li><strong>Interaction Effect</strong>: Checking if the effect of one factor depends on the other.</li>\n<li><strong>p-values</strong>: If p &lt; 0.05, the effect is statistically significant.</li>\n</ul>\n<h2 class=\"wp-block-heading\">Conclusion</h2>\n<p>A two-way repeated measures ANOVA in R is a useful method for analyzing repeated observations across multiple conditions. By following the steps outlined, you can effectively test for main and interaction effects, ensuring valid <a href=\"https://www.statisticalaid.com/statistical-inference-definiton-types-and-estimation-procedures/\" rel=\"nofollow\" target=\"_blank\">statistical inferences</a>.</p>\n<p>By mastering this technique, you can unlock deeper insights into your experimental data and draw more precise conclusions.</p>\n<p>The post <a href=\"https://www.statisticalaid.com/two-way-repeated-measures-anova-in-r/\" rel=\"nofollow\" target=\"_blank\">Two Way Repeated Measures ANOVA in R</a> appeared first on <a href=\"https://www.statisticalaid.com/\" rel=\"nofollow\" target=\"_blank\">Statistical Aid: A School of Statistics</a>.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://www.statisticalaid.com/two-way-repeated-measures-anova-in-r/\"> R tutorials Archives - Statistical Aid: A School of Statistics %</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
      "main_text": "Two Way Repeated Measures ANOVA in R\nPosted on\nFebruary 13, 2025\nby\nMD TOUHIDUL ISLAM\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nR tutorials Archives - Statistical Aid: A School of Statistics %\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nTwo-way repeated measures ANOVA is a powerful\nstatistical test\nused to analyze datasets where two within-subject factors (independent variables) are measured multiple times for each subject. This test helps determine if there are significant differences between groups over time or across different conditions while accounting for individual variability.\nIn this guide, we will cover:\nWhat is a two-way repeated measures ANOVA?\nWhen to use it?\nHow to perform a two-way repeated measures ANOVA in R?\nInterpretation of results.\nTwo way repeated measures ANOVA is also known as:\nTwo factor repeated measures ANOVA\nTwo factor or two way ANOVA with repeated measures\nWithin within subjects ANOVA\nA two way repeated measures ANOVA is often used in studies where you have measured:\nA dependent\nvariable\nover two or more time points\nWhen subjects have undergone two or more conditions\nYou should also know how to identify a two way repeated measures anova from mixed anova. Mixed anova is very similar to two way repeated measures anova because both tests involve two factors. In a mixed anova, subjects that undergo each condition are different. Whereas in two way repeated measures anova same subjects undergo both conditions.\nWhat is a Two Way Repeated Measures ANOVA?\nA two-way repeated measures ANOVA examines the effects of two within-subject factors on a dependent variable. It extends the one-way repeated measures ANOVA by incorporating an additional factor, allowing for an understanding of both main effects and interaction effects.\nKey Components:\nWithin-Subjects Factors\n: Two categorical independent variables measured on the same subjects.\nDependent Variable\n: A continuous variable affected by the independent factors.\nSubjects as Random Effects\n: Each participant is exposed to all conditions, reducing variability caused by individual differences.\nWhen to Use a Two Way Repeated Measures ANOVA?\nUse this test when:\nYou have two within-subject factors (e.g., time, condition).\nThe same subjects participate in all combinations of factors.\nThe dependent variable is continuous and\nnormally distributed\n.\nYou aim to analyze both main and interaction effects.\nDescription of data\nThe data file for analysis contains subject ID, condition, time interval, and response variable. Researchers recorded the response variable measurements from the same subjects at four different time intervals. The subjects included both male and female individuals. Instead of using different individuals, researchers repeatedly measured the same subjects across different time intervals. Since the same subjects were used repeatedly, we will perform a two-way repeated measures ANOVA in R Studio.\nClear R environment\nAs a first step, I always recommend to clear data objects and values in global environment with\nrm()\nfunction. Set TRUE value for the argument\nall\nto remove objects and values if you have created earlier. Shut down all the graphic windows by using\ngraphics.off()\nfunction. Putting the value “cls” in\nshell()\nfunction will clear the console environment.\nrm(list = ls(all = TRUE))\ngraphics.off()\nshell(\"cls\")\nImporting data\nTo import the data set I have placed the CSV data file in the project working directory. Create an object data and assign to it a function which I am calling as\nread.csv()\n. In argument file after equal sign within quotations just press tab button to access the files present in the working directory. Now we need to choose the respective CSV data file. In the next argument\nheader\ntype TRUE to indicate that the first row of the data file contains variable names or headings.\nIn the next line we can use the\nhead()\nfunction to print the first six rows of the data frame. Here I am converting the first 2 variables as factor variables by using\nas.factor()\nfunction. Use\nattach()\nfunction for data object to mask the components of the variables in the data frame.\ndata <- read.csv(file = \"data.csv\", \n                 header = TRUE)\nhead(data)\n\ndata$group = as.factor(data$group)\ndata$time = as.factor(data$time)\nattach(data)\n#   subID  group time resp.var\n# 1     1   male day1       26\n# 2     2   male day1       27\n# 3     3   male day1       24\n# 4     4 female day1       18\n# 5     5 female day1       17\n# 6     6 female day1       16\nFitting ANOVA model\nLet’s proceed with analysis of variance to see how the response variable changes as the function of condition and time applied to each participant. The\naov()\nfunction is used to fit analysis of variance model. The function is same as used in two way anova with only difference in error argument. Here you need to define error as ratio between subject ID and interaction of group and time factor. For denominator you can also use group, time and interaction term combined with plus sign.\nSummary()\nfunction for model object will print the results.\nmodel.aov <- aov(resp.var ~ \n                           group * time + \n                           Error(subID/(group*time)))\n#OR\nmodel.aov <- aov(resp.var ~\n                           group * time + \n                           Error(subID/(group + time + group:time)))\n\nsummary(model.aov)\n# \n# Error: subID\n#       Df Sum Sq Mean Sq\n# group  1    408     408\n# \n# Error: subID:group\n#       Df Sum Sq Mean Sq\n# group  1  67.25   67.25\n# \n# Error: subID:time\n#      Df Sum Sq Mean Sq\n# time  3  356.7   118.9\n# \n# Error: subID:group:time\n#      Df Sum Sq Mean Sq\n# time  3  49.94   16.65\n# \n# Error: Within\n#            Df Sum Sq Mean Sq F value  Pr(>F)   \n# group       1  13.86  13.863   6.105 0.03866 * \n# time        3  52.79  17.596   7.749 0.00943 **\n# group:time  3   2.60   0.868   0.382 0.76887   \n# Residuals   8  18.17   2.271                   \n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nThe results showed that the error function has decomposed the residuals into:\nSubject ID\nSubject ID and group interaction\nSubject ID and time interaction\nThree way interaction of subject ID, group and time\nThis decomposition of error term considerably reduce the residual source of variance for the calculation of F value. Both the time and group variables significantly influence the response variable. However, their interaction was non-significant.\nMean comparison test\nNow let’s compute mean comparisons to observe the differences between main effects.\nSNK test\nSNK test is derived from Tukey, but it is less conservative. Tukey test controls the error for all comparisons, where SNK only controls for comparisons under consideration. Before using\nSNK.test()\nfunction, first define error degree of freedom and error mean square value that will be used in this function.\nEdf <- df.residual(model.aov$Within)\nEdf\n# [1] 8\nEMS <- deviance(model.aov$Within)/Edf\nEMS\n# [1] 2.270833\nTo apply SNK test use\nSNK.test()\nfunction. This function requires:\nY argument that specify the response variable\nTRT argument that represents the treatment factor variable applied to each experimental unit as group and time in this example.\nDF error and MS error represents degree of freedom and mean square for error term as determined earlier\nAlpha shows the significance level. Default value is 5 percent.\nGroup argument specify the formation of treatment groups. True value for group will result in treatment groups with lettering. False value for group will provide information regarding comparisons between treatments.\nlibrary(agricolae)\nSNK.test1 <- SNK.test(y = resp.var,\n                     trt = group,\n                     DFerror = Edf,\n                     MSerror = EMS,\n                     alpha = 0.05,\n                     group = TRUE)\nprint(SNK.test1)\n# $statistics\n#    MSerror Df     Mean       CV\n#   2.270833  8 14.33333 10.51345\n# \n# $parameters\n#   test name.t ntr alpha\n#    SNK  group   2  0.05\n# \n# $snk\n#      Table CriticalRange\n# 2 3.261182      1.418656\n# \n# $means\n#         resp.var      std  r Min Max   Q25  Q50   Q75\n# female  9.833333 4.687184 12   4  18  6.75  9.0 11.50\n# male   18.833333 4.687184 12  13  27 15.75 17.5 21.75\n# \n# $comparison\n# NULL\n# \n# $groups\n#         resp.var groups\n# male   18.833333      a\n# female  9.833333      b\n# \n# attr(,\"class\")\n# [1] \"group\"\nSimilarly, for mean comparisons in time variable just replace group with time in\ntrt\nargument.\nSNK.test2 <- SNK.test(y = resp.var,\n                     trt = time,\n                     DFerror = Edf,\n                     MSerror = EMS,\n                     alpha = 0.05,\n                     group = TRUE)\nprint(SNK.test2)\n# $statistics\n#    MSerror Df     Mean       CV\n#   2.270833  8 14.33333 10.51345\n# \n# $parameters\n#   test name.t ntr alpha\n#    SNK   time   4  0.05\n# \n# $snk\n#      Table CriticalRange\n# 2 3.261182      2.006283\n# 3 4.041036      2.486050\n# 4 4.528810      2.786128\n# \n# $means\n#       resp.var      std r Min Max   Q25  Q50   Q75\n# day1 21.333333 4.885352 6  16  27 17.25 21.0 25.50\n# day2 13.833333 6.145459 6   7  21  9.00 13.5 18.75\n# day3 12.500000 3.937004 6   8  17  9.25 12.5 15.75\n# day4  9.666667 5.240865 6   4  16  5.25  9.5 13.75\n# \n# $comparison\n# NULL\n# \n# $groups\n#       resp.var groups\n# day1 21.333333      a\n# day2 13.833333      b\n# day3 12.500000      b\n# day4  9.666667      c\n# \n# attr(,\"class\")\n# [1] \"group\"\nVisualizing results\nBarplot for time variable\nYou can plot bar graph with standard error at the top of each bar from the output of SNK test applied earlier. The below code shows how the plot will be drawn using\nggplot()\nfunction.\nlibrary(ggplot2)\n\nSE1 = SNK.test1$means$std/sqrt(SNK.test1$means$r)\n\nggplot(data=SNK.test1$means, \n       aes(x= rownames(SNK.test1$means), \n           y= resp.var, \n           fill=rownames(SNK.test1$means))) +\n  geom_bar(stat=\"identity\") +\n  geom_errorbar(aes(ymax = resp.var + std/sqrt(r),\n                    ymin = resp.var - std/sqrt(r)), \n                position = position_dodge(width=0.9), \n                width = 0.25) +\n  labs(title = \"\",\n       x = \"group\",\n       y = \"Response variable\",\n       fill = \"group\") +\n  geom_text(data = SNK.test1$groups, \n            aes(x = rownames(SNK.test1$groups),\n                y = resp.var + SE1,\n                label = as.matrix(groups)),\n            position = position_dodge(width = 0.9),\n            vjust = -(0.5))\nInterpreting Results\nThe output will include:\nMain Effects\n: Examining the effect of\nTime\nand\nCondition\nindependently.\nInteraction Effect\n: Checking if the effect of one factor depends on the other.\np-values\n: If p < 0.05, the effect is statistically significant.\nConclusion\nA two-way repeated measures ANOVA in R is a useful method for analyzing repeated observations across multiple conditions. By following the steps outlined, you can effectively test for main and interaction effects, ensuring valid\nstatistical inferences\n.\nBy mastering this technique, you can unlock deeper insights into your experimental data and draw more precise conclusions.\nThe post\nTwo Way Repeated Measures ANOVA in R\nappeared first on\nStatistical Aid: A School of Statistics\n.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nR tutorials Archives - Statistical Aid: A School of Statistics %\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Two-way repeated measures ANOVA is a powerful statistical test used to analyze datasets where two within-subject factors (independent variables) are measured multiple times for each subject. This test helps determine if there are significant differences between groups over time or across different conditions while accounting for individual variability. In this guide, we will cover: Two ... Read more The post Two Way Repeated Measures ANOVA in R appeared first on Statistical Aid: A School of Statistics.",
      "meta_keywords": null,
      "og_description": "Two-way repeated measures ANOVA is a powerful statistical test used to analyze datasets where two within-subject factors (independent variables) are measured multiple times for each subject. This test helps determine if there are significant differences between groups over time or across different conditions while accounting for individual variability. In this guide, we will cover: Two ... Read more The post Two Way Repeated Measures ANOVA in R appeared first on Statistical Aid: A School of Statistics.",
      "og_image": "https://www.statisticalaid.com/wp-content/uploads/2021/10/rm-2-300x240.png",
      "og_title": "Two Way Repeated Measures ANOVA in R | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 9.3,
      "sitemap_lastmod": null,
      "twitter_description": "Two-way repeated measures ANOVA is a powerful statistical test used to analyze datasets where two within-subject factors (independent variables) are measured multiple times for each subject. This test helps determine if there are significant differences between groups over time or across different conditions while accounting for individual variability. In this guide, we will cover: Two ... Read more The post Two Way Repeated Measures ANOVA in R appeared first on Statistical Aid: A School of Statistics.",
      "twitter_title": "Two Way Repeated Measures ANOVA in R | R-bloggers",
      "url": "https://www.r-bloggers.com/2025/02/two-way-repeated-measures-anova-in-r/",
      "word_count": 1855
    }
  }
}