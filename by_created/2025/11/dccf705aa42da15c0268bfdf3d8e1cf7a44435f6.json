{
  "id": "dccf705aa42da15c0268bfdf3d8e1cf7a44435f6",
  "url": "https://www.r-bloggers.com/2025/03/a-function-to-draw-complex-multiplets/",
  "created_at_utc": "2025-11-22T19:59:06Z",
  "data": null,
  "raw_original": {
    "uuid": "f24479d6-be71-4a0b-9538-727fab9d6a4c",
    "created_at": "2025-11-22 19:59:06",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2025/03/a-function-to-draw-complex-multiplets/",
      "crawled_at": "2025-11-22T10:52:45.320993",
      "external_links": [
        {
          "href": "http://chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets.html",
          "text": "Chemometrics and Spectroscopy Using R"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://cheminfographic.wordpress.com/",
          "text": "Roman A. Valiulin’s"
        },
        {
          "href": "https://cheminfographic.wordpress.com/2024/12/09/nmr-multiplet-interpretation-an-infographic-walk-through-2025-2nd-edition/",
          "text": "NMR Multiplet Interpretation"
        },
        {
          "href": "https://chemospec.org/posts/2025-02-06-Multiplets/Multiplets.html",
          "text": "previously"
        },
        {
          "href": "https://cran.r-project.org/package=SpecHelpers",
          "text": "SpecHelperspackage"
        },
        {
          "href": "https://creativecommons.org/licenses/by/4.0/",
          "text": "CC BY 4.0"
        },
        {
          "href": "http://chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets.html",
          "text": "http://chemospec.org/posts/2025-03-06\nMore Multiplets/MoreMultiplets.html"
        },
        {
          "href": "http://chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets.html",
          "text": "Chemometrics and Spectroscopy Using R"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "A Function to Draw Complex Multiplets | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-2-1.png?w=450"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-3-1.png?w=450"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-4-1.png?w=450"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-1.png?w=450"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-2.png?w=450"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-3.png?w=450"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-4.png?w=450"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-5.png?w=450"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-6.png?w=450"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/bryan-hanson/",
          "text": "Bryan Hanson"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-391007 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">A Function to Draw Complex Multiplets</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">March 6, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/bryan-hanson/\">Bryan Hanson</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"http://chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets.html\"> Chemometrics and Spectroscopy Using R</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<p>Inspired by <a href=\"https://cheminfographic.wordpress.com/\" rel=\"nofollow\" target=\"_blank\">Roman A. Valiulin’s</a> book <a href=\"https://cheminfographic.wordpress.com/2024/12/09/nmr-multiplet-interpretation-an-infographic-walk-through-2025-2nd-edition/\" rel=\"nofollow\" target=\"_blank\">NMR Multiplet Interpretation</a> (discussed <a href=\"https://chemospec.org/posts/2025-02-06-Multiplets/Multiplets.html\" rel=\"nofollow\" target=\"_blank\">previously</a>), I decided to write an <code>R</code> function to draw complex multiplets. The function will draw the multiplet, and optionally, can draw a splitting tree and some annotations.<sup>1</sup> Some of you may find this useful for teaching the topic.</p>\n<p>The function is called <code>multiplet</code> and it resides in the <a href=\"https://cran.r-project.org/package=SpecHelpers\" rel=\"nofollow\" target=\"_blank\"><code>SpecHelpers</code> package</a>, which was just updated to version 0.3.1. Here are some examples of the function at work, drawn from Valiulin’s book:</p>\n<div class=\"cell\">\n<pre>library(\"SpecHelpers\") # you need version 0.3.1</pre>\n</div>\n<div class=\"cell\">\n<pre># Example 3.1 from Valiulin, a ddt.\nres &lt;- multiplet(J = c(16.8, 10.1, 6.7, 6.7))</pre>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-2-1.png?w=450\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-2-1.png?w=450\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n<div class=\"cell\">\n<pre># Example 3.2 from Valiulin, a tt.\nres &lt;- multiplet(J = c(6.1, 6.1, 2.15, 2.15))</pre>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-3-1.png?w=450\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-3-1.png?w=450\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n<div class=\"cell\">\n<pre># Example 3.3 from Valiulin, a dddd.\nres &lt;- multiplet(J = c(12.7, 12.2, 10.0, 4.9))</pre>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-4-1.png?w=450\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-4-1.png?w=450\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n<p>One interesting aspect of Valiulin’s approach is that all multiplets are treated as doublets of doublets … of doublets. We can use the new function to show how a triplet can be understood as a doublet of doublets in which the coupling constants are the same. Starting from what is clearly a doublet of doublets we can see how the spectrum changes as the coupling constants become more equal, finally leading to the overlap of the two central peaks, giving a triplet.</p>\n<div class=\"cell\">\n<pre>Jvals &lt;- c(2, 4, 8, 10, 11, 12)\nfor (i in 1:length(Jvals)) {\n  res &lt;- multiplet(J = c(12, Jvals[i]), pw = 0.25)\n}</pre>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-1.png?w=450\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-1.png?w=450\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-2.png?w=450\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-2.png?w=450\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-3.png?w=450\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-3.png?w=450\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-4.png?w=450\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-4.png?w=450\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-5.png?w=450\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-5.png?w=450\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-6.png?w=450\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-5-6.png?w=450\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n<p>I hope some of you will find this function useful!</p>\n<div class=\"default\" id=\"quarto-appendix\"><section class=\"footnotes footnotes-end-of-document\" id=\"footnotes\"><h2 class=\"anchored quarto-appendix-heading\">Footnotes</h2>\n<ol>\n<li id=\"fn1\"><p>As a side note, drawing the spectrum was easy because <code>SpecHelpers</code> already contained the necessary functions. On the other hand, getting the splitting tree correct was, well, a bit of work. In contrast to how quickly one might sketch this out by hand, creating it computationally was much more challenging.↩︎</p></li>\n</ol>\n</section><section class=\"quarto-appendix-contents\" id=\"quarto-reuse\"><h2 class=\"anchored quarto-appendix-heading\">Reuse</h2><div class=\"quarto-appendix-contents\"><div><a href=\"https://creativecommons.org/licenses/by/4.0/\" rel=\"nofollow\" target=\"_blank\">CC BY 4.0</a></div></div></section><section class=\"quarto-appendix-contents\" id=\"quarto-citation\"><h2 class=\"anchored quarto-appendix-heading\">Citation</h2><div><div class=\"quarto-appendix-secondary-label\">BibTeX citation:</div><pre>@online{hanson2025,\n  author = {Hanson, Bryan},\n  title = {A {Function} to {Draw} {Complex} {Multiplets}},\n  date = {2025-03-06},\n  url = {http://chemospec.org/posts/2025-03-06 More Multiplets/MoreMultiplets.html},\n  langid = {en}\n}\n</pre><div class=\"quarto-appendix-secondary-label\">For attribution, please cite this work as:</div><div class=\"csl-entry quarto-appendix-citeas\" id=\"ref-hanson2025\">\nHanson, Bryan. 2025. <span>“A Function to Draw Complex\nMultiplets.”</span> March 6, 2025. <a href=\"http://chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets.html\" rel=\"nofollow\" target=\"_blank\">http://chemospec.org/posts/2025-03-06\nMore Multiplets/MoreMultiplets.html</a>.\n</div></div></section></div>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"http://chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets.html\"> Chemometrics and Spectroscopy Using R</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
      "main_text": "A Function to Draw Complex Multiplets\nPosted on\nMarch 6, 2025\nby\nBryan Hanson\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nChemometrics and Spectroscopy Using R\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nInspired by\nRoman A. Valiulin’s\nbook\nNMR Multiplet Interpretation\n(discussed\npreviously\n), I decided to write an\nR\nfunction to draw complex multiplets. The function will draw the multiplet, and optionally, can draw a splitting tree and some annotations.\n1\nSome of you may find this useful for teaching the topic.\nThe function is called\nmultiplet\nand it resides in the\nSpecHelpers\npackage\n, which was just updated to version 0.3.1. Here are some examples of the function at work, drawn from Valiulin’s book:\nlibrary(\"SpecHelpers\") # you need version 0.3.1\n# Example 3.1 from Valiulin, a ddt.\nres <- multiplet(J = c(16.8, 10.1, 6.7, 6.7))\n# Example 3.2 from Valiulin, a tt.\nres <- multiplet(J = c(6.1, 6.1, 2.15, 2.15))\n# Example 3.3 from Valiulin, a dddd.\nres <- multiplet(J = c(12.7, 12.2, 10.0, 4.9))\nOne interesting aspect of Valiulin’s approach is that all multiplets are treated as doublets of doublets … of doublets. We can use the new function to show how a triplet can be understood as a doublet of doublets in which the coupling constants are the same. Starting from what is clearly a doublet of doublets we can see how the spectrum changes as the coupling constants become more equal, finally leading to the overlap of the two central peaks, giving a triplet.\nJvals <- c(2, 4, 8, 10, 11, 12)\nfor (i in 1:length(Jvals)) {\n  res <- multiplet(J = c(12, Jvals[i]), pw = 0.25)\n}\nI hope some of you will find this function useful!\nFootnotes\nAs a side note, drawing the spectrum was easy because\nSpecHelpers\nalready contained the necessary functions. On the other hand, getting the splitting tree correct was, well, a bit of work. In contrast to how quickly one might sketch this out by hand, creating it computationally was much more challenging.↩︎\nReuse\nCC BY 4.0\nCitation\nBibTeX citation:\n@online{hanson2025,\n  author = {Hanson, Bryan},\n  title = {A {Function} to {Draw} {Complex} {Multiplets}},\n  date = {2025-03-06},\n  url = {http://chemospec.org/posts/2025-03-06 More Multiplets/MoreMultiplets.html},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nHanson, Bryan. 2025.\n“A Function to Draw Complex\nMultiplets.”\nMarch 6, 2025.\nhttp://chemospec.org/posts/2025-03-06\nMore Multiplets/MoreMultiplets.html\n.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nChemometrics and Spectroscopy Using R\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Inspired by Roman A. Valiulin’s book NMR Multiplet Interpretation (discussed previously), I decided to write an R function to draw complex multiplets. The function will draw the multiplet, and optionally, can draw a splitting tree and some annota...",
      "meta_keywords": null,
      "og_description": "Inspired by Roman A. Valiulin’s book NMR Multiplet Interpretation (discussed previously), I decided to write an R function to draw complex multiplets. The function will draw the multiplet, and optionally, can draw a splitting tree and some annota...",
      "og_image": "https://chemospec.org/posts/2025-03-06%20More%20Multiplets/MoreMultiplets_files/figure-html/unnamed-chunk-2-1.png",
      "og_title": "A Function to Draw Complex Multiplets | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 2.7,
      "sitemap_lastmod": null,
      "twitter_description": "Inspired by Roman A. Valiulin’s book NMR Multiplet Interpretation (discussed previously), I decided to write an R function to draw complex multiplets. The function will draw the multiplet, and optionally, can draw a splitting tree and some annota...",
      "twitter_title": "A Function to Draw Complex Multiplets | R-bloggers",
      "url": "https://www.r-bloggers.com/2025/03/a-function-to-draw-complex-multiplets/",
      "word_count": 532
    }
  }
}