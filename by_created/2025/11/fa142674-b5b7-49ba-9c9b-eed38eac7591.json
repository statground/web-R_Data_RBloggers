{
  "uuid": "fa142674-b5b7-49ba-9c9b-eed38eac7591",
  "created_at": "2025-11-22 19:58:26",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2025/06/r-version-of-probabilistic-machine-learning-for-longitudinal-data-reserving-work-in-progress/",
    "crawled_at": "2025-11-22T10:47:49.914188",
    "external_links": [
      {
        "href": "https://thierrymoudiki.github.io//blog/2025/06/05/r/ml-reserves-R",
        "text": "T. Moudiki's Webpage - R"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://colab.research.google.com/github/Techtonique/mlreserving/blob/main/mlreserving/demo/2025-06-05-ml-reserving-R-version.ipynb",
        "text": null
      },
      {
        "href": "https://thierrymoudiki.github.io//blog/2025/06/05/r/ml-reserves-R",
        "text": "T. Moudiki's Webpage - R"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "R version of Probabilistic Machine Learning (for longitudinal data) Reserving (work in progress) | R-bloggers",
    "images": [
      {
        "alt": "image-title-here",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "image-title-here",
        "base64": null,
        "src": "https://i0.wp.com/thierrymoudiki.github.io/images/2025-06-05/2025-06-05-image1.png?w=578&ssl=1"
      },
      {
        "alt": "Open In Colab",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Open In Colab",
        "base64": "data:image/jpeg;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTE3IiBoZWlnaHQ9IjIwIj48bGluZWFyR3JhZGllbnQgaWQ9ImIiIHgyPSIwIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjYmJiIiBzdG9wLW9wYWNpdHk9Ii4xIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLW9wYWNpdHk9Ii4xIi8+PC9saW5lYXJHcmFkaWVudD48Y2xpcFBhdGggaWQ9ImEiPjxyZWN0IHdpZHRoPSIxMTciIGhlaWdodD0iMjAiIHJ4PSIzIiBmaWxsPSIjZmZmIi8+PC9jbGlwUGF0aD48ZyBjbGlwLXBhdGg9InVybCgjYSkiPjxwYXRoIGZpbGw9IiM1NTUiIGQ9Ik0wIDBoMzB2MjBIMHoiLz48cGF0aCBmaWxsPSIjMDA3ZWM2IiBkPSJNMzAgMGg4N3YyMEgzMHoiLz48cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJNMCAwaDExN3YyMEgweiIvPjwvZz48ZyBmaWxsPSIjZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iRGVqYVZ1IFNhbnMsVmVyZGFuYSxHZW5ldmEsc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMTAiPjxzdmcgeD0iNHB4IiB5PSIwcHgiIHdpZHRoPSIyMnB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9Ii0yIDAgMjggMjQiIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmO2JvcmRlci1yYWRpdXM6IDFweDsiPjxwYXRoIHN0eWxlPSJmaWxsOiNlODcxMGE7IiBkPSJNMS45NzcsMTYuNzdjLTIuNjY3LTIuMjc3LTIuNjA1LTcuMDc5LDAtOS4zNTdDMi45MTksOC4wNTcsMy41MjIsOS4wNzUsNC40OSw5LjY5MWMtMS4xNTIsMS42LTEuMTQ2LDMuMjAxLTAuMDA0LDQuODAzQzMuNTIyLDE1LjExMSwyLjkxOCwxNi4xMjYsMS45NzcsMTYuNzd6Ii8+PHBhdGggc3R5bGU9ImZpbGw6I2Y5YWIwMDsiIGQ9Ik0xMi4yNTcsMTcuMTE0Yy0xLjc2Ny0xLjYzMy0yLjQ4NS0zLjY1OC0yLjExOC02LjAyYzAuNDUxLTIuOTEsMi4xMzktNC44OTMsNC45NDYtNS42NzhjMi41NjUtMC43MTgsNC45NjQtMC4yMTcsNi44NzgsMS44MTljLTAuODg0LDAuNzQzLTEuNzA3LDEuNTQ3LTIuNDM0LDIuNDQ2QzE4LjQ4OCw4LjgyNywxNy4zMTksOC40MzUsMTYsOC44NTZjLTIuNDA0LDAuNzY3LTMuMDQ2LDMuMjQxLTEuNDk0LDUuNjQ0Yy0wLjI0MSwwLjI3NS0wLjQ5MywwLjU0MS0wLjcyMSwwLjgyNkMxMy4yOTUsMTUuOTM5LDEyLjUxMSwxNi4zLDEyLjI1NywxNy4xMTR6Ii8+PHBhdGggc3R5bGU9ImZpbGw6I2U4NzEwYTsiIGQ9Ik0xOS41MjksOS42ODJjMC43MjctMC44OTksMS41NS0xLjcwMywyLjQzNC0yLjQ0NmMyLjcwMywyLjc4MywyLjcwMSw3LjAzMS0wLjAwNSw5Ljc2NGMtMi42NDgsMi42NzQtNi45MzYsMi43MjUtOS43MDEsMC4xMTVjMC4yNTQtMC44MTQsMS4wMzgtMS4xNzUsMS41MjgtMS43ODhjMC4yMjgtMC4yODUsMC40OC0wLjU1MiwwLjcyMS0wLjgyNmMxLjA1MywwLjkxNiwyLjI1NCwxLjI2OCwzLjYsMC44M0MyMC41MDIsMTQuNTUxLDIxLjE1MSwxMS45MjcsMTkuNTI5LDkuNjgyeiIvPjxwYXRoIHN0eWxlPSJmaWxsOiNmOWFiMDA7IiBkPSJNNC40OSw5LjY5MUMzLjUyMiw5LjA3NSwyLjkxOSw4LjA1NywxLjk3Nyw3LjQxM2MyLjIwOS0yLjM5OCw1LjcyMS0yLjk0Miw4LjQ3Ni0xLjM1NWMwLjU1NSwwLjMyLDAuNzE5LDAuNjA2LDAuMjg1LDEuMTI4Yy0wLjE1NywwLjE4OC0wLjI1OCwwLjQyMi0wLjM5MSwwLjYzMWMtMC4yOTksMC40Ny0wLjUwOSwxLjA2Ny0wLjkyOSwxLjM3MUM4LjkzMyw5LjUzOSw4LjUyMyw4Ljg0Nyw4LjAyMSw4Ljc0NkM2LjY3Myw4LjQ3NSw1LjUwOSw4Ljc4Nyw0LjQ5LDkuNjkxeiIvPjxwYXRoIHN0eWxlPSJmaWxsOiNmOWFiMDA7IiBkPSJNMS45NzcsMTYuNzdjMC45NDEtMC42NDQsMS41NDUtMS42NTksMi41MDktMi4yNzdjMS4zNzMsMS4xNTIsMi44NSwxLjQzMyw0LjQ1LDAuNDk5YzAuMzMyLTAuMTk0LDAuNTAzLTAuMDg4LDAuNjczLDAuMTljMC4zODYsMC42MzUsMC43NTMsMS4yODUsMS4xODEsMS44OWMwLjM0LDAuNDgsMC4yMjIsMC43MTUtMC4yNTMsMS4wMDZDNy44NCwxOS43Myw0LjIwNSwxOS4xODgsMS45NzcsMTYuNzd6Ii8+PC9zdmc+PHRleHQgeD0iMjQ1IiB5PSIxNDAiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiB0ZXh0TGVuZ3RoPSIzMCI+IDwvdGV4dD48dGV4dCB4PSI3MjUiIHk9IjE1MCIgZmlsbD0iIzAxMDEwMSIgZmlsbC1vcGFjaXR5PSIuMyIgdHJhbnNmb3JtPSJzY2FsZSguMSkiIHRleHRMZW5ndGg9Ijc3MCI+T3BlbiBpbiBDb2xhYjwvdGV4dD48dGV4dCB4PSI3MjUiIHk9IjE0MCIgdHJhbnNmb3JtPSJzY2FsZSguMSkiIHRleHRMZW5ndGg9Ijc3MCI+T3BlbiBpbiBDb2xhYjwvdGV4dD48L2c+IDwvc3ZnPgo=",
        "src": "https://colab.research.google.com/assets/colab-badge.svg"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/t-moudiki/",
        "text": "T. Moudiki"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-392866 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">R version of Probabilistic Machine Learning (for longitudinal data) Reserving (work in progress)</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">June 4, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/t-moudiki/\">T. Moudiki</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://thierrymoudiki.github.io//blog/2025/06/05/r/ml-reserves-R\"> T. Moudiki's Webpage - R</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47--><p>Work in progress. Comments welcome.</p>\n<pre>!pip install git+https://github.com/Techtonique/mlreserving.git --verbose\n\n%load_ext rpy2.ipython\n\n%%R\n\ninstall.packages(\"reticulate\")\n\n%%R\n\nlibrary(reticulate)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Import Python modules\npd &lt;- import(\"pandas\")\nnp &lt;- import(\"numpy\")\nplt &lt;- import(\"matplotlib.pyplot\")\nMLReserving &lt;- import(\"mlreserving\")$MLReserving\nRidgeCV &lt;- import(\"sklearn.linear_model\")$RidgeCV\nExtraTreesRegressor &lt;- import(\"sklearn.ensemble\")$ExtraTreesRegressor\nRandomForestRegressor &lt;- import(\"sklearn.ensemble\")$RandomForestRegressor\n\n# Load the dataset\nurl &lt;- \"https://raw.githubusercontent.com/Techtonique/datasets/refs/heads/main/tabular/triangle/raa.csv\"\ndf &lt;- pd$read_csv(url)\n\n# Print head and tail\nprint(head(df))\nprint(tail(df))\n\nlibrary(reticulate)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Import Python modules with convert=FALSE for more control\npd &lt;- import(\"pandas\", convert=FALSE)\nnp &lt;- import(\"numpy\", convert=FALSE)\nMLReserving &lt;- import(\"mlreserving\", convert=FALSE)$MLReserving\nRidgeCV &lt;- import(\"sklearn.linear_model\", convert=FALSE)$RidgeCV\nExtraTreesRegressor &lt;- import(\"sklearn.ensemble\", convert=FALSE)$ExtraTreesRegressor\nRandomForestRegressor &lt;- import(\"sklearn.ensemble\", convert=FALSE)$RandomForestRegressor\n\n# Load the dataset and convert to Python object\nurl &lt;- \"https://raw.githubusercontent.com/Techtonique/datasets/refs/heads/main/tabular/triangle/raa.csv\"\npy_df &lt;- pd$read_csv(url)\n\n# Print head and tail\nprint(py_df$head())\nprint(py_df$tail())\n\n# Create models list\nmodels &lt;- list(\n  RidgeCV(),\n  ExtraTreesRegressor(),\n  RandomForestRegressor()\n)\n\n# Helper function to create Python integers\npy_int &lt;- function(x) {\n  floor(x)\n}\n\nfor (mdl in models) {\n  # Initialize the model with explicit Python integers\n  model &lt;- MLReserving(\n    model = mdl,\n    level = py_int(95),  # 95% confidence level\n    random_state = py_int(42)\n  )\n\n  # Fit the model\n  model$fit(\n    py_df,\n    origin_col = \"origin\",\n    development_col = \"development\",\n    value_col = \"values\"\n  )\n\n  # Uncomment to make predictions\n  result &lt;- model$predict()\n  print(result)\n}\n\n(mean_df &lt;- py_to_r(result$ibnr_mean))\n(lower_df &lt;- py_to_r(result$ibnr_lower))\n(upper_df &lt;- py_to_r(result$ibnr_upper))\n\nmean_vals &lt;- mean_df\nlower_vals &lt;- lower_df\nupper_vals &lt;- upper_df\n\n# Get origin years as numeric values\nyears &lt;- as.numeric(names(mean_vals))\n\n# Set up plot\nplot(years, mean_vals,\n     ylim = range(c(lower_vals, upper_vals)),\n     xlab = \"Origin Year\", ylab = \"IBNR Value\",\n     main = \"IBNR Estimates with Confidence Interval\",\n     pch = 19, col = \"blue\", type = \"n\")\n\n# Add polygons and lines\nfor (i in seq_along(years)) {\n  # Coordinates for polygon: x and y pairs for upper and lower bounds\n  x_poly &lt;- c(years[i] - 0.2, years[i] + 0.2, years[i] + 0.2, years[i] - 0.2)\n  y_poly &lt;- c(lower_vals[i], lower_vals[i], upper_vals[i], upper_vals[i])\n\n  polygon(x_poly, y_poly, col = rgb(0, 0, 1, 0.2), border = NA)\n\n  # Draw the mean point on top\n  points(years[i], mean_vals[i], pch = 19, col = \"blue\")\n}\n\n# Optional: Add a legend\nlegend(\"topleft\", legend = c(\"IBNR Mean\", \"Confidence Interval\"),\n       col = c(\"blue\", rgb(0, 0, 1, 0.2)), pch = c(19, 15), bty = \"n\")\n\n  development origin values\n1        1981   1981   5012\n2        1982   1982    106\n3        1983   1983   3410\n4        1984   1984   5655\n5        1985   1985   1092\n6        1986   1986   1513\n   development origin values\n50        1988   1981  18608\n51        1989   1982  16169\n52        1990   1983  23466\n53        1989   1981  18662\n54        1990   1982  16704\n55        1990   1981  18834\n   development  origin  values\n0         1981    1981 5012.00\n1         1982    1982  106.00\n2         1983    1983 3410.00\n3         1984    1984 5655.00\n4         1985    1985 1092.00\n    development  origin   values\n50         1989    1982 16169.00\n51         1990    1983 23466.00\n52         1989    1981 18662.00\n53         1990    1982 16704.00\n54         1990    1981 18834.00\nDescribeResult(mean=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00 22908.59   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00 21823.11 24108.16   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00 20182.39 22964.19 25369.88   \n1987    557.00  4020.00 10946.00 12314.00 17925.30 21236.16 24164.31 26696.94   \n1988   1351.00  6947.00 13112.00 15015.00 18859.87 22344.37 25426.49 28092.70   \n1989   3133.00  5395.00 11465.39 15796.71 19842.66 23509.80 26753.91 29560.66   \n1990   2063.00  7394.65 12061.46 16618.70 20876.12 24735.39 28149.89 31104.52   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00 23699.40  \n1983   23509.79 24943.97  \n1984   24742.62 26253.21  \n1985   26039.42 27630.45  \n1986   27403.47 29079.18  \n1987   28838.23 30603.08  \n1988   30347.32 32206.00  \n1989   31934.55 33891.99  \n1990   33603.93 35665.33  , lower=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00  8974.39   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00  8549.13  9444.35   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00  7906.33  8996.17  9938.66   \n1987    557.00  4020.00 10946.00 12314.00  7022.06  8319.17  9466.35 10458.57   \n1988   1351.00  6947.00 13112.00  5881.88  7388.20  8753.34  9960.84 11005.39   \n1989   3133.00  5395.00  4491.24  6188.14  7773.24  9209.93 10480.88 11580.50   \n1990   2063.00  2896.43  4724.76  6510.17  8178.12  9690.08 11027.79 12185.34   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00  9284.21  \n1983    9209.92  9771.80  \n1984    9692.91 10284.72  \n1985   10200.96 10824.29  \n1986   10735.37 11391.87  \n1987   11297.47 11988.89  \n1988   11888.69 12616.87  \n1989   12510.53 13277.40  \n1990   13164.55 13972.15  , upper=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00 58475.51   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00 55704.84 61537.39   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00 51516.90 58617.43 64757.93   \n1987    557.00  4020.00 10946.00 12314.00 45755.71 54206.64 61680.72 68145.25   \n1988   1351.00  6947.00 13112.00 38327.19 48141.20 57035.33 64902.42 71707.89   \n1989   3133.00  5395.00 29266.86 40322.51 50649.76 60010.10 68290.64 75454.84   \n1990   2063.00 18876.34 30788.30 42420.62 53287.66 63138.39 71853.88 79395.53   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00 60494.05  \n1983   60010.06 63670.80  \n1984   63156.85 67012.63  \n1985   66466.91 70528.02  \n1986   69948.64 74225.89  \n1987   73610.85 78115.62  \n1988   77462.79 82207.05  \n1989   81514.19 86510.54  \n1990   85775.26 91036.96  , ibnr_mean=origin\n1982    23699.40\n1983    48453.76\n1984    73904.42\n1985    99601.14\n1986   124999.11\n1987   149464.02\n1988   172291.74\n1989   192755.68\n1990   210209.98\nName: values, dtype: float64, ibnr_lower=origin\n1982    9284.21\n1983   18981.72\n1984   28952.02\n1985   39018.73\n1986   48968.39\n1987   58552.50\n1988   67495.21\n1989   75511.84\n1990   82349.38\nName: values, dtype: float64, ibnr_upper=origin\n1982    60494.05\n1983   123680.86\n1984   188644.98\n1985   254237.16\n1986   319066.80\n1987   381514.79\n1988   439783.88\n1989   492019.43\n1990   536572.94\nName: values, dtype: float64)\nDescribeResult(mean=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00 23466.00   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00 23192.71 23466.00   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00 22839.00 23192.71 23466.00   \n1987    557.00  4020.00 10946.00 12314.00 21412.04 22839.00 23192.71 23466.00   \n1988   1351.00  6947.00 13112.00 20144.66 21412.04 22839.00 23192.71 23466.00   \n1989   3133.00  5395.00 18855.41 20144.66 21412.04 22839.00 23192.71 23466.00   \n1990   2063.00 14144.04 18855.41 20144.66 21412.04 22839.00 23192.71 23466.00   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00 16824.72  \n1983   21775.25 21906.31  \n1984   21775.25 21906.31  \n1985   21775.25 21906.31  \n1986   21775.25 21906.31  \n1987   21775.25 21906.31  \n1988   21775.25 21906.31  \n1989   21775.25 21906.31  \n1990   21775.25 21906.31  , lower=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00  5439.95   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00  5376.58  5439.95   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00  5294.57  5376.58  5439.95   \n1987    557.00  4020.00 10946.00 12314.00  4963.73  5294.57  5376.58  5439.95   \n1988   1351.00  6947.00 13112.00  4669.88  4963.73  5294.57  5376.58  5439.95   \n1989   3133.00  5395.00  4370.96  4669.88  4963.73  5294.57  5376.58  5439.95   \n1990   2063.00  3278.60  4370.96  4669.88  4963.73  5294.57  5376.58  5439.95   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00  3900.13  \n1983    5047.94  5078.33  \n1984    5047.94  5078.33  \n1985    5047.94  5078.33  \n1986    5047.94  5078.33  \n1987    5047.94  5078.33  \n1988    5047.94  5078.33  \n1989    5047.94  5078.33  \n1990    5047.94  5078.33  , upper=dev         1        2        3        4        5        6         7   \\\norigin                                                                  \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00  18009.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00  15496.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00  22863.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00  27067.00   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00 100034.29   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00 98508.72 100034.29   \n1987    557.00  4020.00 10946.00 12314.00 92354.22 98508.72 100034.29   \n1988   1351.00  6947.00 13112.00 86887.95 92354.22 98508.72 100034.29   \n1989   3133.00  5395.00 81327.36 86887.95 92354.22 98508.72 100034.29   \n1990   2063.00 61007.06 81327.36 86887.95 92354.22 98508.72 100034.29   \n\ndev           8        9        10  \norigin                              \n1981    18608.00 18662.00 18834.00  \n1982    16169.00 16704.00 72568.93  \n1983    23466.00 93920.76 94486.02  \n1984   101213.01 93920.76 94486.02  \n1985   101213.01 93920.76 94486.02  \n1986   101213.01 93920.76 94486.02  \n1987   101213.01 93920.76 94486.02  \n1988   101213.01 93920.76 94486.02  \n1989   101213.01 93920.76 94486.02  \n1990   101213.01 93920.76 94486.02  , ibnr_mean=origin\n1982    16824.72\n1983    43681.56\n1984    67147.56\n1985    90340.27\n1986   113179.27\n1987   134591.31\n1988   154735.97\n1989   173591.37\n1990   187735.41\nName: values, dtype: float64, ibnr_lower=origin\n1982    3900.13\n1983   10126.26\n1984   15566.21\n1985   20942.79\n1986   26237.37\n1987   31201.09\n1988   35870.97\n1989   40241.93\n1990   43520.53\nName: values, dtype: float64, ibnr_upper=origin\n1982    72568.93\n1983   188406.78\n1984   289619.79\n1985   389654.08\n1986   488162.80\n1987   580517.03\n1988   667404.98\n1989   748732.34\n1990   809739.40\nName: values, dtype: float64)\nDescribeResult(mean=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00 22799.06   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00 22560.59 22799.06   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00 22227.42 22560.59 22799.06   \n1987    557.00  4020.00 10946.00 12314.00 20320.41 22227.42 22560.59 22799.06   \n1988   1351.00  6947.00 13112.00 19568.73 20320.41 22227.42 22560.59 22799.06   \n1989   3133.00  5395.00 16013.73 19568.73 20320.41 22227.42 22560.59 22799.06   \n1990   2063.00 13812.49 16013.73 19568.73 20320.41 22227.42 22560.59 22799.06   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00 17280.71  \n1983   22747.00 22747.00  \n1984   22747.00 22747.00  \n1985   22747.00 22747.00  \n1986   22747.00 22747.00  \n1987   22747.00 22747.00  \n1988   22747.00 22747.00  \n1989   22747.00 22747.00  \n1990   22747.00 22747.00  , lower=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00  6829.01   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00  6757.57  6829.01   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00  6657.77  6757.57  6829.01   \n1987    557.00  4020.00 10946.00 12314.00  6086.50  6657.77  6757.57  6829.01   \n1988   1351.00  6947.00 13112.00  5861.33  6086.50  6657.77  6757.57  6829.01   \n1989   3133.00  5395.00  4796.39  5861.33  6086.50  6657.77  6757.57  6829.01   \n1990   2063.00  4136.98  4796.39  5861.33  6086.50  6657.77  6757.57  6829.01   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00  5175.93  \n1983    6813.41  6813.41  \n1984    6813.41  6813.41  \n1985    6813.41  6813.41  \n1986    6813.41  6813.41  \n1987    6813.41  6813.41  \n1988    6813.41  6813.41  \n1989    6813.41  6813.41  \n1990    6813.41  6813.41  , upper=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00 76110.60   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00 75314.53 76110.60   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00 74202.33 75314.53 76110.60   \n1987    557.00  4020.00 10946.00 12314.00 67836.33 74202.33 75314.53 76110.60   \n1988   1351.00  6947.00 13112.00 65327.03 67836.33 74202.33 75314.53 76110.60   \n1989   3133.00  5395.00 53459.67 65327.03 67836.33 74202.33 75314.53 76110.60   \n1990   2063.00 46111.46 53459.67 65327.03 67836.33 74202.33 75314.53 76110.60   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00 57689.14  \n1983   75936.79 75936.79  \n1984   75936.79 75936.79  \n1985   75936.79 75936.79  \n1986   75936.79 75936.79  \n1987   75936.79 75936.79  \n1988   75936.79 75936.79  \n1989   75936.79 75936.79  \n1990   75936.79 75936.79  , ibnr_mean=origin\n1982    17280.71\n1983    45493.99\n1984    68293.05\n1985    90853.64\n1986   113081.06\n1987   133401.48\n1988   152970.20\n1989   168983.93\n1990   182796.42\nName: values, dtype: float64, ibnr_lower=origin\n1982    5175.93\n1983   13626.82\n1984   20455.83\n1985   27213.40\n1986   33871.17\n1987   39957.67\n1988   45818.99\n1989   50615.38\n1990   54752.36\nName: values, dtype: float64, ibnr_upper=origin\n1982    57689.14\n1983   151873.58\n1984   227984.18\n1985   303298.71\n1986   377501.04\n1987   445337.37\n1988   510664.40\n1989   564124.08\n1990   610235.54\nName: values, dtype: float64)\n</pre>\n<p><img alt=\"image-title-here\" class=\"img-responsive\" data-lazy-src=\"https://i0.wp.com/thierrymoudiki.github.io/images/2025-06-05/2025-06-05-image1.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image-title-here\" class=\"img-responsive\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/thierrymoudiki.github.io/images/2025-06-05/2025-06-05-image1.png?w=578&amp;ssl=1\"/></noscript></p>\n<p><a href=\"https://colab.research.google.com/github/Techtonique/mlreserving/blob/main/mlreserving/demo/2025-06-05-ml-reserving-R-version.ipynb\" rel=\"nofollow\" target=\"_blank\">\n<img alt=\"Open In Colab\" data-lazy-src=\"https://colab.research.google.com/assets/colab-badge.svg\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" style=\"max-width: 100%; height: auto; width: 120px;\"/><noscript><img alt=\"Open In Colab\" src=\"https://colab.research.google.com/assets/colab-badge.svg\" style=\"max-width: 100%; height: auto; width: 120px;\"/></noscript>\n</a></p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://thierrymoudiki.github.io//blog/2025/06/05/r/ml-reserves-R\"> T. Moudiki's Webpage - R</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
    "main_text": "R version of Probabilistic Machine Learning (for longitudinal data) Reserving (work in progress)\nPosted on\nJune 4, 2025\nby\nT. Moudiki\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nT. Moudiki's Webpage - R\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nWork in progress. Comments welcome.\n!pip install git+https://github.com/Techtonique/mlreserving.git --verbose\n\n%load_ext rpy2.ipython\n\n%%R\n\ninstall.packages(\"reticulate\")\n\n%%R\n\nlibrary(reticulate)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Import Python modules\npd <- import(\"pandas\")\nnp <- import(\"numpy\")\nplt <- import(\"matplotlib.pyplot\")\nMLReserving <- import(\"mlreserving\")$MLReserving\nRidgeCV <- import(\"sklearn.linear_model\")$RidgeCV\nExtraTreesRegressor <- import(\"sklearn.ensemble\")$ExtraTreesRegressor\nRandomForestRegressor <- import(\"sklearn.ensemble\")$RandomForestRegressor\n\n# Load the dataset\nurl <- \"https://raw.githubusercontent.com/Techtonique/datasets/refs/heads/main/tabular/triangle/raa.csv\"\ndf <- pd$read_csv(url)\n\n# Print head and tail\nprint(head(df))\nprint(tail(df))\n\nlibrary(reticulate)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Import Python modules with convert=FALSE for more control\npd <- import(\"pandas\", convert=FALSE)\nnp <- import(\"numpy\", convert=FALSE)\nMLReserving <- import(\"mlreserving\", convert=FALSE)$MLReserving\nRidgeCV <- import(\"sklearn.linear_model\", convert=FALSE)$RidgeCV\nExtraTreesRegressor <- import(\"sklearn.ensemble\", convert=FALSE)$ExtraTreesRegressor\nRandomForestRegressor <- import(\"sklearn.ensemble\", convert=FALSE)$RandomForestRegressor\n\n# Load the dataset and convert to Python object\nurl <- \"https://raw.githubusercontent.com/Techtonique/datasets/refs/heads/main/tabular/triangle/raa.csv\"\npy_df <- pd$read_csv(url)\n\n# Print head and tail\nprint(py_df$head())\nprint(py_df$tail())\n\n# Create models list\nmodels <- list(\n  RidgeCV(),\n  ExtraTreesRegressor(),\n  RandomForestRegressor()\n)\n\n# Helper function to create Python integers\npy_int <- function(x) {\n  floor(x)\n}\n\nfor (mdl in models) {\n  # Initialize the model with explicit Python integers\n  model <- MLReserving(\n    model = mdl,\n    level = py_int(95),  # 95% confidence level\n    random_state = py_int(42)\n  )\n\n  # Fit the model\n  model$fit(\n    py_df,\n    origin_col = \"origin\",\n    development_col = \"development\",\n    value_col = \"values\"\n  )\n\n  # Uncomment to make predictions\n  result <- model$predict()\n  print(result)\n}\n\n(mean_df <- py_to_r(result$ibnr_mean))\n(lower_df <- py_to_r(result$ibnr_lower))\n(upper_df <- py_to_r(result$ibnr_upper))\n\nmean_vals <- mean_df\nlower_vals <- lower_df\nupper_vals <- upper_df\n\n# Get origin years as numeric values\nyears <- as.numeric(names(mean_vals))\n\n# Set up plot\nplot(years, mean_vals,\n     ylim = range(c(lower_vals, upper_vals)),\n     xlab = \"Origin Year\", ylab = \"IBNR Value\",\n     main = \"IBNR Estimates with Confidence Interval\",\n     pch = 19, col = \"blue\", type = \"n\")\n\n# Add polygons and lines\nfor (i in seq_along(years)) {\n  # Coordinates for polygon: x and y pairs for upper and lower bounds\n  x_poly <- c(years[i] - 0.2, years[i] + 0.2, years[i] + 0.2, years[i] - 0.2)\n  y_poly <- c(lower_vals[i], lower_vals[i], upper_vals[i], upper_vals[i])\n\n  polygon(x_poly, y_poly, col = rgb(0, 0, 1, 0.2), border = NA)\n\n  # Draw the mean point on top\n  points(years[i], mean_vals[i], pch = 19, col = \"blue\")\n}\n\n# Optional: Add a legend\nlegend(\"topleft\", legend = c(\"IBNR Mean\", \"Confidence Interval\"),\n       col = c(\"blue\", rgb(0, 0, 1, 0.2)), pch = c(19, 15), bty = \"n\")\n\n  development origin values\n1        1981   1981   5012\n2        1982   1982    106\n3        1983   1983   3410\n4        1984   1984   5655\n5        1985   1985   1092\n6        1986   1986   1513\n   development origin values\n50        1988   1981  18608\n51        1989   1982  16169\n52        1990   1983  23466\n53        1989   1981  18662\n54        1990   1982  16704\n55        1990   1981  18834\n   development  origin  values\n0         1981    1981 5012.00\n1         1982    1982  106.00\n2         1983    1983 3410.00\n3         1984    1984 5655.00\n4         1985    1985 1092.00\n    development  origin   values\n50         1989    1982 16169.00\n51         1990    1983 23466.00\n52         1989    1981 18662.00\n53         1990    1982 16704.00\n54         1990    1981 18834.00\nDescribeResult(mean=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00 22908.59   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00 21823.11 24108.16   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00 20182.39 22964.19 25369.88   \n1987    557.00  4020.00 10946.00 12314.00 17925.30 21236.16 24164.31 26696.94   \n1988   1351.00  6947.00 13112.00 15015.00 18859.87 22344.37 25426.49 28092.70   \n1989   3133.00  5395.00 11465.39 15796.71 19842.66 23509.80 26753.91 29560.66   \n1990   2063.00  7394.65 12061.46 16618.70 20876.12 24735.39 28149.89 31104.52   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00 23699.40  \n1983   23509.79 24943.97  \n1984   24742.62 26253.21  \n1985   26039.42 27630.45  \n1986   27403.47 29079.18  \n1987   28838.23 30603.08  \n1988   30347.32 32206.00  \n1989   31934.55 33891.99  \n1990   33603.93 35665.33  , lower=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00  8974.39   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00  8549.13  9444.35   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00  7906.33  8996.17  9938.66   \n1987    557.00  4020.00 10946.00 12314.00  7022.06  8319.17  9466.35 10458.57   \n1988   1351.00  6947.00 13112.00  5881.88  7388.20  8753.34  9960.84 11005.39   \n1989   3133.00  5395.00  4491.24  6188.14  7773.24  9209.93 10480.88 11580.50   \n1990   2063.00  2896.43  4724.76  6510.17  8178.12  9690.08 11027.79 12185.34   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00  9284.21  \n1983    9209.92  9771.80  \n1984    9692.91 10284.72  \n1985   10200.96 10824.29  \n1986   10735.37 11391.87  \n1987   11297.47 11988.89  \n1988   11888.69 12616.87  \n1989   12510.53 13277.40  \n1990   13164.55 13972.15  , upper=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00 58475.51   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00 55704.84 61537.39   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00 51516.90 58617.43 64757.93   \n1987    557.00  4020.00 10946.00 12314.00 45755.71 54206.64 61680.72 68145.25   \n1988   1351.00  6947.00 13112.00 38327.19 48141.20 57035.33 64902.42 71707.89   \n1989   3133.00  5395.00 29266.86 40322.51 50649.76 60010.10 68290.64 75454.84   \n1990   2063.00 18876.34 30788.30 42420.62 53287.66 63138.39 71853.88 79395.53   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00 60494.05  \n1983   60010.06 63670.80  \n1984   63156.85 67012.63  \n1985   66466.91 70528.02  \n1986   69948.64 74225.89  \n1987   73610.85 78115.62  \n1988   77462.79 82207.05  \n1989   81514.19 86510.54  \n1990   85775.26 91036.96  , ibnr_mean=origin\n1982    23699.40\n1983    48453.76\n1984    73904.42\n1985    99601.14\n1986   124999.11\n1987   149464.02\n1988   172291.74\n1989   192755.68\n1990   210209.98\nName: values, dtype: float64, ibnr_lower=origin\n1982    9284.21\n1983   18981.72\n1984   28952.02\n1985   39018.73\n1986   48968.39\n1987   58552.50\n1988   67495.21\n1989   75511.84\n1990   82349.38\nName: values, dtype: float64, ibnr_upper=origin\n1982    60494.05\n1983   123680.86\n1984   188644.98\n1985   254237.16\n1986   319066.80\n1987   381514.79\n1988   439783.88\n1989   492019.43\n1990   536572.94\nName: values, dtype: float64)\nDescribeResult(mean=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00 23466.00   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00 23192.71 23466.00   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00 22839.00 23192.71 23466.00   \n1987    557.00  4020.00 10946.00 12314.00 21412.04 22839.00 23192.71 23466.00   \n1988   1351.00  6947.00 13112.00 20144.66 21412.04 22839.00 23192.71 23466.00   \n1989   3133.00  5395.00 18855.41 20144.66 21412.04 22839.00 23192.71 23466.00   \n1990   2063.00 14144.04 18855.41 20144.66 21412.04 22839.00 23192.71 23466.00   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00 16824.72  \n1983   21775.25 21906.31  \n1984   21775.25 21906.31  \n1985   21775.25 21906.31  \n1986   21775.25 21906.31  \n1987   21775.25 21906.31  \n1988   21775.25 21906.31  \n1989   21775.25 21906.31  \n1990   21775.25 21906.31  , lower=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00  5439.95   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00  5376.58  5439.95   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00  5294.57  5376.58  5439.95   \n1987    557.00  4020.00 10946.00 12314.00  4963.73  5294.57  5376.58  5439.95   \n1988   1351.00  6947.00 13112.00  4669.88  4963.73  5294.57  5376.58  5439.95   \n1989   3133.00  5395.00  4370.96  4669.88  4963.73  5294.57  5376.58  5439.95   \n1990   2063.00  3278.60  4370.96  4669.88  4963.73  5294.57  5376.58  5439.95   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00  3900.13  \n1983    5047.94  5078.33  \n1984    5047.94  5078.33  \n1985    5047.94  5078.33  \n1986    5047.94  5078.33  \n1987    5047.94  5078.33  \n1988    5047.94  5078.33  \n1989    5047.94  5078.33  \n1990    5047.94  5078.33  , upper=dev         1        2        3        4        5        6         7   \\\norigin                                                                  \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00  18009.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00  15496.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00  22863.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00  27067.00   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00 100034.29   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00 98508.72 100034.29   \n1987    557.00  4020.00 10946.00 12314.00 92354.22 98508.72 100034.29   \n1988   1351.00  6947.00 13112.00 86887.95 92354.22 98508.72 100034.29   \n1989   3133.00  5395.00 81327.36 86887.95 92354.22 98508.72 100034.29   \n1990   2063.00 61007.06 81327.36 86887.95 92354.22 98508.72 100034.29   \n\ndev           8        9        10  \norigin                              \n1981    18608.00 18662.00 18834.00  \n1982    16169.00 16704.00 72568.93  \n1983    23466.00 93920.76 94486.02  \n1984   101213.01 93920.76 94486.02  \n1985   101213.01 93920.76 94486.02  \n1986   101213.01 93920.76 94486.02  \n1987   101213.01 93920.76 94486.02  \n1988   101213.01 93920.76 94486.02  \n1989   101213.01 93920.76 94486.02  \n1990   101213.01 93920.76 94486.02  , ibnr_mean=origin\n1982    16824.72\n1983    43681.56\n1984    67147.56\n1985    90340.27\n1986   113179.27\n1987   134591.31\n1988   154735.97\n1989   173591.37\n1990   187735.41\nName: values, dtype: float64, ibnr_lower=origin\n1982    3900.13\n1983   10126.26\n1984   15566.21\n1985   20942.79\n1986   26237.37\n1987   31201.09\n1988   35870.97\n1989   40241.93\n1990   43520.53\nName: values, dtype: float64, ibnr_upper=origin\n1982    72568.93\n1983   188406.78\n1984   289619.79\n1985   389654.08\n1986   488162.80\n1987   580517.03\n1988   667404.98\n1989   748732.34\n1990   809739.40\nName: values, dtype: float64)\nDescribeResult(mean=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00 22799.06   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00 22560.59 22799.06   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00 22227.42 22560.59 22799.06   \n1987    557.00  4020.00 10946.00 12314.00 20320.41 22227.42 22560.59 22799.06   \n1988   1351.00  6947.00 13112.00 19568.73 20320.41 22227.42 22560.59 22799.06   \n1989   3133.00  5395.00 16013.73 19568.73 20320.41 22227.42 22560.59 22799.06   \n1990   2063.00 13812.49 16013.73 19568.73 20320.41 22227.42 22560.59 22799.06   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00 17280.71  \n1983   22747.00 22747.00  \n1984   22747.00 22747.00  \n1985   22747.00 22747.00  \n1986   22747.00 22747.00  \n1987   22747.00 22747.00  \n1988   22747.00 22747.00  \n1989   22747.00 22747.00  \n1990   22747.00 22747.00  , lower=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00  6829.01   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00  6757.57  6829.01   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00  6657.77  6757.57  6829.01   \n1987    557.00  4020.00 10946.00 12314.00  6086.50  6657.77  6757.57  6829.01   \n1988   1351.00  6947.00 13112.00  5861.33  6086.50  6657.77  6757.57  6829.01   \n1989   3133.00  5395.00  4796.39  5861.33  6086.50  6657.77  6757.57  6829.01   \n1990   2063.00  4136.98  4796.39  5861.33  6086.50  6657.77  6757.57  6829.01   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00  5175.93  \n1983    6813.41  6813.41  \n1984    6813.41  6813.41  \n1985    6813.41  6813.41  \n1986    6813.41  6813.41  \n1987    6813.41  6813.41  \n1988    6813.41  6813.41  \n1989    6813.41  6813.41  \n1990    6813.41  6813.41  , upper=dev         1        2        3        4        5        6        7        8   \\\norigin                                                                          \n1981   5012.00  8269.00 10907.00 11805.00 13539.00 16181.00 18009.00 18608.00   \n1982    106.00  4285.00  5396.00 10666.00 13782.00 15599.00 15496.00 16169.00   \n1983   3410.00  8992.00 13873.00 16141.00 18735.00 22214.00 22863.00 23466.00   \n1984   5655.00 11555.00 15766.00 21266.00 23425.00 26083.00 27067.00 76110.60   \n1985   1092.00  9565.00 15836.00 22169.00 25955.00 26180.00 75314.53 76110.60   \n1986   1513.00  6445.00 11702.00 12935.00 15852.00 74202.33 75314.53 76110.60   \n1987    557.00  4020.00 10946.00 12314.00 67836.33 74202.33 75314.53 76110.60   \n1988   1351.00  6947.00 13112.00 65327.03 67836.33 74202.33 75314.53 76110.60   \n1989   3133.00  5395.00 53459.67 65327.03 67836.33 74202.33 75314.53 76110.60   \n1990   2063.00 46111.46 53459.67 65327.03 67836.33 74202.33 75314.53 76110.60   \n\ndev          9        10  \norigin                    \n1981   18662.00 18834.00  \n1982   16704.00 57689.14  \n1983   75936.79 75936.79  \n1984   75936.79 75936.79  \n1985   75936.79 75936.79  \n1986   75936.79 75936.79  \n1987   75936.79 75936.79  \n1988   75936.79 75936.79  \n1989   75936.79 75936.79  \n1990   75936.79 75936.79  , ibnr_mean=origin\n1982    17280.71\n1983    45493.99\n1984    68293.05\n1985    90853.64\n1986   113081.06\n1987   133401.48\n1988   152970.20\n1989   168983.93\n1990   182796.42\nName: values, dtype: float64, ibnr_lower=origin\n1982    5175.93\n1983   13626.82\n1984   20455.83\n1985   27213.40\n1986   33871.17\n1987   39957.67\n1988   45818.99\n1989   50615.38\n1990   54752.36\nName: values, dtype: float64, ibnr_upper=origin\n1982    57689.14\n1983   151873.58\n1984   227984.18\n1985   303298.71\n1986   377501.04\n1987   445337.37\n1988   510664.40\n1989   564124.08\n1990   610235.54\nName: values, dtype: float64)\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nT. Moudiki's Webpage - R\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "R version Examples of use of Probabilistic Machine Learning (for longitudinal data) Reserving",
    "meta_keywords": null,
    "og_description": "R version Examples of use of Probabilistic Machine Learning (for longitudinal data) Reserving",
    "og_image": "https://thierrymoudiki.github.io/images/2025-06-05/2025-06-05-image1.png",
    "og_title": "R version of Probabilistic Machine Learning (for longitudinal data) Reserving (work in progress) | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 15.4,
    "sitemap_lastmod": null,
    "twitter_description": "R version Examples of use of Probabilistic Machine Learning (for longitudinal data) Reserving",
    "twitter_title": "R version of Probabilistic Machine Learning (for longitudinal data) Reserving (work in progress) | R-bloggers",
    "url": "https://www.r-bloggers.com/2025/06/r-version-of-probabilistic-machine-learning-for-longitudinal-data-reserving-work-in-progress/",
    "word_count": 3083
  }
}