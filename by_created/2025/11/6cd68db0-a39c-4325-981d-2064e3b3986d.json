{
  "uuid": "6cd68db0-a39c-4325-981d-2064e3b3986d",
  "created_at": "2025-11-17 20:39:21",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2023/11/grouped-sequences-in-dplyr-part-2/",
    "crawled_at": "2025-11-17T09:59:51.843578",
    "external_links": [
      {
        "href": "https://alan-y.netlify.com/post/grouped-sequences-in-dplyr-part-2/",
        "text": "R on Alan Yeung"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://alan-y.netlify.com/post/2023-11-05-grouped-sequences-in-dplyr",
        "text": "grouped sequences in dplyr"
      },
      {
        "href": "https://johnmackintosh.net/",
        "text": "John Mackintosh"
      },
      {
        "href": "https://alan-y.netlify.com/post/grouped-sequences-in-dplyr-part-2/",
        "text": "R on Alan Yeung"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Grouped Sequences in dplyr Part 2 | R-bloggers",
    "images": [],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/r-on-alan-yeung/",
        "text": "R on Alan Yeung"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-379745 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Grouped Sequences in dplyr Part 2</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">November 6, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/r-on-alan-yeung/\">R on Alan Yeung</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://alan-y.netlify.com/post/grouped-sequences-in-dplyr-part-2/\"> R on Alan Yeung</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<p>I just wrote a post about <a href=\"https://alan-y.netlify.com/post/2023-11-05-grouped-sequences-in-dplyr\" rel=\"nofollow\" target=\"_blank\">grouped sequences in dplyr</a> and following that, I’ve been made aware of another couple of solutions to this problem (credit <a href=\"https://johnmackintosh.net/\" rel=\"nofollow\" target=\"_blank\">John Mackintosh</a>). The solution involves using the <code>consecutive_id()</code> function, available in dplyr since v1.1.0. In the help page for this function, it’s mentioned that it was inspired by <code>rleid()</code> function from the <code>data.table</code> package. These functions work similarly to the <code>rle()</code> function I used last time (in what I called ‘the complicated solution’) but provide neater outputs. I’ll try them both out here.</p>\n<pre>library(tidyverse)\n\nsports_df &lt;- tibble::tribble(\n  ~team,    ~date,        ~home_or_away, ~num_matches_away,\n  \"Team A\", \"07/10/2022\", \"H\",           0L,\n  \"Team A\", \"14/10/2022\", \"A\",           1L,\n  \"Team A\", \"21/10/2022\", \"A\",           2L,\n  \"Team A\", \"28/10/2022\", \"H\",           0L,\n  \"Team A\", \"04/11/2022\", \"A\",           1L,\n  \"Team A\", \"11/11/2022\", \"A\",           2L,\n  \"Team A\", \"18/11/2022\", \"A\",           3L,\n  \"Team A\", \"25/11/2022\", \"H\",           0L,\n  \"Team A\", \"02/12/2022\", \"H\",           0L,\n  \"Team A\", \"09/12/2022\", \"H\",           0L,\n  \"Team B\", \"07/10/2022\", \"H\",           0L,\n  \"Team B\", \"14/10/2022\", \"A\",           1L,\n  \"Team B\", \"21/10/2022\", \"A\",           2L,\n  \"Team B\", \"28/10/2022\", \"A\",           3L,\n  \"Team B\", \"04/11/2022\", \"H\",           0L,\n  \"Team B\", \"11/11/2022\", \"A\",           1L,\n  \"Team B\", \"18/11/2022\", \"A\",           2L,\n  \"Team B\", \"25/11/2022\", \"H\",           0L,\n  \"Team B\", \"02/12/2022\", \"H\",           0L,\n  \"Team B\", \"09/12/2022\", \"A\",           1L\n) %&gt;%      \n  mutate(date = as.Date(date, \"%d/%m/%Y\")) %&gt;% \n  arrange(team, date)</pre>\n<div class=\"section level2\" id=\"dplyrconsecutive_id\">\n<h2>dplyr::consecutive_id()</h2>\n<pre>sports_df2 &lt;- sports_df %&gt;% \n  group_by(team) %&gt;% \n  mutate(consec_id = consecutive_id(home_or_away)) %&gt;% \n  group_by(team, consec_id) %&gt;% \n  mutate(days_on_road = 1:n(),\n         days_on_road = if_else(home_or_away == \"H\", 0L, days_on_road)) %&gt;% \n  ungroup()\n\nsports_df2\r\n## # A tibble: 20 × 6\n##    team   date       home_or_away num_matches_away consec_id days_on_road\n##    &lt;chr&gt;  &lt;date&gt;     &lt;chr&gt;                   &lt;int&gt;     &lt;int&gt;        &lt;int&gt;\n##  1 Team A 2022-10-07 H                           0         1            0\n##  2 Team A 2022-10-14 A                           1         2            1\n##  3 Team A 2022-10-21 A                           2         2            2\n##  4 Team A 2022-10-28 H                           0         3            0\n##  5 Team A 2022-11-04 A                           1         4            1\n##  6 Team A 2022-11-11 A                           2         4            2\n##  7 Team A 2022-11-18 A                           3         4            3\n##  8 Team A 2022-11-25 H                           0         5            0\n##  9 Team A 2022-12-02 H                           0         5            0\n## 10 Team A 2022-12-09 H                           0         5            0\n## 11 Team B 2022-10-07 H                           0         1            0\n## 12 Team B 2022-10-14 A                           1         2            1\n## 13 Team B 2022-10-21 A                           2         2            2\n## 14 Team B 2022-10-28 A                           3         2            3\n## 15 Team B 2022-11-04 H                           0         3            0\n## 16 Team B 2022-11-11 A                           1         4            1\n## 17 Team B 2022-11-18 A                           2         4            2\n## 18 Team B 2022-11-25 H                           0         5            0\n## 19 Team B 2022-12-02 H                           0         5            0\n## 20 Team B 2022-12-09 A                           1         6            1\r\nidentical(sports_df2$days_on_road, sports_df$num_matches_away)\r\n## [1] TRUE</pre>\n</div>\n<div class=\"section level2\" id=\"data.tablerleid\">\n<h2>data.table::rleid()</h2>\n<pre>sports_df3 &lt;- sports_df %&gt;% \n  group_by(team) %&gt;% \n  mutate(rleid_id = data.table::rleid(home_or_away)) %&gt;% \n  group_by(team, rleid_id) %&gt;% \n  mutate(days_on_road = 1:n(),\n         days_on_road = if_else(home_or_away == \"H\", 0L, days_on_road)) %&gt;% \n  ungroup()\n\nsports_df3\r\n## # A tibble: 20 × 6\n##    team   date       home_or_away num_matches_away rleid_id days_on_road\n##    &lt;chr&gt;  &lt;date&gt;     &lt;chr&gt;                   &lt;int&gt;    &lt;int&gt;        &lt;int&gt;\n##  1 Team A 2022-10-07 H                           0        1            0\n##  2 Team A 2022-10-14 A                           1        2            1\n##  3 Team A 2022-10-21 A                           2        2            2\n##  4 Team A 2022-10-28 H                           0        3            0\n##  5 Team A 2022-11-04 A                           1        4            1\n##  6 Team A 2022-11-11 A                           2        4            2\n##  7 Team A 2022-11-18 A                           3        4            3\n##  8 Team A 2022-11-25 H                           0        5            0\n##  9 Team A 2022-12-02 H                           0        5            0\n## 10 Team A 2022-12-09 H                           0        5            0\n## 11 Team B 2022-10-07 H                           0        1            0\n## 12 Team B 2022-10-14 A                           1        2            1\n## 13 Team B 2022-10-21 A                           2        2            2\n## 14 Team B 2022-10-28 A                           3        2            3\n## 15 Team B 2022-11-04 H                           0        3            0\n## 16 Team B 2022-11-11 A                           1        4            1\n## 17 Team B 2022-11-18 A                           2        4            2\n## 18 Team B 2022-11-25 H                           0        5            0\n## 19 Team B 2022-12-02 H                           0        5            0\n## 20 Team B 2022-12-09 A                           1        6            1\r\nidentical(sports_df3$days_on_road, sports_df$num_matches_away)\r\n## [1] TRUE</pre>\n<p>We now have 4 solutions to this problem – it’s often the case that there are many ways to do the same thing in R! It can be extra effort to remember different solutions but they work in different ways and can be applied to different problems so I do think it’s worthwhile trying these out. Which solution is your favourite?</p>\n</div>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://alan-y.netlify.com/post/grouped-sequences-in-dplyr-part-2/\"> R on Alan Yeung</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
    "main_text": "Grouped Sequences in dplyr Part 2\nPosted on\nNovember 6, 2023\nby\nR on Alan Yeung\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nR on Alan Yeung\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nI just wrote a post about\ngrouped sequences in dplyr\nand following that, I’ve been made aware of another couple of solutions to this problem (credit\nJohn Mackintosh\n). The solution involves using the\nconsecutive_id()\nfunction, available in dplyr since v1.1.0. In the help page for this function, it’s mentioned that it was inspired by\nrleid()\nfunction from the\ndata.table\npackage. These functions work similarly to the\nrle()\nfunction I used last time (in what I called ‘the complicated solution’) but provide neater outputs. I’ll try them both out here.\nlibrary(tidyverse)\n\nsports_df <- tibble::tribble(\n  ~team,    ~date,        ~home_or_away, ~num_matches_away,\n  \"Team A\", \"07/10/2022\", \"H\",           0L,\n  \"Team A\", \"14/10/2022\", \"A\",           1L,\n  \"Team A\", \"21/10/2022\", \"A\",           2L,\n  \"Team A\", \"28/10/2022\", \"H\",           0L,\n  \"Team A\", \"04/11/2022\", \"A\",           1L,\n  \"Team A\", \"11/11/2022\", \"A\",           2L,\n  \"Team A\", \"18/11/2022\", \"A\",           3L,\n  \"Team A\", \"25/11/2022\", \"H\",           0L,\n  \"Team A\", \"02/12/2022\", \"H\",           0L,\n  \"Team A\", \"09/12/2022\", \"H\",           0L,\n  \"Team B\", \"07/10/2022\", \"H\",           0L,\n  \"Team B\", \"14/10/2022\", \"A\",           1L,\n  \"Team B\", \"21/10/2022\", \"A\",           2L,\n  \"Team B\", \"28/10/2022\", \"A\",           3L,\n  \"Team B\", \"04/11/2022\", \"H\",           0L,\n  \"Team B\", \"11/11/2022\", \"A\",           1L,\n  \"Team B\", \"18/11/2022\", \"A\",           2L,\n  \"Team B\", \"25/11/2022\", \"H\",           0L,\n  \"Team B\", \"02/12/2022\", \"H\",           0L,\n  \"Team B\", \"09/12/2022\", \"A\",           1L\n) %>%      \n  mutate(date = as.Date(date, \"%d/%m/%Y\")) %>% \n  arrange(team, date)\ndplyr::consecutive_id()\nsports_df2 <- sports_df %>% \n  group_by(team) %>% \n  mutate(consec_id = consecutive_id(home_or_away)) %>% \n  group_by(team, consec_id) %>% \n  mutate(days_on_road = 1:n(),\n         days_on_road = if_else(home_or_away == \"H\", 0L, days_on_road)) %>% \n  ungroup()\n\nsports_df2\n## # A tibble: 20 × 6\n##    team   date       home_or_away num_matches_away consec_id days_on_road\n##    <chr>  <date>     <chr>                   <int>     <int>        <int>\n##  1 Team A 2022-10-07 H                           0         1            0\n##  2 Team A 2022-10-14 A                           1         2            1\n##  3 Team A 2022-10-21 A                           2         2            2\n##  4 Team A 2022-10-28 H                           0         3            0\n##  5 Team A 2022-11-04 A                           1         4            1\n##  6 Team A 2022-11-11 A                           2         4            2\n##  7 Team A 2022-11-18 A                           3         4            3\n##  8 Team A 2022-11-25 H                           0         5            0\n##  9 Team A 2022-12-02 H                           0         5            0\n## 10 Team A 2022-12-09 H                           0         5            0\n## 11 Team B 2022-10-07 H                           0         1            0\n## 12 Team B 2022-10-14 A                           1         2            1\n## 13 Team B 2022-10-21 A                           2         2            2\n## 14 Team B 2022-10-28 A                           3         2            3\n## 15 Team B 2022-11-04 H                           0         3            0\n## 16 Team B 2022-11-11 A                           1         4            1\n## 17 Team B 2022-11-18 A                           2         4            2\n## 18 Team B 2022-11-25 H                           0         5            0\n## 19 Team B 2022-12-02 H                           0         5            0\n## 20 Team B 2022-12-09 A                           1         6            1\nidentical(sports_df2$days_on_road, sports_df$num_matches_away)\n## [1] TRUE\ndata.table::rleid()\nsports_df3 <- sports_df %>% \n  group_by(team) %>% \n  mutate(rleid_id = data.table::rleid(home_or_away)) %>% \n  group_by(team, rleid_id) %>% \n  mutate(days_on_road = 1:n(),\n         days_on_road = if_else(home_or_away == \"H\", 0L, days_on_road)) %>% \n  ungroup()\n\nsports_df3\n## # A tibble: 20 × 6\n##    team   date       home_or_away num_matches_away rleid_id days_on_road\n##    <chr>  <date>     <chr>                   <int>    <int>        <int>\n##  1 Team A 2022-10-07 H                           0        1            0\n##  2 Team A 2022-10-14 A                           1        2            1\n##  3 Team A 2022-10-21 A                           2        2            2\n##  4 Team A 2022-10-28 H                           0        3            0\n##  5 Team A 2022-11-04 A                           1        4            1\n##  6 Team A 2022-11-11 A                           2        4            2\n##  7 Team A 2022-11-18 A                           3        4            3\n##  8 Team A 2022-11-25 H                           0        5            0\n##  9 Team A 2022-12-02 H                           0        5            0\n## 10 Team A 2022-12-09 H                           0        5            0\n## 11 Team B 2022-10-07 H                           0        1            0\n## 12 Team B 2022-10-14 A                           1        2            1\n## 13 Team B 2022-10-21 A                           2        2            2\n## 14 Team B 2022-10-28 A                           3        2            3\n## 15 Team B 2022-11-04 H                           0        3            0\n## 16 Team B 2022-11-11 A                           1        4            1\n## 17 Team B 2022-11-18 A                           2        4            2\n## 18 Team B 2022-11-25 H                           0        5            0\n## 19 Team B 2022-12-02 H                           0        5            0\n## 20 Team B 2022-12-09 A                           1        6            1\nidentical(sports_df3$days_on_road, sports_df$num_matches_away)\n## [1] TRUE\nWe now have 4 solutions to this problem – it’s often the case that there are many ways to do the same thing in R! It can be extra effort to remember different solutions but they work in different ways and can be applied to different problems so I do think it’s worthwhile trying these out. Which solution is your favourite?\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nR on Alan Yeung\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "I just wrote a post about grouped sequences in dplyr and following that, I’ve been made aware of another couple of solutions to this problem (credit John Mackintosh). The solution involves using the consecutive_id() function, available in dplyr sinc...",
    "meta_keywords": null,
    "og_description": "I just wrote a post about grouped sequences in dplyr and following that, I’ve been made aware of another couple of solutions to this problem (credit John Mackintosh). The solution involves using the consecutive_id() function, available in dplyr sinc...",
    "og_image": "https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png",
    "og_title": "Grouped Sequences in dplyr Part 2 | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 4.8,
    "sitemap_lastmod": "2023-11-07T00:00:00+00:00",
    "twitter_description": "I just wrote a post about grouped sequences in dplyr and following that, I’ve been made aware of another couple of solutions to this problem (credit John Mackintosh). The solution involves using the consecutive_id() function, available in dplyr sinc...",
    "twitter_title": "Grouped Sequences in dplyr Part 2 | R-bloggers",
    "url": "https://www.r-bloggers.com/2023/11/grouped-sequences-in-dplyr-part-2/",
    "word_count": 962
  }
}