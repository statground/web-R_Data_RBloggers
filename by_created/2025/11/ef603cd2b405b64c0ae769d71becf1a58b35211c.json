{
  "id": "ef603cd2b405b64c0ae769d71becf1a58b35211c",
  "url": "https://www.r-bloggers.com/2024/01/r-solution-for-excel-puzzles-6/",
  "created_at_utc": "2025-11-17T20:38:42Z",
  "data": null,
  "raw_original": {
    "uuid": "ae7ac35a-e454-4c6a-af6d-9c7cfbc1142b",
    "created_at": "2025-11-17 20:38:42",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2024/01/r-solution-for-excel-puzzles-6/",
      "crawled_at": "2025-11-17T09:25:00.979722",
      "external_links": [
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-5e687e0ddb82",
          "text": "Numbers around us - Medium"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://www.linkedin.com/in/excelbi/",
          "text": "ExcelBI"
        },
        {
          "href": "https://github.com/kgryczan/excelbi_puzzles",
          "text": "Github"
        },
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-5e687e0ddb82",
          "text": "R Solution for Excel Puzzles"
        },
        {
          "href": "https://medium.com/number-around-us",
          "text": "Numbers around us"
        },
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-5e687e0ddb82",
          "text": "Numbers around us - Medium"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "R Solution for Excel Puzzles | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*q4EDiWkxxoqXKD93CV7-Xg.jpeg?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*IVYk_DKkQ15QJ9Aau4RdQA.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/cdn-images-1.medium.com/max/835/1*YA7nV075UTyhnJ0qB5hKMQ.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*5bzM6QTbn2BAcOctQ9GCaA.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*_S9z9jXOODjknLb1Du2P0A.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*R3b4rzg1f-CFAUQmBQF4Ew.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*GRY9eHqfPj1vF_nrvuQvDA.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": "data:application/octet-stream;base64,R0lGODlhAQABAO+/vQAA77+977+977+9AAAAIe+/vQQBAAAAACwAAAAAAQABAAACAkQBADs=",
          "src": "https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=5e687e0ddb82"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/numbers-around-us/",
          "text": "Numbers around us"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-381246 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">R Solution for Excel Puzzles</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">January 2, 2024</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/numbers-around-us/\">Numbers around us</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-5e687e0ddb82\"> Numbers around us - Medium</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*q4EDiWkxxoqXKD93CV7-Xg.jpeg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*q4EDiWkxxoqXKD93CV7-Xg.jpeg?w=578&amp;ssl=1\"/></noscript></figure><p>Puzzles no.¬†354‚Äì358</p><h3>Puzzles</h3><p>Author: <a href=\"https://www.linkedin.com/in/excelbi/\" rel=\"nofollow\" target=\"_blank\">ExcelBI</a></p><p>From this week all files (xlsx with puzzle and R with solution) for each and every puzzle are available on my <a href=\"https://github.com/kgryczan/excelbi_puzzles\" rel=\"nofollow\" target=\"_blank\">Github</a>.¬†Enjoy.</p><h3>Puzzle #354</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*IVYk_DKkQ15QJ9Aau4RdQA.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*IVYk_DKkQ15QJ9Aau4RdQA.png?w=578&amp;ssl=1\"/></noscript></figure><p>This puzzle comes up on Christmas (Dec, 25th), so it was not really suprising that topic to solve will be somekind linked to Christmas. This time we do not have to count, calculate or process anything‚Ä¶ Our goal was to make Christmas Tree Generator. After changing input variable value, we were generating Christmas tree with different width.</p><h4>Load libraries</h4><pre>library(tidyverse)\nlibrary(crayon)</pre><h4>Function</h4><pre>print_christmas_tree &lt;- function(n) {\n  for(i in 1:n) {\n    spaces &lt;- strrep(\" \", n - i)\n    asterisks &lt;- strrep(\"*\", 2 * i - 1)\n    cat(spaces, green(asterisks), spaces, \"\\n\")\n  }\n  \n  trunk_spaces &lt;- strrep(\" \", n - 1)\n  for(i in 1:2) {\n    cat(trunk_spaces, red(\"*\"), trunk_spaces, \"\\n\")\n  }\n  cat(strrep(\" \", n - 2), red(\"***\"), strrep(\" \", n - 2), \"\\n\")\n}</pre><h4>Christmas trees¬†üôÇ</h4><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/835/1*YA7nV075UTyhnJ0qB5hKMQ.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/835/1*YA7nV075UTyhnJ0qB5hKMQ.png?w=578&amp;ssl=1\"/></noscript></figure><h3>Puzzle #355</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*5bzM6QTbn2BAcOctQ9GCaA.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*5bzM6QTbn2BAcOctQ9GCaA.png?w=578&amp;ssl=1\"/></noscript></figure><p>From cosy atmosphere of Xmas we are going into vast spaces of the Internet. What we have exactly to do is to check if given IP address (from IPv6 range) is correct. We are given some clues how to recognize proper IP and what can an excluding signal.</p><ol><li>IPv6 address is represented as x:x:x:x:x:x:x:x (total 8 x) where x consists of 1 to 4 Hexadecimal digits.</li><li>Leading 0s can be omitted. Hence, 00A6 can be written as¬†A6</li><li>Double colons (::) can be used in place of a series of zeros. For example, IPv6 address CD34:0:0:0:0:0:0:A4 can be written as CD34::A4.</li><li>Double colons can be used only once in an IP¬†address.</li></ol><p>So lets check those addresses.</p><h4>Load libraries and¬†data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/355 Valid IPv6 Addresses.xlsx\", range = \"A1:B10\") %&gt;%\n  janitor::clean_names()\ntest  = read_excel(\"Excel/355 Valid IPv6 Addresses.xlsx\", range = \"C1:C5\") %&gt;%\n  janitor::clean_names()</pre><h4>Transformation</h4><pre>is_hexadecimal &lt;- function(x) {\n  str_detect(x, \"^[0-9a-fA-F]+$\")\n}\n\nis_ipv6 &lt;- function(ip) {\n  if (str_detect(ip, \":::\") || str_detect(ip, \":\") &gt; 7) {\n    return(FALSE)\n  }\n  \n  parts = str_split(ip, \":\", simplify = TRUE)\n  \n  if (str_detect(ip, \"::\")) {\n    missing_parts = 8 - length(parts[parts != \"\"])\n    parts = parts[parts != \"\"]\n    parts = c(parts, rep(\"0\", missing_parts))\n  }\n  \n  length(parts) == 8 \n  &amp;&amp; all(map_lgl(parts, is_hexadecimal)) \n  &amp;&amp; all(map_lgl(parts, ~ nchar(.) &lt;= 4))\n}\n\nresult = input %&gt;%\n  mutate(check = map_lgl(i_pv6_address, is_ipv6)) %&gt;%\n  filter(check == TRUE) %&gt;%\n  select(i_pv6_address)</pre><h4>Validation</h4><pre>identical(result$i_pv6_address, test$answer_expected)\n#&gt; [1] TRUE</pre><h3>Puzzle #356</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*_S9z9jXOODjknLb1Du2P0A.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*_S9z9jXOODjknLb1Du2P0A.png?w=578&amp;ssl=1\"/></noscript></figure><p>Today we are counting, sorting and comparing. But case is not really hard. We have to check big numbers for following condition:</p><ul><li>check what is frequency of biggest¬†digit</li><li>list all digits that are more frequent in this number than the biggest¬†one.</li></ul><p>So lets¬†go.</p><h4>Load libraries and¬†data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/356 Count Digit Frequencies.xlsx\", range = \"A1:A10\")\ntest  = read_excel(\"Excel/356 Count Digit Frequencies.xlsx\", range = \"B1:B10\")</pre><h4>Transformation</h4><pre>evaluate = function(number) {\n  result = str_split(number, \"\")[[1]] %&gt;%\n    table() %&gt;%\n    as.data.frame() %&gt;%\n    select(digit = 1, freq = 2) %&gt;%\n    mutate(digit = as.numeric(as.character(digit)),\n           freq_of_max = freq[which.max(digit)]) %&gt;%\n    filter(freq &gt; freq_of_max) %&gt;%\n    pull(digit) %&gt;%\n    paste0(collapse = \", \") %&gt;%\n    ifelse(nchar(.) == 0, NA, .)\n  return(result)  \n}\n\nresult = input %&gt;%\n  mutate(Digits = map_chr(Numbers, evaluate))</pre><h4>Validation</h4><pre>identical(result$Digits, test$Digits)\n# [1] TRUE</pre><h3>Puzzle #357</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*R3b4rzg1f-CFAUQmBQF4Ew.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*R3b4rzg1f-CFAUQmBQF4Ew.png?w=578&amp;ssl=1\"/></noscript></figure><p>This time we have problem linked with dictionary (which is not very popular in R). Object of this kind are very popular and commonly used in Python. And what we exactly have to do is to construct dictionary (pair or pairs of Keys and Values) from two separate lists (Keys in one and Values in second). In Python there is function called zip which similarly like real life zip get alternally one value from Keys, one from Values, bind them and then go to next. But we can do it differently as¬†well.</p><h4>Load libraries and¬†data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/357 Prepare Dictionary.xlsx\", range = \"A1:B7\")\ntest  = read_excel(\"Excel/357 Prepare Dictionary.xlsx\", range = \"C1:C7\")</pre><h4>Transformation</h4><pre>process = function(key, value) {\n  keys = strsplit(key, \", \")[[1]]\n  values = strsplit(value, \", \")[[1]]\n  tib = tibble(key = keys, value = values) %&gt;%\n    filter(!key %in% c(\"a\",\"e\",\"i\",\"o\",\"u\")) %&gt;%\n    unite(\"dict\", key, value, sep = \":\") %&gt;% \n    pull(dict) %&gt;%\n    paste0(., collapse = \", \") %&gt;%\n    ifelse(. == \"\", NA, .)\n  return(tib)\n}\n\nresult = input %&gt;%\n  mutate(dict = map2_chr(Key, Value, process))</pre><h4>Validation</h4><pre>identical(result$dict, test$`Answer Expected`)\n#&gt; [1] TRUE</pre><h3>Puzzle #358</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*GRY9eHqfPj1vF_nrvuQvDA.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*GRY9eHqfPj1vF_nrvuQvDA.png?w=578&amp;ssl=1\"/></noscript></figure><p>Not really long ago we had similar task, but then we were checking what the sum of digits in diagonals is. Today we ‚Äúonly‚Äù have to get both diagonals and ‚Äústraight‚Äù it up to be columns. Lets do¬†it.</p><h4>Load libraries and¬†data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput_1 = read_excel(\"Excel/358 Stack Diagonal Values.xlsx\", \n                     range = \"A2:C4\", col_names = F) %&gt;%  as.matrix()\ninput_2 = read_excel(\"Excel/358 Stack Diagonal Values.xlsx\", \n                     range = \"A6:D9\",  col_names = F) %&gt;% as.matrix()\ninput_3 = read_excel(\"Excel/358 Stack Diagonal Values.xlsx\", \n                     range = \"A11:E15\", col_names = F) %&gt;% as.matrix()\n\ntest_1 = read_excel(\"Excel/358 Stack Diagonal Values.xlsx\", \n                    range = \"G2:H4\", col_names = c(\"A\", \"B\"))\ntest_2 = read_excel(\"Excel/358 Stack Diagonal Values.xlsx\", \n                    range = \"G6:H9\", col_names = c(\"A\", \"B\"))\ntest_3 = read_excel(\"Excel/358 Stack Diagonal Values.xlsx\", \n                    range = \"G11:H15\", col_names = c(\"A\", \"B\"))</pre><h4>Transformation and validation</h4><pre>get_diagonals = function(M) {\n  result = tibble(\n    A = diag(M),\n    B = diag(M[, ncol(M):1])\n  )\n  return(result)\n}\n\nidentical(test_1, get_diagonals(input_1))\n#&gt; [1] TRUE\nidentical(test_2, get_diagonals(input_2))\n#&gt; [1] TRUE\nidentical(test_3, get_diagonals(input_3))\n#&gt; [1] TRUE</pre><p>Feel free to comment, share and contact me with advices, questions and your ideas how to improve anything.</p><img alt=\"\" data-lazy-src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=5e687e0ddb82\" height=\"1\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"1\"/><noscript><img alt=\"\" height=\"1\" loading=\"lazy\" src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=5e687e0ddb82\" width=\"1\"/></noscript><hr/><p><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-5e687e0ddb82\" rel=\"nofollow\" target=\"_blank\">R Solution for Excel Puzzles</a> was originally published in <a href=\"https://medium.com/number-around-us\" rel=\"nofollow\" target=\"_blank\">Numbers around us</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-5e687e0ddb82\"> Numbers around us - Medium</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
      "main_text": "R Solution for Excel Puzzles\nPosted on\nJanuary 2, 2024\nby\nNumbers around us\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nNumbers around us - Medium\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nPuzzles no.¬†354‚Äì358\nPuzzles\nAuthor:\nExcelBI\nFrom this week all files (xlsx with puzzle and R with solution) for each and every puzzle are available on my\nGithub\n.¬†Enjoy.\nPuzzle #354\nThis puzzle comes up on Christmas (Dec, 25th), so it was not really suprising that topic to solve will be somekind linked to Christmas. This time we do not have to count, calculate or process anything‚Ä¶ Our goal was to make Christmas Tree Generator. After changing input variable value, we were generating Christmas tree with different width.\nLoad libraries\nlibrary(tidyverse)\nlibrary(crayon)\nFunction\nprint_christmas_tree <- function(n) {\n  for(i in 1:n) {\n    spaces <- strrep(\" \", n - i)\n    asterisks <- strrep(\"*\", 2 * i - 1)\n    cat(spaces, green(asterisks), spaces, \"\\n\")\n  }\n  \n  trunk_spaces <- strrep(\" \", n - 1)\n  for(i in 1:2) {\n    cat(trunk_spaces, red(\"*\"), trunk_spaces, \"\\n\")\n  }\n  cat(strrep(\" \", n - 2), red(\"***\"), strrep(\" \", n - 2), \"\\n\")\n}\nChristmas trees¬†üôÇ\nPuzzle #355\nFrom cosy atmosphere of Xmas we are going into vast spaces of the Internet. What we have exactly to do is to check if given IP address (from IPv6 range) is correct. We are given some clues how to recognize proper IP and what can an excluding signal.\nIPv6 address is represented as x:x:x:x:x:x:x:x (total 8 x) where x consists of 1 to 4 Hexadecimal digits.\nLeading 0s can be omitted. Hence, 00A6 can be written as¬†A6\nDouble colons (::) can be used in place of a series of zeros. For example, IPv6 address CD34:0:0:0:0:0:0:A4 can be written as CD34::A4.\nDouble colons can be used only once in an IP¬†address.\nSo lets check those addresses.\nLoad libraries and¬†data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/355 Valid IPv6 Addresses.xlsx\", range = \"A1:B10\") %>%\n  janitor::clean_names()\ntest  = read_excel(\"Excel/355 Valid IPv6 Addresses.xlsx\", range = \"C1:C5\") %>%\n  janitor::clean_names()\nTransformation\nis_hexadecimal <- function(x) {\n  str_detect(x, \"^[0-9a-fA-F]+$\")\n}\n\nis_ipv6 <- function(ip) {\n  if (str_detect(ip, \":::\") || str_detect(ip, \":\") > 7) {\n    return(FALSE)\n  }\n  \n  parts = str_split(ip, \":\", simplify = TRUE)\n  \n  if (str_detect(ip, \"::\")) {\n    missing_parts = 8 - length(parts[parts != \"\"])\n    parts = parts[parts != \"\"]\n    parts = c(parts, rep(\"0\", missing_parts))\n  }\n  \n  length(parts) == 8 \n  && all(map_lgl(parts, is_hexadecimal)) \n  && all(map_lgl(parts, ~ nchar(.) <= 4))\n}\n\nresult = input %>%\n  mutate(check = map_lgl(i_pv6_address, is_ipv6)) %>%\n  filter(check == TRUE) %>%\n  select(i_pv6_address)\nValidation\nidentical(result$i_pv6_address, test$answer_expected)\n#> [1] TRUE\nPuzzle #356\nToday we are counting, sorting and comparing. But case is not really hard. We have to check big numbers for following condition:\ncheck what is frequency of biggest¬†digit\nlist all digits that are more frequent in this number than the biggest¬†one.\nSo lets¬†go.\nLoad libraries and¬†data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/356 Count Digit Frequencies.xlsx\", range = \"A1:A10\")\ntest  = read_excel(\"Excel/356 Count Digit Frequencies.xlsx\", range = \"B1:B10\")\nTransformation\nevaluate = function(number) {\n  result = str_split(number, \"\")[[1]] %>%\n    table() %>%\n    as.data.frame() %>%\n    select(digit = 1, freq = 2) %>%\n    mutate(digit = as.numeric(as.character(digit)),\n           freq_of_max = freq[which.max(digit)]) %>%\n    filter(freq > freq_of_max) %>%\n    pull(digit) %>%\n    paste0(collapse = \", \") %>%\n    ifelse(nchar(.) == 0, NA, .)\n  return(result)  \n}\n\nresult = input %>%\n  mutate(Digits = map_chr(Numbers, evaluate))\nValidation\nidentical(result$Digits, test$Digits)\n# [1] TRUE\nPuzzle #357\nThis time we have problem linked with dictionary (which is not very popular in R). Object of this kind are very popular and commonly used in Python. And what we exactly have to do is to construct dictionary (pair or pairs of Keys and Values) from two separate lists (Keys in one and Values in second). In Python there is function called zip which similarly like real life zip get alternally one value from Keys, one from Values, bind them and then go to next. But we can do it differently as¬†well.\nLoad libraries and¬†data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/357 Prepare Dictionary.xlsx\", range = \"A1:B7\")\ntest  = read_excel(\"Excel/357 Prepare Dictionary.xlsx\", range = \"C1:C7\")\nTransformation\nprocess = function(key, value) {\n  keys = strsplit(key, \", \")[[1]]\n  values = strsplit(value, \", \")[[1]]\n  tib = tibble(key = keys, value = values) %>%\n    filter(!key %in% c(\"a\",\"e\",\"i\",\"o\",\"u\")) %>%\n    unite(\"dict\", key, value, sep = \":\") %>% \n    pull(dict) %>%\n    paste0(., collapse = \", \") %>%\n    ifelse(. == \"\", NA, .)\n  return(tib)\n}\n\nresult = input %>%\n  mutate(dict = map2_chr(Key, Value, process))\nValidation\nidentical(result$dict, test$`Answer Expected`)\n#> [1] TRUE\nPuzzle #358\nNot really long ago we had similar task, but then we were checking what the sum of digits in diagonals is. Today we ‚Äúonly‚Äù have to get both diagonals and ‚Äústraight‚Äù it up to be columns. Lets do¬†it.\nLoad libraries and¬†data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput_1 = read_excel(\"Excel/358 Stack Diagonal Values.xlsx\", \n                     range = \"A2:C4\", col_names = F) %>%  as.matrix()\ninput_2 = read_excel(\"Excel/358 Stack Diagonal Values.xlsx\", \n                     range = \"A6:D9\",  col_names = F) %>% as.matrix()\ninput_3 = read_excel(\"Excel/358 Stack Diagonal Values.xlsx\", \n                     range = \"A11:E15\", col_names = F) %>% as.matrix()\n\ntest_1 = read_excel(\"Excel/358 Stack Diagonal Values.xlsx\", \n                    range = \"G2:H4\", col_names = c(\"A\", \"B\"))\ntest_2 = read_excel(\"Excel/358 Stack Diagonal Values.xlsx\", \n                    range = \"G6:H9\", col_names = c(\"A\", \"B\"))\ntest_3 = read_excel(\"Excel/358 Stack Diagonal Values.xlsx\", \n                    range = \"G11:H15\", col_names = c(\"A\", \"B\"))\nTransformation and validation\nget_diagonals = function(M) {\n  result = tibble(\n    A = diag(M),\n    B = diag(M[, ncol(M):1])\n  )\n  return(result)\n}\n\nidentical(test_1, get_diagonals(input_1))\n#> [1] TRUE\nidentical(test_2, get_diagonals(input_2))\n#> [1] TRUE\nidentical(test_3, get_diagonals(input_3))\n#> [1] TRUE\nFeel free to comment, share and contact me with advices, questions and your ideas how to improve anything.\nR Solution for Excel Puzzles\nwas originally published in\nNumbers around us\non Medium, where people are continuing the conversation by highlighting and responding to this story.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nNumbers around us - Medium\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Puzzles no. 354‚Äì358PuzzlesAuthor: ExcelBIFrom this week all files (xlsx with puzzle and R with solution) for each and every puzzle are available on my Github. Enjoy.Puzzle #354This puzzle comes up on Christmas (Dec, 25th), so it was not really suprisin...",
      "meta_keywords": null,
      "og_description": "Puzzles no. 354‚Äì358PuzzlesAuthor: ExcelBIFrom this week all files (xlsx with puzzle and R with solution) for each and every puzzle are available on my Github. Enjoy.Puzzle #354This puzzle comes up on Christmas (Dec, 25th), so it was not really suprisin...",
      "og_image": "https://cdn-images-1.medium.com/max/1024/1*q4EDiWkxxoqXKD93CV7-Xg.jpeg",
      "og_title": "R Solution for Excel Puzzles | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 5.3,
      "sitemap_lastmod": "2024-01-02T18:37:14+00:00",
      "twitter_description": "Puzzles no. 354‚Äì358PuzzlesAuthor: ExcelBIFrom this week all files (xlsx with puzzle and R with solution) for each and every puzzle are available on my Github. Enjoy.Puzzle #354This puzzle comes up on Christmas (Dec, 25th), so it was not really suprisin...",
      "twitter_title": "R Solution for Excel Puzzles | R-bloggers",
      "url": "https://www.r-bloggers.com/2024/01/r-solution-for-excel-puzzles-6/",
      "word_count": 1067
    }
  }
}