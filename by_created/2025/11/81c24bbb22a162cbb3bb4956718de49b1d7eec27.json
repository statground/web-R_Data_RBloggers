{
  "id": "81c24bbb22a162cbb3bb4956718de49b1d7eec27",
  "url": "https://www.r-bloggers.com/2025/01/pentomino-solution-patchwork/",
  "created_at_utc": "2025-11-22T19:59:28Z",
  "data": null,
  "raw_original": {
    "uuid": "faae779b-9900-44aa-ab02-7daeb9937778",
    "created_at": "2025-11-22 19:59:28",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2025/01/pentomino-solution-patchwork/",
      "crawled_at": "2025-11-22T10:55:44.373357",
      "external_links": [
        {
          "href": "https://chichacha.github.io/chi-files/posts/pentomino/pentomino_part4.html",
          "text": "CHI(œá)-Files"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://isomerdesign.com/Pentomino/",
          "text": "Pentomino puzzle solutions"
        },
        {
          "href": "https://r-spatial.github.io/sf/",
          "text": "sf"
        },
        {
          "href": "https://tidygraph.data-imaginist.com/reference/index.html",
          "text": "tidygraph"
        },
        {
          "href": "https://ggraph.data-imaginist.com/",
          "text": "ggraph"
        },
        {
          "href": "https://www.tidyverse.org/",
          "text": "tidyverse"
        },
        {
          "href": "https://tidygraph.data-imaginist.com/reference/index.html",
          "text": "tidygraph"
        },
        {
          "href": "https://ggraph.data-imaginist.com/",
          "text": "ggraph"
        },
        {
          "href": "https://patchwork.data-imaginist.com/index.html",
          "text": "patchwork"
        },
        {
          "href": "https://patchwork.data-imaginist.com/reference/wrap_plots.html",
          "text": "wrap_plots() function"
        },
        {
          "href": "https://chichacha.github.io/chi-files/posts/pentomino/pentomino_part4.html",
          "text": "CHI(œá)-Files"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Pentomino Solution & Patchwork | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/chichacha.github.io/chi-files/posts/pentomino/pentomino_part4_files/figure-html/unnamed-chunk-3-1.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/chichacha.github.io/chi-files/posts/pentomino/pentomino_part4_files/figure-html/unnamed-chunk-4-1.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/chichacha.github.io/chi-files/posts/pentomino/pentomino_part4_files/figure-html/unnamed-chunk-8-1.png?w=450&ssl=1"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/chisato/",
          "text": "Chisato"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-393195 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Pentomino Solution &amp; Patchwork</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">January 16, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/chisato/\">Chisato</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://chichacha.github.io/chi-files/posts/pentomino/pentomino_part4.html\"> CHI(œá)-Files</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<section class=\"level3\" id=\"pentomino-solution-as-igraph-object\">\n<h3 class=\"anchored\" data-anchor-id=\"pentomino-solution-as-igraph-object\">Pentomino Solution as <code>igraph</code> object</h3>\n<p>In this post, I‚Äôm taking deeper dive into a dataset of <a href=\"https://isomerdesign.com/Pentomino/\" rel=\"nofollow\" target=\"_blank\">Pentomino puzzle solutions</a> using R. This time, I‚Äôm switching gears from the <a href=\"https://r-spatial.github.io/sf/\" rel=\"nofollow\" target=\"_blank\">sf</a> package, but to explore graph theory concepts with <a href=\"https://tidygraph.data-imaginist.com/reference/index.html\" rel=\"nofollow\" target=\"_blank\">tidygraph</a> and <a href=\"https://ggraph.data-imaginist.com/\" rel=\"nofollow\" target=\"_blank\">ggraph</a>. Why? Because Pentomino solutions aren‚Äôt just puzzles; they‚Äôre networks waiting to be uncovered! üåê</p>\n<p>What‚Äôs on the menu? üç¥</p>\n<ul>\n<li>Data Wrangling with <a href=\"https://www.tidyverse.org/\" rel=\"nofollow\" target=\"_blank\">tidyverse</a></li>\n<li>Graphs and graph-based data structures with <a href=\"https://tidygraph.data-imaginist.com/reference/index.html\" rel=\"nofollow\" target=\"_blank\">tidygraph</a> and visualization with <a href=\"https://ggraph.data-imaginist.com/\" rel=\"nofollow\" target=\"_blank\">ggraph</a></li>\n<li>Arranging Multiple Plots effortlessly with <a href=\"https://patchwork.data-imaginist.com/index.html\" rel=\"nofollow\" target=\"_blank\"><code>patchwork</code></a>. The <a href=\"https://patchwork.data-imaginist.com/reference/wrap_plots.html\" rel=\"nofollow\" target=\"_blank\">wrap_plots() function</a> function was a lifesaver, sparing me from the monotony of typing plot1 + plot2 + ‚Ä¶ repeatedly! üôå</li>\n</ul>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Setups and Pakcages Used</summary>\n<pre># Load required libraries\nlibrary(tidyverse)    # Data wrangling and general utilities\nlibrary(ggraph)       # Graph visualization\nlibrary(tidygraph)    # Graph data structure (tbl_graph) + graph algorithms\nlibrary(ggforce)      # Extra geoms for ggplot2\nlibrary(cowplot)      # Additional plotting helpers\nlibrary(patchwork)    # Combine multiple ggplots effortlessly!</pre>\n</details>\n</div>\n</section>\n<section class=\"level3\" id=\"original-solution-dataset\">\n<h3 class=\"anchored\" data-anchor-id=\"original-solution-dataset\">Original Solution Dataset</h3>\n<p>I‚Äôve saved solution as csv file from earlier blog posts. So just retriving the dataset. Solution looks like below.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Reading Solution Dataset</summary>\n<pre>### Read solution data frame from Github \npento_sol &lt;- read_csv(\"https://raw.githubusercontent.com/chichacha/pentomino/refs/heads/main/pentomino_solution.csv\")\n\nsample_n(pento_sol, size=5) |&gt;\n  knitr::kable(\"markdown\")</pre>\n</details>\n<div class=\"cell-output-display\">\n<table class=\"caption-top table table-sm table-striped small\">\n<colgroup>\n<col style=\"width: 4%\"/>\n<col style=\"width: 71%\"/>\n<col style=\"width: 7%\"/>\n<col style=\"width: 7%\"/>\n<col style=\"width: 7%\"/>\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th style=\"text-align: left;\">dim</th>\n<th style=\"text-align: left;\">sol_text</th>\n<th style=\"text-align: right;\">row_cnt</th>\n<th style=\"text-align: right;\">col_cnt</th>\n<th style=\"text-align: right;\">sol_idx</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">5√ó10</td>\n<td style=\"text-align: left;\">LLLLTTTNNN UUULWTNNFF UPUWWTYFFV PPWWYYYYFV PPIIIIIVVV</td>\n<td style=\"text-align: right;\">5</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">5427</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">6√ó10</td>\n<td style=\"text-align: left;\">IIIIIXYYYY VVVFXXXNYW VTFFFXNNWW VTTTFZNWWP UTUZZZNLPP UUUZLLLLPP</td>\n<td style=\"text-align: right;\">6</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">707</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">5√ó9</td>\n<td style=\"text-align: left;\">IIIIIFVVV UUPPFFFTV UPPPZZFTV UUNNZLTTT NNNZZLLLL</td>\n<td style=\"text-align: right;\">5</td>\n<td style=\"text-align: right;\">9</td>\n<td style=\"text-align: right;\">1024</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">8√ó8d</td>\n<td style=\"text-align: left;\">.FFNNNX. FFNNYXXX IFYYYYXT ILLLLTTT IVVVLWWT IVZZWWPP IVZUWUPP .ZZUUUP.</td>\n<td style=\"text-align: right;\">8</td>\n<td style=\"text-align: right;\">8</td>\n<td style=\"text-align: right;\">133</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">5√ó11</td>\n<td style=\"text-align: left;\">LLLLFZZNTTT LXFFFVZNNTY XXXFPVZZNTY UXUPPVVVNYY UUUPPIIIIIY</td>\n<td style=\"text-align: right;\">5</td>\n<td style=\"text-align: right;\">11</td>\n<td style=\"text-align: right;\">2837</td>\n</tr>\n</tbody>\n</table>\n</div>\n</div>\n<section class=\"level4\" id=\"just-prepping-colors\">\n<h4 class=\"anchored\" data-anchor-id=\"just-prepping-colors\">Just prepping colors</h4>\n<p>To make our graphs visually fun, I‚Äôm just using retro-inspired color palette and assign unique colors to each Pentomino piece.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Prepping Color Palette</summary>\n<pre># Just Prepping some color palette\nretro &lt;-  c(\"#00A0B0\", \"#6A4A3C\", \"#CC333F\", \"#EB6841\", \"#EDC951\")\nretro12 &lt;- colorRampPalette(retro)(12)\nretro13 &lt;- c(retro12,\"#ffffff\")\n\n#Assigning names to each color allows direct mapping with scale_color_manual() or scale_fill_manual()\npiece &lt;- c(\"F\",\"I\",\"L\",\"N\",\"P\",\"T\",\"U\",\"V\",\"W\",\"X\",\"Y\",\"Z\")\nnames(retro12) &lt;- piece\nnames(retro13) &lt;- c(piece,\".\")\n\nretro12 |&gt; enframe() |&gt;\n  ggplot(aes(x=name,y=1)) +\n  geom_tile(aes(fill=I(value))) +\n  geom_text(aes(label=name), color=\"white\",vjust=-0.5) +\n  geom_text(aes(label=value), color=\"white\",vjust=1, size=3) +\n  theme_nothing()</pre>\n</details>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/chichacha.github.io/chi-files/posts/pentomino/pentomino_part4_files/figure-html/unnamed-chunk-3-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/chichacha.github.io/chi-files/posts/pentomino/pentomino_part4_files/figure-html/unnamed-chunk-3-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n</section>\n</section>\n<section class=\"level3\" id=\"converting-solution-to-xy-positions\">\n<h3 class=\"anchored\" data-anchor-id=\"converting-solution-to-xy-positions\">Converting Solution to (x,y) Positions üìê</h3>\n<p>Next, we‚Äôll transform each solution into (x, y) coordinates. This step is crucial for graph creation. I‚Äôve listed a visualization &amp; table of some 3√ó5 Pentomino solutions, mapped to their (x, y) position.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Converting Solution Texts to Data Frame with Coordinates</summary>\n<pre>### Convert Solution to XY position data frame\npento_sol_df &lt;- pento_sol |&gt;\n  mutate(solution_num = row_number()) |&gt;\n  mutate(sol_text = str_split(sol_text, \" \")) |&gt;\n  unnest(sol_text) |&gt;\n  group_by(solution_num) |&gt;\n  mutate(y = row_number()) |&gt;\n  ungroup() |&gt;\n  mutate(sol_text = str_split(sol_text, \"\")) |&gt;\n  unnest(sol_text) |&gt;\n  group_by(solution_num, y) |&gt;\n  mutate(x = row_number()) |&gt;\n  ungroup()\n\n\n# Split the data into chunks programmatically\ntables &lt;- pento_sol_df |&gt; \n  filter(dim == \"5√ó3\", sol_idx == 1) |&gt;\n  select(dim, sol_text, x, y) |&gt;\n  group_split(x)\n\npento_sol_df |&gt; \n  filter(dim == \"5√ó3\", sol_idx %in% c(1:6)) |&gt;\n  mutate(sol_idx=if_else(sol_idx==1, str_c(\"1. See Table Below\"), as.character(sol_idx))) |&gt;\n  ggplot(aes(x=x,y=y)) +\n  geom_point(aes(color=sol_text),size=10) +\n  geom_text(aes(label=sol_text), color=\"#fffff3\") +\n  scale_color_manual(values=retro12, guide=\"none\") +\n  theme_minimal() +\n  facet_wrap(~sol_idx,ncol=6) +\n  coord_fixed() +\n  scale_x_continuous(expand=expansion(add=1)) +\n  scale_y_continuous(expand=expansion(add=1))</pre>\n</details>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/chichacha.github.io/chi-files/posts/pentomino/pentomino_part4_files/figure-html/unnamed-chunk-4-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/chichacha.github.io/chi-files/posts/pentomino/pentomino_part4_files/figure-html/unnamed-chunk-4-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n<div>\n</div>\n<div class=\"quarto-layout-panel anchored\" data-layout-ncol=\"3\" id=\"tbl-panel\">\n<div class=\"quarto-layout-row\">\n<div class=\"quarto-layout-cell\" style=\"flex-basis: 33.3%;justify-content: center;\">\n<table class=\"caption-top table\">\n<thead>\n<tr class=\"header\">\n<th style=\"text-align: left;\">dim</th>\n<th style=\"text-align: left;\">sol_text</th>\n<th style=\"text-align: right;\">x</th>\n<th style=\"text-align: right;\">y</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">L</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">1</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">L</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">2</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">L</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">3</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">L</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">4</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">V</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">5</td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"quarto-layout-cell\" style=\"flex-basis: 33.3%;justify-content: center;\">\n<table class=\"caption-top table\">\n<thead>\n<tr class=\"header\">\n<th style=\"text-align: left;\">dim</th>\n<th style=\"text-align: left;\">sol_text</th>\n<th style=\"text-align: right;\">x</th>\n<th style=\"text-align: right;\">y</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">L</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">1</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">N</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">2</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">N</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">3</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">N</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">4</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">V</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">5</td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"quarto-layout-cell\" style=\"flex-basis: 33.3%;justify-content: center;\">\n<table class=\"caption-top table\">\n<thead>\n<tr class=\"header\">\n<th style=\"text-align: left;\">dim</th>\n<th style=\"text-align: left;\">sol_text</th>\n<th style=\"text-align: right;\">x</th>\n<th style=\"text-align: right;\">y</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">N</td>\n<td style=\"text-align: right;\">3</td>\n<td style=\"text-align: right;\">1</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">N</td>\n<td style=\"text-align: right;\">3</td>\n<td style=\"text-align: right;\">2</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">V</td>\n<td style=\"text-align: right;\">3</td>\n<td style=\"text-align: right;\">3</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">V</td>\n<td style=\"text-align: right;\">3</td>\n<td style=\"text-align: right;\">4</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">5√ó3</td>\n<td style=\"text-align: left;\">V</td>\n<td style=\"text-align: right;\">3</td>\n<td style=\"text-align: right;\">5</td>\n</tr>\n</tbody>\n</table>\n</div>\n</div>\n</div>\n</section>\n<section class=\"level3\" id=\"storing-the-solution-in-nested-table\">\n<h3 class=\"anchored\" data-anchor-id=\"storing-the-solution-in-nested-table\">Storing the Solution in Nested Table</h3>\n<p>Use nest(.by = c(solution_num, dim)) to store each solution‚Äôs data in a list column. That way, each row in pento_min corresponds to one puzzle solution, containing the relevant (x, y, sol_text) data in a nested data frame.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Store solution in nested way</summary>\n<pre>pento_min &lt;- pento_sol_df |&gt;\n  filter(sol_text != \".\") |&gt;  # exclude the \".\" cells\n  select(x, y, sol_text, solution_num, dim) |&gt;\n  nest(.by = c(solution_num, dim))</pre>\n</details>\n</div>\n</section>\n<section class=\"level3\" id=\"creating-graphs-with-tidygraph-ggraph\">\n<h3 class=\"anchored\" data-anchor-id=\"creating-graphs-with-tidygraph-ggraph\">Creating Graphs with tidygraph &amp; ggraph üìà</h3>\n<p>To visualize the connections between pieces, we‚Äôll use tidygraph to create graph objects and ggraph for plotting.</p>\n<section class=\"level4\" id=\"function-data-frame-to-graph-conversion\">\n<h4 class=\"anchored\" data-anchor-id=\"function-data-frame-to-graph-conversion\">Function: Data Frame to Graph Conversion</h4>\n<p>This function converts a solution‚Äôs data frame into a graph by identifying adjacent cells.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Convert Data Frame to igraph Object</summary>\n<pre>df_to_graph &lt;- function(data) {\n  \n  # cross join is expensive, but straightforward: \n  # generate all pairs of cells, then filter to pairs that are adjacent (Manhattan distance = 1).\n  tmp &lt;- data |&gt;\n    cross_join(data) |&gt;\n    filter((abs(x.x - x.y) + abs(y.x - y.y)) == 1) |&gt;\n    distinct()\n  \n  edges &lt;- tmp |&gt;\n    transmute(\n      from = paste(x.x, y.x, sol_text.x, sep = \",\"),\n      to   = paste(x.y, y.y, sol_text.y, sep = \",\"),\n      w    = if_else(sol_text.x == sol_text.y, 1, 0.1)\n    )\n  \n  # Standardize from/to to avoid duplicate edges in undirected graph\n  edges_unique &lt;- edges %&gt;%\n    rowwise() %&gt;%\n    mutate(\n      a = min(from, to),\n      b = max(from, to)\n    ) %&gt;%\n    ungroup() %&gt;%\n    distinct(a, b, .keep_all = TRUE) %&gt;%\n    select(-a, -b)\n  \n  graph &lt;- tidygraph::as_tbl_graph(edges_unique, directed = FALSE)\n  \n  # Add node attributes\n  graph &lt;- graph |&gt;\n    mutate(\n      x     = as.numeric(str_split_i(name, \",\", 1)),\n      y     = as.numeric(str_split_i(name, \",\", 2)),\n      piece = str_split_i(name, \",\", 3)\n    ) |&gt;\n    mutate(\n      deg   = centrality_degree(weights = w),\n      btwn  = centrality_betweenness(weights = w),\n      sub_g = centrality_subgraph(),\n      idx   = row_number()\n    )\n  \n  return(graph)\n}</pre>\n</details>\n</div>\n</section>\n<section class=\"level4\" id=\"function-graph-visualization\">\n<h4 class=\"anchored\" data-anchor-id=\"function-graph-visualization\">Function: Graph Visualization</h4>\n<p>This function plots the graph using <code>ggraph</code> and highlights adjacency within pieces.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Visualizing igraph object with ggraph</summary>\n<pre>plot_graph &lt;- function(g) {\n  g |&gt;\n    activate(\"nodes\") |&gt;\n    mutate(comm = group_louvain(weights = w)) |&gt;\n    ggraph(layout = \"manual\", x = x, y = y) +\n    \n    # 1) Thicker edges for cells in the same piece\n    geom_edge_link(\n      lineend = \"round\", linejoin = \"mitre\", alpha = 0.8,\n      aes(edge_color = .N()$piece[from], edge_width = I(if_else(w == 1, 7, w)))\n    ) +\n    \n    # 2) Another edge layer (white dash) just as decoration\n    geom_edge_link(\n      lineend = \"square\", linejoin = \"round\", alpha = 0.8,\n      aes(edge_width = I(w)), color = \"#ffffff\", linetype = 3\n    ) +\n    \n    coord_fixed() +\n    theme_nothing() +\n    scale_edge_color_manual(values = retro12) +\n    scale_x_continuous(expand = expansion(add = 1)) +\n    scale_y_reverse(expand = expansion(add = 1))\n  \n}</pre>\n</details>\n</div>\n</section>\n</section>\n<section class=\"level3\" id=\"wrapping-it-up-with-patchwork\">\n<h3 class=\"anchored\" data-anchor-id=\"wrapping-it-up-with-patchwork\">Wrapping It Up with patchwork üñºÔ∏è</h3>\n<p>Finally, let‚Äôs use patchwork to combine multiple graphs into a single layout.</p>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Utilizing wrap_plot function</summary>\n<pre>indexes &lt;- c(14369:15378) |&gt; sample(size = 24)\n\nlist_of_plots &lt;- indexes %&gt;%\n  map(~ {\n    pento_min$data[[.x]] %&gt;%\n      df_to_graph() %&gt;%\n      plot_graph()\n  })\n\nwrap_plots(list_of_plots, ncol = 3) +\n  plot_annotation(\n    title = \"Collection of Pentomino Solutions (5x12)\",\n    theme = theme(text = element_text(family = \"Roboto Condensed\"))\n  ) +\n  plot_layout()</pre>\n</details>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/chichacha.github.io/chi-files/posts/pentomino/pentomino_part4_files/figure-html/unnamed-chunk-8-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/chichacha.github.io/chi-files/posts/pentomino/pentomino_part4_files/figure-html/unnamed-chunk-8-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n</section>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://chichacha.github.io/chi-files/posts/pentomino/pentomino_part4.html\"> CHI(œá)-Files</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
      "main_text": "Pentomino Solution & Patchwork\nPosted on\nJanuary 16, 2025\nby\nChisato\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nCHI(œá)-Files\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nPentomino Solution as\nigraph\nobject\nIn this post, I‚Äôm taking deeper dive into a dataset of\nPentomino puzzle solutions\nusing R. This time, I‚Äôm switching gears from the\nsf\npackage, but to explore graph theory concepts with\ntidygraph\nand\nggraph\n. Why? Because Pentomino solutions aren‚Äôt just puzzles; they‚Äôre networks waiting to be uncovered! üåê\nWhat‚Äôs on the menu? üç¥\nData Wrangling with\ntidyverse\nGraphs and graph-based data structures with\ntidygraph\nand visualization with\nggraph\nArranging Multiple Plots effortlessly with\npatchwork\n. The\nwrap_plots() function\nfunction was a lifesaver, sparing me from the monotony of typing plot1 + plot2 + ‚Ä¶ repeatedly! üôå\nSetups and Pakcages Used\n# Load required libraries\nlibrary(tidyverse)    # Data wrangling and general utilities\nlibrary(ggraph)       # Graph visualization\nlibrary(tidygraph)    # Graph data structure (tbl_graph) + graph algorithms\nlibrary(ggforce)      # Extra geoms for ggplot2\nlibrary(cowplot)      # Additional plotting helpers\nlibrary(patchwork)    # Combine multiple ggplots effortlessly!\nOriginal Solution Dataset\nI‚Äôve saved solution as csv file from earlier blog posts. So just retriving the dataset. Solution looks like below.\nReading Solution Dataset\n### Read solution data frame from Github \npento_sol <- read_csv(\"https://raw.githubusercontent.com/chichacha/pentomino/refs/heads/main/pentomino_solution.csv\")\n\nsample_n(pento_sol, size=5) |>\n  knitr::kable(\"markdown\")\ndim\nsol_text\nrow_cnt\ncol_cnt\nsol_idx\n5√ó10\nLLLLTTTNNN UUULWTNNFF UPUWWTYFFV PPWWYYYYFV PPIIIIIVVV\n5\n10\n5427\n6√ó10\nIIIIIXYYYY VVVFXXXNYW VTFFFXNNWW VTTTFZNWWP UTUZZZNLPP UUUZLLLLPP\n6\n10\n707\n5√ó9\nIIIIIFVVV UUPPFFFTV UPPPZZFTV UUNNZLTTT NNNZZLLLL\n5\n9\n1024\n8√ó8d\n.FFNNNX. FFNNYXXX IFYYYYXT ILLLLTTT IVVVLWWT IVZZWWPP IVZUWUPP .ZZUUUP.\n8\n8\n133\n5√ó11\nLLLLFZZNTTT LXFFFVZNNTY XXXFPVZZNTY UXUPPVVVNYY UUUPPIIIIIY\n5\n11\n2837\nJust prepping colors\nTo make our graphs visually fun, I‚Äôm just using retro-inspired color palette and assign unique colors to each Pentomino piece.\nPrepping Color Palette\n# Just Prepping some color palette\nretro <-  c(\"#00A0B0\", \"#6A4A3C\", \"#CC333F\", \"#EB6841\", \"#EDC951\")\nretro12 <- colorRampPalette(retro)(12)\nretro13 <- c(retro12,\"#ffffff\")\n\n#Assigning names to each color allows direct mapping with scale_color_manual() or scale_fill_manual()\npiece <- c(\"F\",\"I\",\"L\",\"N\",\"P\",\"T\",\"U\",\"V\",\"W\",\"X\",\"Y\",\"Z\")\nnames(retro12) <- piece\nnames(retro13) <- c(piece,\".\")\n\nretro12 |> enframe() |>\n  ggplot(aes(x=name,y=1)) +\n  geom_tile(aes(fill=I(value))) +\n  geom_text(aes(label=name), color=\"white\",vjust=-0.5) +\n  geom_text(aes(label=value), color=\"white\",vjust=1, size=3) +\n  theme_nothing()\nConverting Solution to (x,y) Positions üìê\nNext, we‚Äôll transform each solution into (x, y) coordinates. This step is crucial for graph creation. I‚Äôve listed a visualization & table of some 3√ó5 Pentomino solutions, mapped to their (x, y) position.\nConverting Solution Texts to Data Frame with Coordinates\n### Convert Solution to XY position data frame\npento_sol_df <- pento_sol |>\n  mutate(solution_num = row_number()) |>\n  mutate(sol_text = str_split(sol_text, \" \")) |>\n  unnest(sol_text) |>\n  group_by(solution_num) |>\n  mutate(y = row_number()) |>\n  ungroup() |>\n  mutate(sol_text = str_split(sol_text, \"\")) |>\n  unnest(sol_text) |>\n  group_by(solution_num, y) |>\n  mutate(x = row_number()) |>\n  ungroup()\n\n# Split the data into chunks programmatically\ntables <- pento_sol_df |> \n  filter(dim == \"5√ó3\", sol_idx == 1) |>\n  select(dim, sol_text, x, y) |>\n  group_split(x)\n\npento_sol_df |> \n  filter(dim == \"5√ó3\", sol_idx %in% c(1:6)) |>\n  mutate(sol_idx=if_else(sol_idx==1, str_c(\"1. See Table Below\"), as.character(sol_idx))) |>\n  ggplot(aes(x=x,y=y)) +\n  geom_point(aes(color=sol_text),size=10) +\n  geom_text(aes(label=sol_text), color=\"#fffff3\") +\n  scale_color_manual(values=retro12, guide=\"none\") +\n  theme_minimal() +\n  facet_wrap(~sol_idx,ncol=6) +\n  coord_fixed() +\n  scale_x_continuous(expand=expansion(add=1)) +\n  scale_y_continuous(expand=expansion(add=1))\ndim\nsol_text\nx\ny\n5√ó3\nL\n1\n1\n5√ó3\nL\n1\n2\n5√ó3\nL\n1\n3\n5√ó3\nL\n1\n4\n5√ó3\nV\n1\n5\ndim\nsol_text\nx\ny\n5√ó3\nL\n2\n1\n5√ó3\nN\n2\n2\n5√ó3\nN\n2\n3\n5√ó3\nN\n2\n4\n5√ó3\nV\n2\n5\ndim\nsol_text\nx\ny\n5√ó3\nN\n3\n1\n5√ó3\nN\n3\n2\n5√ó3\nV\n3\n3\n5√ó3\nV\n3\n4\n5√ó3\nV\n3\n5\nStoring the Solution in Nested Table\nUse nest(.by = c(solution_num, dim)) to store each solution‚Äôs data in a list column. That way, each row in pento_min corresponds to one puzzle solution, containing the relevant (x, y, sol_text) data in a nested data frame.\nStore solution in nested way\npento_min <- pento_sol_df |>\n  filter(sol_text != \".\") |>  # exclude the \".\" cells\n  select(x, y, sol_text, solution_num, dim) |>\n  nest(.by = c(solution_num, dim))\nCreating Graphs with tidygraph & ggraph üìà\nTo visualize the connections between pieces, we‚Äôll use tidygraph to create graph objects and ggraph for plotting.\nFunction: Data Frame to Graph Conversion\nThis function converts a solution‚Äôs data frame into a graph by identifying adjacent cells.\nConvert Data Frame to igraph Object\ndf_to_graph <- function(data) {\n  \n  # cross join is expensive, but straightforward: \n  # generate all pairs of cells, then filter to pairs that are adjacent (Manhattan distance = 1).\n  tmp <- data |>\n    cross_join(data) |>\n    filter((abs(x.x - x.y) + abs(y.x - y.y)) == 1) |>\n    distinct()\n  \n  edges <- tmp |>\n    transmute(\n      from = paste(x.x, y.x, sol_text.x, sep = \",\"),\n      to   = paste(x.y, y.y, sol_text.y, sep = \",\"),\n      w    = if_else(sol_text.x == sol_text.y, 1, 0.1)\n    )\n  \n  # Standardize from/to to avoid duplicate edges in undirected graph\n  edges_unique <- edges %>%\n    rowwise() %>%\n    mutate(\n      a = min(from, to),\n      b = max(from, to)\n    ) %>%\n    ungroup() %>%\n    distinct(a, b, .keep_all = TRUE) %>%\n    select(-a, -b)\n  \n  graph <- tidygraph::as_tbl_graph(edges_unique, directed = FALSE)\n  \n  # Add node attributes\n  graph <- graph |>\n    mutate(\n      x     = as.numeric(str_split_i(name, \",\", 1)),\n      y     = as.numeric(str_split_i(name, \",\", 2)),\n      piece = str_split_i(name, \",\", 3)\n    ) |>\n    mutate(\n      deg   = centrality_degree(weights = w),\n      btwn  = centrality_betweenness(weights = w),\n      sub_g = centrality_subgraph(),\n      idx   = row_number()\n    )\n  \n  return(graph)\n}\nFunction: Graph Visualization\nThis function plots the graph using\nggraph\nand highlights adjacency within pieces.\nVisualizing igraph object with ggraph\nplot_graph <- function(g) {\n  g |>\n    activate(\"nodes\") |>\n    mutate(comm = group_louvain(weights = w)) |>\n    ggraph(layout = \"manual\", x = x, y = y) +\n    \n    # 1) Thicker edges for cells in the same piece\n    geom_edge_link(\n      lineend = \"round\", linejoin = \"mitre\", alpha = 0.8,\n      aes(edge_color = .N()$piece[from], edge_width = I(if_else(w == 1, 7, w)))\n    ) +\n    \n    # 2) Another edge layer (white dash) just as decoration\n    geom_edge_link(\n      lineend = \"square\", linejoin = \"round\", alpha = 0.8,\n      aes(edge_width = I(w)), color = \"#ffffff\", linetype = 3\n    ) +\n    \n    coord_fixed() +\n    theme_nothing() +\n    scale_edge_color_manual(values = retro12) +\n    scale_x_continuous(expand = expansion(add = 1)) +\n    scale_y_reverse(expand = expansion(add = 1))\n  \n}\nWrapping It Up with patchwork üñºÔ∏è\nFinally, let‚Äôs use patchwork to combine multiple graphs into a single layout.\nUtilizing wrap_plot function\nindexes <- c(14369:15378) |> sample(size = 24)\n\nlist_of_plots <- indexes %>%\n  map(~ {\n    pento_min$data[[.x]] %>%\n      df_to_graph() %>%\n      plot_graph()\n  })\n\nwrap_plots(list_of_plots, ncol = 3) +\n  plot_annotation(\n    title = \"Collection of Pentomino Solutions (5x12)\",\n    theme = theme(text = element_text(family = \"Roboto Condensed\"))\n  ) +\n  plot_layout()\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nCHI(œá)-Files\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Pentomino Solution as igraph object In this post, I‚Äôm taking deeper dive into a dataset of Pentomino puzzle solutions using R. This time, I‚Äôm switching gears from the sf package, but to explore graph theory concepts with tidygraph and ggraph. W...",
      "meta_keywords": null,
      "og_description": "Pentomino Solution as igraph object In this post, I‚Äôm taking deeper dive into a dataset of Pentomino puzzle solutions using R. This time, I‚Äôm switching gears from the sf package, but to explore graph theory concepts with tidygraph and ggraph. W...",
      "og_image": "https://chichacha.github.io/chi-files/posts/pentomino/pentomino_part4_files/figure-html/unnamed-chunk-3-1.png",
      "og_title": "Pentomino Solution & Patchwork | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 5.9,
      "sitemap_lastmod": null,
      "twitter_description": "Pentomino Solution as igraph object In this post, I‚Äôm taking deeper dive into a dataset of Pentomino puzzle solutions using R. This time, I‚Äôm switching gears from the sf package, but to explore graph theory concepts with tidygraph and ggraph. W...",
      "twitter_title": "Pentomino Solution & Patchwork | R-bloggers",
      "url": "https://www.r-bloggers.com/2025/01/pentomino-solution-patchwork/",
      "word_count": 1188
    }
  }
}