{
  "uuid": "cd9de8be-4cc1-4baf-be0c-b9eeb6e3c19b",
  "created_at": "2025-11-22 19:57:23",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2025/11/an-introduction-to-writing-your-own-ggplot2-geoms/",
    "crawled_at": "2025-11-22T10:41:14.722043",
    "external_links": [
      {
        "href": "https://rworks.dev/posts/ggplot2-extensions/",
        "text": "R Works"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://wilkelab.org/ggridges/",
        "text": "ggridges"
      },
      {
        "href": "https://const-ae.github.io/ggsignif/",
        "text": "ggsignif"
      },
      {
        "href": "https://github.com/EvaMaeRey",
        "text": "Gina Reynolds"
      },
      {
        "href": "https://evamaerey.github.io/ggplot_flipbook/ggplot_flipbook_xaringan.html#1",
        "text": "flipbookr"
      },
      {
        "href": "https://ggplot2-extenders.github.io/ggplot-extension-club/",
        "text": "ggextenders"
      },
      {
        "href": "https://larmarange.github.io/ggstats/",
        "text": "ggstats"
      },
      {
        "href": "https://docs.google.com/forms/d/e/1FAIpQLSe3M1KwUPrmTfEGuuQp0fZ0J7dZkk_82gb310JCvdouMTa_7Q/viewform",
        "text": "Join us sometime by filling out this questionnaire"
      },
      {
        "href": "https://evamaerey.github.io/easy-geom-recipes/",
        "text": "Easy geom recipes"
      },
      {
        "href": "https://i1.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-3-1.png?ssl=1",
        "text": null
      },
      {
        "href": "https://i2.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-7-1.png?ssl=1",
        "text": null
      },
      {
        "href": "https://i1.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-11-1.png?ssl=1",
        "text": null
      },
      {
        "href": "https://docs.r-wasm.org/webr/latest/",
        "text": "webR"
      },
      {
        "href": "https://github.com/r-wasm/quarto-live",
        "text": "Quarto Live"
      },
      {
        "href": "https://evamaerey.github.io/easy-geom-recipes/recipe1means.html#your-turn-write-geom_means",
        "text": "Easy geom recipes"
      },
      {
        "href": "https://evamaerey.github.io/everyday_ggplot2_extension/community.html",
        "text": "adorable ggextenders hex"
      },
      {
        "href": "https://ggplot2-extenders.github.io/ggplot-extension-club/",
        "text": "ggplot2 extenders club website"
      },
      {
        "href": "https://evamaerey.github.io/everyday_ggplot2_extension/",
        "text": "Everyday ggplot2 extension"
      },
      {
        "href": "https://evamaerey.github.io/ggplot2-extension-cookbook/",
        "text": "ggplot2 extension cookbook"
      },
      {
        "href": "https://evamaerey.github.io/easy-geom-recipes/",
        "text": "Easy geom recipes"
      },
      {
        "href": "https://ggplot2-extenders.github.io/ggplot-extension-club/additional-resources.html",
        "text": "list of resources on the ggplot2 extenders club website"
      },
      {
        "href": "https://closeread.dev/",
        "text": "Closeread"
      },
      {
        "href": "https://rworks.dev/posts/ggplot2-extensions/",
        "text": "R Works"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "An Introduction to Writing Your Own ggplot2 Geoms | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-3-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-7-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-11-1.png?w=450&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/isabella-velasquez/",
        "text": "Isabella Vel√°squez"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-396524 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">An Introduction to Writing Your Own ggplot2 Geoms</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">November 2, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/isabella-velasquez/\">Isabella Vel√°squez</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://rworks.dev/posts/ggplot2-extensions/\"> R Works</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<!-- user-provided yaml closeread style options -->\n\n<p>If you use ggplot2, you are probably used to creating plots with <code>geom_line()</code> and <code>geom_point()</code>. You may also have ventured into to the broader ggplot2 ecosystem to use geoms like <code>geom_density_ridges()</code> from <a href=\"https://wilkelab.org/ggridges/\" rel=\"nofollow\" target=\"_blank\">ggridges</a> or <code>geom_signif()</code> from <a href=\"https://const-ae.github.io/ggsignif/\" rel=\"nofollow\" target=\"_blank\">ggsignif</a>. But have you ever wondered <em>how</em> these extensions were created? Where did the authors figure out how to create a new geom? And, if the plot of your dreams doesn‚Äôt exist, how would you make your own?</p>\n<p>Enter the exciting world of creating your own ggplot2 extensions.</p>\n<p>I had the pleasure of meeting <a href=\"https://github.com/EvaMaeRey\" rel=\"nofollow\" target=\"_blank\">Gina Reynolds</a> when I first began my job at Posit (then RStudio) and she was contributing a blog post on <a href=\"https://evamaerey.github.io/ggplot_flipbook/ggplot_flipbook_xaringan.html#1\" rel=\"nofollow\" target=\"_blank\">flipbookr</a>. Since then, we‚Äôve kept in touch through the <a href=\"https://ggplot2-extenders.github.io/ggplot-extension-club/\" rel=\"nofollow\" target=\"_blank\">ggextenders</a> extension club. Every few months, the club meets virtually to hear from a ggextender (someone who works with ggplot2 extensions). The speaker can talk about a custom geom they‚Äôve created for the community or more general R visualization topics. Each presentation is insightful and interesting. I‚Äôve had the opportunity to learn about cool packages like <a href=\"https://larmarange.github.io/ggstats/\" rel=\"nofollow\" target=\"_blank\">ggstats</a>. <a href=\"https://docs.google.com/forms/d/e/1FAIpQLSe3M1KwUPrmTfEGuuQp0fZ0J7dZkk_82gb310JCvdouMTa_7Q/viewform\" rel=\"nofollow\" target=\"_blank\">Join us sometime by filling out this questionnaire</a>!</p>\n<p>However, I was never a ‚Äúggextender‚Äù myself (having just used and never developed extenders). I found the idea of creating an extension daunting. That is, until recently!</p>\n<p>Gina held a focus group that worked through the <a href=\"https://evamaerey.github.io/easy-geom-recipes/\" rel=\"nofollow\" target=\"_blank\">Easy geom recipes</a>, a series of tutorials on creating ggplot2 extensions. Following ‚Äúrecipes‚Äù, you methodically create three extensions. Each time, certain key knowledge points are reinforced and new variations are introduced.</p>\n<p>So, say we want to create a new <code>geom_*()</code> that adds a point on the median of the x-axis and y-axis variables of a plot. We will call it <code>geom_medians()</code>. Let‚Äôs follow the recipe:</p>\n<div class=\"cr-section cr-column-screen sidebar-left\">\n<div class=\"narrative-col\">\n<section class=\"level2 narrative trigger\" id=\"step-0.-get-the-job-done-with-base-ggplot2.\">\n<h2 class=\"narrative anchored\" data-anchor-id=\"step-0.-get-the-job-done-with-base-ggplot2.\">Step 0. Get the job done with ‚Äòbase‚Äô ggplot2.</h2>\n</section>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-0a\" data-highlight=\"1,2\">\n<div class=\"narrative\">\n<p>First, clarify what needs to happen without getting into the extension architecture. Load the tidyverse package and the palmerpenguins package.</p>\n</div>\n</div>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-0a\" data-highlight=\"5,6,7\">\n<div class=\"narrative\">\n<p>Calculate the median of the x variable (<code>bill_length_mm</code>) and y variable (<code>bill_depth_mm</code>) as you would normally.</p>\n</div>\n</div>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step02\">\n<div class=\"narrative\">\n<p>Now, use base ggplot2 to get the job done.</p>\n</div>\n</div>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-0b\" data-highlight=\"7,8\">\n<div class=\"narrative\">\n<p>This requires specifying <code>bill_depth_mm_median</code> and <code>bill_length_mm_median</code>, which we just created, within <code>aes()</code> in <code>geom_point()</code>.</p>\n</div>\n</div>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-0c\">\n<div class=\"narrative\">\n<p>This is the resulting plot.</p>\n</div>\n</div>\n<section class=\"level2 narrative trigger\" id=\"step-1-define-compute-and-test.\">\n<h2 class=\"narrative anchored\" data-anchor-id=\"step-1-define-compute-and-test.\">Step 1: Define Compute and test.</h2>\n</section>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-1a\">\n<div class=\"narrative\">\n<p>Define the compute that will transform your input data ‚Äúunder the hood‚Äù before rendering it.</p>\n</div>\n</div>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-1b\">\n<div class=\"narrative\">\n<p>Next, test the compute to make sure that the output matches what you expect. Note that the names <code>x</code> and <code>y</code> are required.</p>\n</div>\n</div>\n<section class=\"level2 narrative trigger\" id=\"step-2-define-new-stat.-test.\">\n<h2 class=\"narrative anchored\" data-anchor-id=\"step-2-define-new-stat.-test.\">Step 2: Define new Stat. Test.</h2>\n</section>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-2a\">\n<div class=\"narrative\">\n<p>Next, use the <code>ggplot2::ggproto()</code> function, which creates a new Stat function that does computation under the hood when building a plot. Don‚Äôt worry, you don‚Äôt have to write this yourself. This is provided as boilerplate code, all you have to do is edit the relevant code!</p>\n</div>\n</div>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-2b\" data-highlight=\"6\">\n<div class=\"narrative\">\n<p>Test your new Stat by using it in a <code>geom_*()</code> function.</p>\n</div>\n</div>\n<section class=\"level2 narrative trigger\" id=\"step-3-define-user-facing-functions.-test.\">\n<h2 class=\"narrative anchored\" data-anchor-id=\"step-3-define-user-facing-functions.-test.\">Step 3: Define user-facing functions. Test.</h2>\n</section>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-3a\">\n<div class=\"narrative\">\n<p>Now, define the user-facing function. This is more boilerplate code that you edit depending on what you are creating.</p>\n</div>\n</div>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-3a\" data-highlight=\"1\">\n<div class=\"narrative\">\n<p>The <code>stat_*()</code> function name derives from the Stat objects‚Äôs name, but is snake case.</p>\n</div>\n</div>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-3a\" data-highlight=\"3\">\n<div class=\"narrative\">\n<p>‚ÄúPoint‚Äù is specified as the default for the geom argument in the function. This means that the <code>ggplot2::geom_point()</code> will be used in the layer unless otherwise specified by the user.</p>\n</div>\n</div>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-3a\" data-highlight=\"6\">\n<div class=\"narrative\">\n<p><code>StatMedians</code> defines the new layer function, so summarizing the medians will be in play before the layer is rendered.</p>\n</div>\n</div>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-3a-1\" data-highlight=\"1\">\n<div class=\"narrative\">\n<p>Alternatively, the new <code>make_constructor()</code> function, available in ggplot2 v4.0.0, will write much of the above boilerplate code for you.</p>\n</div>\n</div>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-3b\">\n<div class=\"narrative\">\n<p>And because users are more accustomed to using layers that have the ‚Äògeom‚Äô prefix, you might also define geom with almost identical properties using <code>make_constructor()</code>.The difference between <code>stat_medians</code> and <code>geom_medians</code> is that the <code>stat</code> is fixed in the former, and the <code>geom</code> is fixed in the latter.</p>\n</div>\n</div>\n<div class=\"trigger new-trigger\" data-focus-on=\"cr-step-3c\" data-highlight=\"6\">\n<div class=\"narrative\">\n<p>Now, test your user-facing function by using it in a ggplot2 plot.</p>\n</div>\n</div>\n</div>\n<div class=\"sticky-col\">\n<div class=\"sticky-col-stack\">\n<div class=\"scale-to-fill sticky\" id=\"cr-step-0a\">\n<div class=\"cell\">\n<pre>library(tidyverse)\nlibrary(palmerpenguins)\n\n# Compute\npenguins_medians &lt;- penguins |&gt; \n  summarize(bill_length_mm_median = median(bill_length_mm, na.rm = TRUE),\n            bill_depth_mm_median = median(bill_depth_mm, na.rm = TRUE))</pre>\n</div>\n</div>\n<div class=\"scale-to-fill sticky\" id=\"cr-step-0b\">\n<div class=\"cell\">\n<pre># Plot\npenguins |&gt; \n  ggplot() + \n  aes(x = bill_depth_mm, y = bill_length_mm) + \n  geom_point() + \n  geom_point(data = penguins_medians,\n             aes(x = bill_depth_mm_median,\n                 y = bill_length_mm_median),\n             size = 8, color = \"red\") + \n  labs(title = \"Created with base ggplot2\")</pre>\n</div>\n</div>\n<div class=\"scale-to-fill sticky\" id=\"cr-step-0c\">\n<div class=\"cell\">\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-1\" href=\"https://i1.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-3-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-3-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-3-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n</div>\n<div class=\"scale-to-fill sticky\" id=\"cr-step-1a\">\n<div class=\"cell\">\n<pre># Define compute.\ncompute_group_medians &lt;- function(data, scales){ \n  data |&gt; \n    summarize(x = median(x, na.rm = T),\n              y = median(y, na.rm = T))\n}</pre>\n</div>\n</div>\n<div class=\"scale-to-fill sticky\" id=\"cr-step-1b\">\n<div class=\"cell\">\n<pre># Test compute. \npenguins |&gt;\n  select(x = bill_depth_mm,  \n         y = bill_length_mm) |&gt;  \n  compute_group_medians()</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre># A tibble: 1 √ó 2\n      x     y\n  &lt;dbl&gt; &lt;dbl&gt;\n1  17.3  44.4</pre>\n</div>\n</div>\n</div>\n<div class=\"scale-to-fill sticky\" id=\"cr-step-2a\">\n<div class=\"cell\">\n<pre>StatMedians &lt;-\n  ggplot2::ggproto(\n    `_class` = \"StatMedians\",\n    `_inherit` = ggplot2::Stat,\n    compute_group = compute_group_medians,\n    required_aes = c(\"x\", \"y\")\n  )</pre>\n</div>\n</div>\n<div class=\"scale-to-fill sticky\" id=\"cr-step-2b\">\n<div class=\"cell\">\n<pre>penguins |&gt; \n  ggplot() + \n  aes(x = bill_depth_mm,\n      y = bill_length_mm) + \n  geom_point() + \n  geom_point(stat = StatMedians, size = 7) + \n  labs(title = \"Testing StatMedians\")</pre>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-2\" href=\"https://i2.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-7-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-7-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-7-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n</div>\n<div class=\"scale-to-fill sticky\" id=\"cr-step-3a\">\n<div class=\"cell\">\n<pre>stat_medians &lt;- \n  function(mapping = NULL, data = NULL, \n           geom = \"point\", position = \"identity\", \n           ..., show.legend = NA, inherit.aes = TRUE) \n    {\n    layer(data = data, mapping = mapping, stat = StatMedians, \n          geom = geom, position = position, show.legend = show.legend, \n          inherit.aes = inherit.aes, params = rlang::list2(na.rm = FALSE, \n                                                           ...))\n    }</pre>\n</div>\n</div>\n<div class=\"scale-to-fill sticky\" id=\"cr-step-3a-1\">\n<div class=\"cell\">\n<pre>stat_medians &lt;- make_constructor(StatMedians, geom = \"point\")\n\n## check the new function's specification\nprint(stat_medians)</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>function (mapping = NULL, data = NULL, geom = \"point\", position = \"identity\", \n    ..., na.rm = FALSE, show.legend = NA, inherit.aes = TRUE) \n{\n    layer(mapping = mapping, data = data, geom = geom, stat = \"medians\", \n        position = position, show.legend = show.legend, inherit.aes = inherit.aes, \n        params = list2(na.rm = na.rm, ...))\n}\n&lt;environment: 0x11ff6daf8&gt;</pre>\n</div>\n</div>\n</div>\n<div class=\"scale-to-fill sticky\" id=\"cr-step-3b\">\n<div class=\"cell\">\n<pre>geom_medians &lt;- make_constructor(GeomPoint, stat = \"medians\")\n\n## check the new function's specification\nprint(geom_medians)</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>function (mapping = NULL, data = NULL, stat = \"medians\", position = \"identity\", \n    ..., na.rm = FALSE, show.legend = NA, inherit.aes = TRUE) \n{\n    layer(mapping = mapping, data = data, geom = \"point\", stat = stat, \n        position = position, show.legend = show.legend, inherit.aes = inherit.aes, \n        params = list2(na.rm = na.rm, ...))\n}\n&lt;environment: 0x128266630&gt;</pre>\n</div>\n</div>\n</div>\n<div class=\"scale-to-fill sticky\" id=\"cr-step-3c\">\n<div class=\"cell\">\n<pre>## Test user-facing.\npenguins |&gt;\n  ggplot() +\n  aes(x = bill_depth_mm, y = bill_length_mm) +\n  geom_point() +\n  geom_medians(size = 8)  +\n  labs(title = \"Testing geom_medians()\")</pre>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-3\" href=\"https://i1.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-11-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-11-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-11-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p>And then you‚Äôre done! You‚Äôve created your first ggplot extension ü•≥.</p>\n<p>Going through the recipes is a great way to ease into your ggplot2 extension journey. They offer three well-crafted examples with a clear structure and sequence of steps. The boilerplate code looks daunting, but you can copy/paste it and edit it depending on what you are creating; if you want to go into more detail as to what it‚Äôs actually doing, the tutorials provide additional resources. A fun note is that the geom recipes website uses <a href=\"https://docs.r-wasm.org/webr/latest/\" rel=\"nofollow\" target=\"_blank\">webR</a> and <a href=\"https://github.com/r-wasm/quarto-live\" rel=\"nofollow\" target=\"_blank\">Quarto Live</a> to embed interactive code chunks directly in the tutorial. It makes for an immersive experience while going through the exercises.</p>\n<p>Want to try your own hand at creating <code>geom_means()</code>? Go through the interactive tutorial in <a href=\"https://evamaerey.github.io/easy-geom-recipes/recipe1means.html#your-turn-write-geom_means\" rel=\"nofollow\" target=\"_blank\">Easy geom recipes</a>!</p>\n<section class=\"level2\" id=\"resources\">\n<h2 class=\"anchored\" data-anchor-id=\"resources\">Resources</h2>\n<p>It‚Äôs a delight going through Gina‚Äôs resources, from seeing the <a href=\"https://evamaerey.github.io/everyday_ggplot2_extension/community.html\" rel=\"nofollow\" target=\"_blank\">adorable ggextenders hex</a> to reading all the touching notes about ggplot2, comparing it to art, food, poetry, and more. It‚Äôs a testament to how a tool can inspire so many. Here are some of my favorites quotations and metaphors:</p>\n<ul>\n<li>‚Äúggplot2 lets users ‚Äòspeak their plots into existence‚Äô‚Äù ‚Äî Thomas Lin Pedersen</li>\n<li>‚ÄúYou are a composer of ‚Äògraphical poems‚Äô‚Äù ‚Äî Hadley Wickham</li>\n</ul>\n<p>Learn more about Gina‚Äôs work here:</p>\n<ul>\n<li><a href=\"https://ggplot2-extenders.github.io/ggplot-extension-club/\" rel=\"nofollow\" target=\"_blank\">ggplot2 extenders club website</a>: See previous talks and sign up for future webinars</li>\n<li><a href=\"https://evamaerey.github.io/everyday_ggplot2_extension/\" rel=\"nofollow\" target=\"_blank\">Everyday ggplot2 extension</a>: Education materials for potential extenders</li>\n<li><a href=\"https://evamaerey.github.io/ggplot2-extension-cookbook/\" rel=\"nofollow\" target=\"_blank\">ggplot2 extension cookbook</a>: Guide that presents extension strategies in a consistent and accessible way</li>\n<li><a href=\"https://evamaerey.github.io/easy-geom-recipes/\" rel=\"nofollow\" target=\"_blank\">Easy geom recipes</a>: A series of tutorials on creating a tutorial</li>\n</ul>\n<p>There is a comprehensive <a href=\"https://ggplot2-extenders.github.io/ggplot-extension-club/additional-resources.html\" rel=\"nofollow\" target=\"_blank\">list of resources on the ggplot2 extenders club website</a>.</p>\n<p>Many thanks to Andrew Bray, James Goldie, and the QMD Lab for <a href=\"https://closeread.dev/\" rel=\"nofollow\" target=\"_blank\">Closeread</a>, a Quarto extension for scrollytelling, which walked through the ggextender steps, and Gina, for both organizing the ggplot2 extenders club and reviewing this post!</p>\n</section>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://rworks.dev/posts/ggplot2-extensions/\"> R Works</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
    "main_text": "An Introduction to Writing Your Own ggplot2 Geoms\nPosted on\nNovember 2, 2025\nby\nIsabella Vel√°squez\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nR Works\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nIf you use ggplot2, you are probably used to creating plots with\ngeom_line()\nand\ngeom_point()\n. You may also have ventured into to the broader ggplot2 ecosystem to use geoms like\ngeom_density_ridges()\nfrom\nggridges\nor\ngeom_signif()\nfrom\nggsignif\n. But have you ever wondered\nhow\nthese extensions were created? Where did the authors figure out how to create a new geom? And, if the plot of your dreams doesn‚Äôt exist, how would you make your own?\nEnter the exciting world of creating your own ggplot2 extensions.\nI had the pleasure of meeting\nGina Reynolds\nwhen I first began my job at Posit (then RStudio) and she was contributing a blog post on\nflipbookr\n. Since then, we‚Äôve kept in touch through the\nggextenders\nextension club. Every few months, the club meets virtually to hear from a ggextender (someone who works with ggplot2 extensions). The speaker can talk about a custom geom they‚Äôve created for the community or more general R visualization topics. Each presentation is insightful and interesting. I‚Äôve had the opportunity to learn about cool packages like\nggstats\n.\nJoin us sometime by filling out this questionnaire\n!\nHowever, I was never a ‚Äúggextender‚Äù myself (having just used and never developed extenders). I found the idea of creating an extension daunting. That is, until recently!\nGina held a focus group that worked through the\nEasy geom recipes\n, a series of tutorials on creating ggplot2 extensions. Following ‚Äúrecipes‚Äù, you methodically create three extensions. Each time, certain key knowledge points are reinforced and new variations are introduced.\nSo, say we want to create a new\ngeom_*()\nthat adds a point on the median of the x-axis and y-axis variables of a plot. We will call it\ngeom_medians()\n. Let‚Äôs follow the recipe:\nStep 0. Get the job done with ‚Äòbase‚Äô ggplot2.\nFirst, clarify what needs to happen without getting into the extension architecture. Load the tidyverse package and the palmerpenguins package.\nCalculate the median of the x variable (\nbill_length_mm\n) and y variable (\nbill_depth_mm\n) as you would normally.\nNow, use base ggplot2 to get the job done.\nThis requires specifying\nbill_depth_mm_median\nand\nbill_length_mm_median\n, which we just created, within\naes()\nin\ngeom_point()\n.\nThis is the resulting plot.\nStep 1: Define Compute and test.\nDefine the compute that will transform your input data ‚Äúunder the hood‚Äù before rendering it.\nNext, test the compute to make sure that the output matches what you expect. Note that the names\nx\nand\ny\nare required.\nStep 2: Define new Stat. Test.\nNext, use the\nggplot2::ggproto()\nfunction, which creates a new Stat function that does computation under the hood when building a plot. Don‚Äôt worry, you don‚Äôt have to write this yourself. This is provided as boilerplate code, all you have to do is edit the relevant code!\nTest your new Stat by using it in a\ngeom_*()\nfunction.\nStep 3: Define user-facing functions. Test.\nNow, define the user-facing function. This is more boilerplate code that you edit depending on what you are creating.\nThe\nstat_*()\nfunction name derives from the Stat objects‚Äôs name, but is snake case.\n‚ÄúPoint‚Äù is specified as the default for the geom argument in the function. This means that the\nggplot2::geom_point()\nwill be used in the layer unless otherwise specified by the user.\nStatMedians\ndefines the new layer function, so summarizing the medians will be in play before the layer is rendered.\nAlternatively, the new\nmake_constructor()\nfunction, available in ggplot2 v4.0.0, will write much of the above boilerplate code for you.\nAnd because users are more accustomed to using layers that have the ‚Äògeom‚Äô prefix, you might also define geom with almost identical properties using\nmake_constructor()\n.The difference between\nstat_medians\nand\ngeom_medians\nis that the\nstat\nis fixed in the former, and the\ngeom\nis fixed in the latter.\nNow, test your user-facing function by using it in a ggplot2 plot.\nlibrary(tidyverse)\nlibrary(palmerpenguins)\n\n# Compute\npenguins_medians <- penguins |> \n  summarize(bill_length_mm_median = median(bill_length_mm, na.rm = TRUE),\n            bill_depth_mm_median = median(bill_depth_mm, na.rm = TRUE))\n# Plot\npenguins |> \n  ggplot() + \n  aes(x = bill_depth_mm, y = bill_length_mm) + \n  geom_point() + \n  geom_point(data = penguins_medians,\n             aes(x = bill_depth_mm_median,\n                 y = bill_length_mm_median),\n             size = 8, color = \"red\") + \n  labs(title = \"Created with base ggplot2\")\n# Define compute.\ncompute_group_medians <- function(data, scales){ \n  data |> \n    summarize(x = median(x, na.rm = T),\n              y = median(y, na.rm = T))\n}\n# Test compute. \npenguins |>\n  select(x = bill_depth_mm,  \n         y = bill_length_mm) |>  \n  compute_group_medians()\n# A tibble: 1 √ó 2\n      x     y\n  <dbl> <dbl>\n1  17.3  44.4\nStatMedians <-\n  ggplot2::ggproto(\n    `_class` = \"StatMedians\",\n    `_inherit` = ggplot2::Stat,\n    compute_group = compute_group_medians,\n    required_aes = c(\"x\", \"y\")\n  )\npenguins |> \n  ggplot() + \n  aes(x = bill_depth_mm,\n      y = bill_length_mm) + \n  geom_point() + \n  geom_point(stat = StatMedians, size = 7) + \n  labs(title = \"Testing StatMedians\")\nstat_medians <- \n  function(mapping = NULL, data = NULL, \n           geom = \"point\", position = \"identity\", \n           ..., show.legend = NA, inherit.aes = TRUE) \n    {\n    layer(data = data, mapping = mapping, stat = StatMedians, \n          geom = geom, position = position, show.legend = show.legend, \n          inherit.aes = inherit.aes, params = rlang::list2(na.rm = FALSE, \n                                                           ...))\n    }\nstat_medians <- make_constructor(StatMedians, geom = \"point\")\n\n## check the new function's specification\nprint(stat_medians)\nfunction (mapping = NULL, data = NULL, geom = \"point\", position = \"identity\", \n    ..., na.rm = FALSE, show.legend = NA, inherit.aes = TRUE) \n{\n    layer(mapping = mapping, data = data, geom = geom, stat = \"medians\", \n        position = position, show.legend = show.legend, inherit.aes = inherit.aes, \n        params = list2(na.rm = na.rm, ...))\n}\n<environment: 0x11ff6daf8>\ngeom_medians <- make_constructor(GeomPoint, stat = \"medians\")\n\n## check the new function's specification\nprint(geom_medians)\nfunction (mapping = NULL, data = NULL, stat = \"medians\", position = \"identity\", \n    ..., na.rm = FALSE, show.legend = NA, inherit.aes = TRUE) \n{\n    layer(mapping = mapping, data = data, geom = \"point\", stat = stat, \n        position = position, show.legend = show.legend, inherit.aes = inherit.aes, \n        params = list2(na.rm = na.rm, ...))\n}\n<environment: 0x128266630>\n## Test user-facing.\npenguins |>\n  ggplot() +\n  aes(x = bill_depth_mm, y = bill_length_mm) +\n  geom_point() +\n  geom_medians(size = 8)  +\n  labs(title = \"Testing geom_medians()\")\nAnd then you‚Äôre done! You‚Äôve created your first ggplot extension ü•≥.\nGoing through the recipes is a great way to ease into your ggplot2 extension journey. They offer three well-crafted examples with a clear structure and sequence of steps. The boilerplate code looks daunting, but you can copy/paste it and edit it depending on what you are creating; if you want to go into more detail as to what it‚Äôs actually doing, the tutorials provide additional resources. A fun note is that the geom recipes website uses\nwebR\nand\nQuarto Live\nto embed interactive code chunks directly in the tutorial. It makes for an immersive experience while going through the exercises.\nWant to try your own hand at creating\ngeom_means()\n? Go through the interactive tutorial in\nEasy geom recipes\n!\nResources\nIt‚Äôs a delight going through Gina‚Äôs resources, from seeing the\nadorable ggextenders hex\nto reading all the touching notes about ggplot2, comparing it to art, food, poetry, and more. It‚Äôs a testament to how a tool can inspire so many. Here are some of my favorites quotations and metaphors:\n‚Äúggplot2 lets users ‚Äòspeak their plots into existence‚Äô‚Äù ‚Äî Thomas Lin Pedersen\n‚ÄúYou are a composer of ‚Äògraphical poems‚Äô‚Äù ‚Äî Hadley Wickham\nLearn more about Gina‚Äôs work here:\nggplot2 extenders club website\n: See previous talks and sign up for future webinars\nEveryday ggplot2 extension\n: Education materials for potential extenders\nggplot2 extension cookbook\n: Guide that presents extension strategies in a consistent and accessible way\nEasy geom recipes\n: A series of tutorials on creating a tutorial\nThere is a comprehensive\nlist of resources on the ggplot2 extenders club website\n.\nMany thanks to Andrew Bray, James Goldie, and the QMD Lab for\nCloseread\n, a Quarto extension for scrollytelling, which walked through the ggextender steps, and Gina, for both organizing the ggplot2 extenders club and reviewing this post!\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nR Works\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "If you use ggplot2, you are probably used to creating plots with geom_line() and geom_point(). You may also have ventured into to the broader ggplot2 ecosystem to use geoms like geom_density_ridges() from ggridges or geom_signif() from ggsignif. But have you ever wondered how these extensions were created? Where did the authors figure out how to create a new geom? And, if the plot of your dreams doesn‚Äôt exist, how would you make your own? Enter the exciting world of creating your own ggplot2 extensions. I had the pleasure of meeting Gina Reynolds when I first began my job at Posit (then RStudio) and she was contributing a blog post on flipbookr. Since then, we‚Äôve kept in touch through the ggextenders extension club. Every few months, the club meets virtually to hear from a ggextender (someone who works with ggplot2 extensions). The speaker can talk about a custom geom they‚Äôve created for the community or more general R visualization topics. Each presentation is insightful and interesting. I‚Äôve had the opportunity to learn about cool packages like ggstats. Join us sometime by filling out this questionnaire! However, I was never a ‚Äúggextender‚Äù myself (having just used and never developed extenders). I found the idea of creating an extension daunting. That is, until recently! Gina held a focus group that worked through the Easy geom recipes, a series of tutorials on creating ggplot2 extensions. Following ‚Äúrecipes‚Äù, you methodically create three extensions. Each time, certain key knowledge points are reinforced and new variations are introduced. So, say we want to create a new geom_*() that adds a point on the median of the x-axis and y-axis variables of a plot. We will call it geom_medians(). Let‚Äôs follow the recipe: Step 0. Get the job done with ‚Äòbase‚Äô ggplot2. First, clarify what needs to happen without getting into the extension architecture. Load the tidyverse package and the palmerpenguins package. Calculate the median of the x variable (bill_length_mm) and y variable (bill_depth_mm) as you would normally. Now, use base ggplot2 to get the job done. This requires specifying bill_depth_mm_median and bill_length_mm_median, which we just created, within aes() in geom_point(). This is the resulting plot. Step 1: Define Compute and test. Define the compute that will transform your input data ‚Äúunder the hood‚Äù before rendering it. Next, test the compute to make sure that the output matches what you expect. Note that the names x and y are required. Step 2: Define new Stat. Test. Next, use the ggplot2::ggproto() function, which creates a new Stat function that does computation under the hood when building a plot. Don‚Äôt worry, you don‚Äôt have to write this yourself. This is provided as boilerplate code, all you have to do is edit the relevant code! Test your new Stat by using it in a geom_*() function. Step 3: Define user-facing functions. Test. Now, define the user-facing function. This is more boilerplate code that you edit depending on what you are creating. The stat_*() function name derives from the Stat objects‚Äôs name, but is snake case. ‚ÄúPoint‚Äù is specified as the default for the geom argument in the function. This means that the ggplot2::geom_point() will be used in the layer unless otherwise specified by the user. StatMedians defines the new layer function, so summarizing the medians will be in play before the layer is rendered. Alternatively, the new make_constructor() function, available in ggplot2 v4.0.0, will write much of the above boilerplate code for you. And because users are more accustomed to using layers that have the ‚Äògeom‚Äô prefix, you might also define geom with almost identical properties using make_constructor().The difference between stat_medians and geom_medians is that the stat is fixed in the former, and the geom is fixed in the latter. Now, test your user-facing function by using it in a ggplot2 plot. library(tidyverse) library(palmerpenguins) # Compute penguins_medians summarize(bill_length_mm_median = median(bill_length_mm, na.rm = TRUE), bill_depth_mm_median = median(bill_depth_mm, na.rm = TRUE)) # Plot penguins |> ggplot() + aes(x = bill_depth_mm, y = bill_length_mm) + geom_point() + geom_point(data = penguins_medians, aes(x = bill_depth_mm_median, y = bill_length_mm_median), size = 8, color = \"red\") + labs(title = \"Created with base ggplot2\") # Define compute. compute_group_medians summarize(x = median(x, na.rm = T), y = median(y, na.rm = T)) } # Test compute. penguins |> select(x = bill_depth_mm, y = bill_length_mm) |> compute_group_medians() # A tibble: 1 √ó 2 x y 1 17.3 44.4 StatMedians ggplot() + aes(x = bill_depth_mm, y = bill_length_mm) + geom_point() + geom_point(stat = StatMedians, size = 7) + labs(title = \"Testing StatMedians\") stat_medians ggplot() + aes(x = bill_depth_mm, y = bill_length_mm) + geom_point() + geom_medians(size = 8) + labs(title = \"Testing geom_medians()\") And then you‚Äôre done! You‚Äôve created your first ggplot extension ü•≥. Going through the recipes is a great way to ease into your ggplot2 extension journey. They offer three well-crafted examples with a clear structure and sequence of steps. The boilerplate code looks daunting, but you can copy/paste it and edit it depending on what you are creating; if you want to go into more detail as to what it‚Äôs actually doing, the tutorials provide additional resources. A fun note is that the geom recipes website uses webR and Quarto Live to embed interactive code chunks directly in the tutorial. It makes for an immersive experience while going through the exercises. Want to try your own hand at creating geom_means()? Go through the interactive tutorial in Easy geom recipes! Resources It‚Äôs a delight going through Gina‚Äôs resources, from seeing the adorable ggextenders hex to reading all the touching notes about ggplot2, comparing it to art, food, poetry, and more. It‚Äôs a testament to how a tool can inspire so many. Here are some of my favorites quotations and metaphors: ‚Äúggplot2 lets users ‚Äòspeak their plots into existence‚Äô‚Äù ‚Äî Thomas Lin Pedersen ‚ÄúYou are a composer of ‚Äògraphical poems‚Äô‚Äù ‚Äî Hadley Wickham Learn more about Gina‚Äôs work here: ggplot2 extenders club website: See previous talks and sign up for future webinars Everyday ggplot2 extension: Education materials for potential extenders ggplot2 extension cookbook: Guide that presents extension strategies in a consistent and accessible way Easy geom recipes: A series of tutorials on creating a tutorial There is a comprehensive list of resources on the ggplot2 extenders club website. Many thanks to Andrew Bray, James Goldie, and the QMD Lab for Closeread, a Quarto extension for scrollytelling, which walked through the ggextender steps, and Gina, for both organizing the ggplot2 extenders club and reviewing this post!",
    "meta_keywords": null,
    "og_description": "If you use ggplot2, you are probably used to creating plots with geom_line() and geom_point(). You may also have ventured into to the broader ggplot2 ecosystem to use geoms like geom_density_ridges() from ggridges or geom_signif() from ggsignif. But have you ever wondered how these extensions were created? Where did the authors figure out how to create a new geom? And, if the plot of your dreams doesn‚Äôt exist, how would you make your own? Enter the exciting world of creating your own ggplot2 extensions. I had the pleasure of meeting Gina Reynolds when I first began my job at Posit (then RStudio) and she was contributing a blog post on flipbookr. Since then, we‚Äôve kept in touch through the ggextenders extension club. Every few months, the club meets virtually to hear from a ggextender (someone who works with ggplot2 extensions). The speaker can talk about a custom geom they‚Äôve created for the community or more general R visualization topics. Each presentation is insightful and interesting. I‚Äôve had the opportunity to learn about cool packages like ggstats. Join us sometime by filling out this questionnaire! However, I was never a ‚Äúggextender‚Äù myself (having just used and never developed extenders). I found the idea of creating an extension daunting. That is, until recently! Gina held a focus group that worked through the Easy geom recipes, a series of tutorials on creating ggplot2 extensions. Following ‚Äúrecipes‚Äù, you methodically create three extensions. Each time, certain key knowledge points are reinforced and new variations are introduced. So, say we want to create a new geom_*() that adds a point on the median of the x-axis and y-axis variables of a plot. We will call it geom_medians(). Let‚Äôs follow the recipe: Step 0. Get the job done with ‚Äòbase‚Äô ggplot2. First, clarify what needs to happen without getting into the extension architecture. Load the tidyverse package and the palmerpenguins package. Calculate the median of the x variable (bill_length_mm) and y variable (bill_depth_mm) as you would normally. Now, use base ggplot2 to get the job done. This requires specifying bill_depth_mm_median and bill_length_mm_median, which we just created, within aes() in geom_point(). This is the resulting plot. Step 1: Define Compute and test. Define the compute that will transform your input data ‚Äúunder the hood‚Äù before rendering it. Next, test the compute to make sure that the output matches what you expect. Note that the names x and y are required. Step 2: Define new Stat. Test. Next, use the ggplot2::ggproto() function, which creates a new Stat function that does computation under the hood when building a plot. Don‚Äôt worry, you don‚Äôt have to write this yourself. This is provided as boilerplate code, all you have to do is edit the relevant code! Test your new Stat by using it in a geom_*() function. Step 3: Define user-facing functions. Test. Now, define the user-facing function. This is more boilerplate code that you edit depending on what you are creating. The stat_*() function name derives from the Stat objects‚Äôs name, but is snake case. ‚ÄúPoint‚Äù is specified as the default for the geom argument in the function. This means that the ggplot2::geom_point() will be used in the layer unless otherwise specified by the user. StatMedians defines the new layer function, so summarizing the medians will be in play before the layer is rendered. Alternatively, the new make_constructor() function, available in ggplot2 v4.0.0, will write much of the above boilerplate code for you. And because users are more accustomed to using layers that have the ‚Äògeom‚Äô prefix, you might also define geom with almost identical properties using make_constructor().The difference between stat_medians and geom_medians is that the stat is fixed in the former, and the geom is fixed in the latter. Now, test your user-facing function by using it in a ggplot2 plot. library(tidyverse) library(palmerpenguins) # Compute penguins_medians summarize(bill_length_mm_median = median(bill_length_mm, na.rm = TRUE), bill_depth_mm_median = median(bill_depth_mm, na.rm = TRUE)) # Plot penguins |> ggplot() + aes(x = bill_depth_mm, y = bill_length_mm) + geom_point() + geom_point(data = penguins_medians, aes(x = bill_depth_mm_median, y = bill_length_mm_median), size = 8, color = \"red\") + labs(title = \"Created with base ggplot2\") # Define compute. compute_group_medians summarize(x = median(x, na.rm = T), y = median(y, na.rm = T)) } # Test compute. penguins |> select(x = bill_depth_mm, y = bill_length_mm) |> compute_group_medians() # A tibble: 1 √ó 2 x y 1 17.3 44.4 StatMedians ggplot() + aes(x = bill_depth_mm, y = bill_length_mm) + geom_point() + geom_point(stat = StatMedians, size = 7) + labs(title = \"Testing StatMedians\") stat_medians ggplot() + aes(x = bill_depth_mm, y = bill_length_mm) + geom_point() + geom_medians(size = 8) + labs(title = \"Testing geom_medians()\") And then you‚Äôre done! You‚Äôve created your first ggplot extension ü•≥. Going through the recipes is a great way to ease into your ggplot2 extension journey. They offer three well-crafted examples with a clear structure and sequence of steps. The boilerplate code looks daunting, but you can copy/paste it and edit it depending on what you are creating; if you want to go into more detail as to what it‚Äôs actually doing, the tutorials provide additional resources. A fun note is that the geom recipes website uses webR and Quarto Live to embed interactive code chunks directly in the tutorial. It makes for an immersive experience while going through the exercises. Want to try your own hand at creating geom_means()? Go through the interactive tutorial in Easy geom recipes! Resources It‚Äôs a delight going through Gina‚Äôs resources, from seeing the adorable ggextenders hex to reading all the touching notes about ggplot2, comparing it to art, food, poetry, and more. It‚Äôs a testament to how a tool can inspire so many. Here are some of my favorites quotations and metaphors: ‚Äúggplot2 lets users ‚Äòspeak their plots into existence‚Äô‚Äù ‚Äî Thomas Lin Pedersen ‚ÄúYou are a composer of ‚Äògraphical poems‚Äô‚Äù ‚Äî Hadley Wickham Learn more about Gina‚Äôs work here: ggplot2 extenders club website: See previous talks and sign up for future webinars Everyday ggplot2 extension: Education materials for potential extenders ggplot2 extension cookbook: Guide that presents extension strategies in a consistent and accessible way Easy geom recipes: A series of tutorials on creating a tutorial There is a comprehensive list of resources on the ggplot2 extenders club website. Many thanks to Andrew Bray, James Goldie, and the QMD Lab for Closeread, a Quarto extension for scrollytelling, which walked through the ggextender steps, and Gina, for both organizing the ggplot2 extenders club and reviewing this post!",
    "og_image": "https://rworks.dev/posts/ggplot2-extensions/index_files/figure-html/unnamed-chunk-3-1.png",
    "og_title": "An Introduction to Writing Your Own ggplot2 Geoms | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 7,
    "sitemap_lastmod": null,
    "twitter_description": "If you use ggplot2, you are probably used to creating plots with geom_line() and geom_point(). You may also have ventured into to the broader ggplot2 ecosystem to use geoms like geom_density_ridges() from ggridges or geom_signif() from ggsignif. But have you ever wondered how these extensions were created? Where did the authors figure out how to create a new geom? And, if the plot of your dreams doesn‚Äôt exist, how would you make your own? Enter the exciting world of creating your own ggplot2 extensions. I had the pleasure of meeting Gina Reynolds when I first began my job at Posit (then RStudio) and she was contributing a blog post on flipbookr. Since then, we‚Äôve kept in touch through the ggextenders extension club. Every few months, the club meets virtually to hear from a ggextender (someone who works with ggplot2 extensions). The speaker can talk about a custom geom they‚Äôve created for the community or more general R visualization topics. Each presentation is insightful and interesting. I‚Äôve had the opportunity to learn about cool packages like ggstats. Join us sometime by filling out this questionnaire! However, I was never a ‚Äúggextender‚Äù myself (having just used and never developed extenders). I found the idea of creating an extension daunting. That is, until recently! Gina held a focus group that worked through the Easy geom recipes, a series of tutorials on creating ggplot2 extensions. Following ‚Äúrecipes‚Äù, you methodically create three extensions. Each time, certain key knowledge points are reinforced and new variations are introduced. So, say we want to create a new geom_*() that adds a point on the median of the x-axis and y-axis variables of a plot. We will call it geom_medians(). Let‚Äôs follow the recipe: Step 0. Get the job done with ‚Äòbase‚Äô ggplot2. First, clarify what needs to happen without getting into the extension architecture. Load the tidyverse package and the palmerpenguins package. Calculate the median of the x variable (bill_length_mm) and y variable (bill_depth_mm) as you would normally. Now, use base ggplot2 to get the job done. This requires specifying bill_depth_mm_median and bill_length_mm_median, which we just created, within aes() in geom_point(). This is the resulting plot. Step 1: Define Compute and test. Define the compute that will transform your input data ‚Äúunder the hood‚Äù before rendering it. Next, test the compute to make sure that the output matches what you expect. Note that the names x and y are required. Step 2: Define new Stat. Test. Next, use the ggplot2::ggproto() function, which creates a new Stat function that does computation under the hood when building a plot. Don‚Äôt worry, you don‚Äôt have to write this yourself. This is provided as boilerplate code, all you have to do is edit the relevant code! Test your new Stat by using it in a geom_*() function. Step 3: Define user-facing functions. Test. Now, define the user-facing function. This is more boilerplate code that you edit depending on what you are creating. The stat_*() function name derives from the Stat objects‚Äôs name, but is snake case. ‚ÄúPoint‚Äù is specified as the default for the geom argument in the function. This means that the ggplot2::geom_point() will be used in the layer unless otherwise specified by the user. StatMedians defines the new layer function, so summarizing the medians will be in play before the layer is rendered. Alternatively, the new make_constructor() function, available in ggplot2 v4.0.0, will write much of the above boilerplate code for you. And because users are more accustomed to using layers that have the ‚Äògeom‚Äô prefix, you might also define geom with almost identical properties using make_constructor().The difference between stat_medians and geom_medians is that the stat is fixed in the former, and the geom is fixed in the latter. Now, test your user-facing function by using it in a ggplot2 plot. library(tidyverse) library(palmerpenguins) # Compute penguins_medians summarize(bill_length_mm_median = median(bill_length_mm, na.rm = TRUE), bill_depth_mm_median = median(bill_depth_mm, na.rm = TRUE)) # Plot penguins |> ggplot() + aes(x = bill_depth_mm, y = bill_length_mm) + geom_point() + geom_point(data = penguins_medians, aes(x = bill_depth_mm_median, y = bill_length_mm_median), size = 8, color = \"red\") + labs(title = \"Created with base ggplot2\") # Define compute. compute_group_medians summarize(x = median(x, na.rm = T), y = median(y, na.rm = T)) } # Test compute. penguins |> select(x = bill_depth_mm, y = bill_length_mm) |> compute_group_medians() # A tibble: 1 √ó 2 x y 1 17.3 44.4 StatMedians ggplot() + aes(x = bill_depth_mm, y = bill_length_mm) + geom_point() + geom_point(stat = StatMedians, size = 7) + labs(title = \"Testing StatMedians\") stat_medians ggplot() + aes(x = bill_depth_mm, y = bill_length_mm) + geom_point() + geom_medians(size = 8) + labs(title = \"Testing geom_medians()\") And then you‚Äôre done! You‚Äôve created your first ggplot extension ü•≥. Going through the recipes is a great way to ease into your ggplot2 extension journey. They offer three well-crafted examples with a clear structure and sequence of steps. The boilerplate code looks daunting, but you can copy/paste it and edit it depending on what you are creating; if you want to go into more detail as to what it‚Äôs actually doing, the tutorials provide additional resources. A fun note is that the geom recipes website uses webR and Quarto Live to embed interactive code chunks directly in the tutorial. It makes for an immersive experience while going through the exercises. Want to try your own hand at creating geom_means()? Go through the interactive tutorial in Easy geom recipes! Resources It‚Äôs a delight going through Gina‚Äôs resources, from seeing the adorable ggextenders hex to reading all the touching notes about ggplot2, comparing it to art, food, poetry, and more. It‚Äôs a testament to how a tool can inspire so many. Here are some of my favorites quotations and metaphors: ‚Äúggplot2 lets users ‚Äòspeak their plots into existence‚Äô‚Äù ‚Äî Thomas Lin Pedersen ‚ÄúYou are a composer of ‚Äògraphical poems‚Äô‚Äù ‚Äî Hadley Wickham Learn more about Gina‚Äôs work here: ggplot2 extenders club website: See previous talks and sign up for future webinars Everyday ggplot2 extension: Education materials for potential extenders ggplot2 extension cookbook: Guide that presents extension strategies in a consistent and accessible way Easy geom recipes: A series of tutorials on creating a tutorial There is a comprehensive list of resources on the ggplot2 extenders club website. Many thanks to Andrew Bray, James Goldie, and the QMD Lab for Closeread, a Quarto extension for scrollytelling, which walked through the ggextender steps, and Gina, for both organizing the ggplot2 extenders club and reviewing this post!",
    "twitter_title": "An Introduction to Writing Your Own ggplot2 Geoms | R-bloggers",
    "url": "https://www.r-bloggers.com/2025/11/an-introduction-to-writing-your-own-ggplot2-geoms/",
    "word_count": 1395
  }
}