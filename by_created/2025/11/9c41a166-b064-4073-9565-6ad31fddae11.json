{
  "uuid": "9c41a166-b064-4073-9565-6ad31fddae11",
  "created_at": "2025-11-22 19:58:37",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2025/05/notes-on-deseq2-design/",
    "crawled_at": "2025-11-22T10:49:04.049293",
    "external_links": [
      {
        "href": "https://onetipperday.blogspot.com/2025/05/notes-on-deseq2-design.html",
        "text": "One Tip Per Day"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://onetipperday.blogspot.com/2025/05/notes-on-deseq2-design.html",
        "text": "One Tip Per Day"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Notes on DEseq2 design | R-bloggers",
    "images": [],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/xianjun-dong/",
        "text": "Xianjun Dong"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-392412 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Notes on DEseq2 design</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">May 13, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/xianjun-dong/\">Xianjun Dong</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://onetipperday.blogspot.com/2025/05/notes-on-deseq2-design.html\"> One Tip Per Day</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47--><p style=\"orphans: auto; widows: auto;\"><span style=\"background-color: #f8f8f8; orphans: 2; widows: 2;\">M</span><span style=\"background-color: #f8f8f8; color: #1d1c1d; font-family: Slack-Lato, Slack-Fractions, appleLogo, sans-serif; font-size: 15px; orphans: 2; widows: 2;\">y note from today’s lab meeting:</span></p><div class=\"p-rich_text_section\" style=\"background-color: #f8f8f8; box-sizing: inherit; color: #1d1c1d; display: inline; font-family: Slack-Lato, Slack-Fractions, appleLogo, sans-serif; font-size: 15px; font-variant-ligatures: common-ligatures; orphans: 2; text-decoration-thickness: initial; widows: 2;\"><span aria-label=\"\" class=\"c-mrkdwn__br\" data-stringify-type=\"paragraph-break\" style=\"box-sizing: inherit; display: block; height: 8px;\"></span></div><ol class=\"p-rich_text_list p-rich_text_list__ordered p-rich_text_list--nested\" data-border=\"0\" data-indent=\"0\" data-list-tree=\"true\" data-stringify-type=\"ordered-list\" style=\"background-color: #f8f8f8; box-sizing: inherit; color: #1d1c1d; font-family: Slack-Lato, Slack-Fractions, appleLogo, sans-serif; font-size: 15px; font-variant-ligatures: common-ligatures; margin: 0px 0px 0px 20px; orphans: 2; padding-inline-start: 0px; padding: 0px; text-decoration-thickness: initial; widows: 2;\"><li data-stringify-border=\"0\" data-stringify-indent=\"0\" style=\"box-sizing: inherit; list-style-type: unset; margin-bottom: 0px; margin-inline-start: 20px; padding-inline-start: 8px;\">For senario like Rambo’s project, where in a case-control two group comparison, each subject has multiple repeats (or multiple time points). To test the genes associated with the condition, you <span data-stringify-type=\"bold\" style=\"box-sizing: inherit;\">must model subject as a blocking factor (random effect)</span> to properly control for <span data-stringify-type=\"bold\" style=\"box-sizing: inherit;\">within-subject</span> correlations. DEseq2 does not take random effect directly, so we typically use <span data-stringify-type=\"bold\" style=\"box-sizing: inherit;\">linear mixed effect </span>model from other packages like <code>voom</code> or <code>dream</code> in variancePartition for such data. Here is the correct design to linear mixed effect model wehre subjectID is a random effect:  <code>design &lt;- ~ group * time + age + sex + (1|subject_id)</code> (Please note that <code>group * time</code> part is same as <code>group + time + group:time</code> where <code>group:time</code> is the interaction term.)<ol class=\"p-rich_text_list p-rich_text_list__ordered p-rich_text_list--nested\" data-border=\"0\" data-indent=\"1\" data-list-tree=\"true\" data-stringify-type=\"ordered-list\" style=\"box-sizing: inherit; list-style-type: lower-alpha; margin: 0px 0px 0px 20px; padding-inline-start: 0px; padding: 0px;\"><li data-stringify-border=\"0\" data-stringify-indent=\"1\" style=\"box-sizing: inherit; list-style-type: unset; margin-bottom: 0px; margin-inline-start: 20px; padding-inline-start: 8px;\">If you still want to use DESeq2 (limited option), you can collapse the repeated measures <span data-stringify-type=\"bold\" style=\"box-sizing: inherit;\">by treating </span><code>subject_id</code><span data-stringify-type=\"bold\" style=\"box-sizing: inherit;\"> as a fixed effect</span> (only works if subjects are not too many), e.g. <code>design = ~ subjectID + age + sex + group</code>. For case where you have many subject (e.g. usually n&gt;20), you don't want to do that as each subjectID will become a dummy variable and it will be very computationally expensive to calculate coefficiency.</li><li data-stringify-border=\"0\" data-stringify-indent=\"1\" style=\"box-sizing: inherit; list-style-type: unset; margin-bottom: 0px; margin-inline-start: 20px; padding-inline-start: 8px;\">Another way to test the interaction term in DEseq2 (or other similar framework) is to use <span data-stringify-type=\"bold\" style=\"box-sizing: inherit;\">LRT (likelihood ratio test)</span> between two designs: e.g. full mode <code>design = ~ subject_id + time + group + group:time</code> and reduce mode as <code>~ subject_id + time + group</code> , then in DEseq2, you can call function like  <code>dds &lt;- DESeq(dds, test=\"LRT\", reduced = ~ subject_id + time + group)</code> to get the genes with expression changes over time differ between groups (aka: progression-associated genes).</li></ol></li><li data-stringify-border=\"0\" data-stringify-indent=\"0\" style=\"box-sizing: inherit; list-style-type: unset; margin-bottom: 0px; margin-inline-start: 20px; padding-inline-start: 8px;\">For senario like Himanshu's project, where each subject has a <span data-stringify-type=\"bold\" style=\"box-sizing: inherit;\">paired condition</span> (e.g. before and after drug treatment, or neuroma and paired non-neuroma tissue). To test the genes associated with the condition, you can simply include the subjectID as a covariate e.g. <code>design = ~ subjectID + age + sex + condition</code>.</li></ol>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://onetipperday.blogspot.com/2025/05/notes-on-deseq2-design.html\"> One Tip Per Day</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
    "main_text": "Notes on DEseq2 design\nPosted on\nMay 13, 2025\nby\nXianjun Dong\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nOne Tip Per Day\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nM\ny note from today’s lab meeting:\nFor senario like Rambo’s project, where in a case-control two group comparison, each subject has multiple repeats (or multiple time points). To test the genes associated with the condition, you\nmust model subject as a blocking factor (random effect)\nto properly control for\nwithin-subject\ncorrelations. DEseq2 does not take random effect directly, so we typically use\nlinear mixed effect\nmodel from other packages like\nvoom\nor\ndream\nin variancePartition for such data. Here is the correct design to linear mixed effect model wehre subjectID is a random effect:\ndesign <- ~ group * time + age + sex + (1|subject_id)\n(Please note that\ngroup * time\npart is same as\ngroup + time + group:time\nwhere\ngroup:time\nis the interaction term.)\nIf you still want to use DESeq2 (limited option), you can collapse the repeated measures\nby treating\nsubject_id\nas a fixed effect\n(only works if subjects are not too many), e.g.\ndesign = ~ subjectID + age + sex + group\n. For case where you have many subject (e.g. usually n>20), you don't want to do that as each subjectID will become a dummy variable and it will be very computationally expensive to calculate coefficiency.\nAnother way to test the interaction term in DEseq2 (or other similar framework) is to use\nLRT (likelihood ratio test)\nbetween two designs: e.g. full mode\ndesign = ~ subject_id + time + group + group:time\nand reduce mode as\n~ subject_id + time + group\n, then in DEseq2, you can call function like\ndds <- DESeq(dds, test=\"LRT\", reduced = ~ subject_id + time + group)\nto get the genes with expression changes over time differ between groups (aka: progression-associated genes).\nFor senario like Himanshu's project, where each subject has a\npaired condition\n(e.g. before and after drug treatment, or neuroma and paired non-neuroma tissue). To test the genes associated with the condition, you can simply include the subjectID as a covariate e.g.\ndesign = ~ subjectID + age + sex + condition\n.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nOne Tip Per Day\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "My note from today's lab meeting:For senario like Rambo's project, where in a case-control two group comparison, each subject has multiple repeats (or multiple time points). To test the genes associated with the condition, you must model subject a...",
    "meta_keywords": null,
    "og_description": "My note from today's lab meeting:For senario like Rambo's project, where in a case-control two group comparison, each subject has multiple repeats (or multiple time points). To test the genes associated with the condition, you must model subject a...",
    "og_image": "https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png",
    "og_title": "Notes on DEseq2 design | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 2.3,
    "sitemap_lastmod": null,
    "twitter_description": "My note from today's lab meeting:For senario like Rambo's project, where in a case-control two group comparison, each subject has multiple repeats (or multiple time points). To test the genes associated with the condition, you must model subject a...",
    "twitter_title": "Notes on DEseq2 design | R-bloggers",
    "url": "https://www.r-bloggers.com/2025/05/notes-on-deseq2-design/",
    "word_count": 466
  }
}