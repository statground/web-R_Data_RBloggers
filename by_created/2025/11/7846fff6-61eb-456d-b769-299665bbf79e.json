{
  "uuid": "7846fff6-61eb-456d-b769-299665bbf79e",
  "created_at": "2025-11-17 20:40:03",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2009/11/rs-xtabs-for-total-weighted-read-coverage/",
    "crawled_at": "2025-11-17T10:18:29.176928",
    "external_links": [
      {
        "href": "https://jermdemo.blogspot.com/2009/11/rs-xtabs-for-total-weighted-read.html",
        "text": "Jermdemo Raised to the Law"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "http://stat.ethz.ch/R-manual/R-patched/library/stats/html/xtabs.html",
        "text": "xtabs"
      },
      {
        "href": "https://jermdemo.blogspot.com/2009/11/rs-xtabs-for-total-weighted-read.html",
        "text": "Jermdemo Raised to the Law"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "R’s xtabs for total weighted read coverage | R-bloggers",
    "images": [],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/jeremy-leipzig/",
        "text": "Jeremy Leipzig"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-14140 post type-post status-publish format-standard hentry\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">R’s xtabs for total weighted read coverage</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">November 4, 2009</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/jeremy-leipzig/\">Jeremy Leipzig</a></span>  in Uncategorized | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<p class=\"syndicated-attribution\"><!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://jermdemo.blogspot.com/2009/11/rs-xtabs-for-total-weighted-read.html\"> Jermdemo Raised to the Law</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div></p>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->Samtools and its BioPerl wrapper Bio::DB:Sam prefer to give read coverage on a depth per base pair basis. This is typically an array of depths, one for every position that has at least one read aligned. OK, works for me. But how can we quickly see which targets (in my case transcripts) have the greatest total weighted read coverage (i.e. sum every base pair of every read that aligned)?<br/><br/>My solution is to take that target-pos-depth information and import a table into R with at least the following columns:<br/>targetName<br/>depth<br/><br/>I added the pos column here to emphasize the base-pair granularity<br/><pre>         tx pos depth\n1   tx500090 227     1\n2   tx500090 228     1\n3   tx500090 229     1\n4   tx500090 230     1\n5   tx500090 231     1\n...\n66  tx500123 184     1\n67  tx500123 185     1\n68  tx500123 186     1\n69  tx500123 187     2\n70  tx500123 188     2\n71  tx500123 189     2</pre><br/>In R<br/><pre>myCoverage&lt;-read.table(\"myCoverage.txt\",header=TRUE)\nmyxTab&lt;-xtabs(depth ~ tx,data=myCoverage)</pre><br/><a href=\"http://stat.ethz.ch/R-manual/R-patched/library/stats/html/xtabs.html\" rel=\"nofollow\" target=\"_blank\">xtabs</a> will sum up depth-weighted positions by default (i suppose this is what tabulated contigency really means) and return an unsorted list of transcripts and their weighted coverage (total base pair read coverage)<br/><pre>&gt; myxTab[1:100]\ntx\ntx500090 tx500123 tx500134 tx500155 tx500170 tx500178 tx500203 tx500207\n      38       92      610       46      176       46       92      130\ntx500273 tx500441 tx500481 tx500482 tx500501 tx500507 tx500667 tx500684\n      76     2390      114    71228      762      222      542      442\ntx500945 tx500955 tx501016 tx501120 tx501127 tx501169 tx501190 tx501192\n    1378     3604       46       46      420      854      130      352\ntx501206 tx501226 tx501229 tx501245 tx501270 tx501297 tx501390 tx501405\n     244     1204      206    15926      214       46      168       46\ntx501406 tx501438 tx501504 tx501694 tx501702 tx501877 tx501902 tx502238\n      38     2572     7768     3274      314      298       84      198\ntx502320 tx502364 tx502403 tx502414 tx502462 tx502515 tx502517 tx502519\n     122       38      588       46       46       38       38      466\ntx502610 tx502624 tx502680 tx502841 tx502882 tx503090 tx503192 tx503204\n     206       38      168     3750       38      122       76       92\ntx503416 tx503468 tx503523 tx503536 tx503571 tx503578 tx503623 tx503700\n     260       38      168       38       46       46       84       38\ntx503720 tx503721 tx503722 tx503788 tx503872 tx503892 tx503930 tx503970\n   97112       38       38     4708       38       38     1290       84\ntx503995 tx504107 tx504115 tx504346 tx504353 tx504355 tx504357 tx504398\n      46      152      206       46     3416     1402      122      290\ntx504434 tx504483 tx504523 tx504589 tx504612 tx504711 tx504751 tx504827\n     290     8728      176       46       46       76     5644     1308\ntx504828 tx504834 tx504882 tx504931 tx504952 tx505017 tx505029 tx505078\n    2336      328       46    34138     1000     1838       46      474\ntx505123 tx505146 tx505159 tx505184\n      38   123344      160      588</pre><br/>this is approximately 10000x faster than using a formula like:<br/><pre>by(myCoverage,myCoverage$tx,function(x){sum(x$depth)}</pre>\n\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->\n<p class=\"syndicated-attribution\"><div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://jermdemo.blogspot.com/2009/11/rs-xtabs-for-total-weighted-read.html\"> Jermdemo Raised to the Law</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div></p> </div>\n</article>",
    "main_text": "R’s xtabs for total weighted read coverage\nPosted on\nNovember 4, 2009\nby\nJeremy Leipzig\nin Uncategorized | 0 Comments\n[This article was first published on\nJermdemo Raised to the Law\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nSamtools and its BioPerl wrapper Bio::DB:Sam prefer to give read coverage on a depth per base pair basis. This is typically an array of depths, one for every position that has at least one read aligned. OK, works for me. But how can we quickly see which targets (in my case transcripts) have the greatest total weighted read coverage (i.e. sum every base pair of every read that aligned)?\nMy solution is to take that target-pos-depth information and import a table into R with at least the following columns:\ntargetName\ndepth\nI added the pos column here to emphasize the base-pair granularity\ntx pos depth\n1   tx500090 227     1\n2   tx500090 228     1\n3   tx500090 229     1\n4   tx500090 230     1\n5   tx500090 231     1\n...\n66  tx500123 184     1\n67  tx500123 185     1\n68  tx500123 186     1\n69  tx500123 187     2\n70  tx500123 188     2\n71  tx500123 189     2\nIn R\nmyCoverage<-read.table(\"myCoverage.txt\",header=TRUE)\nmyxTab<-xtabs(depth ~ tx,data=myCoverage)\nxtabs\nwill sum up depth-weighted positions by default (i suppose this is what tabulated contigency really means) and return an unsorted list of transcripts and their weighted coverage (total base pair read coverage)\n> myxTab[1:100]\ntx\ntx500090 tx500123 tx500134 tx500155 tx500170 tx500178 tx500203 tx500207\n      38       92      610       46      176       46       92      130\ntx500273 tx500441 tx500481 tx500482 tx500501 tx500507 tx500667 tx500684\n      76     2390      114    71228      762      222      542      442\ntx500945 tx500955 tx501016 tx501120 tx501127 tx501169 tx501190 tx501192\n    1378     3604       46       46      420      854      130      352\ntx501206 tx501226 tx501229 tx501245 tx501270 tx501297 tx501390 tx501405\n     244     1204      206    15926      214       46      168       46\ntx501406 tx501438 tx501504 tx501694 tx501702 tx501877 tx501902 tx502238\n      38     2572     7768     3274      314      298       84      198\ntx502320 tx502364 tx502403 tx502414 tx502462 tx502515 tx502517 tx502519\n     122       38      588       46       46       38       38      466\ntx502610 tx502624 tx502680 tx502841 tx502882 tx503090 tx503192 tx503204\n     206       38      168     3750       38      122       76       92\ntx503416 tx503468 tx503523 tx503536 tx503571 tx503578 tx503623 tx503700\n     260       38      168       38       46       46       84       38\ntx503720 tx503721 tx503722 tx503788 tx503872 tx503892 tx503930 tx503970\n   97112       38       38     4708       38       38     1290       84\ntx503995 tx504107 tx504115 tx504346 tx504353 tx504355 tx504357 tx504398\n      46      152      206       46     3416     1402      122      290\ntx504434 tx504483 tx504523 tx504589 tx504612 tx504711 tx504751 tx504827\n     290     8728      176       46       46       76     5644     1308\ntx504828 tx504834 tx504882 tx504931 tx504952 tx505017 tx505029 tx505078\n    2336      328       46    34138     1000     1838       46      474\ntx505123 tx505146 tx505159 tx505184\n      38   123344      160      588\nthis is approximately 10000x faster than using a formula like:\nby(myCoverage,myCoverage$tx,function(x){sum(x$depth)}\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nJermdemo Raised to the Law\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "Samtools and its BioPerl wrapper Bio::DB:Sam prefer to give read coverage on a depth per base pair basis. This is typically an array of depths, one for every position that has at least one read aligned. OK, works for me. But how can we quickly see which targets (in my case transcripts) have the greatest total weighted read coverage (i.e. sum every base pair of every read that aligned)?My solution is to take that target-pos-depth information and import a table into R with at least the following columns:targetNamedepthI added the pos column here to emphasize the base-pair granularity tx pos depth1 tx500090 227 12 tx500090 228 13 tx500090 229 14 tx500090 230 15 tx500090 231 1...66 tx500123 184 167 tx500123 185 168 tx500123 186 169 tx500123 187 270 tx500123 188 271 tx500123 189 2 In RmyCoveragemyxTabxtabs will sum up depth-weighted positions by default (i suppose this is what tabulated contigency really means) and return an unsorted list of transcripts and their weighted coverage (total base pair read coverage)> myxTab[1:100]txtx500090 tx500123 tx500134 tx500155 tx500170 tx500178 tx500203 tx500207 38 92 610 46 176 46 92 130tx500273 tx500441 tx500481 tx500482 tx500501 tx500507 tx500667 tx500684 76 2390 114 71228 762 222 542 442tx500945 tx500955 tx501016 tx501120 tx501127 tx501169 tx501190 tx501192 1378 3604 46 46 420 854 130 352tx501206 tx501226 tx501229 tx501245 tx501270 tx501297 tx501390 tx501405 244 1204 206 15926 214 46 168 46tx501406 tx501438 tx501504 tx501694 tx501702 tx501877 tx501902 tx502238 38 2572 7768 3274 314 298 84 198tx502320 tx502364 tx502403 tx502414 tx502462 tx502515 tx502517 tx502519 122 38 588 46 46 38 38 466tx502610 tx502624 tx502680 tx502841 tx502882 tx503090 tx503192 tx503204 206 38 168 3750 38 122 76 92tx503416 tx503468 tx503523 tx503536 tx503571 tx503578 tx503623 tx503700 260 38 168 38 46 46 84 38tx503720 tx503721 tx503722 tx503788 tx503872 tx503892 tx503930 tx503970 97112 38 38 4708 38 38 1290 84tx503995 tx504107 tx504115 tx504346 tx504353 tx504355 tx504357 tx504398 46 152 206 46 3416 1402 122 290tx504434 tx504483 tx504523 tx504589 tx504612 tx504711 tx504751 tx504827 290 8728 176 46 46 76 5644 1308tx504828 tx504834 tx504882 tx504931 tx504952 tx505017 tx505029 tx505078 2336 328 46 34138 1000 1838 46 474tx505123 tx505146 tx505159 tx505184 38 123344 160 588this is approximately 10000x faster than using a formula like:by(myCoverage,myCoverage$tx,function(x){sum(x$depth)}",
    "meta_keywords": null,
    "og_description": "Samtools and its BioPerl wrapper Bio::DB:Sam prefer to give read coverage on a depth per base pair basis. This is typically an array of depths, one for every position that has at least one read aligned. OK, works for me. But how can we quickly see which targets (in my case transcripts) have the greatest total weighted read coverage (i.e. sum every base pair of every read that aligned)?My solution is to take that target-pos-depth information and import a table into R with at least the following columns:targetNamedepthI added the pos column here to emphasize the base-pair granularity tx pos depth1 tx500090 227 12 tx500090 228 13 tx500090 229 14 tx500090 230 15 tx500090 231 1...66 tx500123 184 167 tx500123 185 168 tx500123 186 169 tx500123 187 270 tx500123 188 271 tx500123 189 2 In RmyCoveragemyxTabxtabs will sum up depth-weighted positions by default (i suppose this is what tabulated contigency really means) and return an unsorted list of transcripts and their weighted coverage (total base pair read coverage)> myxTab[1:100]txtx500090 tx500123 tx500134 tx500155 tx500170 tx500178 tx500203 tx500207 38 92 610 46 176 46 92 130tx500273 tx500441 tx500481 tx500482 tx500501 tx500507 tx500667 tx500684 76 2390 114 71228 762 222 542 442tx500945 tx500955 tx501016 tx501120 tx501127 tx501169 tx501190 tx501192 1378 3604 46 46 420 854 130 352tx501206 tx501226 tx501229 tx501245 tx501270 tx501297 tx501390 tx501405 244 1204 206 15926 214 46 168 46tx501406 tx501438 tx501504 tx501694 tx501702 tx501877 tx501902 tx502238 38 2572 7768 3274 314 298 84 198tx502320 tx502364 tx502403 tx502414 tx502462 tx502515 tx502517 tx502519 122 38 588 46 46 38 38 466tx502610 tx502624 tx502680 tx502841 tx502882 tx503090 tx503192 tx503204 206 38 168 3750 38 122 76 92tx503416 tx503468 tx503523 tx503536 tx503571 tx503578 tx503623 tx503700 260 38 168 38 46 46 84 38tx503720 tx503721 tx503722 tx503788 tx503872 tx503892 tx503930 tx503970 97112 38 38 4708 38 38 1290 84tx503995 tx504107 tx504115 tx504346 tx504353 tx504355 tx504357 tx504398 46 152 206 46 3416 1402 122 290tx504434 tx504483 tx504523 tx504589 tx504612 tx504711 tx504751 tx504827 290 8728 176 46 46 76 5644 1308tx504828 tx504834 tx504882 tx504931 tx504952 tx505017 tx505029 tx505078 2336 328 46 34138 1000 1838 46 474tx505123 tx505146 tx505159 tx505184 38 123344 160 588this is approximately 10000x faster than using a formula like:by(myCoverage,myCoverage$tx,function(x){sum(x$depth)}",
    "og_image": "https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png",
    "og_title": "R’s xtabs for total weighted read coverage | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 2.9,
    "sitemap_lastmod": "2010-04-14T19:51:28+00:00",
    "twitter_description": "Samtools and its BioPerl wrapper Bio::DB:Sam prefer to give read coverage on a depth per base pair basis. This is typically an array of depths, one for every position that has at least one read aligned. OK, works for me. But how can we quickly see which targets (in my case transcripts) have the greatest total weighted read coverage (i.e. sum every base pair of every read that aligned)?My solution is to take that target-pos-depth information and import a table into R with at least the following columns:targetNamedepthI added the pos column here to emphasize the base-pair granularity tx pos depth1 tx500090 227 12 tx500090 228 13 tx500090 229 14 tx500090 230 15 tx500090 231 1...66 tx500123 184 167 tx500123 185 168 tx500123 186 169 tx500123 187 270 tx500123 188 271 tx500123 189 2 In RmyCoveragemyxTabxtabs will sum up depth-weighted positions by default (i suppose this is what tabulated contigency really means) and return an unsorted list of transcripts and their weighted coverage (total base pair read coverage)> myxTab[1:100]txtx500090 tx500123 tx500134 tx500155 tx500170 tx500178 tx500203 tx500207 38 92 610 46 176 46 92 130tx500273 tx500441 tx500481 tx500482 tx500501 tx500507 tx500667 tx500684 76 2390 114 71228 762 222 542 442tx500945 tx500955 tx501016 tx501120 tx501127 tx501169 tx501190 tx501192 1378 3604 46 46 420 854 130 352tx501206 tx501226 tx501229 tx501245 tx501270 tx501297 tx501390 tx501405 244 1204 206 15926 214 46 168 46tx501406 tx501438 tx501504 tx501694 tx501702 tx501877 tx501902 tx502238 38 2572 7768 3274 314 298 84 198tx502320 tx502364 tx502403 tx502414 tx502462 tx502515 tx502517 tx502519 122 38 588 46 46 38 38 466tx502610 tx502624 tx502680 tx502841 tx502882 tx503090 tx503192 tx503204 206 38 168 3750 38 122 76 92tx503416 tx503468 tx503523 tx503536 tx503571 tx503578 tx503623 tx503700 260 38 168 38 46 46 84 38tx503720 tx503721 tx503722 tx503788 tx503872 tx503892 tx503930 tx503970 97112 38 38 4708 38 38 1290 84tx503995 tx504107 tx504115 tx504346 tx504353 tx504355 tx504357 tx504398 46 152 206 46 3416 1402 122 290tx504434 tx504483 tx504523 tx504589 tx504612 tx504711 tx504751 tx504827 290 8728 176 46 46 76 5644 1308tx504828 tx504834 tx504882 tx504931 tx504952 tx505017 tx505029 tx505078 2336 328 46 34138 1000 1838 46 474tx505123 tx505146 tx505159 tx505184 38 123344 160 588this is approximately 10000x faster than using a formula like:by(myCoverage,myCoverage$tx,function(x){sum(x$depth)}",
    "twitter_title": "R’s xtabs for total weighted read coverage | R-bloggers",
    "url": "https://www.r-bloggers.com/2009/11/rs-xtabs-for-total-weighted-read-coverage/",
    "word_count": 574
  }
}