{
  "id": "5a5fd130623c670e215b027a591a4f6ecabdf0ab",
  "url": "https://www.r-bloggers.com/2009/12/ncep-global-forecast-system/",
  "created_at_utc": "2025-11-17T20:39:43Z",
  "data": null,
  "raw_original": {
    "uuid": "1a18cdf5-ba31-48e3-9b2d-32bfac6705cf",
    "created_at": "2025-11-17 20:39:43",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2009/12/ncep-global-forecast-system/",
      "crawled_at": "2025-11-17T10:11:14.512170",
      "external_links": [
        {
          "href": "http://joewheatley.net/ncep-global-forecast-system/",
          "text": "Biospherica » R"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "http://www.nco.ncep.noaa.gov/",
          "text": "NCEP"
        },
        {
          "href": "https://i0.wp.com/joewheatley.net/wp-content/uploads/2009/12/t2m.jpeg",
          "text": null
        },
        {
          "href": "http://www.nco.ncep.noaa.gov/pmb/products/gfs/",
          "text": "GFS forecasts"
        },
        {
          "href": "http://www.unidata.ucar.edu/software/netcdf/",
          "text": "netcdf"
        },
        {
          "href": "http://www.nco.ncep.noaa.gov/pmb/products/gfs/gfs.t00z.sfluxgrbf00.grib2.shtml",
          "text": "here"
        },
        {
          "href": "http://www.cpc.noaa.gov/products/wesley/wgrib2/",
          "text": "wgrib2"
        },
        {
          "href": "http://joewheatley.net/ncep-global-forecast-system/",
          "text": "Biospherica » R"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "NCEP Global Forecast System | R-bloggers",
      "images": [
        {
          "alt": "t2m",
          "base64": null,
          "src": "https://i2.wp.com/joewheatley.net/wp-content/uploads/2009/12/t2m-1024x572.jpg?w=450"
        },
        {
          "alt": "t2m",
          "base64": null,
          "src": "https://i2.wp.com/joewheatley.net/wp-content/uploads/2009/12/t2m-1024x572.jpg?w=450"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/joe/",
          "text": "joe"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-9550 post type-post status-publish format-standard hentry\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">NCEP Global Forecast System</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 16, 2009</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/joe/\">joe</a></span>  in Uncategorized | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<p class=\"syndicated-attribution\"><!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"http://joewheatley.net/ncep-global-forecast-system/\"> Biospherica » R</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div></p>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.0--><p>Just about everyone is familiar with weather maps. There are many situations where it is useful to combine the underlying numerical weather data with other types of information. Accessing  the weather data is a necessary first step.</p>\n<p>The output from the U.S. National Centers for Environmental Prediction (<strong><a href=\"http://www.nco.ncep.noaa.gov/\" rel=\"nofollow\" target=\"_blank\">NCEP</a></strong>) Global  Forecast System (GFS) is freely available. The surface resolution of the model is ≈ 0.3º× 0.3°. The model runs every 6 hours, producing forecasts at 3-hourly intervals extending out to 16 days. As an example of output from GFS, the map (below) shows the predicted average  temperature at 2 metres over the entire globe for the next 24 hr (date of this post). The map shows predicted cold conditions in Europe, and the continuing heatwave in Australia.</p>\n<p><a href=\"https://i0.wp.com/joewheatley.net/wp-content/uploads/2009/12/t2m.jpeg\" rel=\"nofollow\" target=\"_blank\"><img alt=\"t2m\" class=\"aligncenter size-large wp-image-1685 jetpack-lazy-image\" data-lazy-src=\"https://i2.wp.com/joewheatley.net/wp-content/uploads/2009/12/t2m-1024x572.jpg?w=450&amp;is-pending-load=1\" data-recalc-dims=\"1\" loading=\"lazy\" src=\"https://i2.wp.com/joewheatley.net/wp-content/uploads/2009/12/t2m-1024x572.jpg?w=450\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" title=\"t2m\"/><noscript><img alt=\"t2m\" class=\"aligncenter size-large wp-image-1685\" data-recalc-dims=\"1\" loading=\"lazy\" src=\"https://i2.wp.com/joewheatley.net/wp-content/uploads/2009/12/t2m-1024x572.jpg?w=450\" title=\"t2m\"/></noscript></a></p>\n<h3>How the map was made</h3>\n<p><strong><a href=\"http://www.nco.ncep.noaa.gov/pmb/products/gfs/\" rel=\"nofollow\" target=\"_blank\">GFS forecasts</a></strong> are in a format called GRIB2. According to Wikipedia, <em><strong>“</strong>GRIB (GRIdded Binary) is a mathematically concise data format commonly used in meteorology to store historical and forecast weather data.” </em>GRIB files contain physical fields such as temperature, humidity etc defined on a spatial grid, as well as boundary conditions such as vegetation type and elevation. The data might be assimilated from observations, or output from a forecast model.</p>\n<p>The first step is to translate the GRIB into a raster format such as <strong><a href=\"http://www.unidata.ucar.edu/software/netcdf/\" rel=\"nofollow\" target=\"_blank\">netcdf</a></strong> which can be read in <em>R</em><strong><em>. </em></strong>For example, the GRIB2 file <em>gfs.2009121700/gfs.t00z.sfluxgrbf03.grib2</em> contains the 3-hr forecast surface data on 17 Dec 2009  produced at 00 UTC (midnight universal time). An inventory of the data contained in this file can be seen <strong><a href=\"http://www.nco.ncep.noaa.gov/pmb/products/gfs/gfs.t00z.sfluxgrbf00.grib2.shtml\" rel=\"nofollow\" target=\"_blank\">here</a></strong>. Download this forecast as <em>temp.grb</em></p>\n<p><code>loc=file.path(\"ftp://ftp.ncep.noaa.gov/pub/data/nccf/com/gfs/prod/gfs.2009121700/gfs.t00z.sfluxgrbf03.grib2\")\n\ndownload.file(loc,\"temp.grb\",mode=\"wb\")</code></p>\n<p>To read <em>temp.grb</em> a utility called <strong><a href=\"http://www.cpc.noaa.gov/products/wesley/wgrib2/\" rel=\"nofollow\" target=\"_blank\">wgrib2</a></strong> needs to be installed on your system. Then data such as land fraction can extracted into a netcdf file <em>LAND.nc</em> using the <em>R</em> shell command</p>\n<p><code>shell(\"wgrib2 -s temp03.grb | grep :LAND: | wgrib2 -i temp00.grb -netcdf LAND.nc\",intern=T)</code></p>\n<p>The ncdf package can now be used to read the contents of <em>LAND.nc</em>.</p>\n<p><code>library(ncdf)\n\nlandFrac &lt;-open.ncdf(\"LAND.nc\")\n\nland &lt;- get.var.ncdf(landFrac,\"LAND_surface\")\n\nx &lt;- get.var.ncdf(landFrac,\"longitude\")\n\ny &lt;- get.var.ncdf(landFrac,\"latitude\")</code></p>\n<p>The 1152×576 matrix <em>land</em> takes values 1 for land and 0 for water (sea-ice is 1). x and y are the longitude and latitude of the non-uniform GFS grid.</p>\n<p>2m temperature data can be read in the same way. The average of the first 8  forecasts was called <em>t2m.mean</em> and plotted using <em>image.plot()</em> from the fields package:</p>\n<p><code>library(fields)\n\nrgb.palette &lt;- colorRampPalette(c(\"snow1\",\"snow2\",\"snow3\",\"seagreen\",\"orange\",\"firebrick\"), space = \"rgb\")#colors\n\nimage.plot(x,y,t2m.mean,col=rgb.palette(200),axes=F,main=as.expression(paste(\"GFS 24hr Average 2M Temperature\",day,\"00 UTC\",sep=\"\")),axes=F,legend.lab=\"o C\")\n\ncontour(x,y,land,add=TRUE,lwd=1,levels=0.99,drawlabels=FALSE,col=\"grey30\") #add land outline </code></p>\n\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->\n<p class=\"syndicated-attribution\"><div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"http://joewheatley.net/ncep-global-forecast-system/\"> Biospherica » R</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div></p> </div>\n</article>",
      "main_text": "NCEP Global Forecast System\nPosted on\nDecember 16, 2009\nby\njoe\nin Uncategorized | 0 Comments\n[This article was first published on\nBiospherica » R\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nJust about everyone is familiar with weather maps. There are many situations where it is useful to combine the underlying numerical weather data with other types of information. Accessing  the weather data is a necessary first step.\nThe output from the U.S. National Centers for Environmental Prediction (\nNCEP\n) Global  Forecast System (GFS) is freely available. The surface resolution of the model is ≈ 0.3º× 0.3°. The model runs every 6 hours, producing forecasts at 3-hourly intervals extending out to 16 days. As an example of output from GFS, the map (below) shows the predicted average  temperature at 2 metres over the entire globe for the next 24 hr (date of this post). The map shows predicted cold conditions in Europe, and the continuing heatwave in Australia.\nHow the map was made\nGFS forecasts\nare in a format called GRIB2. According to Wikipedia,\n“\nGRIB (GRIdded Binary) is a mathematically concise data format commonly used in meteorology to store historical and forecast weather data.”\nGRIB files contain physical fields such as temperature, humidity etc defined on a spatial grid, as well as boundary conditions such as vegetation type and elevation. The data might be assimilated from observations, or output from a forecast model.\nThe first step is to translate the GRIB into a raster format such as\nnetcdf\nwhich can be read in\nR\n.\nFor example, the GRIB2 file\ngfs.2009121700/gfs.t00z.sfluxgrbf03.grib2\ncontains the 3-hr forecast surface data on 17 Dec 2009  produced at 00 UTC (midnight universal time). An inventory of the data contained in this file can be seen\nhere\n. Download this forecast as\ntemp.grb\nloc=file.path(\"ftp://ftp.ncep.noaa.gov/pub/data/nccf/com/gfs/prod/gfs.2009121700/gfs.t00z.sfluxgrbf03.grib2\")\n\ndownload.file(loc,\"temp.grb\",mode=\"wb\")\nTo read\ntemp.grb\na utility called\nwgrib2\nneeds to be installed on your system. Then data such as land fraction can extracted into a netcdf file\nLAND.nc\nusing the\nR\nshell command\nshell(\"wgrib2 -s temp03.grb | grep :LAND: | wgrib2 -i temp00.grb -netcdf LAND.nc\",intern=T)\nThe ncdf package can now be used to read the contents of\nLAND.nc\n.\nlibrary(ncdf)\n\nlandFrac <-open.ncdf(\"LAND.nc\")\n\nland <- get.var.ncdf(landFrac,\"LAND_surface\")\n\nx <- get.var.ncdf(landFrac,\"longitude\")\n\ny <- get.var.ncdf(landFrac,\"latitude\")\nThe 1152×576 matrix\nland\ntakes values 1 for land and 0 for water (sea-ice is 1). x and y are the longitude and latitude of the non-uniform GFS grid.\n2m temperature data can be read in the same way. The average of the first 8  forecasts was called\nt2m.mean\nand plotted using\nimage.plot()\nfrom the fields package:\nlibrary(fields)\n\nrgb.palette <- colorRampPalette(c(\"snow1\",\"snow2\",\"snow3\",\"seagreen\",\"orange\",\"firebrick\"), space = \"rgb\")#colors\n\nimage.plot(x,y,t2m.mean,col=rgb.palette(200),axes=F,main=as.expression(paste(\"GFS 24hr Average 2M Temperature\",day,\"00 UTC\",sep=\"\")),axes=F,legend.lab=\"o C\")\n\ncontour(x,y,land,add=TRUE,lwd=1,levels=0.99,drawlabels=FALSE,col=\"grey30\") #add land outline\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nBiospherica » R\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Just about everyone is familiar with weather maps. There are many situations where it is useful to combine the underlying numerical weather data with other types of information. Accessing the weather data is a necessary first step. The output from the U.S. National Centers for Environmental Prediction (NCEP) Global Forecast System (GFS) is freely available. [...]",
      "meta_keywords": null,
      "og_description": "Just about everyone is familiar with weather maps. There are many situations where it is useful to combine the underlying numerical weather data with other types of information. Accessing the weather data is a necessary first step. The output from the U.S. National Centers for Environmental Prediction (NCEP) Global Forecast System (GFS) is freely available. [...]",
      "og_image": "https://joewheatley.net/wp-content/uploads/2009/12/t2m-1024x572.jpg",
      "og_title": "NCEP Global Forecast System | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 3.3,
      "sitemap_lastmod": "2009-12-16T11:14:32+00:00",
      "twitter_description": "Just about everyone is familiar with weather maps. There are many situations where it is useful to combine the underlying numerical weather data with other types of information. Accessing the weather data is a necessary first step. The output from the U.S. National Centers for Environmental Prediction (NCEP) Global Forecast System (GFS) is freely available. [...]",
      "twitter_title": "NCEP Global Forecast System | R-bloggers",
      "url": "https://www.r-bloggers.com/2009/12/ncep-global-forecast-system/",
      "word_count": 651
    }
  }
}