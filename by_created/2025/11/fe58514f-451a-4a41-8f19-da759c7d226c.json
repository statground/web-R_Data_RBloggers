{
  "uuid": "fe58514f-451a-4a41-8f19-da759c7d226c",
  "created_at": "2025-11-17 20:39:11",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2023/11/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/",
    "crawled_at": "2025-11-17T09:53:57.167162",
    "external_links": [
      {
        "href": "https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/",
        "text": "Rstats – quantixed"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://en.wikipedia.org/wiki/Alpha_shape",
        "text": "3D alpha shapes"
      },
      {
        "href": "https://cran.r-project.org/web/packages/alphashape3d/index.html",
        "text": "alphashape3d"
      },
      {
        "href": "https://en.wikipedia.org/wiki/Heron's_formula",
        "text": "Heron’s formula"
      },
      {
        "href": "https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/",
        "text": "Rstats – quantixed"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Airy Area: approximating surface area of a cell from a 3D point set | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?resize=640%2C374&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-08.26.19.png?resize=640%2C683&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?resize=640%2C150&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?resize=640%2C669&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-2.png?resize=640%2C703&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?resize=640%2C625&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/stephen-royle/",
        "text": "Stephen Royle"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-380201 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Airy Area: approximating surface area of a cell from a 3D point set</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">November 21, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/stephen-royle/\">Stephen Royle</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/\"> Rstats – quantixed</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<p>In the spirit of “if it took you a while to find out how to do something, write about it”, I will detail a method to approximate the surface area of a 3D shape.</p>\n<p>Our application here was finding the surface area of a cell but it can be used on any shape.</p>\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-3122\" data-attachment-id=\"3122\" data-comments-opened=\"1\" data-image-caption=\"\" data-image-description=\"\" data-image-title=\"Screenshot-2023-11-21-at-07.56.49\" data-large-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?fit=640%2C374&amp;ssl=1\" data-lazy-sizes=\"(max-width: 640px) 100vw, 640px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?resize=640%2C374&amp;ssl=1\" data-medium-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?fit=300%2C175&amp;ssl=1\" data-orig-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?fit=928%2C542&amp;ssl=1\" data-orig-size=\"928,542\" data-permalink=\"https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/screenshot-2023-11-21-at-07-56-49/\" data-recalc-dims=\"1\" decoding=\"async\" fetchpriority=\"high\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?w=928&amp;ssl=1 928w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?resize=300%2C175&amp;ssl=1 300w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?resize=768%2C449&amp;ssl=1 768w\" width=\"450\"/><noscript><img alt=\"\" aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\"=\"\" class=\"wp-image-3122\" data-attachment-id=\"3122\" data-comments-opened=\"1\" data-image-caption=\"\" data-image-description=\"\" data-image-meta=\"{\" data-image-title=\"Screenshot-2023-11-21-at-07.56.49\" data-large-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?fit=640%2C374&amp;ssl=1\" data-medium-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?fit=300%2C175&amp;ssl=1\" data-orig-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?fit=928%2C542&amp;ssl=1\" data-orig-size=\"928,542\" data-permalink=\"https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/screenshot-2023-11-21-at-07-56-49/\" data-recalc-dims=\"1\" decoding=\"async\" fetchpriority=\"high\" loading=\"lazy\" sizes=\"(max-width: 640px) 100vw, 640px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?resize=640%2C374&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?w=928&amp;ssl=1 928w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?resize=300%2C175&amp;ssl=1 300w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?resize=768%2C449&amp;ssl=1 768w\" width=\"450\"/></noscript></figure>\n<p>We start with a 3D point set, specified by points of interest in a single cell imaged by 3D confocal microscopy. The details of the points aren’t too important, but they are generally on the cell surface with some internal points.</p>\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-3121\" data-attachment-id=\"3121\" data-comments-opened=\"1\" data-image-caption=\"\" data-image-description=\"\" data-image-title=\"Screenshot-2023-11-21-at-08.26.19\" data-large-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-08.26.19.png?fit=640%2C683&amp;ssl=1\" data-lazy-sizes=\"(max-width: 640px) 100vw, 640px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-08.26.19.png?resize=640%2C683&amp;ssl=1\" data-medium-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-08.26.19.png?fit=281%2C300&amp;ssl=1\" data-orig-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-08.26.19.png?fit=722%2C771&amp;ssl=1\" data-orig-size=\"722,771\" data-permalink=\"https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/screenshot-2023-11-21-at-08-26-19/\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-08.26.19.png?w=722&amp;ssl=1 722w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-08.26.19.png?resize=281%2C300&amp;ssl=1 281w\" width=\"450\"/><noscript><img alt=\"\" aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\"=\"\" class=\"wp-image-3121\" data-attachment-id=\"3121\" data-comments-opened=\"1\" data-image-caption=\"\" data-image-description=\"\" data-image-meta=\"{\" data-image-title=\"Screenshot-2023-11-21-at-08.26.19\" data-large-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-08.26.19.png?fit=640%2C683&amp;ssl=1\" data-medium-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-08.26.19.png?fit=281%2C300&amp;ssl=1\" data-orig-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-08.26.19.png?fit=722%2C771&amp;ssl=1\" data-orig-size=\"722,771\" data-permalink=\"https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/screenshot-2023-11-21-at-08-26-19/\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"(max-width: 640px) 100vw, 640px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-08.26.19.png?resize=640%2C683&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-08.26.19.png?w=722&amp;ssl=1 722w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-08.26.19.png?resize=281%2C300&amp;ssl=1 281w\" width=\"450\"/></noscript></figure>\n<p>This is an ugly plot, don’t worry, it will get better!</p>\n<p>To find the surface of this point set we can use <a href=\"https://en.wikipedia.org/wiki/Alpha_shape\" rel=\"nofollow\" target=\"_blank\">3D alpha shapes</a>. Briefly, this is a method to trim away at a 3D convex hull to more finely contour the surface of an object. Fortunately, there is a nice R package called <a href=\"https://cran.r-project.org/web/packages/alphashape3d/index.html\" rel=\"nofollow\" target=\"_blank\">alphashape3d</a> on CRAN to do the calculation.</p>\n<pre>\nlibrary(alphashape3d)\n# Create a data frame\ndf &lt;- read.csv(\"Data/measure3d2.csv\")\n# the x y z coords are in columns 8 to 10 of the file, stored in real units (um)\nmata &lt;- as.matrix(df[,8:10])\n# 3d coords can be fed into the function ashape3d()\n# the second argument specifies alpha\nalfa &lt;- ashape3d(mata, 5)\nplot(alfa)\n</pre>\n<p>the <code>plot()</code> function here displays the shape using <code>{rgl}</code> and XQuartz</p>\n<figure class=\"wp-block-video\"><video controls=\"\" src=\"https://quantixed.org/wp-content/uploads/2023/11/Screen-Recording-2023-11-17-at-16.41.56.mp4\"></video></figure>\n<p>So we have our 3D shape. There is a function in <code>{alphashape3d}</code> to calculate volume:</p>\n<pre>\nvolume_ashape3d(alfa)\n&gt;2151.8822004701\n</pre>\n<p>The question is: <strong>how can we calculate the surface area?</strong></p>\n<p>I couldn’t see a way to do this using an in-built function, so I rolled my sleeves up.</p>\n<h2 class=\"wp-block-heading\">The solution</h2>\n<p>We simply need to sum all the triangles represented in the plot above to get an approximation of the surface.</p>\n<p>If we take a look at <code>alfa</code>, we can see it is an S3 object termed ashape3d. <code>View(alfa)</code></p>\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-3124\" data-attachment-id=\"3124\" data-comments-opened=\"1\" data-image-caption=\"\" data-image-description=\"\" data-image-title=\"image\" data-large-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?fit=640%2C150&amp;ssl=1\" data-lazy-sizes=\"(max-width: 640px) 100vw, 640px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?resize=640%2C150&amp;ssl=1\" data-medium-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?fit=300%2C70&amp;ssl=1\" data-orig-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?fit=961%2C225&amp;ssl=1\" data-orig-size=\"961,225\" data-permalink=\"https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/image/\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?w=961&amp;ssl=1 961w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?resize=300%2C70&amp;ssl=1 300w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?resize=768%2C180&amp;ssl=1 768w\" width=\"450\"/><noscript><img alt=\"\" aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\"=\"\" class=\"wp-image-3124\" data-attachment-id=\"3124\" data-comments-opened=\"1\" data-image-caption=\"\" data-image-description=\"\" data-image-meta=\"{\" data-image-title=\"image\" data-large-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?fit=640%2C150&amp;ssl=1\" data-medium-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?fit=300%2C70&amp;ssl=1\" data-orig-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?fit=961%2C225&amp;ssl=1\" data-orig-size=\"961,225\" data-permalink=\"https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/image/\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"(max-width: 640px) 100vw, 640px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?resize=640%2C150&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?w=961&amp;ssl=1 961w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?resize=300%2C70&amp;ssl=1 300w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image.png?resize=768%2C180&amp;ssl=1 768w\" width=\"450\"/></noscript></figure>\n<p>The matrix <code>triang</code> contains the triangle information, while <code>x</code> contains the 3D point set that we used to generate the ashape3d. From the docs we can see that the ninth column of <code>triang</code> tells us whether that triangle is in the alpha shape or not (if it has a value or 2 or 3). We also know that the columns termed tr1, tr2 and tr3 specify the indices of points (of x) that make up the triangle.</p>\n<p>Putting that information together, we can do something like:</p>\n<pre>\nselection &lt;- alfa$triang[, 9] &gt;= 2\ntriangles &lt;- alfa$triang[selection, c(\"tr1\", \"tr2\", \"tr3\")]\ntriangles &lt;- as.data.frame(triangles)\ntriangles$area &lt;- calculate_area(alfa$x, triangles)\n</pre>\n<p>this extracts the triangles of interest and collects the three points that comprise them. Then we send this, together with the point set, to a function in order to do the calculation.</p>\n<p>This function, <code>calculate_area()</code> uses a bunch of subfunctions to get the area of the triangles of interest. At the heart of it is <a href=\"https://en.wikipedia.org/wiki/Heron's_formula\" rel=\"nofollow\" target=\"_blank\">Heron’s formula</a>.</p>\n<pre>\n# function to calculate area of a triangle in 3D space\nheron &lt;- function(a,b,c){\n  s &lt;- (a + b + c) / 2\n  area &lt;- sqrt(s*(s-a) * (s-b)*(s-c))\n  return(area)\n}\n\n# utility to get the distance between two 3D coords\ndistance3d &lt;- function(x1,y1,z1,x2,y2,z2){\n  a &lt;- (x1-x2)^2+(y1-y2)^2 + (z1-z2)^2\n  d &lt;- sqrt(a)\n  return(d)\n}\n\n# wrapper to calculate the area of triangle from 2 x 3d coord sets\nareatriangle3d &lt;- function(x1,y1,z1,x2,y2,z2,x3,y3,z3){\n  a &lt;- distance3d(x1,y1,z1,x2,y2,z2)\n  b &lt;- distance3d(x2,y2,z2,x3,y3,z3)\n  c &lt;- distance3d(x3,y3,z3,x1,y1,z1)\n  A &lt;- heron(a,b,c)\n  # print(paste(\"area of triangle is\",A))\n  return(A)\n}\n\n# this function calculates the area of each triangle\ncalculate_area &lt;- function(x, triangles) {\n  # x is a matrix of 3D coordinates\n  # triangles is a data frame of triangle indices\n  # calculate the area of each triangle\n  \n  a &lt;- areatriangle3d(x[triangles$tr1, 1], x[triangles$tr1, 2], x[triangles$tr1, 3],\n                      x[triangles$tr2, 1], x[triangles$tr2, 2], x[triangles$tr2, 3],\n                      x[triangles$tr3, 1], x[triangles$tr3, 2], x[triangles$tr3, 3])\n  return(a)\n}\n</pre>\n<p>Now <code>triangles</code> has a column containing the area of each triangle of interest, and we can simply sum them to approximate the cell surface.</p>\n<pre>\n&gt;sum(triangles$area)\n1107.63245400761\n</pre>\n<p>Well, there’s <em>a</em> solution, or perhaps <em>the</em> solution, to the problem. But how do we know that it’s correct?</p>\n<h2 class=\"wp-block-heading\">Verifying the method</h2>\n<p>Let’s use a simple shape to check whether the method works.</p>\n<pre>\n# construct a 9 x 3 matrix of points on the surface of a cube\ncube &lt;- matrix(c(-1,1,-1,1,-1,1,-1,1,\n         1,1,-1,-1,1,1,-1,-1,\n         1,1,1,1,-1,-1,-1,-1), ncol = 3)\ncube_a &lt;- ashape3d(cube, 10)\nplot(cube_a)\n</pre>\n<p>And this gives:</p>\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-3125\" data-attachment-id=\"3125\" data-comments-opened=\"1\" data-image-caption=\"\" data-image-description=\"\" data-image-title=\"image-1\" data-large-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?fit=640%2C669&amp;ssl=1\" data-lazy-sizes=\"(max-width: 640px) 100vw, 640px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?resize=640%2C669&amp;ssl=1\" data-medium-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?fit=287%2C300&amp;ssl=1\" data-orig-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?fit=816%2C853&amp;ssl=1\" data-orig-size=\"816,853\" data-permalink=\"https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/image-1/\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?w=816&amp;ssl=1 816w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?resize=287%2C300&amp;ssl=1 287w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?resize=768%2C803&amp;ssl=1 768w\" width=\"450\"/><noscript><img alt=\"\" aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\"=\"\" class=\"wp-image-3125\" data-attachment-id=\"3125\" data-comments-opened=\"1\" data-image-caption=\"\" data-image-description=\"\" data-image-meta=\"{\" data-image-title=\"image-1\" data-large-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?fit=640%2C669&amp;ssl=1\" data-medium-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?fit=287%2C300&amp;ssl=1\" data-orig-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?fit=816%2C853&amp;ssl=1\" data-orig-size=\"816,853\" data-permalink=\"https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/image-1/\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"(max-width: 640px) 100vw, 640px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?resize=640%2C669&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?w=816&amp;ssl=1 816w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?resize=287%2C300&amp;ssl=1 287w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-1.png?resize=768%2C803&amp;ssl=1 768w\" width=\"450\"/></noscript></figure>\n<p>Which is a cube with edges of 2 units, centred on the origin.</p>\n<p>We can use a wrapper to do the calculations for us:</p>\n<pre>\n# this functions does all the calculations and prints the results\ncalculations_3d &lt;- function(mat) {\n  \n  alphamat &lt;- ashape3d(mat, 5)\n  \n  # volume of alpha shape\n  cat(paste0(\"Volume: \",volume_ashape3d(alphamat),\"\\n\"))\n  # surface area of alpha shape\n  selection &lt;- alphamat$triang[, 9] &gt;= 2\n  triangles &lt;- alphamat$triang[selection, c(\"tr1\", \"tr2\", \"tr3\")]\n  triangles &lt;- as.data.frame(triangles)\n  triangles$area &lt;- calculate_area(alphamat$x, triangles)\n  # sum the area of all triangles\n  cat(paste0(\"Surface area: \",sum(triangles$area),\"\\n\"))\n  # number of spots that went in\n  cat(paste0(\"Number of spots: \",nrow(mat),\"\\n\"))\n  # density of spots is the number of spots divided by the surface area\n  cat(paste0(\"Density of spots: \",nrow(mat) / sum(triangles$area),\"\\n\"))\n  # how many spots are in the alpha shape? the number of unique triangle indices\n  cat(paste0(\"Number of spots in alpha shape: \",length(unique(c(triangles$tr1, triangles$tr2, triangles$tr3))),\"\\n\"))\n  # density of the spots in alpha shape\n  cat(paste0(\"Density of spots in alpha shape: \",length(unique(c(triangles$tr1, triangles$tr2, triangles$tr3))) / sum(triangles$area),\"\\n\"))\n}\n</pre>\n<p>So, let’s try it:</p>\n<pre>\n&gt; calculations_3d(cube)\nVolume: 8\nSurface area: 24\nNumber of spots: 8\nDensity of spots: 0.333333333333333\nNumber of spots in alpha shape: 8\nDensity of spots in alpha shape: 0.333333333333333\n</pre>\n<p>The surface area is indeed 24 units, as expected.</p>\n<h3 class=\"wp-block-heading\">Let’s try a different object: a sphere.</h3>\n<p>We first need a 3D point set. I found this handy function online. We can make a sphere with a radius of 1, and either have points throughout the sphere or just on the surface.</p>\n<pre>\nrsphere &lt;- function(n, r = 1.0, surface_only = FALSE) {\n  phi       &lt;- runif(n, 0.0, 2.0 * pi)\n  cos_theta &lt;- runif(n, -1.0, 1.0)\n  sin_theta &lt;- sqrt((1.0-cos_theta)*(1.0+cos_theta))\n  radius &lt;- r\n  if (surface_only == FALSE) {\n    radius &lt;- r * runif(n, 0.0, 1.0)^(1.0/3.0)\n  }\n  \n  x &lt;- radius * sin_theta * cos(phi)\n  y &lt;- radius * sin_theta * sin(phi)\n  z &lt;- radius * cos_theta\n  \n  cbind(x, y, z)\n}\n\n# when we test the function, we get the following results\nset.seed(123)\nsphere_points &lt;- rsphere(500, surface_only = T)\ncalculations_3d(sphere_points)\n\n# plot the sphere\nplot3d(sphere_points, col = \"red\", size = 0.5)\nsphere_alpha &lt;- ashape3d(sphere_points, 10)\nplot(sphere_alpha)\n</pre>\n<p>The results:</p>\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-3127\" data-attachment-id=\"3127\" data-comments-opened=\"1\" data-image-caption=\"\" data-image-description=\"\" data-image-title=\"image-2\" data-large-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-2.png?fit=640%2C703&amp;ssl=1\" data-lazy-sizes=\"(max-width: 640px) 100vw, 640px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-2.png?resize=640%2C703&amp;ssl=1\" data-medium-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-2.png?fit=273%2C300&amp;ssl=1\" data-orig-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-2.png?fit=717%2C788&amp;ssl=1\" data-orig-size=\"717,788\" data-permalink=\"https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/image-2/\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-2.png?w=717&amp;ssl=1 717w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-2.png?resize=273%2C300&amp;ssl=1 273w\" width=\"450\"/><noscript><img alt=\"\" aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\"=\"\" class=\"wp-image-3127\" data-attachment-id=\"3127\" data-comments-opened=\"1\" data-image-caption=\"\" data-image-description=\"\" data-image-meta=\"{\" data-image-title=\"image-2\" data-large-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-2.png?fit=640%2C703&amp;ssl=1\" data-medium-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-2.png?fit=273%2C300&amp;ssl=1\" data-orig-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-2.png?fit=717%2C788&amp;ssl=1\" data-orig-size=\"717,788\" data-permalink=\"https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/image-2/\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"(max-width: 640px) 100vw, 640px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-2.png?resize=640%2C703&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-2.png?w=717&amp;ssl=1 717w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-2.png?resize=273%2C300&amp;ssl=1 273w\" width=\"450\"/></noscript></figure>\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-3128\" data-attachment-id=\"3128\" data-comments-opened=\"1\" data-image-caption=\"\" data-image-description=\"\" data-image-title=\"image-3\" data-large-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?fit=640%2C625&amp;ssl=1\" data-lazy-sizes=\"(max-width: 640px) 100vw, 640px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?resize=640%2C625&amp;ssl=1\" data-medium-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?fit=300%2C293&amp;ssl=1\" data-orig-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?fit=770%2C752&amp;ssl=1\" data-orig-size=\"770,752\" data-permalink=\"https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/image-3/\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?w=770&amp;ssl=1 770w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?resize=300%2C293&amp;ssl=1 300w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?resize=768%2C750&amp;ssl=1 768w\" width=\"450\"/><noscript><img alt=\"\" aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\"=\"\" class=\"wp-image-3128\" data-attachment-id=\"3128\" data-comments-opened=\"1\" data-image-caption=\"\" data-image-description=\"\" data-image-meta=\"{\" data-image-title=\"image-3\" data-large-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?fit=640%2C625&amp;ssl=1\" data-medium-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?fit=300%2C293&amp;ssl=1\" data-orig-file=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?fit=770%2C752&amp;ssl=1\" data-orig-size=\"770,752\" data-permalink=\"https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/image-3/\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"(max-width: 640px) 100vw, 640px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?resize=640%2C625&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?w=770&amp;ssl=1 770w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?resize=300%2C293&amp;ssl=1 300w, https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/image-3.png?resize=768%2C750&amp;ssl=1 768w\" width=\"450\"/></noscript></figure>\n<pre>\nVolume: 4.09187028812644\nSurface area: 12.4200231832229\nNumber of spots: 500\nDensity of spots: 40.2575738083488\nNumber of spots in alpha shape: 500\nDensity of spots in alpha shape: 40.2575738083488\n</pre>\n<p>The volume is approximately 4/3 * pi * r^3 = 4.19 and the surface area is approximately 4 * p i* r^2 = 12.57</p>\n<p>If we increase the number of points we get closer to these numbers, although the method using triangles will always be less than the true value.</p>\n<pre>\n&gt; set.seed(123)\n&gt; sphere_points &lt;- rsphere(5000, surface_only = T)\n&gt; calculations_3d(sphere_points)\nVolume: 4.17880848901202\nSurface area: 12.5513891616036\nNumber of spots: 5000\nDensity of spots: 398.362279714479\nNumber of spots in alpha shape: 5000\nDensity of spots in alpha shape: 398.362279714479\n</pre>\n<p>Finally, these checks have only used the situation of points that are on the surface of the object, let’s make some internal points:</p>\n<pre>\n&gt; set.seed(123)\n&gt; sphere_points &lt;- rsphere(10000, surface_only = F)\n&gt; calculations_3d(sphere_points)\nVolume: 4.00201444091866\nSurface area: 12.2429156824266\nNumber of spots: 10000\nDensity of spots: 816.798894919607\nNumber of spots in alpha shape: 471\nDensity of spots in alpha shape: 38.4712279507135\n</pre>\n<p>In this example, we generated 10000 points anywhere in the sphere, but only 471 were on the alpha shape, rather than being internal. Our approximation is similar to the 500 point (all surface) result above.</p>\n<h2 class=\"wp-block-heading\">Conclusion</h2>\n<p>Even though there was no in-built function to approximate the surface area of a 3D alpha shape. It is possible to do this direct from the ashape3d object.</p>\n<p>—</p>\n<p>The post title comes from “Airy Area” by Ozric Tentacles from the “Vitamin Enhanced” album.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://quantixed.org/2023/11/21/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/\"> Rstats – quantixed</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
    "main_text": "Airy Area: approximating surface area of a cell from a 3D point set\nPosted on\nNovember 21, 2023\nby\nStephen Royle\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nRstats – quantixed\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nIn the spirit of “if it took you a while to find out how to do something, write about it”, I will detail a method to approximate the surface area of a 3D shape.\nOur application here was finding the surface area of a cell but it can be used on any shape.\nWe start with a 3D point set, specified by points of interest in a single cell imaged by 3D confocal microscopy. The details of the points aren’t too important, but they are generally on the cell surface with some internal points.\nThis is an ugly plot, don’t worry, it will get better!\nTo find the surface of this point set we can use\n3D alpha shapes\n. Briefly, this is a method to trim away at a 3D convex hull to more finely contour the surface of an object. Fortunately, there is a nice R package called\nalphashape3d\non CRAN to do the calculation.\nlibrary(alphashape3d)\n# Create a data frame\ndf <- read.csv(\"Data/measure3d2.csv\")\n# the x y z coords are in columns 8 to 10 of the file, stored in real units (um)\nmata <- as.matrix(df[,8:10])\n# 3d coords can be fed into the function ashape3d()\n# the second argument specifies alpha\nalfa <- ashape3d(mata, 5)\nplot(alfa)\nthe\nplot()\nfunction here displays the shape using\n{rgl}\nand XQuartz\nSo we have our 3D shape. There is a function in\n{alphashape3d}\nto calculate volume:\nvolume_ashape3d(alfa)\n>2151.8822004701\nThe question is:\nhow can we calculate the surface area?\nI couldn’t see a way to do this using an in-built function, so I rolled my sleeves up.\nThe solution\nWe simply need to sum all the triangles represented in the plot above to get an approximation of the surface.\nIf we take a look at\nalfa\n, we can see it is an S3 object termed ashape3d.\nView(alfa)\nThe matrix\ntriang\ncontains the triangle information, while\nx\ncontains the 3D point set that we used to generate the ashape3d. From the docs we can see that the ninth column of\ntriang\ntells us whether that triangle is in the alpha shape or not (if it has a value or 2 or 3). We also know that the columns termed tr1, tr2 and tr3 specify the indices of points (of x) that make up the triangle.\nPutting that information together, we can do something like:\nselection <- alfa$triang[, 9] >= 2\ntriangles <- alfa$triang[selection, c(\"tr1\", \"tr2\", \"tr3\")]\ntriangles <- as.data.frame(triangles)\ntriangles$area <- calculate_area(alfa$x, triangles)\nthis extracts the triangles of interest and collects the three points that comprise them. Then we send this, together with the point set, to a function in order to do the calculation.\nThis function,\ncalculate_area()\nuses a bunch of subfunctions to get the area of the triangles of interest. At the heart of it is\nHeron’s formula\n.\n# function to calculate area of a triangle in 3D space\nheron <- function(a,b,c){\n  s <- (a + b + c) / 2\n  area <- sqrt(s*(s-a) * (s-b)*(s-c))\n  return(area)\n}\n\n# utility to get the distance between two 3D coords\ndistance3d <- function(x1,y1,z1,x2,y2,z2){\n  a <- (x1-x2)^2+(y1-y2)^2 + (z1-z2)^2\n  d <- sqrt(a)\n  return(d)\n}\n\n# wrapper to calculate the area of triangle from 2 x 3d coord sets\nareatriangle3d <- function(x1,y1,z1,x2,y2,z2,x3,y3,z3){\n  a <- distance3d(x1,y1,z1,x2,y2,z2)\n  b <- distance3d(x2,y2,z2,x3,y3,z3)\n  c <- distance3d(x3,y3,z3,x1,y1,z1)\n  A <- heron(a,b,c)\n  # print(paste(\"area of triangle is\",A))\n  return(A)\n}\n\n# this function calculates the area of each triangle\ncalculate_area <- function(x, triangles) {\n  # x is a matrix of 3D coordinates\n  # triangles is a data frame of triangle indices\n  # calculate the area of each triangle\n  \n  a <- areatriangle3d(x[triangles$tr1, 1], x[triangles$tr1, 2], x[triangles$tr1, 3],\n                      x[triangles$tr2, 1], x[triangles$tr2, 2], x[triangles$tr2, 3],\n                      x[triangles$tr3, 1], x[triangles$tr3, 2], x[triangles$tr3, 3])\n  return(a)\n}\nNow\ntriangles\nhas a column containing the area of each triangle of interest, and we can simply sum them to approximate the cell surface.\n>sum(triangles$area)\n1107.63245400761\nWell, there’s\na\nsolution, or perhaps\nthe\nsolution, to the problem. But how do we know that it’s correct?\nVerifying the method\nLet’s use a simple shape to check whether the method works.\n# construct a 9 x 3 matrix of points on the surface of a cube\ncube <- matrix(c(-1,1,-1,1,-1,1,-1,1,\n         1,1,-1,-1,1,1,-1,-1,\n         1,1,1,1,-1,-1,-1,-1), ncol = 3)\ncube_a <- ashape3d(cube, 10)\nplot(cube_a)\nAnd this gives:\nWhich is a cube with edges of 2 units, centred on the origin.\nWe can use a wrapper to do the calculations for us:\n# this functions does all the calculations and prints the results\ncalculations_3d <- function(mat) {\n  \n  alphamat <- ashape3d(mat, 5)\n  \n  # volume of alpha shape\n  cat(paste0(\"Volume: \",volume_ashape3d(alphamat),\"\\n\"))\n  # surface area of alpha shape\n  selection <- alphamat$triang[, 9] >= 2\n  triangles <- alphamat$triang[selection, c(\"tr1\", \"tr2\", \"tr3\")]\n  triangles <- as.data.frame(triangles)\n  triangles$area <- calculate_area(alphamat$x, triangles)\n  # sum the area of all triangles\n  cat(paste0(\"Surface area: \",sum(triangles$area),\"\\n\"))\n  # number of spots that went in\n  cat(paste0(\"Number of spots: \",nrow(mat),\"\\n\"))\n  # density of spots is the number of spots divided by the surface area\n  cat(paste0(\"Density of spots: \",nrow(mat) / sum(triangles$area),\"\\n\"))\n  # how many spots are in the alpha shape? the number of unique triangle indices\n  cat(paste0(\"Number of spots in alpha shape: \",length(unique(c(triangles$tr1, triangles$tr2, triangles$tr3))),\"\\n\"))\n  # density of the spots in alpha shape\n  cat(paste0(\"Density of spots in alpha shape: \",length(unique(c(triangles$tr1, triangles$tr2, triangles$tr3))) / sum(triangles$area),\"\\n\"))\n}\nSo, let’s try it:\n> calculations_3d(cube)\nVolume: 8\nSurface area: 24\nNumber of spots: 8\nDensity of spots: 0.333333333333333\nNumber of spots in alpha shape: 8\nDensity of spots in alpha shape: 0.333333333333333\nThe surface area is indeed 24 units, as expected.\nLet’s try a different object: a sphere.\nWe first need a 3D point set. I found this handy function online. We can make a sphere with a radius of 1, and either have points throughout the sphere or just on the surface.\nrsphere <- function(n, r = 1.0, surface_only = FALSE) {\n  phi       <- runif(n, 0.0, 2.0 * pi)\n  cos_theta <- runif(n, -1.0, 1.0)\n  sin_theta <- sqrt((1.0-cos_theta)*(1.0+cos_theta))\n  radius <- r\n  if (surface_only == FALSE) {\n    radius <- r * runif(n, 0.0, 1.0)^(1.0/3.0)\n  }\n  \n  x <- radius * sin_theta * cos(phi)\n  y <- radius * sin_theta * sin(phi)\n  z <- radius * cos_theta\n  \n  cbind(x, y, z)\n}\n\n# when we test the function, we get the following results\nset.seed(123)\nsphere_points <- rsphere(500, surface_only = T)\ncalculations_3d(sphere_points)\n\n# plot the sphere\nplot3d(sphere_points, col = \"red\", size = 0.5)\nsphere_alpha <- ashape3d(sphere_points, 10)\nplot(sphere_alpha)\nThe results:\nVolume: 4.09187028812644\nSurface area: 12.4200231832229\nNumber of spots: 500\nDensity of spots: 40.2575738083488\nNumber of spots in alpha shape: 500\nDensity of spots in alpha shape: 40.2575738083488\nThe volume is approximately 4/3 * pi * r^3 = 4.19 and the surface area is approximately 4 * p i* r^2 = 12.57\nIf we increase the number of points we get closer to these numbers, although the method using triangles will always be less than the true value.\n> set.seed(123)\n> sphere_points <- rsphere(5000, surface_only = T)\n> calculations_3d(sphere_points)\nVolume: 4.17880848901202\nSurface area: 12.5513891616036\nNumber of spots: 5000\nDensity of spots: 398.362279714479\nNumber of spots in alpha shape: 5000\nDensity of spots in alpha shape: 398.362279714479\nFinally, these checks have only used the situation of points that are on the surface of the object, let’s make some internal points:\n> set.seed(123)\n> sphere_points <- rsphere(10000, surface_only = F)\n> calculations_3d(sphere_points)\nVolume: 4.00201444091866\nSurface area: 12.2429156824266\nNumber of spots: 10000\nDensity of spots: 816.798894919607\nNumber of spots in alpha shape: 471\nDensity of spots in alpha shape: 38.4712279507135\nIn this example, we generated 10000 points anywhere in the sphere, but only 471 were on the alpha shape, rather than being internal. Our approximation is similar to the 500 point (all surface) result above.\nConclusion\nEven though there was no in-built function to approximate the surface area of a 3D alpha shape. It is possible to do this direct from the ashape3d object.\n—\nThe post title comes from “Airy Area” by Ozric Tentacles from the “Vitamin Enhanced” album.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nRstats – quantixed\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "In the spirit of “if it took you a while to find out how to do something, write about it”, I will detail a method to approximate the surface area of a 3D shape. Our application here was finding the surface area of a cell but it can be used on any shape. We start […]",
    "meta_keywords": null,
    "og_description": "In the spirit of “if it took you a while to find out how to do something, write about it”, I will detail a method to approximate the surface area of a 3D shape. Our application here was finding the surface area of a cell but it can be used on any shape. We start […]",
    "og_image": "https://i0.wp.com/quantixed.org/wp-content/uploads/2023/11/Screenshot-2023-11-21-at-07.56.49.png?resize=640%2C374&ssl=1",
    "og_title": "Airy Area: approximating surface area of a cell from a 3D point set | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 8,
    "sitemap_lastmod": "2023-11-21T13:40:00+00:00",
    "twitter_description": "In the spirit of “if it took you a while to find out how to do something, write about it”, I will detail a method to approximate the surface area of a 3D shape. Our application here was finding the surface area of a cell but it can be used on any shape. We start […]",
    "twitter_title": "Airy Area: approximating surface area of a cell from a 3D point set | R-bloggers",
    "url": "https://www.r-bloggers.com/2023/11/airy-area-approximating-surface-area-of-a-cell-from-a-3d-point-set/",
    "word_count": 1596
  }
}