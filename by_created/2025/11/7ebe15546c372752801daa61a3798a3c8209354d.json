{
  "id": "7ebe15546c372752801daa61a3798a3c8209354d",
  "url": "https://www.r-bloggers.com/2025/10/tutorial-for-developing-an-advanced-stock-dashboard-for-the-sp-500-for-the-2025-posit-table-contest/",
  "created_at_utc": "2025-11-22T19:57:28Z",
  "data": null,
  "raw_original": {
    "uuid": "a2a2101b-3c2b-4362-aa1f-989af13bf808",
    "created_at": "2025-11-22 19:57:28",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2025/10/tutorial-for-developing-an-advanced-stock-dashboard-for-the-sp-500-for-the-2025-posit-table-contest/",
      "crawled_at": "2025-11-22T10:41:46.712152",
      "external_links": [
        {
          "href": "https://ozancanozdemir.github.io/r/2025-posit-table-contest-tutorial/",
          "text": "Ozancan Ozdemir"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://ozancanozdemir.shinyapps.io/sp500-monitoring-dashboard/",
          "text": "link"
        },
        {
          "href": "https://ozancanozdemir.github.io/r/2025-posit-table-contest-tutorial/",
          "text": "Ozancan Ozdemir"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Tutorial for Developing an Advanced Stock Dashboard for the S&P 500 for the 2025 Posit Table Contest | R-bloggers",
      "images": [],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/ozancan-ozdemir/",
          "text": "Ozancan Ozdemir"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-396167 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Tutorial for Developing an Advanced Stock Dashboard for the S&amp;P 500 for the 2025 Posit Table Contest</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">October 17, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/ozancan-ozdemir/\">Ozancan Ozdemir</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://ozancanozdemir.github.io/r/2025-posit-table-contest-tutorial/\"> Ozancan Ozdemir</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47--><p>This tutorial breaks down the development of an R Shiny application titled <strong>S&amp;P 500 Monitoring Dashboard</strong> for the 2025 Posit Table Dashboard. This app effectively combines interactive financial data visualization (<code>plotly</code>), beautiful data tables (<code>gt</code>, <code>gtExtras</code>), web scraping (<code>rvest</code>), and external API integration (<code>riingo</code>, <code>ellmer</code>/Gemini AI) within a custom, sleek dark theme.\nYou can access the app through this <a href=\"https://ozancanozdemir.shinyapps.io/sp500-monitoring-dashboard/\" rel=\"nofollow\" target=\"_blank\">link</a></p>\n<h2 id=\"1-project-overview-and-key-technologies\">1. Project Overview and Key Technologies</h2>\n<p>This application is divided into several functional panels:</p>\n<ol>\n<li><strong>Market Overview</strong>: Top 10 S&amp;P 500 companies by market cap, presented in a <code>gt</code> table with sparkline trends.</li>\n<li><strong>Stock Details</strong>: Interactive selection, real-time price header, key statistics, and a daily/comparison price chart (<code>plotly</code>).</li>\n<li><strong>Fundamental Analysis</strong>: Sortable table of key fundamental metrics.</li>\n<li><strong>Market News &amp; AI</strong>: News headlines (<code>riingo</code>) with sentiment analysis (<code>sentimentr</code>) and a large language model assistant (<code>ellmer</code>/Gemini AI).</li>\n<li><strong>Portfolio Calculator</strong>: Simple portfolio backtesting and metric calculation.</li>\n</ol>\n<h3 id=\"-core-r-packages-used\">üìö Core R Packages Used</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align: left\">Category</th>\n<th style=\"text-align: left\">Packages</th>\n<th style=\"text-align: left\">Purpose</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align: left\"><strong>App &amp; UI</strong></td>\n<td style=\"text-align: left\"><code>shiny</code>, <code>htmltools</code>, <code>shinyLP</code></td>\n<td style=\"text-align: left\">Application framework, custom HTML/CSS theming.</td>\n</tr>\n<tr>\n<td style=\"text-align: left\"><strong>Data Fetching</strong></td>\n<td style=\"text-align: left\"><code>quantmod</code>, <code>rvest</code>, <code>xml2</code>, <code>riingo</code></td>\n<td style=\"text-align: left\">Fetching stock data (Yahoo), web scraping (S\\&amp;P 500, fundamentals), and news (Tiingo).</td>\n</tr>\n<tr>\n<td style=\"text-align: left\"><strong>Data Viz/Tables</strong></td>\n<td style=\"text-align: left\"><code>gt</code>, <code>gtExtras</code>, <code>plotly</code>, <code>svglite</code></td>\n<td style=\"text-align: left\">Creating highly styled, professional data tables and interactive charts.</td>\n</tr>\n<tr>\n<td style=\"text-align: left\"><strong>AI Integration</strong></td>\n<td style=\"text-align: left\"><code>ellmer</code>, <code>shinychat</code></td>\n<td style=\"text-align: left\">Connecting to the Gemini API for the financial assistant.</td>\n</tr>\n<tr>\n<td style=\"text-align: left\"><strong>Utilities</strong></td>\n<td style=\"text-align: left\"><code>dplyr</code>, <code>stringr</code>, <code>lubridate</code>, <code>zoo</code></td>\n<td style=\"text-align: left\">Data cleaning, manipulation, and time series handling.</td>\n</tr>\n</tbody>\n</table>\n<hr/>\n<h2 id=\"2-setting-up-the-environment-and-helper-functions\">2. Setting up the Environment and Helper Functions</h2>\n<p>The application starts by loading all necessary libraries and defining utility functions.</p>\n<h3 id=\"21-icon-and-theming-setup\">2.1. Icon and Theming Setup</h3>\n<p>The <strong><code>ICON_MAP</code></strong> list defines custom <code>font-awesome</code> icons used in the statistics boxes, setting the inline CSS style for specific colors.</p>\n<h3 id=\"22-web-scraping-get_sp500_tickers\">2.2. Web Scraping: <code>get_sp500_tickers()</code></h3>\n<p>This crucial helper function scrapes the S&amp;P 500 ticker list from Wikipedia.</p>\n<ul>\n<li>It uses <strong><code>rvest::read_html()</code></strong> and <strong><code>rvest::html_table()</code></strong> to extract the data.</li>\n<li>It includes robust error handling (<code>tryCatch</code>) and a hardcoded <strong>fallback list</strong> if scraping fails.</li>\n<li><strong>Logo Generation</strong>: It uses a Google Favicon service URL (<code>https://www.google.com/s2/favicons?sz=64&amp;domain=...</code>) to dynamically generate company logos based on their domain, enhancing the visual appeal of the selection inputs and tables.</li>\n</ul>\n<h3 id=\"23-data-retrieval-and-sparklines\">2.3. Data Retrieval and Sparklines</h3>\n<ul>\n<li><strong><code>pf_get_prices_for_sparkline()</code></strong>: Uses <strong><code>quantmod::getSymbols(src = \"yahoo\")</code></strong> to fetch the last 30 days of closing prices for a list of tickers, storing the data as a list of numeric vectors for use in <code>gt</code> sparklines.</li>\n<li><strong><code>spark_area_svg()</code></strong>: This complex function uses <strong><code>ggplot2</code></strong> and <strong><code>svglite::stringSVG()</code></strong> to generate a data URI containing the SVG code for a colored area sparkline. This is essential for rendering the sparklines directly within the <code>gt</code> table cells without external image hosting.</li>\n</ul>\n<hr/>\n<h2 id=\"3-the-custom-dark-ui-uir\">3. The Custom Dark UI (<code>ui.R</code>)</h2>\n<p>The dashboard‚Äôs premium look is achieved entirely through custom CSS within the <code>tags$head</code> section of the <code>ui</code>.</p>\n<h3 id=\"31-custom-css-theme\">3.1. Custom CSS Theme</h3>\n<p>The CSS (embedded using <code>tags$style(HTML(...))</code>):</p>\n<ul>\n<li>Sets a dark blue/black <strong>linear-gradient</strong> background for the <code>body</code>.</li>\n<li>Uses modern fonts like <strong>‚ÄòInter‚Äô</strong> and <strong>‚ÄòJetBrains Mono‚Äô</strong> (a monospace font often used for finance/coding) for a sleek, technical look.</li>\n<li>Applies distinct background colors (<code>#131722</code>, <code>#1e2431</code>, <code>#252b3d</code>) and border colors (<code>#2a2e39</code>) to various elements (<code>.main-container</code>, <code>.stock-header</code>, <code>.stat-card</code>, <code>.selectize-input</code>) to create a layered, visually separated design.</li>\n<li>Defines distinct colors for price changes: <strong>Green (<code>#26a69a</code>) for up</strong> and <strong>Red (<code>#ef5350</code>) for down</strong>.</li>\n<li>Customizes scrollbars, inputs (<code>selectize-input</code>), and the fixed <strong><code>app-footer</code></strong> for consistency.</li>\n</ul>\n<h3 id=\"32-layout-structure\">3.2. Layout Structure</h3>\n<p>The <code>fluidPage</code> uses a simple <strong>three-column layout</strong> within the <code>main-container</code> (which is a custom-styled <code>div</code>):</p>\n<ul>\n<li><strong>Top Half (Left)</strong>: Market Cap Table, Fundamental Metrics Table.</li>\n<li><strong>Top Half (Right)</strong>: Stock Selector, Custom Header (<code>uiOutput(\"top_header_ui\")</code>), Key Stats Cards, Price Tables (<code>gt_output</code>), and the Main Chart (<code>plotlyOutput</code>).</li>\n<li><strong>Bottom Half</strong>: Riingo News (<code>gt_output</code>) and AI Chat (<code>chat_mod_ui</code>).</li>\n<li><strong>Bottom Global</strong>: Portfolio Calculator Panel.</li>\n</ul>\n<hr/>\n<h2 id=\"4-the-server-logic-serverr\">4. The Server Logic (<code>server.R</code>)</h2>\n<p>The server manages data retrieval, reactive computations, and rendering of all outputs.</p>\n<h3 id=\"41-stock-data-reactives\">4.1. Stock Data Reactives</h3>\n<ul>\n<li><strong><code>stock_data1</code></strong> and <strong><code>stock_data2</code></strong>: These <code>reactive</code> objects call <code>get_stock_data()</code> (which uses <code>quantmod::getSymbols</code>) to fetch stock prices based on the selected ticker(s) and time interval. They are triggered by changes in <code>ticker1</code>, <code>interval</code>, or the manual <strong>REFRESH DATA</strong> button (<code>input$refresh</code>).</li>\n</ul>\n<h3 id=\"42-dynamic-header--stats\">4.2. Dynamic Header &amp; Stats</h3>\n<ul>\n<li><strong><code>output$top_header_ui</code></strong>: This <code>renderUI</code> function dynamically generates the header HTML, including the company logo, name, and the formatted last price and daily change.\n    <ul>\n<li><strong><code>make_stock_header()</code></strong> retrieves the logo and name.</li>\n<li><strong><code>make_price_bar()</code></strong> calculates the last price and daily percentage change, assigning a <strong><code>.price-up</code></strong> (green) or <strong><code>.price-down</code></strong> (red) CSS class for visual feedback.</li>\n</ul>\n</li>\n<li>The statistical <code>renderText</code> outputs (Volume, 52W High/Low, Avg Volume) use the <code>stock_data1()</code> reactive.</li>\n</ul>\n<h3 id=\"43-advanced-gt-table-rendering\">4.3. Advanced GT Table Rendering</h3>\n<p>The dashboard uses three major <code>gt</code> tables, each with heavy customization:</p>\n<h4 id=\"a-key-stats-table-outputkey_stats_table\">A. Key Stats Table (<code>output$key_stats_table</code>)</h4>\n<p>This table shows Market Cap, Revenue, and a 30-day price trend for the top stocks.</p>\n<ul>\n<li><strong>Data Preparation</strong>: The data is sourced from <strong><code>get_market_cap_data()</code></strong>, which scrapes a stock analysis website using <code>rvest</code>.</li>\n<li><strong>Logo/Name Formatting</strong>: The <code>Name_Logo</code> column is transformed using <strong><code>gt::text_transform</code></strong> to embed the logo image (<code>&lt;img&gt;</code> tag) next to the company name, thanks to the custom HTML/CSS used.</li>\n<li><strong>Market Cap Visualization</strong>: <strong><code>gtExtras::gt_plt_bar()</code></strong> creates a simple bar chart inside the cell to show relative market capitalization.</li>\n<li><strong>Revenue Visualization</strong>: <strong><code>gtExtras::gt_color_box()</code></strong> adds a background color box based on the revenue value.</li>\n<li><strong>Sparkline Trend</strong>: This uses <strong><code>gt::text_transform</code></strong> to call the custom <strong><code>spark_area_svg()</code></strong> helper, embedding the generated SVG data URI as the cell content.</li>\n</ul>\n<h4 id=\"b-daily-prices-table-outputprice_table1\">B. Daily Prices Table (<code>output$price_table1</code>)</h4>\n<p>This table shows the last 5 days of OHLC (Open, High, Low, Close) and key technical indicators (RSI, MACD).</p>\n<ul>\n<li><strong>Indicator Calculation</strong>: Inside <code>create_table()</code>, technical analysis is performed using <strong><code>quantmod::RSI()</code></strong> and <strong><code>quantmod::MACD()</code></strong>.</li>\n<li><strong>Conditional Formatting</strong>:\n    <ul>\n<li><strong>Change/Change %</strong>: Uses a complex <code>text_transform</code> to show green (‚ñ≤) or red (‚ñº) arrows and text color based on the price movement.</li>\n<li><strong>RSI</strong>: Uses <strong><code>gt::tab_style</code></strong> with <code>gt::cells_body</code> to highlight the cell background when RSI is <strong>overbought (&gt;= 70)</strong> or <strong>oversold (&lt;= 30)</strong>.</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"c-riingo-news-table-outputriingo_news_gt\">C. Riingo News Table (<code>output$riingo_news_gt</code>)</h4>\n<p>This table displays news headlines based on the selected ticker and source.</p>\n<ul>\n<li><strong>News Fetching</strong>: <strong><code>riingo_news_data()</code></strong> uses <code>riingo::riingo_news()</code> (requires a Tiingo API token, which is hardcoded in this example: <code>TIINGO_TOKEN &lt;- \"8c7094ec74e7fc1ceca99a468fc4770df03dd0ec\"</code>)</li>\n<li><strong>Sentiment Analysis</strong>: <strong><code>sentimentr::sentiment_by()</code></strong> is used to quickly classify the headline sentiment as ‚ÄòPositive‚Äô, ‚ÄòNegative‚Äô, or ‚ÄòNeutral‚Äô.</li>\n<li><strong>Visualization</strong>:\n    <ul>\n<li><strong>Source Logo</strong>: A <code>text_transform</code> embeds the news source logo (<code>&lt;img&gt;</code> tag).</li>\n<li><strong>Sentiment Highlight</strong>: <code>gt::tab_style</code> conditionally colors the background and text of the <code>Sentiment</code> column based on the computed label (Green/Red/Gray).</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"44-interactive-plotting-outputprice_plot\">4.4. Interactive Plotting (<code>output$price_plot</code>)</h3>\n<ul>\n<li><strong>Candlestick Chart (No Compare)</strong>: When <code>input$compare_mode</code> is <code>FALSE</code>, the code uses <strong><code>plotly::plot_ly(type = \"candlestick\")</code></strong> to display the OHLC data, setting custom increasing/decreasing colors (<code>#26a69a</code> / <code>#ef5350</code>).</li>\n<li><strong>Normalized Comparison (Compare Mode)</strong>: When <code>TRUE</code>, it calculates the <strong>percentage change</strong> from the first day for both selected stocks and uses <strong><code>plotly::add_lines()</code></strong> to plot their performance curves on the same normalized Y-axis, which is the standard practice for performance comparison.</li>\n</ul>\n<h3 id=\"45-portfolio-backtesting\">4.5. Portfolio Backtesting</h3>\n<p>The <strong>Portfolio Calculator</strong> section implements classic financial backtesting logic:</p>\n<ul>\n<li><strong><code>pf_get_prices()</code></strong>: Downloads the closing prices for the selected tickers.</li>\n<li><strong><code>pf_returns()</code></strong>: Calculates daily returns ($R_t = \\frac{P_t}{P_{t-1}} - 1$).</li>\n<li><strong><code>pf_port_ret()</code></strong>: Calculates the portfolio‚Äôs daily return ($\\sum w_i R_{i,t}$) based on the user-inputted weights (<code>pf_weights()</code>).</li>\n<li><strong><code>pf_equity()</code></strong>: Calculates the portfolio‚Äôs cumulative value over time based on the initial capital ($Equity_t = Capital \\times \\prod (1 + R_{port,t})$).</li>\n<li><strong>Metrics</strong>: Calculates key performance indicators:\n    <ul>\n<li><strong>CAGR (Compound Annual Growth Rate)</strong>: Annualized return.</li>\n<li><strong>Volatility</strong>: Annualized standard deviation of returns.</li>\n<li><strong>Sharpe Ratio</strong>: Measures return per unit of risk ($\\frac{Annualized Return - Risk-Free Rate}{Annualized Volatility}$).</li>\n</ul>\n</li>\n<li><strong><code>output$pf_alloc_table</code></strong>: Displays the final allocation using the custom <strong><code>weight_pill_html()</code></strong> function, which creates a slick, dynamically filled progress bar for the weight percentage within the <code>gt</code> table.</li>\n</ul>\n<h3 id=\"46-ai-chat-integration\">4.6. AI Chat Integration</h3>\n<ul>\n<li>The code sets up a reactive <code>chat_client</code> using the <strong><code>ellmer::chat_google_gemini()</code></strong> function from the <code>ellmer</code> package.</li>\n<li>Users must input their <strong>Gemini API Key</strong> and click <strong>SET API KEY</strong> to initialize the client.</li>\n<li>The <code>system_prompt</code> is used to instruct the AI to act as an ‚Äúexpert financial advisor and stock analyst,‚Äù ensuring relevant responses.</li>\n<li><strong><code>chat_mod_server(\"stock_chat\", chat_client())</code></strong> connects the initialized AI client to the <code>shinychat</code> UI module, making the chat functionality live.</li>\n</ul>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://ozancanozdemir.github.io/r/2025-posit-table-contest-tutorial/\"> Ozancan Ozdemir</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
      "main_text": "Tutorial for Developing an Advanced Stock Dashboard for the S&P 500 for the 2025 Posit Table Contest\nPosted on\nOctober 17, 2025\nby\nOzancan Ozdemir\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nOzancan Ozdemir\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nThis tutorial breaks down the development of an R Shiny application titled\nS&P 500 Monitoring Dashboard\nfor the 2025 Posit Table Dashboard. This app effectively combines interactive financial data visualization (\nplotly\n), beautiful data tables (\ngt\n,\ngtExtras\n), web scraping (\nrvest\n), and external API integration (\nriingo\n,\nellmer\n/Gemini AI) within a custom, sleek dark theme.\nYou can access the app through this\nlink\n1. Project Overview and Key Technologies\nThis application is divided into several functional panels:\nMarket Overview\n: Top 10 S&P 500 companies by market cap, presented in a\ngt\ntable with sparkline trends.\nStock Details\n: Interactive selection, real-time price header, key statistics, and a daily/comparison price chart (\nplotly\n).\nFundamental Analysis\n: Sortable table of key fundamental metrics.\nMarket News & AI\n: News headlines (\nriingo\n) with sentiment analysis (\nsentimentr\n) and a large language model assistant (\nellmer\n/Gemini AI).\nPortfolio Calculator\n: Simple portfolio backtesting and metric calculation.\nüìö Core R Packages Used\nCategory\nPackages\nPurpose\nApp & UI\nshiny\n,\nhtmltools\n,\nshinyLP\nApplication framework, custom HTML/CSS theming.\nData Fetching\nquantmod\n,\nrvest\n,\nxml2\n,\nriingo\nFetching stock data (Yahoo), web scraping (S\\&P 500, fundamentals), and news (Tiingo).\nData Viz/Tables\ngt\n,\ngtExtras\n,\nplotly\n,\nsvglite\nCreating highly styled, professional data tables and interactive charts.\nAI Integration\nellmer\n,\nshinychat\nConnecting to the Gemini API for the financial assistant.\nUtilities\ndplyr\n,\nstringr\n,\nlubridate\n,\nzoo\nData cleaning, manipulation, and time series handling.\n2. Setting up the Environment and Helper Functions\nThe application starts by loading all necessary libraries and defining utility functions.\n2.1. Icon and Theming Setup\nThe\nICON_MAP\nlist defines custom\nfont-awesome\nicons used in the statistics boxes, setting the inline CSS style for specific colors.\n2.2. Web Scraping:\nget_sp500_tickers()\nThis crucial helper function scrapes the S&P 500 ticker list from Wikipedia.\nIt uses\nrvest::read_html()\nand\nrvest::html_table()\nto extract the data.\nIt includes robust error handling (\ntryCatch\n) and a hardcoded\nfallback list\nif scraping fails.\nLogo Generation\n: It uses a Google Favicon service URL (\nhttps://www.google.com/s2/favicons?sz=64&domain=...\n) to dynamically generate company logos based on their domain, enhancing the visual appeal of the selection inputs and tables.\n2.3. Data Retrieval and Sparklines\npf_get_prices_for_sparkline()\n: Uses\nquantmod::getSymbols(src = \"yahoo\")\nto fetch the last 30 days of closing prices for a list of tickers, storing the data as a list of numeric vectors for use in\ngt\nsparklines.\nspark_area_svg()\n: This complex function uses\nggplot2\nand\nsvglite::stringSVG()\nto generate a data URI containing the SVG code for a colored area sparkline. This is essential for rendering the sparklines directly within the\ngt\ntable cells without external image hosting.\n3. The Custom Dark UI (\nui.R\n)\nThe dashboard‚Äôs premium look is achieved entirely through custom CSS within the\ntags$head\nsection of the\nui\n.\n3.1. Custom CSS Theme\nThe CSS (embedded using\ntags$style(HTML(...))\n):\nSets a dark blue/black\nlinear-gradient\nbackground for the\nbody\n.\nUses modern fonts like\n‚ÄòInter‚Äô\nand\n‚ÄòJetBrains Mono‚Äô\n(a monospace font often used for finance/coding) for a sleek, technical look.\nApplies distinct background colors (\n#131722\n,\n#1e2431\n,\n#252b3d\n) and border colors (\n#2a2e39\n) to various elements (\n.main-container\n,\n.stock-header\n,\n.stat-card\n,\n.selectize-input\n) to create a layered, visually separated design.\nDefines distinct colors for price changes:\nGreen (\n#26a69a\n) for up\nand\nRed (\n#ef5350\n) for down\n.\nCustomizes scrollbars, inputs (\nselectize-input\n), and the fixed\napp-footer\nfor consistency.\n3.2. Layout Structure\nThe\nfluidPage\nuses a simple\nthree-column layout\nwithin the\nmain-container\n(which is a custom-styled\ndiv\n):\nTop Half (Left)\n: Market Cap Table, Fundamental Metrics Table.\nTop Half (Right)\n: Stock Selector, Custom Header (\nuiOutput(\"top_header_ui\")\n), Key Stats Cards, Price Tables (\ngt_output\n), and the Main Chart (\nplotlyOutput\n).\nBottom Half\n: Riingo News (\ngt_output\n) and AI Chat (\nchat_mod_ui\n).\nBottom Global\n: Portfolio Calculator Panel.\n4. The Server Logic (\nserver.R\n)\nThe server manages data retrieval, reactive computations, and rendering of all outputs.\n4.1. Stock Data Reactives\nstock_data1\nand\nstock_data2\n: These\nreactive\nobjects call\nget_stock_data()\n(which uses\nquantmod::getSymbols\n) to fetch stock prices based on the selected ticker(s) and time interval. They are triggered by changes in\nticker1\n,\ninterval\n, or the manual\nREFRESH DATA\nbutton (\ninput$refresh\n).\n4.2. Dynamic Header & Stats\noutput$top_header_ui\n: This\nrenderUI\nfunction dynamically generates the header HTML, including the company logo, name, and the formatted last price and daily change.\nmake_stock_header()\nretrieves the logo and name.\nmake_price_bar()\ncalculates the last price and daily percentage change, assigning a\n.price-up\n(green) or\n.price-down\n(red) CSS class for visual feedback.\nThe statistical\nrenderText\noutputs (Volume, 52W High/Low, Avg Volume) use the\nstock_data1()\nreactive.\n4.3. Advanced GT Table Rendering\nThe dashboard uses three major\ngt\ntables, each with heavy customization:\nA. Key Stats Table (\noutput$key_stats_table\n)\nThis table shows Market Cap, Revenue, and a 30-day price trend for the top stocks.\nData Preparation\n: The data is sourced from\nget_market_cap_data()\n, which scrapes a stock analysis website using\nrvest\n.\nLogo/Name Formatting\n: The\nName_Logo\ncolumn is transformed using\ngt::text_transform\nto embed the logo image (\n<img>\ntag) next to the company name, thanks to the custom HTML/CSS used.\nMarket Cap Visualization\n:\ngtExtras::gt_plt_bar()\ncreates a simple bar chart inside the cell to show relative market capitalization.\nRevenue Visualization\n:\ngtExtras::gt_color_box()\nadds a background color box based on the revenue value.\nSparkline Trend\n: This uses\ngt::text_transform\nto call the custom\nspark_area_svg()\nhelper, embedding the generated SVG data URI as the cell content.\nB. Daily Prices Table (\noutput$price_table1\n)\nThis table shows the last 5 days of OHLC (Open, High, Low, Close) and key technical indicators (RSI, MACD).\nIndicator Calculation\n: Inside\ncreate_table()\n, technical analysis is performed using\nquantmod::RSI()\nand\nquantmod::MACD()\n.\nConditional Formatting\n:\nChange/Change %\n: Uses a complex\ntext_transform\nto show green (‚ñ≤) or red (‚ñº) arrows and text color based on the price movement.\nRSI\n: Uses\ngt::tab_style\nwith\ngt::cells_body\nto highlight the cell background when RSI is\noverbought (>= 70)\nor\noversold (<= 30)\n.\nC. Riingo News Table (\noutput$riingo_news_gt\n)\nThis table displays news headlines based on the selected ticker and source.\nNews Fetching\n:\nriingo_news_data()\nuses\nriingo::riingo_news()\n(requires a Tiingo API token, which is hardcoded in this example:\nTIINGO_TOKEN <- \"8c7094ec74e7fc1ceca99a468fc4770df03dd0ec\"\n)\nSentiment Analysis\n:\nsentimentr::sentiment_by()\nis used to quickly classify the headline sentiment as ‚ÄòPositive‚Äô, ‚ÄòNegative‚Äô, or ‚ÄòNeutral‚Äô.\nVisualization\n:\nSource Logo\n: A\ntext_transform\nembeds the news source logo (\n<img>\ntag).\nSentiment Highlight\n:\ngt::tab_style\nconditionally colors the background and text of the\nSentiment\ncolumn based on the computed label (Green/Red/Gray).\n4.4. Interactive Plotting (\noutput$price_plot\n)\nCandlestick Chart (No Compare)\n: When\ninput$compare_mode\nis\nFALSE\n, the code uses\nplotly::plot_ly(type = \"candlestick\")\nto display the OHLC data, setting custom increasing/decreasing colors (\n#26a69a\n/\n#ef5350\n).\nNormalized Comparison (Compare Mode)\n: When\nTRUE\n, it calculates the\npercentage change\nfrom the first day for both selected stocks and uses\nplotly::add_lines()\nto plot their performance curves on the same normalized Y-axis, which is the standard practice for performance comparison.\n4.5. Portfolio Backtesting\nThe\nPortfolio Calculator\nsection implements classic financial backtesting logic:\npf_get_prices()\n: Downloads the closing prices for the selected tickers.\npf_returns()\n: Calculates daily returns ($R_t = \\frac{P_t}{P_{t-1}} - 1$).\npf_port_ret()\n: Calculates the portfolio‚Äôs daily return ($\\sum w_i R_{i,t}$) based on the user-inputted weights (\npf_weights()\n).\npf_equity()\n: Calculates the portfolio‚Äôs cumulative value over time based on the initial capital ($Equity_t = Capital \\times \\prod (1 + R_{port,t})$).\nMetrics\n: Calculates key performance indicators:\nCAGR (Compound Annual Growth Rate)\n: Annualized return.\nVolatility\n: Annualized standard deviation of returns.\nSharpe Ratio\n: Measures return per unit of risk ($\\frac{Annualized Return - Risk-Free Rate}{Annualized Volatility}$).\noutput$pf_alloc_table\n: Displays the final allocation using the custom\nweight_pill_html()\nfunction, which creates a slick, dynamically filled progress bar for the weight percentage within the\ngt\ntable.\n4.6. AI Chat Integration\nThe code sets up a reactive\nchat_client\nusing the\nellmer::chat_google_gemini()\nfunction from the\nellmer\npackage.\nUsers must input their\nGemini API Key\nand click\nSET API KEY\nto initialize the client.\nThe\nsystem_prompt\nis used to instruct the AI to act as an ‚Äúexpert financial advisor and stock analyst,‚Äù ensuring relevant responses.\nchat_mod_server(\"stock_chat\", chat_client())\nconnects the initialized AI client to the\nshinychat\nUI module, making the chat functionality live.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nOzancan Ozdemir\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "This tutorial breaks down the development of an R Shiny application titled S&P 500 Monitoring Dashboard for the 2025 Posit Table Dashboard. This app effectively combines interactive financial data visualization (plotly), beautiful data tables (gt, gtExtras), web scraping (rvest), and external API integration (riingo, ellmer/Gemini AI) within a custom, sleek dark theme. You can access the app through this link",
      "meta_keywords": null,
      "og_description": "This tutorial breaks down the development of an R Shiny application titled S&P 500 Monitoring Dashboard for the 2025 Posit Table Dashboard. This app effectively combines interactive financial data visualization (plotly), beautiful data tables (gt, gtExtras), web scraping (rvest), and external API integration (riingo, ellmer/Gemini AI) within a custom, sleek dark theme. You can access the app through this link",
      "og_image": "https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png",
      "og_title": "Tutorial for Developing an Advanced Stock Dashboard for the S&P 500 for the 2025 Posit Table Contest | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 7.5,
      "sitemap_lastmod": null,
      "twitter_description": "This tutorial breaks down the development of an R Shiny application titled S&P 500 Monitoring Dashboard for the 2025 Posit Table Dashboard. This app effectively combines interactive financial data visualization (plotly), beautiful data tables (gt, gtExtras), web scraping (rvest), and external API integration (riingo, ellmer/Gemini AI) within a custom, sleek dark theme. You can access the app through this link",
      "twitter_title": "Tutorial for Developing an Advanced Stock Dashboard for the S&P 500 for the 2025 Posit Table Contest | R-bloggers",
      "url": "https://www.r-bloggers.com/2025/10/tutorial-for-developing-an-advanced-stock-dashboard-for-the-sp-500-for-the-2025-posit-table-contest/",
      "word_count": 1505
    }
  }
}