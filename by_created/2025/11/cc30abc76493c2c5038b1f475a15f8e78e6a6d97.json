{
  "id": "cc30abc76493c2c5038b1f475a15f8e78e6a6d97",
  "url": "https://www.r-bloggers.com/2025/11/rainfall/",
  "created_at_utc": "2025-11-22T19:57:25Z",
  "data": null,
  "raw_original": {
    "uuid": "31e081fa-613f-4c00-852a-ecc96aba9838",
    "created_at": "2025-11-22 19:57:25",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2025/11/rainfall/",
      "crawled_at": "2025-11-22T10:41:26.374826",
      "external_links": [
        {
          "href": "https://r.iresmi.net/posts/2025/rainfall/",
          "text": "r.iresmi.net"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://www.flickr.com/photos/lochaven/36336928682/",
          "text": null
        },
        {
          "href": "https://30daymapchallenge.com/",
          "text": "30DayMapChallenge"
        },
        {
          "href": "https://r.iresmi.net/#category=30DayMapChallenge",
          "text": "previously"
        },
        {
          "href": "https://cds.climate.copernicus.eu/datasets/derived-era5-single-levels-daily-statistics",
          "text": "ERA5 post-processed daily statistics on single levels from 1940 to present"
        },
        {
          "href": "https://r.iresmi.net/posts/2025/rainfall/",
          "text": "r.iresmi.net"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Rainfall | R-bloggers",
      "images": [
        {
          "alt": "A photo of Rouen at sunset",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "A photo of Rouen at sunset",
          "base64": null,
          "src": "https://i0.wp.com/r.iresmi.net/posts/2025/rainfall/images/36336928682_23460bd075_c.jpg?w=578&ssl=1"
        },
        {
          "alt": "Map of maximum daily rainfall in 2024",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "Map of maximum daily rainfall in 2024",
          "base64": null,
          "src": "https://i1.wp.com/r.iresmi.net/posts/2025/rainfall/index_files/figure-html/fig-map-1.png?w=578&ssl=1"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/michael/",
          "text": "Michael"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-396687 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Rainfall</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">November 8, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/michael/\">Michael</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://r.iresmi.net/posts/2025/rainfall/\"> r.iresmi.net</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div class=\"quarto-figure quarto-figure-center\">\n<figure class=\"figure\">\n<p><a href=\"https://www.flickr.com/photos/lochaven/36336928682/\" rel=\"nofollow\" target=\"_blank\"><img alt=\"A photo of Rouen at sunset\" class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/r.iresmi.net/posts/2025/rainfall/images/36336928682_23460bd075_c.jpg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"A photo of Rouen at sunset\" class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/r.iresmi.net/posts/2025/rainfall/images/36336928682_23460bd075_c.jpg?w=578&amp;ssl=1\"/></noscript></a></p>\n<figcaption>Storms Over the Ocean – CC-BY-NC by Lochaven</figcaption>\n</figure>\n</div>\n<p>Day 10 of <a href=\"https://30daymapchallenge.com/\" rel=\"nofollow\" target=\"_blank\">30DayMapChallenge</a>: « Air » (<a href=\"https://r.iresmi.net/#category=30DayMapChallenge\" rel=\"nofollow\" target=\"_blank\">previously</a>).</p>\n<p><strong>Where did it rain the most in a day last year?</strong></p>\n<p>Using <a href=\"https://cds.climate.copernicus.eu/datasets/derived-era5-single-levels-daily-statistics\" rel=\"nofollow\" target=\"_blank\"><em>ERA5 post-processed daily statistics on single levels from 1940 to present</em></a>.</p>\n<blockquote class=\"blockquote\">\n<p>ERA5 is the fifth generation ECMWF reanalysis for the global climate and weather for the past 8 decades. Data is available from 1940 onwards. Reanalysis combines model data with observations from across the world into a globally complete and consistent dataset using the laws of physics.</p>\n</blockquote>\n<div class=\"cell\">\n<pre>library(terra)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(glue)\nlibrary(sf)\nlibrary(ggspatial)\nlibrary(rnaturalearth)</pre>\n</div>\n<section class=\"level2\" id=\"data\">\n<h2 class=\"anchored\" data-anchor-id=\"data\">Data</h2>\n<p>First, you need to register for a (free) account. Once the query form is sent (with year 2024, total precipitation, all months, all days etc.), your job is queued and you’ll need to wait to get your link to a downloadable dataset. It took around 35 min and we obtain a 600 MB NetCDF file.</p>\n<p>An API is also available to automate the queries.</p>\n<p>The coordinates are in the [0, 360] degrees range (often the case for climate data, don’t ask me why), so we need to rotate the data to find our more familiar [-180, 180]. The total precipitation is in meters; we’ll convert to cm.</p>\n<div class=\"cell\">\n<pre># It takes a few minutes to compute, so we cache it\nif (!file.exists(\"max_rainfall_cm.tif\")) {\n  rainfall &lt;- rast(\"~/data/era5/4d4e91553b16edf0e896d4511e028719.nc\") \n  \n  max_rainfall_cm &lt;- max(rainfall, na.rm = TRUE) * 100\n  max_rainfall_cm &lt;- rotate(max_rainfall_cm)\n  set.crs(max_rainfall_cm, \"EPSG:4326\")\n  writeRaster(max_rainfall_cm, \"max_rainfall_cm.tif\",\n              gdal = c(\"COMPRESS=DEFLATE\"))\n} else {\n  max_rainfall_cm &lt;- rast(\"max_rainfall_cm.tif\")\n}\n\n# Get the world max value and its location\nval_max_rainfall &lt;- round(max(where.max(max_rainfall_cm)[[1, \"value\"]]), 1)\nloc_max_rainfall &lt;- xyFromCell(max_rainfall_cm, \n                               where.max(max_rainfall_cm)[2]) |&gt; \n  st_point() |&gt; \n  st_sfc(crs = \"EPSG:4326\") |&gt; \n  st_sf() |&gt; \n  mutate(val_max_rainfall = val_max_rainfall)\n\n# map background\nworld &lt;- ne_countries() </pre>\n</div>\n</section>\n<section class=\"level2\" id=\"map\">\n<h2 class=\"anchored\" data-anchor-id=\"map\">Map</h2>\n<div class=\"cell\">\n<pre>ggplot() +\n  layer_spatial(data = max_rainfall_cm) +\n  geom_sf(data = world, fill = NA, color = \"white\") +\n  geom_sf(data = loc_max_rainfall, color = \"red\") +\n  geom_sf_text(data = loc_max_rainfall, aes(label = val_max_rainfall), \n               fontface = \"bold\", vjust = -1, color = \"red\") +\n  scale_fill_viridis_c(name = \"height (cm)\", trans = \"sqrt\") +\n  coord_sf(crs = \"EPSG:8857\") +\n  labs(title = \"Maximum daily rainfall\",\n       subtitle = \"2024\",\n       fill = \"type\", x =\"\", y = \"\",\n       caption = glue(\"https://r.iresmi.net/ - {Sys.Date()}\n                      data: ERA5 doi:10.24381/cds.4991cf48 / Natural Earth\")) +\n  theme_minimal() +\n  theme(plot.caption = element_text(size = 6, \n                                    color = \"darkgrey\"),\n        legend.position = \"bottom\")</pre>\n<div class=\"cell-output-display\">\n<div alt=\"Map of maximum daily rainfall in 2024\" class=\"quarto-float quarto-figure quarto-figure-center anchored\" id=\"fig-map\">\n<figure class=\"quarto-float quarto-float-fig figure\">\n<div aria-describedby=\"fig-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca\">\n<img alt=\"Map of maximum daily rainfall in 2024\" class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/r.iresmi.net/posts/2025/rainfall/index_files/figure-html/fig-map-1.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" style=\"width:100.0%\"/><noscript><img alt=\"Map of maximum daily rainfall in 2024\" class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/r.iresmi.net/posts/2025/rainfall/index_files/figure-html/fig-map-1.png?w=578&amp;ssl=1\" style=\"width:100.0%\"/></noscript>\n</div>\n<figcaption class=\"quarto-float-caption-bottom quarto-float-caption quarto-float-fig\" id=\"fig-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca\">\nFigure 1: Maximum daily rainfall in 2024\n</figcaption>\n</figure>\n</div>\n</div>\n</div>\n<p>It seems the maximum rainfall in 24 hours was 48.7 cm, off the northern coast of The Philippines…</p>\n<p>Finding the date it happened is an exercise left to the reader.</p>\n<!-- -->\n</section>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://r.iresmi.net/posts/2025/rainfall/\"> r.iresmi.net</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
      "main_text": "Rainfall\nPosted on\nNovember 8, 2025\nby\nMichael\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nr.iresmi.net\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nStorms Over the Ocean – CC-BY-NC by Lochaven\nDay 10 of\n30DayMapChallenge\n: « Air » (\npreviously\n).\nWhere did it rain the most in a day last year?\nUsing\nERA5 post-processed daily statistics on single levels from 1940 to present\n.\nERA5 is the fifth generation ECMWF reanalysis for the global climate and weather for the past 8 decades. Data is available from 1940 onwards. Reanalysis combines model data with observations from across the world into a globally complete and consistent dataset using the laws of physics.\nlibrary(terra)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(glue)\nlibrary(sf)\nlibrary(ggspatial)\nlibrary(rnaturalearth)\nData\nFirst, you need to register for a (free) account. Once the query form is sent (with year 2024, total precipitation, all months, all days etc.), your job is queued and you’ll need to wait to get your link to a downloadable dataset. It took around 35 min and we obtain a 600 MB NetCDF file.\nAn API is also available to automate the queries.\nThe coordinates are in the [0, 360] degrees range (often the case for climate data, don’t ask me why), so we need to rotate the data to find our more familiar [-180, 180]. The total precipitation is in meters; we’ll convert to cm.\n# It takes a few minutes to compute, so we cache it\nif (!file.exists(\"max_rainfall_cm.tif\")) {\n  rainfall <- rast(\"~/data/era5/4d4e91553b16edf0e896d4511e028719.nc\") \n  \n  max_rainfall_cm <- max(rainfall, na.rm = TRUE) * 100\n  max_rainfall_cm <- rotate(max_rainfall_cm)\n  set.crs(max_rainfall_cm, \"EPSG:4326\")\n  writeRaster(max_rainfall_cm, \"max_rainfall_cm.tif\",\n              gdal = c(\"COMPRESS=DEFLATE\"))\n} else {\n  max_rainfall_cm <- rast(\"max_rainfall_cm.tif\")\n}\n\n# Get the world max value and its location\nval_max_rainfall <- round(max(where.max(max_rainfall_cm)[[1, \"value\"]]), 1)\nloc_max_rainfall <- xyFromCell(max_rainfall_cm, \n                               where.max(max_rainfall_cm)[2]) |> \n  st_point() |> \n  st_sfc(crs = \"EPSG:4326\") |> \n  st_sf() |> \n  mutate(val_max_rainfall = val_max_rainfall)\n\n# map background\nworld <- ne_countries()\nMap\nggplot() +\n  layer_spatial(data = max_rainfall_cm) +\n  geom_sf(data = world, fill = NA, color = \"white\") +\n  geom_sf(data = loc_max_rainfall, color = \"red\") +\n  geom_sf_text(data = loc_max_rainfall, aes(label = val_max_rainfall), \n               fontface = \"bold\", vjust = -1, color = \"red\") +\n  scale_fill_viridis_c(name = \"height (cm)\", trans = \"sqrt\") +\n  coord_sf(crs = \"EPSG:8857\") +\n  labs(title = \"Maximum daily rainfall\",\n       subtitle = \"2024\",\n       fill = \"type\", x =\"\", y = \"\",\n       caption = glue(\"https://r.iresmi.net/ - {Sys.Date()}\n                      data: ERA5 doi:10.24381/cds.4991cf48 / Natural Earth\")) +\n  theme_minimal() +\n  theme(plot.caption = element_text(size = 6, \n                                    color = \"darkgrey\"),\n        legend.position = \"bottom\")\nFigure 1: Maximum daily rainfall in 2024\nIt seems the maximum rainfall in 24 hours was 48.7 cm, off the northern coast of The Philippines…\nFinding the date it happened is an exercise left to the reader.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nr.iresmi.net\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Storms Over the Ocean – CC-BY-NC by Lochaven Day 10 of 30DayMapChallenge: « Air » (previously). Where did it rain the most in a day last year? Using ERA5 post-processed daily statistics on single levels from 1940 to present....",
      "meta_keywords": null,
      "og_description": "Storms Over the Ocean – CC-BY-NC by Lochaven Day 10 of 30DayMapChallenge: « Air » (previously). Where did it rain the most in a day last year? Using ERA5 post-processed daily statistics on single levels from 1940 to present....",
      "og_image": "https://r.iresmi.net/posts/2025/rainfall/images/36336928682_23460bd075_c.jpg",
      "og_title": "Rainfall | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 2.8,
      "sitemap_lastmod": null,
      "twitter_description": "Storms Over the Ocean – CC-BY-NC by Lochaven Day 10 of 30DayMapChallenge: « Air » (previously). Where did it rain the most in a day last year? Using ERA5 post-processed daily statistics on single levels from 1940 to present....",
      "twitter_title": "Rainfall | R-bloggers",
      "url": "https://www.r-bloggers.com/2025/11/rainfall/",
      "word_count": 550
    }
  }
}