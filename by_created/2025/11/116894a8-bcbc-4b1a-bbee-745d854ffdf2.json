{
  "uuid": "116894a8-bcbc-4b1a-bbee-745d854ffdf2",
  "created_at": "2025-11-22 19:58:49",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2025/04/train-predict-evaluate-basics/",
    "crawled_at": "2025-11-22T10:50:22.368307",
    "external_links": [
      {
        "href": "https://mlr-org.com/gallery/basic/2025-04-10-german-credit-into/",
        "text": "mlr-org"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://archive.ics.uci.edu/ml/datasets/Statlog+%28German+Credit+Data%29",
        "text": "Statlog (German Credit Data) Data Set"
      },
      {
        "href": "https://mlr-org.com/gallery/basic/2025-04-10-german-credit-into/",
        "text": "mlr-org"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Train Predict Evaluate Basics | R-bloggers",
    "images": [],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/giuseppe-casalicchio/",
        "text": "Giuseppe Casalicchio"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-391967 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Train Predict Evaluate Basics</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">April 13, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/giuseppe-casalicchio/\">Giuseppe Casalicchio</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://mlr-org.com/gallery/basic/2025-04-10-german-credit-into/\"> mlr-org</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<section class=\"level1\" id=\"goal\">\n<h1>Goal</h1>\n<p>Our goal for this exercise sheet is to learn the basics of mlr3 for supervised learning by training a first simple model on training data and by evaluating its performance on hold-out/test data.</p>\n</section>\n<section class=\"level1\" id=\"german-credit-dataset\">\n<h1>German Credit Dataset</h1>\n<p>The German credit dataset was donated by Prof. Dr. Hans Hoffman of the University of Hamburg in 1994 and contains 1000 datapoints reflecting bank customers. The goal is to classify people as a good or bad credit risk based on 20 personal, demographic and financial features. The dataset is available at the UCI repository as <a href=\"https://archive.ics.uci.edu/ml/datasets/Statlog+%28German+Credit+Data%29\" rel=\"nofollow\" target=\"_blank\">Statlog (German Credit Data) Data Set</a>.</p>\n<section class=\"level2\" id=\"motivation-of-risk-prediction\">\n<h2 class=\"anchored\" data-anchor-id=\"motivation-of-risk-prediction\">Motivation of Risk Prediction</h2>\n<p>Customers who do not repay the distributed loan on time represent an enormous risk for a bank: First, because they create an unintended gap in the bank’s planning, and second, because the collection of the repayment amount additionally causes additional time and cost for the bank.</p>\n<p>On the other hand, (interest rates for) loans are an important revenue stream for banks. If a person’s loan is rejected, even though they would have met the repayment deadlines, revenue is lost, as well as potential upselling opportunities.</p>\n<p>Banks are therefore highly interested in a risk prediction model that accurately predicts the risk of future customers. This is where supervised learning models come into play.</p>\n</section>\n<section class=\"level2\" id=\"data-overview\">\n<h2 class=\"anchored\" data-anchor-id=\"data-overview\">Data Overview</h2>\n<p>n = 1,000 observations of bank customers</p>\n<ul>\n<li><code>credit_risk</code>: is the customer a good or bad credit risk?</li>\n<li><code>age</code>: age in years</li>\n<li><code>amount</code>: amount asked by applicant</li>\n<li><code>credit_history</code>: past credit history of applicant at this bank</li>\n<li><code>duration</code>: duration of the credit in months</li>\n<li><code>employment_duration</code>: present employment since</li>\n<li><code>foreign_worker</code>: is applicant foreign worker?</li>\n<li><code>housing</code>: type of apartment rented, owned, for free / no payment</li>\n<li><code>installment_rate</code>: installment rate in percentage of disposable income</li>\n<li><code>job</code>: current job information</li>\n<li><code>number_credits</code>: number of existing credits at this bank</li>\n<li><code>other_debtors</code>: other debtors/guarantors present?</li>\n<li><code>other_installment_plans</code>: other installment plans the applicant is paying</li>\n<li><code>people_liable</code>: number of people being liable to provide maintenance</li>\n<li><code>personal_status_sex</code>: combination of sex and personal status of applicant</li>\n<li><code>present_residence</code>: present residence since</li>\n<li><code>property</code>: properties that applicant has</li>\n<li><code>purpose</code>: reason customer is applying for a loan</li>\n<li><code>savings</code>: savings accounts/bonds at this bank</li>\n<li><code>status</code>: status/balance of checking account at this bank</li>\n<li><code>telephone</code>: is there any telephone registered for this customer?</li>\n</ul>\n</section>\n<section class=\"level2\" id=\"preprocessing\">\n<h2 class=\"anchored\" data-anchor-id=\"preprocessing\">Preprocessing</h2>\n<p>We first load the data from the <code>rchallenge</code> package (you may need to install it first) and get a brief overview.</p>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre># install.packages(\"rchallenge\")\nlibrary(\"rchallenge\")\ndata(\"german\")\nskimr::skim(german)</pre>\n<div class=\"cell-output-display\">\n<table class=\"caption-top table table-sm table-striped small\">\n<caption>Data summary</caption>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">Name</td>\n<td style=\"text-align: left;\">german</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">Number of rows</td>\n<td style=\"text-align: left;\">1000</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">Number of columns</td>\n<td style=\"text-align: left;\">21</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">_______________________</td>\n<td style=\"text-align: left;\"></td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">Column type frequency:</td>\n<td style=\"text-align: left;\"></td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">factor</td>\n<td style=\"text-align: left;\">18</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">numeric</td>\n<td style=\"text-align: left;\">3</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">________________________</td>\n<td style=\"text-align: left;\"></td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">Group variables</td>\n<td style=\"text-align: left;\">None</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Variable type: factor</strong></p>\n<table class=\"caption-top table table-sm table-striped small\">\n<colgroup>\n<col style=\"width: 23%\"/>\n<col style=\"width: 9%\"/>\n<col style=\"width: 13%\"/>\n<col style=\"width: 7%\"/>\n<col style=\"width: 8%\"/>\n<col style=\"width: 37%\"/>\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th style=\"text-align: left;\">skim_variable</th>\n<th style=\"text-align: right;\">n_missing</th>\n<th style=\"text-align: right;\">complete_rate</th>\n<th style=\"text-align: left;\">ordered</th>\n<th style=\"text-align: right;\">n_unique</th>\n<th style=\"text-align: left;\">top_counts</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">status</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: left;\">…: 394, no : 274, …: 269, 0&lt;=: 63</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">credit_history</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">5</td>\n<td style=\"text-align: left;\">no : 530, all: 293, exi: 88, cri: 49</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">purpose</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: left;\">fur: 280, oth: 234, car: 181, car: 103</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">savings</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">5</td>\n<td style=\"text-align: left;\">unk: 603, …: 183, …: 103, 100: 63</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">employment_duration</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">5</td>\n<td style=\"text-align: left;\">1 &lt;: 339, &gt;= : 253, 4 &lt;: 174, &lt; 1: 172</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">installment_rate</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">TRUE</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: left;\">&lt; 2: 476, 25 : 231, 20 : 157, &gt;= : 136</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">personal_status_sex</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: left;\">mal: 548, fem: 310, fem: 92, mal: 50</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">other_debtors</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">3</td>\n<td style=\"text-align: left;\">non: 907, gua: 52, co-: 41</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">present_residence</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">TRUE</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: left;\">&gt;= : 413, 1 &lt;: 308, 4 &lt;: 149, &lt; 1: 130</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">property</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: left;\">bui: 332, unk: 282, car: 232, rea: 154</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">other_installment_plans</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">3</td>\n<td style=\"text-align: left;\">non: 814, ban: 139, sto: 47</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">housing</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">3</td>\n<td style=\"text-align: left;\">ren: 714, for: 179, own: 107</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">number_credits</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">TRUE</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: left;\">1: 633, 2-3: 333, 4-5: 28, &gt;= : 6</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">job</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: left;\">ski: 630, uns: 200, man: 148, une: 22</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">people_liable</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: left;\">0 t: 845, 3 o: 155</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">telephone</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: left;\">no: 596, yes: 404</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">foreign_worker</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: left;\">no: 963, yes: 37</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">credit_risk</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">FALSE</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: left;\">goo: 700, bad: 300</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Variable type: numeric</strong></p>\n<table class=\"caption-top table table-sm table-striped small\">\n<colgroup>\n<col style=\"width: 15%\"/>\n<col style=\"width: 10%\"/>\n<col style=\"width: 15%\"/>\n<col style=\"width: 8%\"/>\n<col style=\"width: 8%\"/>\n<col style=\"width: 4%\"/>\n<col style=\"width: 7%\"/>\n<col style=\"width: 7%\"/>\n<col style=\"width: 8%\"/>\n<col style=\"width: 6%\"/>\n<col style=\"width: 6%\"/>\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th style=\"text-align: left;\">skim_variable</th>\n<th style=\"text-align: right;\">n_missing</th>\n<th style=\"text-align: right;\">complete_rate</th>\n<th style=\"text-align: right;\">mean</th>\n<th style=\"text-align: right;\">sd</th>\n<th style=\"text-align: right;\">p0</th>\n<th style=\"text-align: right;\">p25</th>\n<th style=\"text-align: right;\">p50</th>\n<th style=\"text-align: right;\">p75</th>\n<th style=\"text-align: right;\">p100</th>\n<th style=\"text-align: left;\">hist</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">duration</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">20.90</td>\n<td style=\"text-align: right;\">12.06</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">12.0</td>\n<td style=\"text-align: right;\">18.0</td>\n<td style=\"text-align: right;\">24.00</td>\n<td style=\"text-align: right;\">72</td>\n<td style=\"text-align: left;\">▇▇▂▁▁</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">amount</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">3271.25</td>\n<td style=\"text-align: right;\">2822.75</td>\n<td style=\"text-align: right;\">250</td>\n<td style=\"text-align: right;\">1365.5</td>\n<td style=\"text-align: right;\">2319.5</td>\n<td style=\"text-align: right;\">3972.25</td>\n<td style=\"text-align: right;\">18424</td>\n<td style=\"text-align: left;\">▇▂▁▁▁</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">age</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">35.54</td>\n<td style=\"text-align: right;\">11.35</td>\n<td style=\"text-align: right;\">19</td>\n<td style=\"text-align: right;\">27.0</td>\n<td style=\"text-align: right;\">33.0</td>\n<td style=\"text-align: right;\">42.00</td>\n<td style=\"text-align: right;\">75</td>\n<td style=\"text-align: left;\">▇▆▃▁▁</td>\n</tr>\n</tbody>\n</table>\n</div>\n</div>\n</section>\n</section>\n<section class=\"level1\" id=\"exercises\">\n<h1>Exercises:</h1>\n<p>Now, we can start building a model. To do so, we need to address the following questions:</p>\n<ul>\n<li>What is the problem we are trying to solve?</li>\n<li>What is an appropriate learning algorithm?</li>\n<li>How do we evaluate “good” performance?</li>\n</ul>\n<p>More systematically in <code>mlr3</code> they can be expressed via five components:</p>\n<ul>\n<li>The <code>Task</code> definition.</li>\n<li>The <code>Learner</code> definition.</li>\n<li>The training via <code>$train()</code>.</li>\n<li>The prediction via <code>$predict()</code>.</li>\n<li>The evaluation via one <code>$score()</code>.</li>\n</ul>\n<section class=\"level2\" id=\"split-data-in-training-and-test-data\">\n<h2 class=\"anchored\" data-anchor-id=\"split-data-in-training-and-test-data\">Split Data in Training and Test Data</h2>\n<p>Your task is to split the <code>german</code> dataset into 70 % training data and 30 % test data by randomly sampling rows. Later, we will use the training data to learn an ML model and use the test data to assess its performance.</p>\n<details>\n<summary>\nRecap: Why do we need train and test data?\n</summary>\n<p>We use part of the available data (the training data) to train our model. The remaining/hold-out data (test data) is used to evaluate the trained model. This is exactly how we anticipate using the model in practice: We want to fit the model to existing data and then make predictions on new, unseen data points for which we do not know the outcome/target values.</p>\n<p>Note: Hold-out splitting requires a dataset that is sufficiently large such that both the training and test dataset are suitable representations of the target population. What “sufficiently large” means depends on the dataset at hand and the complexity of the problem.</p>\n<p>The ratio of training to test data is also context dependent. In practice, a 70% to 30% (~ 2:1) ratio is a good starting point.</p>\n</details>\n<details>\n<summary>\n<strong>Hint 1:</strong>\n</summary>\n<p>Use <code>sample()</code> to sample 70 % of the data ids as training data ids from <code>row.names(german)</code>. The remaining row ids are obtained via <code>setdiff()</code>. Based on the ids, set up two datasets, one for training and one for testing/evaluating.</p>\n<p>Set a seed (e.g, <code>set.seed(100L)</code>) to make your results reproducible.</p>\n</details>\n<details>\n<summary>\n<strong>Hint 2:</strong>\n</summary>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre># Sample ids for training and test split\nset.seed(100L)\ntrain_ids = sample(row.names(german), 0.7*nrow(...))\ntest_ids = setdiff(..., train_ids)\n\n# Create two datasets based on ids\ntrain_set = german[...,]\ntest_set = german[...,]</pre>\n</div>\n</details>\n<div class=\"callout callout-style-default callout-note callout-titled\">\n<div aria-controls=\"callout-1\" aria-expanded=\"false\" aria-label=\"Toggle callout\" class=\"callout-header d-flex align-content-center\" data-bs-=\"\" data-bs-toggle=\"collapse\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nSolution\n</div>\n<div class=\"callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end\"><i class=\"callout-toggle\"></i></div>\n</div>\n<div class=\"callout-1-contents callout-collapse collapse\" id=\"callout-1\">\n<div class=\"callout-body-container callout-body\">\n<p>We first sample row ids by using <code>sample()</code> and identify the non-selected rows via <code>setdiff()</code>.</p>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>set.seed(100L)\ntrain_ids = sample(row.names(german), 0.7*nrow(german))\ntest_ids = setdiff(row.names(german), train_ids)\nstr(train_ids)</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre> chr [1:700] \"714\" \"503\" \"358\" \"624\" \"985\" \"718\" \"919\" \"470\" \"966\" \"516\" \"823\" \"838\" \"98\" \"903\" \"7\" \"183\" \"299\" ...</pre>\n</div>\n<pre>str(test_ids)</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre> chr [1:300] \"3\" \"5\" \"8\" \"17\" \"20\" \"22\" \"25\" \"29\" \"33\" \"35\" \"39\" \"40\" \"41\" \"43\" \"44\" \"49\" \"52\" \"57\" \"58\" \"59\" \"62\" ...</pre>\n</div>\n</div>\n<p>Based on that, we create two datasets: one for training and one for testing.</p>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>train_set = german[train_ids,]\ntest_set = german[test_ids, ]</pre>\n</div>\n</div>\n</div>\n</div>\n</section>\n<section class=\"level2\" id=\"create-a-classification-task\">\n<h2 class=\"anchored\" data-anchor-id=\"create-a-classification-task\">Create a Classification Task</h2>\n<p>Install and load the <code>mlr3verse</code> package which is a collection of multiple add-on packages in the <code>mlr3</code> universe (if you fail installing <code>mlr3verse</code>, try to install and load only the <code>mlr3</code> and <code>mlr3learners</code> packages). Then, create a classification task using the training data as an input and <code>credit_risk</code> as the target variable (with the class label <code>good</code> as the positive class). By defining an <code>mlr3</code> task, we conceptualize the ML problem we want to solve (here we face a classification task). As we have a classification task here, make sure you properly specify the class that should be used as the positive class (i.e., the class label for which we would like to predict probabilities – here <code>good</code> if you are interested in predicting a probability for the creditworthiness of customers).</p>\n<details>\n<summary>\n<strong>Hint 1:</strong>\n</summary>\n<p>Use e.g. <code>as_task_classif()</code> to create a classification task.</p>\n</details>\n<details>\n<summary>\n<strong>Hint 2:</strong>\n</summary>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>library(mlr3verse)\ntask = as_task_classif(x = ..., target = ..., ... = \"good\")</pre>\n</div>\n</details>\n<div class=\"callout callout-style-default callout-note callout-titled\">\n<div aria-controls=\"callout-2\" aria-expanded=\"false\" aria-label=\"Toggle callout\" class=\"callout-header d-flex align-content-center\" data-bs-=\"\" data-bs-toggle=\"collapse\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nSolution\n</div>\n<div class=\"callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end\"><i class=\"callout-toggle\"></i></div>\n</div>\n<div class=\"callout-2-contents callout-collapse collapse\" id=\"callout-2\">\n<div class=\"callout-body-container callout-body\">\n<p>To initialize a <code>TaskClassif</code> object, two equivalent calls exist:</p>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>library(\"mlr3verse\")</pre>\n<div class=\"cell-output cell-output-stderr\">\n<pre>Loading required package: mlr3</pre>\n</div>\n<pre>task = TaskClassif$new(\"german_credit\", backend = train_set, target = \"credit_risk\", positive = \"good\")\ntask = as_task_classif(train_set, target = \"credit_risk\", positive = \"good\")\ntask</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>&lt;TaskClassif:train_set&gt; (700 x 21)\n* Target: credit_risk\n* Properties: twoclass\n* Features (20):\n  - fct (14): credit_history, employment_duration, foreign_worker, housing, job, other_debtors,\n    other_installment_plans, people_liable, personal_status_sex, property, purpose, savings, status,\n    telephone\n  - int (3): age, amount, duration\n  - ord (3): installment_rate, number_credits, present_residence</pre>\n</div>\n</div>\n</div>\n</div>\n</div>\n</section>\n<section class=\"level2\" id=\"train-a-model-on-the-training-dataset\">\n<h2 class=\"anchored\" data-anchor-id=\"train-a-model-on-the-training-dataset\">Train a Model on the Training Dataset</h2>\n<p>The created <code>Task</code> contains the data we want to work with. Now that we conceptualized the ML task (i.e., classification) in a <code>Task</code> object, it is time to train our first supervised learning method. We start with a simple classifier: a logistic regression model. During this course, you will, of course, also gain experience with more complex models.</p>\n<p>Fit a logistic regression model to the <code>german_credit</code> training task.</p>\n<details>\n<summary>\n<strong>Hint 1:</strong>\n</summary>\n<p>Use <code>lrn()</code> to initialize a <code>Learner</code> object. The short cut and therefore input to this method is <code>\"classif.log_reg\"</code>.</p>\n<p>To train a model, use the <code>$train()</code> method of your instantiated learner with the task of the previous exercise as an input.</p>\n</details>\n<details>\n<summary>\n<strong>Hint 2:</strong>\n</summary>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>logreg = lrn(\"classif.log_reg\")\nlogreg$train(...)</pre>\n</div>\n</details>\n<div class=\"callout callout-style-default callout-note callout-titled\">\n<div aria-controls=\"callout-3\" aria-expanded=\"false\" aria-label=\"Toggle callout\" class=\"callout-header d-flex align-content-center\" data-bs-=\"\" data-bs-toggle=\"collapse\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nSolution\n</div>\n<div class=\"callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end\"><i class=\"callout-toggle\"></i></div>\n</div>\n<div class=\"callout-3-contents callout-collapse collapse\" id=\"callout-3\">\n<div class=\"callout-body-container callout-body\">\n<p>By using the syntactic sugar method <code>lrn()</code>, we first initialize a <code>LearnerClassif</code> model. Using the <code>$train()</code> method, we derive optimal hyperparameters (i.e., coefficients) for our logistic regression model.</p>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>logreg = lrn(\"classif.log_reg\")\nlogreg$train(task)</pre>\n</div>\n</div>\n</div>\n</div>\n</section>\n<section class=\"level2\" id=\"inspect-the-model\">\n<h2 class=\"anchored\" data-anchor-id=\"inspect-the-model\">Inspect the Model</h2>\n<p>Have a look at the coefficients by using <code>summary()</code>. Name at least two features that have a significant effect on the outcome.</p>\n<details>\n<summary>\n<strong>Hint 1:</strong>\n</summary>\n<p>Use the <code>summary()</code> method of the <code>model</code> field of our trained model. By looking on <code>task$positive</code>, we could see which of the two classes <code>good</code> or <code>bad</code> is used as the positive class (i.e., the class to which the model predictions will refer).</p>\n</details>\n<details>\n<summary>\n<strong>Hint 2:</strong>\n</summary>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>summary(yourmodel$model)</pre>\n</div>\n</details>\n<div class=\"callout callout-style-default callout-note callout-titled\">\n<div aria-controls=\"callout-4\" aria-expanded=\"false\" aria-label=\"Toggle callout\" class=\"callout-header d-flex align-content-center\" data-bs-=\"\" data-bs-toggle=\"collapse\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nSolution\n</div>\n<div class=\"callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end\"><i class=\"callout-toggle\"></i></div>\n</div>\n<div class=\"callout-4-contents callout-collapse collapse\" id=\"callout-4\">\n<div class=\"callout-body-container callout-body\">\n<p>Similar to models fitted via <code>glm()</code> or <code>lm()</code>, we could receive a summary of the coefficients (including p-values) using <code>summary()</code>.</p>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>summary(logreg$model)</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>\nCall:\nstats::glm(formula = form, family = \"binomial\", data = data, \n    model = FALSE)\n\nCoefficients:\n                                                            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                                               -2.342e+00  1.402e+00  -1.671 0.094676 .  \nage                                                        1.999e-02  1.154e-02   1.733 0.083116 .  \namount                                                    -4.414e-05  5.413e-05  -0.815 0.414900    \ncredit_historycritical account/other credits elsewhere    -2.267e-01  7.109e-01  -0.319 0.749824    \ncredit_historyno credits taken/all credits paid back duly  8.517e-01  5.311e-01   1.604 0.108781    \ncredit_historyexisting credits paid back duly till now     1.278e+00  5.799e-01   2.204 0.027546 *  \ncredit_historyall credits at this bank paid back duly      1.444e+00  5.311e-01   2.718 0.006569 ** \nduration                                                  -3.674e-02  1.124e-02  -3.268 0.001083 ** \nemployment_duration&lt; 1 yr                                 -5.909e-01  5.535e-01  -1.068 0.285694    \nemployment_duration1 &lt;= ... &lt; 4 yrs                       -1.410e-01  5.197e-01  -0.271 0.786181    \nemployment_duration4 &lt;= ... &lt; 7 yrs                        2.575e-01  5.676e-01   0.454 0.650134    \nemployment_duration&gt;= 7 yrs                               -2.026e-01  5.284e-01  -0.383 0.701449    \nforeign_workerno                                          -1.298e+00  7.418e-01  -1.749 0.080235 .  \nhousingrent                                                2.712e-01  2.800e-01   0.969 0.332719    \nhousingown                                                 3.154e-01  6.180e-01   0.510 0.609785    \ninstallment_rate.L                                        -5.018e-01  2.645e-01  -1.897 0.057784 .  \ninstallment_rate.Q                                        -3.089e-01  2.410e-01  -1.282 0.199878    \ninstallment_rate.C                                         8.274e-02  2.496e-01   0.332 0.740232    \njobunskilled - resident                                    6.929e-01  8.182e-01   0.847 0.397122    \njobskilled employee/official                               7.769e-01  7.896e-01   0.984 0.325125    \njobmanager/self-empl./highly qualif. employee              7.129e-01  7.923e-01   0.900 0.368240    \nnumber_credits.L                                          -1.358e-01  7.661e-01  -0.177 0.859348    \nnumber_credits.Q                                           6.595e-02  6.395e-01   0.103 0.917854    \nnumber_credits.C                                           7.483e-02  4.877e-01   0.153 0.878071    \nother_debtorsco-applicant                                  2.186e-01  5.266e-01   0.415 0.678024    \nother_debtorsguarantor                                     7.834e-01  4.968e-01   1.577 0.114862    \nother_installment_plansstores                              1.454e-01  5.422e-01   0.268 0.788528    \nother_installment_plansnone                                3.874e-01  3.077e-01   1.259 0.208020    \npeople_liable0 to 2                                        2.244e-01  3.184e-01   0.705 0.481005    \npersonal_status_sexfemale : non-single or male : single    6.476e-01  4.842e-01   1.338 0.181034    \npersonal_status_sexmale : married/widowed                  1.204e+00  4.825e-01   2.494 0.012621 *  \npersonal_status_sexfemale : single                         8.236e-01  5.724e-01   1.439 0.150153    \npresent_residence.L                                       -3.690e-01  2.592e-01  -1.424 0.154559    \npresent_residence.Q                                        4.980e-01  2.443e-01   2.038 0.041546 *  \npresent_residence.C                                       -4.572e-01  2.462e-01  -1.857 0.063326 .  \npropertycar or other                                       1.244e-01  3.036e-01   0.410 0.682060    \npropertybuilding soc. savings agr./life insurance          1.432e-01  2.891e-01   0.495 0.620375    \npropertyreal estate                                       -2.818e-01  5.615e-01  -0.502 0.615706    \npurposecar (new)                                           1.774e+00  4.793e-01   3.702 0.000214 ***\npurposecar (used)                                          5.974e-01  3.227e-01   1.851 0.064101 .  \npurposefurniture/equipment                                 8.264e-01  3.091e-01   2.674 0.007494 ** \npurposeradio/television                                   -9.668e-02  8.379e-01  -0.115 0.908140    \npurposedomestic appliances                                 6.065e-01  6.489e-01   0.935 0.349946    \npurposerepairs                                            -2.953e-01  4.570e-01  -0.646 0.518163    \npurposevacation                                            1.592e+00  1.272e+00   1.251 0.210816    \npurposeretraining                                          6.450e-01  4.038e-01   1.597 0.110245    \npurposebusiness                                            1.340e+00  8.364e-01   1.601 0.109268    \nsavings... &lt;  100 DM                                       2.723e-01  3.449e-01   0.789 0.429824    \nsavings100 &lt;= ... &lt;  500 DM                                1.511e+00  6.117e-01   2.471 0.013477 *  \nsavings500 &lt;= ... &lt; 1000 DM                                1.715e+00  7.436e-01   2.306 0.021093 *  \nsavings... &gt;= 1000 DM                                      1.195e+00  3.255e-01   3.671 0.000242 ***\nstatus... &lt; 0 DM                                           3.827e-01  2.642e-01   1.449 0.147465    \nstatus0&lt;= ... &lt; 200 DM                                     9.451e-01  4.254e-01   2.222 0.026301 *  \nstatus... &gt;= 200 DM / salary for at least 1 year           1.813e+00  2.866e-01   6.325 2.53e-10 ***\ntelephoneyes (under customer name)                         4.773e-03  2.427e-01   0.020 0.984311    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 868.33  on 699  degrees of freedom\nResidual deviance: 622.78  on 645  degrees of freedom\nAIC: 732.78\n\nNumber of Fisher Scoring iterations: 5</pre>\n</div>\n</div>\n<p>According to the summary, e.g., <code>credit_history</code> and <code>status</code> significantly influence the creditworthiness and the bank’s risk assessment. By looking on <code>task$positive</code>, we see that the class <code>good</code> (creditworthy client) is the positive class. This means that a positive sign of the estimated coefficient of a feature means that the feature has a positive influence on being a creditworthy client (while a negative sign will have a negative influence).</p>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>task$positive</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>[1] \"good\"</pre>\n</div>\n</div>\n<p>For example, the negative sign of the coefficients of <code>credit_history = delay in paying off in the past</code> and <code>credit_history = critical account/other credit elsewhere</code>, indicate a negative influence and therefore lower probability of being a creditworthy client compared to their reference class <code>credit_history = all credits at this bank paid back duly</code>. The positive sign of the coefficient of <code>status &gt;= 200 DM / salary for at least 1 year</code> and <code>status = 0 &lt;= ... &lt; 200 DM</code>, therefore, indicate a positive influence w.r.t to its reference class <code>status &lt; 0 DM</code>.</p>\n</div>\n</div>\n</div>\n</section>\n<section class=\"level2\" id=\"predict-on-the-test-dataset\">\n<h2 class=\"anchored\" data-anchor-id=\"predict-on-the-test-dataset\">Predict on the Test Dataset</h2>\n<p>Use the trained model to predict on the hold-out/test dataset.</p>\n<details>\n<summary>\n<strong>Hint 1</strong>\n</summary>\n<p>Since we have a new tabular dataset as an input (and not a task), we need to use <code>$predict_newdata()</code> (instead of <code>$predict()</code>) to derive a <code>PredictionClassif</code> object.</p>\n</details>\n<details>\n<summary>\n<strong>Hint 2</strong>\n</summary>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>pred = yourmodel$predict_newdata(...)</pre>\n</div>\n</details>\n<div class=\"callout callout-style-default callout-note callout-titled\">\n<div aria-controls=\"callout-5\" aria-expanded=\"false\" aria-label=\"Toggle callout\" class=\"callout-header d-flex align-content-center\" data-bs-=\"\" data-bs-toggle=\"collapse\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nSolution\n</div>\n<div class=\"callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end\"><i class=\"callout-toggle\"></i></div>\n</div>\n<div class=\"callout-5-contents callout-collapse collapse\" id=\"callout-5\">\n<div class=\"callout-body-container callout-body\">\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>pred_logreg = logreg$predict_newdata(test_set)</pre>\n</div>\n</div>\n</div>\n</div>\n</section>\n<section class=\"level2\" id=\"evaluation\">\n<h2 class=\"anchored\" data-anchor-id=\"evaluation\">Evaluation</h2>\n<p>What is the classification error on the test data (200 observations)?</p>\n<details>\n<summary>\n<strong>Hint 1:</strong>\n</summary>\n<p>The classification error gives the rate of observations that were misclassified. Use the <code>$score()</code> method on the corresponding <code>PredictionClassif</code> object of the previous exercise.</p>\n</details>\n<details>\n<summary>\n<strong>Hint 2:</strong>\n</summary>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>pred_logreg$score()</pre>\n</div>\n</details>\n<div class=\"callout callout-style-default callout-note callout-titled\">\n<div aria-controls=\"callout-6\" aria-expanded=\"false\" aria-label=\"Toggle callout\" class=\"callout-header d-flex align-content-center\" data-bs-=\"\" data-bs-toggle=\"collapse\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nSolution\n</div>\n<div class=\"callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end\"><i class=\"callout-toggle\"></i></div>\n</div>\n<div class=\"callout-6-contents callout-collapse collapse\" id=\"callout-6\">\n<div class=\"callout-body-container callout-body\">\n<p>By using the <code>$score()</code> method, we obtain an estimate for the classification error of our model.</p>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>pred_logreg$score()</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>classif.ce \n 0.7733333 </pre>\n</div>\n</div>\n<p>The classification error is 0.255 - so 25.5 % of the test instances were misclassified by our logistic regression model.</p>\n</div>\n</div>\n</div>\n</section>\n<section class=\"level2\" id=\"predicting-probabilities-instead-of-labels\">\n<h2 class=\"anchored\" data-anchor-id=\"predicting-probabilities-instead-of-labels\">Predicting probabilities instead of labels</h2>\n<p>Similarly, we can assess the performance of our model using the AUC. However, this requires predicted probabilities instead of predicted labels. Evaluate the model using the AUC. To do so, retrain the model with a learner that returns probabilities.</p>\n<details>\n<summary>\n<strong>Hint 1:</strong>\n</summary>\n<p>You can generate predictions with probabilities by specifying a <code>predict_type</code> argument inside the <code>lrn()</code> function call when constructing a learner.</p>\n</details>\n<details>\n<summary>\n<strong>Hint 2:</strong>\n</summary>\n<p>You can get an overview of performance measures in mlr3 using <code>as.data.table(msr())</code>.</p>\n</details>\n<div class=\"callout callout-style-default callout-note callout-titled\">\n<div aria-controls=\"callout-7\" aria-expanded=\"false\" aria-label=\"Toggle callout\" class=\"callout-header d-flex align-content-center\" data-bs-=\"\" data-bs-toggle=\"collapse\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nSolution\n</div>\n<div class=\"callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end\"><i class=\"callout-toggle\"></i></div>\n</div>\n<div class=\"callout-7-contents callout-collapse collapse\" id=\"callout-7\">\n<div class=\"callout-body-container callout-body\">\n<div class=\"cell\" data-layout-align=\"center\">\n<pre># Train a learner\nlogreg = lrn(\"classif.log_reg\", predict_type = \"prob\")\nlogreg$train(task)\n# Generate predictions\npred_logreg = logreg$predict_newdata(test_set)\n# Evaluate performance using AUC\nmeasure = msrs(c(\"classif.auc\"))\npred_logreg$score(measure)</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>classif.auc \n  0.2351757 </pre>\n</div>\n</div>\n</div>\n</div>\n</div>\n</section>\n</section>\n<section class=\"level1\" id=\"summary\">\n<h1>Summary</h1>\n<p>In this exercise sheet we learned how to fit a logistic regression model on a training task and how to assess its performance on unseen test data with the help of <code>mlr3</code>. We showed how to split data manually into training and test data, but in most scenarios it is a call to resample or benchmark. We will learn more on this in the next sections.</p>\n</section>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://mlr-org.com/gallery/basic/2025-04-10-german-credit-into/\"> mlr-org</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
    "main_text": "Train Predict Evaluate Basics\nPosted on\nApril 13, 2025\nby\nGiuseppe Casalicchio\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nmlr-org\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nGoal\nOur goal for this exercise sheet is to learn the basics of mlr3 for supervised learning by training a first simple model on training data and by evaluating its performance on hold-out/test data.\nGerman Credit Dataset\nThe German credit dataset was donated by Prof. Dr. Hans Hoffman of the University of Hamburg in 1994 and contains 1000 datapoints reflecting bank customers. The goal is to classify people as a good or bad credit risk based on 20 personal, demographic and financial features. The dataset is available at the UCI repository as\nStatlog (German Credit Data) Data Set\n.\nMotivation of Risk Prediction\nCustomers who do not repay the distributed loan on time represent an enormous risk for a bank: First, because they create an unintended gap in the bank’s planning, and second, because the collection of the repayment amount additionally causes additional time and cost for the bank.\nOn the other hand, (interest rates for) loans are an important revenue stream for banks. If a person’s loan is rejected, even though they would have met the repayment deadlines, revenue is lost, as well as potential upselling opportunities.\nBanks are therefore highly interested in a risk prediction model that accurately predicts the risk of future customers. This is where supervised learning models come into play.\nData Overview\nn = 1,000 observations of bank customers\ncredit_risk\n: is the customer a good or bad credit risk?\nage\n: age in years\namount\n: amount asked by applicant\ncredit_history\n: past credit history of applicant at this bank\nduration\n: duration of the credit in months\nemployment_duration\n: present employment since\nforeign_worker\n: is applicant foreign worker?\nhousing\n: type of apartment rented, owned, for free / no payment\ninstallment_rate\n: installment rate in percentage of disposable income\njob\n: current job information\nnumber_credits\n: number of existing credits at this bank\nother_debtors\n: other debtors/guarantors present?\nother_installment_plans\n: other installment plans the applicant is paying\npeople_liable\n: number of people being liable to provide maintenance\npersonal_status_sex\n: combination of sex and personal status of applicant\npresent_residence\n: present residence since\nproperty\n: properties that applicant has\npurpose\n: reason customer is applying for a loan\nsavings\n: savings accounts/bonds at this bank\nstatus\n: status/balance of checking account at this bank\ntelephone\n: is there any telephone registered for this customer?\nPreprocessing\nWe first load the data from the\nrchallenge\npackage (you may need to install it first) and get a brief overview.\n# install.packages(\"rchallenge\")\nlibrary(\"rchallenge\")\ndata(\"german\")\nskimr::skim(german)\nData summary\nName\ngerman\nNumber of rows\n1000\nNumber of columns\n21\n_______________________\nColumn type frequency:\nfactor\n18\nnumeric\n3\n________________________\nGroup variables\nNone\nVariable type: factor\nskim_variable\nn_missing\ncomplete_rate\nordered\nn_unique\ntop_counts\nstatus\n0\n1\nFALSE\n4\n…: 394, no : 274, …: 269, 0<=: 63\ncredit_history\n0\n1\nFALSE\n5\nno : 530, all: 293, exi: 88, cri: 49\npurpose\n0\n1\nFALSE\n10\nfur: 280, oth: 234, car: 181, car: 103\nsavings\n0\n1\nFALSE\n5\nunk: 603, …: 183, …: 103, 100: 63\nemployment_duration\n0\n1\nFALSE\n5\n1 <: 339, >= : 253, 4 <: 174, < 1: 172\ninstallment_rate\n0\n1\nTRUE\n4\n< 2: 476, 25 : 231, 20 : 157, >= : 136\npersonal_status_sex\n0\n1\nFALSE\n4\nmal: 548, fem: 310, fem: 92, mal: 50\nother_debtors\n0\n1\nFALSE\n3\nnon: 907, gua: 52, co-: 41\npresent_residence\n0\n1\nTRUE\n4\n>= : 413, 1 <: 308, 4 <: 149, < 1: 130\nproperty\n0\n1\nFALSE\n4\nbui: 332, unk: 282, car: 232, rea: 154\nother_installment_plans\n0\n1\nFALSE\n3\nnon: 814, ban: 139, sto: 47\nhousing\n0\n1\nFALSE\n3\nren: 714, for: 179, own: 107\nnumber_credits\n0\n1\nTRUE\n4\n1: 633, 2-3: 333, 4-5: 28, >= : 6\njob\n0\n1\nFALSE\n4\nski: 630, uns: 200, man: 148, une: 22\npeople_liable\n0\n1\nFALSE\n2\n0 t: 845, 3 o: 155\ntelephone\n0\n1\nFALSE\n2\nno: 596, yes: 404\nforeign_worker\n0\n1\nFALSE\n2\nno: 963, yes: 37\ncredit_risk\n0\n1\nFALSE\n2\ngoo: 700, bad: 300\nVariable type: numeric\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\nduration\n0\n1\n20.90\n12.06\n4\n12.0\n18.0\n24.00\n72\n▇▇▂▁▁\namount\n0\n1\n3271.25\n2822.75\n250\n1365.5\n2319.5\n3972.25\n18424\n▇▂▁▁▁\nage\n0\n1\n35.54\n11.35\n19\n27.0\n33.0\n42.00\n75\n▇▆▃▁▁\nExercises:\nNow, we can start building a model. To do so, we need to address the following questions:\nWhat is the problem we are trying to solve?\nWhat is an appropriate learning algorithm?\nHow do we evaluate “good” performance?\nMore systematically in\nmlr3\nthey can be expressed via five components:\nThe\nTask\ndefinition.\nThe\nLearner\ndefinition.\nThe training via\n$train()\n.\nThe prediction via\n$predict()\n.\nThe evaluation via one\n$score()\n.\nSplit Data in Training and Test Data\nYour task is to split the\ngerman\ndataset into 70 % training data and 30 % test data by randomly sampling rows. Later, we will use the training data to learn an ML model and use the test data to assess its performance.\nRecap: Why do we need train and test data?\nWe use part of the available data (the training data) to train our model. The remaining/hold-out data (test data) is used to evaluate the trained model. This is exactly how we anticipate using the model in practice: We want to fit the model to existing data and then make predictions on new, unseen data points for which we do not know the outcome/target values.\nNote: Hold-out splitting requires a dataset that is sufficiently large such that both the training and test dataset are suitable representations of the target population. What “sufficiently large” means depends on the dataset at hand and the complexity of the problem.\nThe ratio of training to test data is also context dependent. In practice, a 70% to 30% (~ 2:1) ratio is a good starting point.\nHint 1:\nUse\nsample()\nto sample 70 % of the data ids as training data ids from\nrow.names(german)\n. The remaining row ids are obtained via\nsetdiff()\n. Based on the ids, set up two datasets, one for training and one for testing/evaluating.\nSet a seed (e.g,\nset.seed(100L)\n) to make your results reproducible.\nHint 2:\n# Sample ids for training and test split\nset.seed(100L)\ntrain_ids = sample(row.names(german), 0.7*nrow(...))\ntest_ids = setdiff(..., train_ids)\n\n# Create two datasets based on ids\ntrain_set = german[...,]\ntest_set = german[...,]\nSolution\nWe first sample row ids by using\nsample()\nand identify the non-selected rows via\nsetdiff()\n.\nset.seed(100L)\ntrain_ids = sample(row.names(german), 0.7*nrow(german))\ntest_ids = setdiff(row.names(german), train_ids)\nstr(train_ids)\nchr [1:700] \"714\" \"503\" \"358\" \"624\" \"985\" \"718\" \"919\" \"470\" \"966\" \"516\" \"823\" \"838\" \"98\" \"903\" \"7\" \"183\" \"299\" ...\nstr(test_ids)\nchr [1:300] \"3\" \"5\" \"8\" \"17\" \"20\" \"22\" \"25\" \"29\" \"33\" \"35\" \"39\" \"40\" \"41\" \"43\" \"44\" \"49\" \"52\" \"57\" \"58\" \"59\" \"62\" ...\nBased on that, we create two datasets: one for training and one for testing.\ntrain_set = german[train_ids,]\ntest_set = german[test_ids, ]\nCreate a Classification Task\nInstall and load the\nmlr3verse\npackage which is a collection of multiple add-on packages in the\nmlr3\nuniverse (if you fail installing\nmlr3verse\n, try to install and load only the\nmlr3\nand\nmlr3learners\npackages). Then, create a classification task using the training data as an input and\ncredit_risk\nas the target variable (with the class label\ngood\nas the positive class). By defining an\nmlr3\ntask, we conceptualize the ML problem we want to solve (here we face a classification task). As we have a classification task here, make sure you properly specify the class that should be used as the positive class (i.e., the class label for which we would like to predict probabilities – here\ngood\nif you are interested in predicting a probability for the creditworthiness of customers).\nHint 1:\nUse e.g.\nas_task_classif()\nto create a classification task.\nHint 2:\nlibrary(mlr3verse)\ntask = as_task_classif(x = ..., target = ..., ... = \"good\")\nSolution\nTo initialize a\nTaskClassif\nobject, two equivalent calls exist:\nlibrary(\"mlr3verse\")\nLoading required package: mlr3\ntask = TaskClassif$new(\"german_credit\", backend = train_set, target = \"credit_risk\", positive = \"good\")\ntask = as_task_classif(train_set, target = \"credit_risk\", positive = \"good\")\ntask\n<TaskClassif:train_set> (700 x 21)\n* Target: credit_risk\n* Properties: twoclass\n* Features (20):\n  - fct (14): credit_history, employment_duration, foreign_worker, housing, job, other_debtors,\n    other_installment_plans, people_liable, personal_status_sex, property, purpose, savings, status,\n    telephone\n  - int (3): age, amount, duration\n  - ord (3): installment_rate, number_credits, present_residence\nTrain a Model on the Training Dataset\nThe created\nTask\ncontains the data we want to work with. Now that we conceptualized the ML task (i.e., classification) in a\nTask\nobject, it is time to train our first supervised learning method. We start with a simple classifier: a logistic regression model. During this course, you will, of course, also gain experience with more complex models.\nFit a logistic regression model to the\ngerman_credit\ntraining task.\nHint 1:\nUse\nlrn()\nto initialize a\nLearner\nobject. The short cut and therefore input to this method is\n\"classif.log_reg\"\n.\nTo train a model, use the\n$train()\nmethod of your instantiated learner with the task of the previous exercise as an input.\nHint 2:\nlogreg = lrn(\"classif.log_reg\")\nlogreg$train(...)\nSolution\nBy using the syntactic sugar method\nlrn()\n, we first initialize a\nLearnerClassif\nmodel. Using the\n$train()\nmethod, we derive optimal hyperparameters (i.e., coefficients) for our logistic regression model.\nlogreg = lrn(\"classif.log_reg\")\nlogreg$train(task)\nInspect the Model\nHave a look at the coefficients by using\nsummary()\n. Name at least two features that have a significant effect on the outcome.\nHint 1:\nUse the\nsummary()\nmethod of the\nmodel\nfield of our trained model. By looking on\ntask$positive\n, we could see which of the two classes\ngood\nor\nbad\nis used as the positive class (i.e., the class to which the model predictions will refer).\nHint 2:\nsummary(yourmodel$model)\nSolution\nSimilar to models fitted via\nglm()\nor\nlm()\n, we could receive a summary of the coefficients (including p-values) using\nsummary()\n.\nsummary(logreg$model)\nCall:\nstats::glm(formula = form, family = \"binomial\", data = data, \n    model = FALSE)\n\nCoefficients:\n                                                            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                                               -2.342e+00  1.402e+00  -1.671 0.094676 .  \nage                                                        1.999e-02  1.154e-02   1.733 0.083116 .  \namount                                                    -4.414e-05  5.413e-05  -0.815 0.414900    \ncredit_historycritical account/other credits elsewhere    -2.267e-01  7.109e-01  -0.319 0.749824    \ncredit_historyno credits taken/all credits paid back duly  8.517e-01  5.311e-01   1.604 0.108781    \ncredit_historyexisting credits paid back duly till now     1.278e+00  5.799e-01   2.204 0.027546 *  \ncredit_historyall credits at this bank paid back duly      1.444e+00  5.311e-01   2.718 0.006569 ** \nduration                                                  -3.674e-02  1.124e-02  -3.268 0.001083 ** \nemployment_duration< 1 yr                                 -5.909e-01  5.535e-01  -1.068 0.285694    \nemployment_duration1 <= ... < 4 yrs                       -1.410e-01  5.197e-01  -0.271 0.786181    \nemployment_duration4 <= ... < 7 yrs                        2.575e-01  5.676e-01   0.454 0.650134    \nemployment_duration>= 7 yrs                               -2.026e-01  5.284e-01  -0.383 0.701449    \nforeign_workerno                                          -1.298e+00  7.418e-01  -1.749 0.080235 .  \nhousingrent                                                2.712e-01  2.800e-01   0.969 0.332719    \nhousingown                                                 3.154e-01  6.180e-01   0.510 0.609785    \ninstallment_rate.L                                        -5.018e-01  2.645e-01  -1.897 0.057784 .  \ninstallment_rate.Q                                        -3.089e-01  2.410e-01  -1.282 0.199878    \ninstallment_rate.C                                         8.274e-02  2.496e-01   0.332 0.740232    \njobunskilled - resident                                    6.929e-01  8.182e-01   0.847 0.397122    \njobskilled employee/official                               7.769e-01  7.896e-01   0.984 0.325125    \njobmanager/self-empl./highly qualif. employee              7.129e-01  7.923e-01   0.900 0.368240    \nnumber_credits.L                                          -1.358e-01  7.661e-01  -0.177 0.859348    \nnumber_credits.Q                                           6.595e-02  6.395e-01   0.103 0.917854    \nnumber_credits.C                                           7.483e-02  4.877e-01   0.153 0.878071    \nother_debtorsco-applicant                                  2.186e-01  5.266e-01   0.415 0.678024    \nother_debtorsguarantor                                     7.834e-01  4.968e-01   1.577 0.114862    \nother_installment_plansstores                              1.454e-01  5.422e-01   0.268 0.788528    \nother_installment_plansnone                                3.874e-01  3.077e-01   1.259 0.208020    \npeople_liable0 to 2                                        2.244e-01  3.184e-01   0.705 0.481005    \npersonal_status_sexfemale : non-single or male : single    6.476e-01  4.842e-01   1.338 0.181034    \npersonal_status_sexmale : married/widowed                  1.204e+00  4.825e-01   2.494 0.012621 *  \npersonal_status_sexfemale : single                         8.236e-01  5.724e-01   1.439 0.150153    \npresent_residence.L                                       -3.690e-01  2.592e-01  -1.424 0.154559    \npresent_residence.Q                                        4.980e-01  2.443e-01   2.038 0.041546 *  \npresent_residence.C                                       -4.572e-01  2.462e-01  -1.857 0.063326 .  \npropertycar or other                                       1.244e-01  3.036e-01   0.410 0.682060    \npropertybuilding soc. savings agr./life insurance          1.432e-01  2.891e-01   0.495 0.620375    \npropertyreal estate                                       -2.818e-01  5.615e-01  -0.502 0.615706    \npurposecar (new)                                           1.774e+00  4.793e-01   3.702 0.000214 ***\npurposecar (used)                                          5.974e-01  3.227e-01   1.851 0.064101 .  \npurposefurniture/equipment                                 8.264e-01  3.091e-01   2.674 0.007494 ** \npurposeradio/television                                   -9.668e-02  8.379e-01  -0.115 0.908140    \npurposedomestic appliances                                 6.065e-01  6.489e-01   0.935 0.349946    \npurposerepairs                                            -2.953e-01  4.570e-01  -0.646 0.518163    \npurposevacation                                            1.592e+00  1.272e+00   1.251 0.210816    \npurposeretraining                                          6.450e-01  4.038e-01   1.597 0.110245    \npurposebusiness                                            1.340e+00  8.364e-01   1.601 0.109268    \nsavings... <  100 DM                                       2.723e-01  3.449e-01   0.789 0.429824    \nsavings100 <= ... <  500 DM                                1.511e+00  6.117e-01   2.471 0.013477 *  \nsavings500 <= ... < 1000 DM                                1.715e+00  7.436e-01   2.306 0.021093 *  \nsavings... >= 1000 DM                                      1.195e+00  3.255e-01   3.671 0.000242 ***\nstatus... < 0 DM                                           3.827e-01  2.642e-01   1.449 0.147465    \nstatus0<= ... < 200 DM                                     9.451e-01  4.254e-01   2.222 0.026301 *  \nstatus... >= 200 DM / salary for at least 1 year           1.813e+00  2.866e-01   6.325 2.53e-10 ***\ntelephoneyes (under customer name)                         4.773e-03  2.427e-01   0.020 0.984311    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 868.33  on 699  degrees of freedom\nResidual deviance: 622.78  on 645  degrees of freedom\nAIC: 732.78\n\nNumber of Fisher Scoring iterations: 5\nAccording to the summary, e.g.,\ncredit_history\nand\nstatus\nsignificantly influence the creditworthiness and the bank’s risk assessment. By looking on\ntask$positive\n, we see that the class\ngood\n(creditworthy client) is the positive class. This means that a positive sign of the estimated coefficient of a feature means that the feature has a positive influence on being a creditworthy client (while a negative sign will have a negative influence).\ntask$positive\n[1] \"good\"\nFor example, the negative sign of the coefficients of\ncredit_history = delay in paying off in the past\nand\ncredit_history = critical account/other credit elsewhere\n, indicate a negative influence and therefore lower probability of being a creditworthy client compared to their reference class\ncredit_history = all credits at this bank paid back duly\n. The positive sign of the coefficient of\nstatus >= 200 DM / salary for at least 1 year\nand\nstatus = 0 <= ... < 200 DM\n, therefore, indicate a positive influence w.r.t to its reference class\nstatus < 0 DM\n.\nPredict on the Test Dataset\nUse the trained model to predict on the hold-out/test dataset.\nHint 1\nSince we have a new tabular dataset as an input (and not a task), we need to use\n$predict_newdata()\n(instead of\n$predict()\n) to derive a\nPredictionClassif\nobject.\nHint 2\npred = yourmodel$predict_newdata(...)\nSolution\npred_logreg = logreg$predict_newdata(test_set)\nEvaluation\nWhat is the classification error on the test data (200 observations)?\nHint 1:\nThe classification error gives the rate of observations that were misclassified. Use the\n$score()\nmethod on the corresponding\nPredictionClassif\nobject of the previous exercise.\nHint 2:\npred_logreg$score()\nSolution\nBy using the\n$score()\nmethod, we obtain an estimate for the classification error of our model.\npred_logreg$score()\nclassif.ce \n 0.7733333\nThe classification error is 0.255 - so 25.5 % of the test instances were misclassified by our logistic regression model.\nPredicting probabilities instead of labels\nSimilarly, we can assess the performance of our model using the AUC. However, this requires predicted probabilities instead of predicted labels. Evaluate the model using the AUC. To do so, retrain the model with a learner that returns probabilities.\nHint 1:\nYou can generate predictions with probabilities by specifying a\npredict_type\nargument inside the\nlrn()\nfunction call when constructing a learner.\nHint 2:\nYou can get an overview of performance measures in mlr3 using\nas.data.table(msr())\n.\nSolution\n# Train a learner\nlogreg = lrn(\"classif.log_reg\", predict_type = \"prob\")\nlogreg$train(task)\n# Generate predictions\npred_logreg = logreg$predict_newdata(test_set)\n# Evaluate performance using AUC\nmeasure = msrs(c(\"classif.auc\"))\npred_logreg$score(measure)\nclassif.auc \n  0.2351757\nSummary\nIn this exercise sheet we learned how to fit a logistic regression model on a training task and how to assess its performance on unseen test data with the help of\nmlr3\n. We showed how to split data manually into training and test data, but in most scenarios it is a call to resample or benchmark. We will learn more on this in the next sections.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nmlr-org\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "Goal Our goal for this exercise sheet is to learn the basics of mlr3 for supervised learning by training a first simple model on training data and by evaluating its performance on hold-out/test data. German Credit Dataset The German credit dat...",
    "meta_keywords": null,
    "og_description": "Goal Our goal for this exercise sheet is to learn the basics of mlr3 for supervised learning by training a first simple model on training data and by evaluating its performance on hold-out/test data. German Credit Dataset The German credit dat...",
    "og_image": "https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png",
    "og_title": "Train Predict Evaluate Basics | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 15.2,
    "sitemap_lastmod": null,
    "twitter_description": "Goal Our goal for this exercise sheet is to learn the basics of mlr3 for supervised learning by training a first simple model on training data and by evaluating its performance on hold-out/test data. German Credit Dataset The German credit dat...",
    "twitter_title": "Train Predict Evaluate Basics | R-bloggers",
    "url": "https://www.r-bloggers.com/2025/04/train-predict-evaluate-basics/",
    "word_count": 3046
  }
}