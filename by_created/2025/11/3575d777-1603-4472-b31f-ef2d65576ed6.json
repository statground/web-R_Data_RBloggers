{
  "uuid": "3575d777-1603-4472-b31f-ef2d65576ed6",
  "created_at": "2025-11-17 20:38:56",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2023/12/r-solution-for-excel-puzzles-3/",
    "crawled_at": "2025-11-17T09:37:40.730507",
    "external_links": [
      {
        "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-4d94ecf1a1e3",
        "text": "Numbers around us - Medium"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://www.linkedin.com/in/excelbi/",
        "text": "ExcelBI"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7137289421120258048-W-c2",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dcXj6a4A",
        "text": "file"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7137651807329173504-gcCM",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dRbptbaD",
        "text": "file"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-challenge-excelchallenge-activity-7138014190367129600-kD-T",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dK5p23nS",
        "text": "file"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7138376598243741696-PbOu",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/gRRrHqam",
        "text": "file"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7138738988110045187-Njs2",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dyJrsBuD",
        "text": "file"
      },
      {
        "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-4d94ecf1a1e3",
        "text": "R Solution for Excel Puzzles"
      },
      {
        "href": "https://medium.com/number-around-us",
        "text": "Numbers around us"
      },
      {
        "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-4d94ecf1a1e3",
        "text": "Numbers around us - Medium"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "R Solution for Excel Puzzles | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*OQLAbd_tHb1V6QxD7PmNnw.jpeg?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*qx7N1ITXOA50MyXIHfzg-w.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*6uwL4-mFdu5_G60hDWVU9g.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*bqZSgF1LljTB2raB5rrcUQ.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*mOnRBxKFsBEhYsHW2Zmmig.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*ryDEF0iV4DecmBdl36auxw.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:application/octet-stream;base64,R0lGODlhAQABAO+/vQAA77+977+977+9AAAAIe+/vQQBAAAAACwAAAAAAQABAAACAkQBADs=",
        "src": "https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=4d94ecf1a1e3"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/numbers-around-us/",
        "text": "Numbers around us"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-380861 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">R Solution for Excel Puzzles</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 11, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/numbers-around-us/\">Numbers around us</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-4d94ecf1a1e3\"> Numbers around us - Medium</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><p>Puzzles no. 339–343</p><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*OQLAbd_tHb1V6QxD7PmNnw.jpeg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*OQLAbd_tHb1V6QxD7PmNnw.jpeg?w=578&amp;ssl=1\"/></noscript></figure><h3>Puzzles</h3><p>Author: <a href=\"https://www.linkedin.com/in/excelbi/\" rel=\"nofollow\" target=\"_blank\">ExcelBI</a></p><p>Puzzles:<br/>#339: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7137289421120258048-W-c2\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dcXj6a4A\" rel=\"nofollow\" target=\"_blank\">file</a><br/>#340: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7137651807329173504-gcCM\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dRbptbaD\" rel=\"nofollow\" target=\"_blank\">file</a><br/>#341: <a href=\"https://www.linkedin.com/posts/excelbi_excel-challenge-excelchallenge-activity-7138014190367129600-kD-T\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dK5p23nS\" rel=\"nofollow\" target=\"_blank\">file</a><br/>#342: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7138376598243741696-PbOu\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/gRRrHqam\" rel=\"nofollow\" target=\"_blank\">file</a><br/>#343: <a href=\"https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7138738988110045187-Njs2\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dyJrsBuD\" rel=\"nofollow\" target=\"_blank\">file</a></p><p>Lets dive into solutions!<br/>Short disclaimer: This weeks riddles were well designed and I found out that very good but also readable solutions will not have different approaches this time. It would only overcomplicate the code. So let started.</p><h3>Puzzle #339</h3><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*qx7N1ITXOA50MyXIHfzg-w.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*qx7N1ITXOA50MyXIHfzg-w.png?w=578&amp;ssl=1\"/></noscript></figure><p>Puzzles focused on Fibonacci sequence are frequent guests on our puzzles. This time we are taking regular Fibonacci sequence and have “only” to return nth term of sequence. We did it several times, but today I am adding little twist.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(memoise)\n\ninput = read_excel(\"Nth Fibonacci Number.xlsx\", range = \"A1:A10\")\ntest = read_excel(\"Nth Fibonacci Number.xlsx\", range = \"B1:B10\") %&gt;%janitor::clean_names()</pre><h4>Prepare and run function</h4><p>What is the twist here? We use one technique that I learned not long time ago — memoization. Function with this feature just storing new results in cache and if find out that such computation was already done, do not make calculation, but take result from cache. In our case for example if we do it without memoization line 9 (with 73rd term) would need 72 recursive additions, while if we do it that way: we would have one read from cache, because fib(68) was already stored in cache, and 5 recursive additions. <br/>It will significantly improve data processing time.</p><pre>fib &lt;- memoise(function(n) {\n  if (n &lt;= 2) {\n    return(1)\n  } else {\n    return(fib(n - 1) + fib(n - 2))\n  }\n})\n\nresult = input %&gt;%\n  mutate(fib = map_dbl(input$N, fib)) %&gt;%\n  select(fib)</pre><h4>Validation</h4><pre>identical(result$fib, test$answer_expected)\n#&gt; [1] TRUE</pre><h3>Puzzle 340</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*6uwL4-mFdu5_G60hDWVU9g.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*6uwL4-mFdu5_G60hDWVU9g.png?w=578&amp;ssl=1\"/></noscript></figure><p>This puzzle is extremely easy when approaching it with tidyverse, but goal for “Excel” solvers where to use newly added functions. So let see how lubridate is doing job for us.</p><h4>Loading libraries and data</h4><pre>library(tidyverse) # lubridate is loading with tidyverse\nlibrary(readxl)\n\ninput = read_excel(\"Date Min Max.xlsx\", range = \"A1:A20\")\ntest = read_excel(\"Date Min Max.xlsx\", range = \"C2:F8\")</pre><h4>Transformation</h4><pre>result = input %&gt;%\n  mutate(Year = year(Date),\n         Half = str_c(semester(Date),\"H\")) %&gt;%\n  group_by(Year, Half) %&gt;%\n  summarise(`Min Date` = min(Date),\n            `Max Date` = max(Date)) %&gt;%\n  ungroup()</pre><h4>Validation</h4><pre>identical(test, result)\n#&gt; [1] TRUE</pre><h3>Puzzle 341</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*bqZSgF1LljTB2raB5rrcUQ.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*bqZSgF1LljTB2raB5rrcUQ.png?w=578&amp;ssl=1\"/></noscript></figure><p>We have to sort some things… against all odds. Or maybe not. We have to sort only digits in given numbers that are on odd positions (1,3,5 and so on). Let’s try it out.</p><h4>Loading libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Sort Alternate.xlsx\", range = \"A1:A11\") %&gt;% janitor::clean_names()\ntest = read_excel(\"Sort Alternate.xlsx\", range = \"B1:B11\") %&gt;% janitor::clean_names()</pre><h4>Transforming data</h4><pre>sort_odd_digits = function(number) {\n  digits = strsplit(as.character(number), \"\")[[1]]\n  if (length(digits) &lt; 2) {\n    return(as.numeric(paste0(digits, collapse = \"\")))\n  }\n  odd_digits = digits[seq(1, length(digits), 2)]\n  even_digits = digits[seq(2, length(digits), 2)]\n  sorted_odd = sort(odd_digits)\n  digits[seq(1, length(digits), 2)] = sorted_odd\n  number = digits %&gt;% paste0(collapse = \"\")\n  return(number)\n}\n\nresult  = input %&gt;%\n  mutate(answer_expected = map(number_string, sort_odd_digits))</pre><blockquote>Validation</blockquote><pre>identical(unlist(result$answer_expected), test$answer_expected)\n#&gt; [1] TRUE</pre><h3>Puzzle 342</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*mOnRBxKFsBEhYsHW2Zmmig.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*mOnRBxKFsBEhYsHW2Zmmig.png?w=578&amp;ssl=1\"/></noscript></figure><blockquote>Tsamina mina, eh, eh<br/>Waka waka, eh, eh<br/>Tsamina mina zangalewa<br/>This time for Africa</blockquote><p>I realized that I still remember World Cup in South Africa 2010. And this puzzle take us to South Africa. We have to check some IDs to find out who has illegally forged documents. ID number in South Africa has certain structure which can be checked and confirmed, but it is not that easy. There is an algorithm called Luhn Algorithm used. It is deeply described in puzzle content and on Wikipedia for example so let’s try this challenge.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"South Africa National ID Validation.xlsx\", range = \"A1:A10\") %&gt;% janitor::clean_names()\ntest  = read_excel(\"South Africa National ID Validation.xlsx\", range = \"B1:B4\") %&gt;% janitor::clean_names()</pre><h4>Data transformation</h4><pre>validate_id = function(number) {\n  digits = strsplit(as.character(number), \"\")[[1]]\n  odd_digits = digits[seq(1, 12, 2)]\n  even_digits = digits[seq(2, 12, 2)]\n  \n  dob = str_sub(number, 1, 6) %&gt;% as.Date(format = \"%y%m%d\")\n  \n  A = sum(as.numeric(odd_digits))\n  B = str_c(even_digits, collapse = \"\") %&gt;% as.numeric()\n  B2 = B * 2\n  C = strsplit(as.character(B2), \"\")[[1]] %&gt;% as.numeric() %&gt;% sum()\n  D = A + C\n  Dmod = D %% 10\n  Z13 = str_sub(number, 13, 13) %&gt;% as.numeric()\n  Z = ifelse(Dmod == 0, 0, 10 - D %% 10)\n  \n  is_Z_valid = Z == Z13\n  is_status_valid = str_sub(number, 11, 11) %&gt;% as.numeric() %&gt;% between(0, 1)\n  is_valid_length = length(digits) == 13\n  is_date_valid = !is.na(dob)\n  final_check = is_Z_valid &amp; is_date_valid &amp; is_valid_length &amp; is_status_valid\n  \n  return(final_check)\n}\n\nresult  = input %&gt;%\n  mutate(answer_expected = map(sa_i_ds, validate_id)) %&gt;%\n  filter(answer_expected == TRUE)identical(result$sa_i_ds, test$answer_expected)</pre><h4>Validation</h4><pre>identical(result$sa_i_ds, test$answer_expected)\n#&gt; [1] TRUE</pre><h3>Puzzle 343</h3><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*ryDEF0iV4DecmBdl36auxw.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*ryDEF0iV4DecmBdl36auxw.png?w=578&amp;ssl=1\"/></noscript></figure><p>Palindromes are all about symetry, and I wonder if giving palindromic puzzle on no. 343 was intentional or just coincidence. Nonetheless we had some numbers given, some of them were already palindromes, some of them not. Our goal was to find nearest palindromic number. What is really interesting if you are looking for nearest palindrome from palindrome itself, there is a chance that you will find two on the same distance.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(stringi)\n\ninput = read_excel(\"Nearest Palindrome.xlsx\", range = \"A1:A10\") %&gt;% janitor::clean_names()\ntest  = read_excel(\"Nearest Palindrome.xlsx\", range = \"B1:B10\") %&gt;% janitor::clean_names()</pre><h4>Data transformation</h4><pre>find_closest_palindromes &lt;- function(number) {\n  num_str &lt;- as.character(number)\n  len &lt;- nchar(num_str)\n  is_odd &lt;- len %% 2 == 1\n  half_len &lt;- (len + 1) %/% 2\n  \n  first_half &lt;- substr(num_str, 1, half_len)stat\n\n  candidates &lt;- map_dbl(c(1, 0, -1), ~ {\n    modified_first_half &lt;- as.numeric(first_half) + .x\n    modified_first_half_str &lt;- as.character(modified_first_half)\n    if (nchar(modified_first_half_str) &lt; half_len) {\n      modified_first_half_str &lt;- str_pad(modified_first_half_str, half_len, pad = \"0\")\n    }\n    second_half &lt;- substr(modified_first_half_str, 1, half_len - is_odd)\n    as.numeric(paste0(modified_first_half_str, stri_reverse(second_half)))\n  })\n  \n  differences &lt;- abs(number - candidates) \n  valid_differences &lt;- differences[differences != 0]\n  closest_values &lt;- candidates[differences == min(valid_differences)]\n  \n  return(paste(closest_values, collapse = \", \"))\n}\n\nresult = input %&gt;%\n  mutate(result = map(number, find_closest_palindromes) %&gt;% unlist())</pre><h4>Validation</h4><pre>identical(result$result, test$answer_expected)\n#&gt; [1] TRUE</pre><p>Feel free to comment, share and contact me with advices, questions and your ideas how to improve anything.</p><img alt=\"\" data-lazy-src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=4d94ecf1a1e3\" height=\"1\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"1\"/><noscript><img alt=\"\" height=\"1\" loading=\"lazy\" src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=4d94ecf1a1e3\" width=\"1\"/></noscript><hr/><p><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-4d94ecf1a1e3\" rel=\"nofollow\" target=\"_blank\">R Solution for Excel Puzzles</a> was originally published in <a href=\"https://medium.com/number-around-us\" rel=\"nofollow\" target=\"_blank\">Numbers around us</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-4d94ecf1a1e3\"> Numbers around us - Medium</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
    "main_text": "R Solution for Excel Puzzles\nPosted on\nDecember 11, 2023\nby\nNumbers around us\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nNumbers around us - Medium\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nPuzzles no. 339–343\nPuzzles\nAuthor:\nExcelBI\nPuzzles:\n#339:\ncontent\nfile\n#340:\ncontent\nfile\n#341:\ncontent\nfile\n#342:\ncontent\nfile\n#343:\ncontent\nfile\nLets dive into solutions!\nShort disclaimer: This weeks riddles were well designed and I found out that very good but also readable solutions will not have different approaches this time. It would only overcomplicate the code. So let started.\nPuzzle #339\nPuzzles focused on Fibonacci sequence are frequent guests on our puzzles. This time we are taking regular Fibonacci sequence and have “only” to return nth term of sequence. We did it several times, but today I am adding little twist.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(memoise)\n\ninput = read_excel(\"Nth Fibonacci Number.xlsx\", range = \"A1:A10\")\ntest = read_excel(\"Nth Fibonacci Number.xlsx\", range = \"B1:B10\") %>%janitor::clean_names()\nPrepare and run function\nWhat is the twist here? We use one technique that I learned not long time ago — memoization. Function with this feature just storing new results in cache and if find out that such computation was already done, do not make calculation, but take result from cache. In our case for example if we do it without memoization line 9 (with 73rd term) would need 72 recursive additions, while if we do it that way: we would have one read from cache, because fib(68) was already stored in cache, and 5 recursive additions.\nIt will significantly improve data processing time.\nfib <- memoise(function(n) {\n  if (n <= 2) {\n    return(1)\n  } else {\n    return(fib(n - 1) + fib(n - 2))\n  }\n})\n\nresult = input %>%\n  mutate(fib = map_dbl(input$N, fib)) %>%\n  select(fib)\nValidation\nidentical(result$fib, test$answer_expected)\n#> [1] TRUE\nPuzzle 340\nThis puzzle is extremely easy when approaching it with tidyverse, but goal for “Excel” solvers where to use newly added functions. So let see how lubridate is doing job for us.\nLoading libraries and data\nlibrary(tidyverse) # lubridate is loading with tidyverse\nlibrary(readxl)\n\ninput = read_excel(\"Date Min Max.xlsx\", range = \"A1:A20\")\ntest = read_excel(\"Date Min Max.xlsx\", range = \"C2:F8\")\nTransformation\nresult = input %>%\n  mutate(Year = year(Date),\n         Half = str_c(semester(Date),\"H\")) %>%\n  group_by(Year, Half) %>%\n  summarise(`Min Date` = min(Date),\n            `Max Date` = max(Date)) %>%\n  ungroup()\nValidation\nidentical(test, result)\n#> [1] TRUE\nPuzzle 341\nWe have to sort some things… against all odds. Or maybe not. We have to sort only digits in given numbers that are on odd positions (1,3,5 and so on). Let’s try it out.\nLoading libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Sort Alternate.xlsx\", range = \"A1:A11\") %>% janitor::clean_names()\ntest = read_excel(\"Sort Alternate.xlsx\", range = \"B1:B11\") %>% janitor::clean_names()\nTransforming data\nsort_odd_digits = function(number) {\n  digits = strsplit(as.character(number), \"\")[[1]]\n  if (length(digits) < 2) {\n    return(as.numeric(paste0(digits, collapse = \"\")))\n  }\n  odd_digits = digits[seq(1, length(digits), 2)]\n  even_digits = digits[seq(2, length(digits), 2)]\n  sorted_odd = sort(odd_digits)\n  digits[seq(1, length(digits), 2)] = sorted_odd\n  number = digits %>% paste0(collapse = \"\")\n  return(number)\n}\n\nresult  = input %>%\n  mutate(answer_expected = map(number_string, sort_odd_digits))\nValidation\nidentical(unlist(result$answer_expected), test$answer_expected)\n#> [1] TRUE\nPuzzle 342\nTsamina mina, eh, eh\nWaka waka, eh, eh\nTsamina mina zangalewa\nThis time for Africa\nI realized that I still remember World Cup in South Africa 2010. And this puzzle take us to South Africa. We have to check some IDs to find out who has illegally forged documents. ID number in South Africa has certain structure which can be checked and confirmed, but it is not that easy. There is an algorithm called Luhn Algorithm used. It is deeply described in puzzle content and on Wikipedia for example so let’s try this challenge.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"South Africa National ID Validation.xlsx\", range = \"A1:A10\") %>% janitor::clean_names()\ntest  = read_excel(\"South Africa National ID Validation.xlsx\", range = \"B1:B4\") %>% janitor::clean_names()\nData transformation\nvalidate_id = function(number) {\n  digits = strsplit(as.character(number), \"\")[[1]]\n  odd_digits = digits[seq(1, 12, 2)]\n  even_digits = digits[seq(2, 12, 2)]\n  \n  dob = str_sub(number, 1, 6) %>% as.Date(format = \"%y%m%d\")\n  \n  A = sum(as.numeric(odd_digits))\n  B = str_c(even_digits, collapse = \"\") %>% as.numeric()\n  B2 = B * 2\n  C = strsplit(as.character(B2), \"\")[[1]] %>% as.numeric() %>% sum()\n  D = A + C\n  Dmod = D %% 10\n  Z13 = str_sub(number, 13, 13) %>% as.numeric()\n  Z = ifelse(Dmod == 0, 0, 10 - D %% 10)\n  \n  is_Z_valid = Z == Z13\n  is_status_valid = str_sub(number, 11, 11) %>% as.numeric() %>% between(0, 1)\n  is_valid_length = length(digits) == 13\n  is_date_valid = !is.na(dob)\n  final_check = is_Z_valid & is_date_valid & is_valid_length & is_status_valid\n  \n  return(final_check)\n}\n\nresult  = input %>%\n  mutate(answer_expected = map(sa_i_ds, validate_id)) %>%\n  filter(answer_expected == TRUE)identical(result$sa_i_ds, test$answer_expected)\nValidation\nidentical(result$sa_i_ds, test$answer_expected)\n#> [1] TRUE\nPuzzle 343\nPalindromes are all about symetry, and I wonder if giving palindromic puzzle on no. 343 was intentional or just coincidence. Nonetheless we had some numbers given, some of them were already palindromes, some of them not. Our goal was to find nearest palindromic number. What is really interesting if you are looking for nearest palindrome from palindrome itself, there is a chance that you will find two on the same distance.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(stringi)\n\ninput = read_excel(\"Nearest Palindrome.xlsx\", range = \"A1:A10\") %>% janitor::clean_names()\ntest  = read_excel(\"Nearest Palindrome.xlsx\", range = \"B1:B10\") %>% janitor::clean_names()\nData transformation\nfind_closest_palindromes <- function(number) {\n  num_str <- as.character(number)\n  len <- nchar(num_str)\n  is_odd <- len %% 2 == 1\n  half_len <- (len + 1) %/% 2\n  \n  first_half <- substr(num_str, 1, half_len)stat\n\n  candidates <- map_dbl(c(1, 0, -1), ~ {\n    modified_first_half <- as.numeric(first_half) + .x\n    modified_first_half_str <- as.character(modified_first_half)\n    if (nchar(modified_first_half_str) < half_len) {\n      modified_first_half_str <- str_pad(modified_first_half_str, half_len, pad = \"0\")\n    }\n    second_half <- substr(modified_first_half_str, 1, half_len - is_odd)\n    as.numeric(paste0(modified_first_half_str, stri_reverse(second_half)))\n  })\n  \n  differences <- abs(number - candidates) \n  valid_differences <- differences[differences != 0]\n  closest_values <- candidates[differences == min(valid_differences)]\n  \n  return(paste(closest_values, collapse = \", \"))\n}\n\nresult = input %>%\n  mutate(result = map(number, find_closest_palindromes) %>% unlist())\nValidation\nidentical(result$result, test$answer_expected)\n#> [1] TRUE\nFeel free to comment, share and contact me with advices, questions and your ideas how to improve anything.\nR Solution for Excel Puzzles\nwas originally published in\nNumbers around us\non Medium, where people are continuing the conversation by highlighting and responding to this story.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nNumbers around us - Medium\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "Puzzles no. 339–343PuzzlesAuthor: ExcelBIPuzzles:#339: content file#340: content file#341: content file#342: content file#343: content fileLets dive into solutions!Short disclaimer: This weeks riddles were well designed and I found out that very good b...",
    "meta_keywords": null,
    "og_description": "Puzzles no. 339–343PuzzlesAuthor: ExcelBIPuzzles:#339: content file#340: content file#341: content file#342: content file#343: content fileLets dive into solutions!Short disclaimer: This weeks riddles were well designed and I found out that very good b...",
    "og_image": "https://cdn-images-1.medium.com/max/1024/1*OQLAbd_tHb1V6QxD7PmNnw.jpeg",
    "og_title": "R Solution for Excel Puzzles | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 5.8,
    "sitemap_lastmod": "2023-12-11T19:50:37+00:00",
    "twitter_description": "Puzzles no. 339–343PuzzlesAuthor: ExcelBIPuzzles:#339: content file#340: content file#341: content file#342: content file#343: content fileLets dive into solutions!Short disclaimer: This weeks riddles were well designed and I found out that very good b...",
    "twitter_title": "R Solution for Excel Puzzles | R-bloggers",
    "url": "https://www.r-bloggers.com/2023/12/r-solution-for-excel-puzzles-3/",
    "word_count": 1150
  }
}