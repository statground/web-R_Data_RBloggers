{
  "id": "c94243b4c8efb86251886b21b186e01e7cc13c47",
  "url": "https://www.r-bloggers.com/2023/11/the-secret-sauce-used-in-many-qeml-functions/",
  "created_at_utc": "2025-11-17T20:39:09Z",
  "data": null,
  "raw_original": {
    "uuid": "c5ece6d2-be1a-4669-91bc-8107b508cada",
    "created_at": "2025-11-17 20:39:09",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2023/11/the-secret-sauce-used-in-many-qeml-functions/",
      "crawled_at": "2025-11-17T09:50:33.417996",
      "external_links": [
        {
          "href": "https://matloff.wordpress.com/2023/11/22/the-secret-sauce-used-in-many-qeml-functions/",
          "text": "Mad (Data) Scientist"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://matloff.wordpress.com/2023/11/22/the-secret-sauce-used-in-many-qeml-functions/",
          "text": "Mad (Data) Scientist"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "The “Secret Sauce” Used in Many qeML Functions | R-bloggers",
      "images": [],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/matloff/",
          "text": "matloff"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-380245 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">The “Secret Sauce” Used in Many qeML Functions</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">November 22, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/matloff/\">matloff</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://matloff.wordpress.com/2023/11/22/the-secret-sauce-used-in-many-qeml-functions/\"> Mad (Data) Scientist</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<p>In writing an R package, it is often useful to build up some function call in string form, then “execute” the string. To give a really simple example:</p>\n<pre>&gt; s &lt;- '1+1'\n&gt; eval(parse(text=s))\n[1] 2</pre>\n<p>Quite a lot of trouble to go to just to find that 1+1 = 2? Yes, but this trick can be extremely useful, as we’ll see here.</p>\n<pre>data(svcensus)\nz &lt;- qePCA(svcensus,'wageinc','qeKNN',pcaProp=0.5)</pre>\n<p>This says, “Apply Principal Component Analysis to the ‘svcensus’ data, with enough PCs to get 0.5 of the total variance. Then do k-Nearest Neighbor Analysis, fitting qeKNN to the PCs to predict wage income.”</p>\n<p>So we are invoking a qeML function that the user requested, on the user’s requested data. Fine, but the requested qeML function is called using its default values, in this case k = 25, the number of neighbors. What if we want a different value of k, say 50? We can run</p>\n<pre>z &lt;- qePCA(svcensus,'wageinc','qeKNN',pcaProp=0.5),\n   opts=list(k=50))</pre>\n<p>But how does the internal code of <strong>qePCA</strong> handle this? Here is where <strong>eval </strong>comes in. Typing <strong>qePCA</strong> at the R &gt; prompt shows us the code, two key lines of which are</p>\n<pre>cmd &lt;- buildQEcall(qeName,\"newData\",yName, \n   opts=opts,holdout=holdout)\nqeOut &lt;- eval(parse(text = cmd))</pre>\n<p>So <strong>qeML:::buildQEcall </strong>builds up the full call to the user-requested function, including optional arguments, in a character string. Then we use <strong>eval</strong> and <strong>parse</strong> to execute the string. Inserting a call in <strong>qePCA </strong>to <strong>browser</strong> (not shown), we can take a look at that string:</p>\n<pre>Browse[1]&gt; cmd\n[1] \"qeKNN(data = newData,yName=\\\"wageinc\\\",holdout = 1000,k=50))\"</pre>\n<p>So <strong>qeML:::buildQEcall </strong>pieced together the call to the user’s requested function, <strong>qeKNN</strong>, on the user’s requested data–and with the user’s requested optional arguments. In handling the latter, it among things called <strong>names(opts)</strong>, which got the argument names, ‘k’ here, in string form, exactly what we need.</p>\n<p>Note too R’s <strong>call</strong> function, which similarly creates a function call. (Yes, <strong>call </strong>produces a call, just like <strong>function</strong> produces a function.) E.g.,</p>\n<pre>&gt; sqrt(2)\n[1] 1.414214\n&gt; sqcall &lt;- call('sqrt',2)\n&gt; class(sqcall)\n[1] \"call\"\n&gt; eval(sqcall)\n[1] 1.414214</pre>\n<p>All of this is an example of R’s <em>metaprogramming</em> capabilities–code that produces code–a really cool feature of R that computer science people tend to be ignorant of. Next time you encounter a CS Pythonista who dismisses R as “not a real language,” reply “R is built on functional programming and OOP models, with powerful metaprogramming facilities…”</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://matloff.wordpress.com/2023/11/22/the-secret-sauce-used-in-many-qeml-functions/\"> Mad (Data) Scientist</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
      "main_text": "The “Secret Sauce” Used in Many qeML Functions\nPosted on\nNovember 22, 2023\nby\nmatloff\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nMad (Data) Scientist\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nIn writing an R package, it is often useful to build up some function call in string form, then “execute” the string. To give a really simple example:\n> s <- '1+1'\n> eval(parse(text=s))\n[1] 2\nQuite a lot of trouble to go to just to find that 1+1 = 2? Yes, but this trick can be extremely useful, as we’ll see here.\ndata(svcensus)\nz <- qePCA(svcensus,'wageinc','qeKNN',pcaProp=0.5)\nThis says, “Apply Principal Component Analysis to the ‘svcensus’ data, with enough PCs to get 0.5 of the total variance. Then do k-Nearest Neighbor Analysis, fitting qeKNN to the PCs to predict wage income.”\nSo we are invoking a qeML function that the user requested, on the user’s requested data. Fine, but the requested qeML function is called using its default values, in this case k = 25, the number of neighbors. What if we want a different value of k, say 50? We can run\nz <- qePCA(svcensus,'wageinc','qeKNN',pcaProp=0.5),\n   opts=list(k=50))\nBut how does the internal code of\nqePCA\nhandle this? Here is where\neval\ncomes in. Typing\nqePCA\nat the R > prompt shows us the code, two key lines of which are\ncmd <- buildQEcall(qeName,\"newData\",yName, \n   opts=opts,holdout=holdout)\nqeOut <- eval(parse(text = cmd))\nSo\nqeML:::buildQEcall\nbuilds up the full call to the user-requested function, including optional arguments, in a character string. Then we use\neval\nand\nparse\nto execute the string. Inserting a call in\nqePCA\nto\nbrowser\n(not shown), we can take a look at that string:\nBrowse[1]> cmd\n[1] \"qeKNN(data = newData,yName=\\\"wageinc\\\",holdout = 1000,k=50))\"\nSo\nqeML:::buildQEcall\npieced together the call to the user’s requested function,\nqeKNN\n, on the user’s requested data–and with the user’s requested optional arguments. In handling the latter, it among things called\nnames(opts)\n, which got the argument names, ‘k’ here, in string form, exactly what we need.\nNote too R’s\ncall\nfunction, which similarly creates a function call. (Yes,\ncall\nproduces a call, just like\nfunction\nproduces a function.) E.g.,\n> sqrt(2)\n[1] 1.414214\n> sqcall <- call('sqrt',2)\n> class(sqcall)\n[1] \"call\"\n> eval(sqcall)\n[1] 1.414214\nAll of this is an example of R’s\nmetaprogramming\ncapabilities–code that produces code–a really cool feature of R that computer science people tend to be ignorant of. Next time you encounter a CS Pythonista who dismisses R as “not a real language,” reply “R is built on functional programming and OOP models, with powerful metaprogramming facilities…”\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nMad (Data) Scientist\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "In writing an R package, it is often useful to build up some function call in string form, then “execute” the string. To give a really simple example: Quite a lot of trouble to go to just to find that 1+1 = 2? Yes, but this trick can be extremely useful, as we’ll see here. … Continue reading The “Secret Sauce” Used in Many qeML Functions →",
      "meta_keywords": null,
      "og_description": "In writing an R package, it is often useful to build up some function call in string form, then “execute” the string. To give a really simple example: Quite a lot of trouble to go to just to find that 1+1 = 2? Yes, but this trick can be extremely useful, as we’ll see here. … Continue reading The “Secret Sauce” Used in Many qeML Functions →",
      "og_image": "https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png",
      "og_title": "The “Secret Sauce” Used in Many qeML Functions | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 2.9,
      "sitemap_lastmod": "2023-11-22T20:43:36+00:00",
      "twitter_description": "In writing an R package, it is often useful to build up some function call in string form, then “execute” the string. To give a really simple example: Quite a lot of trouble to go to just to find that 1+1 = 2? Yes, but this trick can be extremely useful, as we’ll see here. … Continue reading The “Secret Sauce” Used in Many qeML Functions →",
      "twitter_title": "The “Secret Sauce” Used in Many qeML Functions | R-bloggers",
      "url": "https://www.r-bloggers.com/2023/11/the-secret-sauce-used-in-many-qeml-functions/",
      "word_count": 578
    }
  }
}