{
  "id": "b394ca952b600d73ffe6c9e97171dab56438130f",
  "url": "https://www.r-bloggers.com/2023/11/a-classifier-thats-very-accurate-and-deep/",
  "created_at_utc": "2025-11-17T20:39:18Z",
  "data": null,
  "raw_original": {
    "uuid": "7bf575f6-fbf0-41d4-b8cf-4a63c00dd0f1",
    "created_at": "2025-11-17 20:39:18",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2023/11/a-classifier-thats-very-accurate-and-deep/",
      "crawled_at": "2025-11-17T09:57:30.028108",
      "external_links": [
        {
          "href": "https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy",
          "text": "T. Moudiki's Webpage - R"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://pypi.org/project/nnetsauce/",
          "text": "PyPI"
        },
        {
          "href": "https://anaconda.org/conda-forge/nnetsauce",
          "text": "conda"
        },
        {
          "href": "https://github.com/Techtonique/nnetsauce",
          "text": "GitHub"
        },
        {
          "href": "https://techtonique.r-universe.dev/nnetsauce",
          "text": "R universe"
        },
        {
          "href": "https://github.com/Techtonique/nnetsauce_r",
          "text": "GitHub"
        },
        {
          "href": "https://thierrymoudiki.github.io/blog/2023/10/22/python/quasirandomizednn/nnetsauce-lazy-predict-preview",
          "text": "this post"
        },
        {
          "href": "https://thierrymoudiki.github.io/blog/2023/10/29/python/quasirandomizednn/MTS-LazyPredict",
          "text": "this post"
        },
        {
          "href": "https://learn.microsoft.com/en-us/windows/wsl/install",
          "text": "Windows Subsystem for Linux (WSL)"
        },
        {
          "href": "https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#0---install-and-import-packages",
          "text": "0 – Install and import packages"
        },
        {
          "href": "https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#1---breast-cancer-data",
          "text": "1 – breast cancer data"
        },
        {
          "href": "https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#2---iris-data",
          "text": "2 – iris data"
        },
        {
          "href": "https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#3---wine-data",
          "text": "3 – wine data"
        },
        {
          "href": "https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#4---digits-data",
          "text": "4 – digits data"
        },
        {
          "href": "https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#5---r-examples",
          "text": "5 – R examples"
        },
        {
          "href": "https://github.com/Techtonique/nnetsauce/blob/master/nnetsauce/demo/thierrymoudiki_091123_lazy_deep_classifier.ipynb",
          "text": "jupyter notebook"
        },
        {
          "href": "https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#contents",
          "text": "top"
        },
        {
          "href": "https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#contents",
          "text": "top"
        },
        {
          "href": "https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#contents",
          "text": "top"
        },
        {
          "href": "https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#contents",
          "text": "top"
        },
        {
          "href": "https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#contents",
          "text": "top"
        },
        {
          "href": "https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#contents",
          "text": "top"
        },
        {
          "href": "https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy",
          "text": "T. Moudiki's Webpage - R"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "A classifier that’s very accurate (and deep) | R-bloggers",
      "images": [
        {
          "alt": "image-title-here",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image-title-here",
          "base64": null,
          "src": "https://i0.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image1.png?w=578&ssl=1"
        },
        {
          "alt": "image-title-here",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image-title-here",
          "base64": null,
          "src": "https://i2.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image2.png?w=578&ssl=1"
        },
        {
          "alt": "image-title-here",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image-title-here",
          "base64": null,
          "src": "https://i1.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image3.png?w=578&ssl=1"
        },
        {
          "alt": "image-title-here",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image-title-here",
          "base64": null,
          "src": "https://i0.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image4.png?w=578&ssl=1"
        },
        {
          "alt": "image-title-here",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "image-title-here",
          "base64": null,
          "src": "https://i2.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image5.png?w=578&ssl=1"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/t-moudiki/",
          "text": "T. Moudiki"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-379964 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">A classifier that’s very accurate (and deep)</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">November 11, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/t-moudiki/\">T. Moudiki</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy\"> T. Moudiki's Webpage - R</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><p>Version <code>v0.15.0</code> of <code>nnetsauce</code> is now available on your favorite platforms: <a href=\"https://pypi.org/project/nnetsauce/\" rel=\"nofollow\" target=\"_blank\">PyPI</a>, <a href=\"https://anaconda.org/conda-forge/nnetsauce\" rel=\"nofollow\" target=\"_blank\">conda</a> and <a href=\"https://github.com/Techtonique/nnetsauce\" rel=\"nofollow\" target=\"_blank\">GitHub</a> for Python; <a href=\"https://techtonique.r-universe.dev/nnetsauce\" rel=\"nofollow\" target=\"_blank\">R universe</a> and <a href=\"https://github.com/Techtonique/nnetsauce_r\" rel=\"nofollow\" target=\"_blank\">GitHub</a> for R.</p>\n<p>The changes in this version are mostly related to  <strong>Automated Machine learning (AutoML)</strong>:</p>\n<ul>\n<li><em>lazy</em> prediction for classification and regression: see <a href=\"https://thierrymoudiki.github.io/blog/2023/10/22/python/quasirandomizednn/nnetsauce-lazy-predict-preview\" rel=\"nofollow\" target=\"_blank\">this post</a> for more details on the subject (and remember to use <code>pip install nnetsauce</code> directly, instead of installing from a GitHub branch named <code>lazy-predict</code>)</li>\n<li><em>lazy</em> prediction for multivariate time series (MTS): see <a href=\"https://thierrymoudiki.github.io/blog/2023/10/29/python/quasirandomizednn/MTS-LazyPredict\" rel=\"nofollow\" target=\"_blank\">this post</a> for more details on the subject (and remember to use <code>pip install nnetsauce</code> directly, instead of installing from a GitHub branch named <code>lazy-predict</code>)</li>\n<li><em>lazy</em> prediction with <strong><em>deep</em> quasi-randomized <em>nnetworks</em></strong> will be described in this post</li>\n</ul>\n<p>Note that in the example below, for the offically released version (v0.15.0), Gradient boosting classifiers are available. This doesn’t change the best model chosen by the algorithm (which is never Gradient boosting, because <strong>the deep model is already doing “too much”</strong>). Not sure if Gradient boosting will be kept as a default model here because, in this context, it’s relatively slow.</p>\n<p>To finish, for Windows users, if you run into issues when trying to install <code>nnetsauce</code> (but you shouldn’t): remember that you can use the <a href=\"https://learn.microsoft.com/en-us/windows/wsl/install\" rel=\"nofollow\" target=\"_blank\">Windows Subsystem for Linux (WSL)</a>.</p>\n<h1 id=\"contents\">Contents</h1>\n<ul>\n<li> <a href=\"https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#0---install-and-import-packages\" rel=\"nofollow\" target=\"_blank\">0 – Install and import packages</a> </li>\n<li> <a href=\"https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#1---breast-cancer-data\" rel=\"nofollow\" target=\"_blank\">1 – breast cancer data</a> </li>\n<li> <a href=\"https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#2---iris-data\" rel=\"nofollow\" target=\"_blank\">2 – iris data</a> </li>\n<li> <a href=\"https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#3---wine-data\" rel=\"nofollow\" target=\"_blank\">3 – wine data</a> </li>\n<li> <a href=\"https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#4---digits-data\" rel=\"nofollow\" target=\"_blank\">4 – digits data</a> </li>\n<li> <a href=\"https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#5---r-examples\" rel=\"nofollow\" target=\"_blank\">5 – R examples</a> </li>\n</ul>\n<p>Here is a <a href=\"https://github.com/Techtonique/nnetsauce/blob/master/nnetsauce/demo/thierrymoudiki_091123_lazy_deep_classifier.ipynb\" rel=\"nofollow\" target=\"_blank\">jupyter notebook</a> allowing you to reproduce these results. Do not hesitate \nto modify these examples by choosing – in <code>LazyDeepClassifier</code> – a different number of layers <code>n_layers</code>, or the number of \nengineered features <em>per</em> layer, <code>n_hidden_features</code>.</p>\n<h1 id=\"0---install-and-import-packages\">0 – Install and import packages</h1>\n<p><a href=\"https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#contents\" rel=\"nofollow\" target=\"_blank\">top</a></p>\n<pre>!pip install nnetsauce --upgrade\n\r\nimport os\nimport nnetsauce as ns\nimport matplotlib.pyplot as plt\nfrom sklearn.datasets import load_breast_cancer, load_iris, load_wine, load_digits\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report, ConfusionMatrixDisplay\nfrom time import time\n</pre>\n<h1 id=\"1---breast-cancer-data\">1 – breast cancer data</h1>\n<p><a href=\"https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#contents\" rel=\"nofollow\" target=\"_blank\">top</a></p>\n<pre>data = load_breast_cancer()\nX = data.data\ny= data.target\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = .2, random_state = 123)\n\nclf = ns.LazyDeepClassifier(n_layers=3, verbose=0, ignore_warnings=True)\nstart = time()\nmodels, predictions = clf.fit(X_train, X_test, y_train, y_test)\nprint(f\"\\n\\n Elapsed: {time()-start} seconds \\n\")\nmodel_dictionary = clf.provide_models(X_train, X_test, y_train, y_test)\n\ndisplay(models)\n\r\n100%|██████████| 27/27 [00:44&lt;00:00,  1.65s/it]\n\n\n\n Elapsed: 44.49836850166321 seconds \n</pre>\n<div class=\"colab-df-container\" id=\"df-872aae81-abd7-4a72-930a-2b6cb3bb0d18\">\n<div>\n\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th></th>\n<th>Accuracy</th>\n<th>Balanced Accuracy</th>\n<th>ROC AUC</th>\n<th>F1 Score</th>\n<th>Time Taken</th>\n</tr>\n<tr>\n<th>Model</th>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>Perceptron</th>\n<td>0.99</td>\n<td>0.99</td>\n<td>0.99</td>\n<td>0.99</td>\n<td>2.15</td>\n</tr>\n<tr>\n<th>SGDClassifier</th>\n<td>0.98</td>\n<td>0.98</td>\n<td>0.98</td>\n<td>0.98</td>\n<td>1.99</td>\n</tr>\n<tr>\n<th>RandomForestClassifier</th>\n<td>0.98</td>\n<td>0.98</td>\n<td>0.98</td>\n<td>0.98</td>\n<td>2.76</td>\n</tr>\n<tr>\n<th>PassiveAggressiveClassifier</th>\n<td>0.98</td>\n<td>0.98</td>\n<td>0.98</td>\n<td>0.98</td>\n<td>1.89</td>\n</tr>\n<tr>\n<th>LogisticRegression</th>\n<td>0.98</td>\n<td>0.98</td>\n<td>0.98</td>\n<td>0.98</td>\n<td>1.14</td>\n</tr>\n<tr>\n<th>ExtraTreesClassifier</th>\n<td>0.98</td>\n<td>0.98</td>\n<td>0.98</td>\n<td>0.98</td>\n<td>3.13</td>\n</tr>\n<tr>\n<th>BaggingClassifier</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>0.97</td>\n<td>0.97</td>\n<td>1.62</td>\n</tr>\n<tr>\n<th>LabelPropagation</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>0.97</td>\n<td>0.97</td>\n<td>1.69</td>\n</tr>\n<tr>\n<th>LabelSpreading</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>0.97</td>\n<td>0.97</td>\n<td>1.08</td>\n</tr>\n<tr>\n<th>AdaBoostClassifier</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>0.97</td>\n<td>0.97</td>\n<td>3.42</td>\n</tr>\n<tr>\n<th>LinearSVC</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>0.97</td>\n<td>0.97</td>\n<td>1.65</td>\n</tr>\n<tr>\n<th>KNeighborsClassifier</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>0.97</td>\n<td>0.97</td>\n<td>1.07</td>\n</tr>\n<tr>\n<th>SVC</th>\n<td>0.97</td>\n<td>0.96</td>\n<td>0.96</td>\n<td>0.97</td>\n<td>1.07</td>\n</tr>\n<tr>\n<th>CalibratedClassifierCV</th>\n<td>0.97</td>\n<td>0.96</td>\n<td>0.96</td>\n<td>0.97</td>\n<td>1.82</td>\n</tr>\n<tr>\n<th>DecisionTreeClassifier</th>\n<td>0.96</td>\n<td>0.96</td>\n<td>0.96</td>\n<td>0.96</td>\n<td>1.50</td>\n</tr>\n<tr>\n<th>QuadraticDiscriminantAnalysis</th>\n<td>0.96</td>\n<td>0.95</td>\n<td>0.95</td>\n<td>0.96</td>\n<td>1.16</td>\n</tr>\n<tr>\n<th>LinearDiscriminantAnalysis</th>\n<td>0.96</td>\n<td>0.95</td>\n<td>0.95</td>\n<td>0.96</td>\n<td>1.39</td>\n</tr>\n<tr>\n<th>ExtraTreeClassifier</th>\n<td>0.96</td>\n<td>0.94</td>\n<td>0.94</td>\n<td>0.96</td>\n<td>0.83</td>\n</tr>\n<tr>\n<th>RidgeClassifier</th>\n<td>0.96</td>\n<td>0.94</td>\n<td>0.94</td>\n<td>0.96</td>\n<td>3.15</td>\n</tr>\n<tr>\n<th>RidgeClassifierCV</th>\n<td>0.96</td>\n<td>0.94</td>\n<td>0.94</td>\n<td>0.96</td>\n<td>1.51</td>\n</tr>\n<tr>\n<th>GaussianNB</th>\n<td>0.93</td>\n<td>0.90</td>\n<td>0.90</td>\n<td>0.93</td>\n<td>1.50</td>\n</tr>\n<tr>\n<th>NearestCentroid</th>\n<td>0.93</td>\n<td>0.90</td>\n<td>0.90</td>\n<td>0.93</td>\n<td>3.00</td>\n</tr>\n<tr>\n<th>NuSVC</th>\n<td>0.93</td>\n<td>0.90</td>\n<td>0.90</td>\n<td>0.93</td>\n<td>1.27</td>\n</tr>\n<tr>\n<th>BernoulliNB</th>\n<td>0.91</td>\n<td>0.89</td>\n<td>0.89</td>\n<td>0.91</td>\n<td>1.15</td>\n</tr>\n<tr>\n<th>DummyClassifier</th>\n<td>0.64</td>\n<td>0.50</td>\n<td>0.50</td>\n<td>0.50</td>\n<td>0.96</td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"colab-df-buttons\">\n<div class=\"colab-df-container\">\n<button class=\"colab-df-convert\" data-cf-modified-03fcc77dd779a0debc9da8bf-=\"\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; convertToInteractive('df-872aae81-abd7-4a72-930a-2b6cb3bb0d18')\" style=\"display:none;\" title=\"Convert this dataframe to an interactive table.\">\n<svg height=\"24px\" viewbox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"></path>\n</svg>\n</button>\n\n\n</div>\n<div id=\"df-4ab2cd36-6861-443a-9038-4712c083df25\">\n<button class=\"colab-df-quickchart\" data-cf-modified-03fcc77dd779a0debc9da8bf-=\"\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; quickchart('df-4ab2cd36-6861-443a-9038-4712c083df25')\" style=\"display:none;\" title=\"Suggest charts\">\n<svg height=\"24px\" viewbox=\"0 0 24 24\" width=\"24px\" xmlns=\"http://www.w3.org/2000/svg\">\n<g>\n<path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"></path>\n</g>\n</svg>\n</button>\n\n\n</div>\n</div>\n</div>\n<pre>model_dictionary[\"Perceptron\"]\n</pre>\n\n<pre>CustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=Perceptron(random_state=42))))</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br/>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden=\"\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-86\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-86\">CustomClassifier</label><div class=\"sk-toggleable__content\"><pre>CustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=Perceptron(random_state=42))))</pre><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-87\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-87\">obj: CustomClassifier</label><pre>CustomClassifier(obj=CustomClassifier(obj=Perceptron(random_state=42)))</pre><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-88\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-88\">obj: CustomClassifier</label><pre>CustomClassifier(obj=Perceptron(random_state=42))</pre><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-89\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-89\">obj: Perceptron</label><pre>Perceptron(random_state=42)</pre><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-90\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-90\">Perceptron</label><pre>Perceptron(random_state=42)\r\nprint(classification_report(y_test, model_dictionary[\"Perceptron\"].fit(X_train, y_train).predict(X_test)))\n\r\n              precision    recall  f1-score   support\n\n           0       1.00      0.98      0.99        41\n           1       0.99      1.00      0.99        73\n\n    accuracy                           0.99       114\n   macro avg       0.99      0.99      0.99       114\nweighted avg       0.99      0.99      0.99       114\n\r\nConfusionMatrixDisplay.from_estimator(model_dictionary[\"Perceptron\"], X_test, y_test)\nplt.show()\n</pre>\n<p><img alt=\"image-title-here\" class=\"img-responsive\" data-lazy-src=\"https://i0.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image1.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image-title-here\" class=\"img-responsive\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image1.png?w=578&amp;ssl=1\"/></noscript></p>\n<h1 id=\"2---iris-data\">2 - iris data</h1>\n<p><a href=\"https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#contents\" rel=\"nofollow\" target=\"_blank\">top</a></p>\n<pre>data = load_iris()\nX = data.data\ny= data.target\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = .2, random_state = 123)\n\nclf = ns.LazyDeepClassifier(n_layers=3, verbose=0, ignore_warnings=True)\nstart = time()\nmodels, predictions = clf.fit(X_train, X_test, y_train, y_test)\nprint(f\"\\n\\n Elapsed: {time()-start} seconds \\n\")\nmodel_dictionary = clf.provide_models(X_train, X_test, y_train, y_test)\ndisplay(models)\n\r\n100%|██████████| 27/27 [00:05&lt;00:00,  4.51it/s]\n\n\n\n Elapsed: 5.992894172668457 seconds \n</pre>\n<div class=\"colab-df-container\" id=\"df-91f9a67c-e65b-41bf-9ca4-79f5826d1670\">\n<div>\n\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th></th>\n<th>Accuracy</th>\n<th>Balanced Accuracy</th>\n<th>ROC AUC</th>\n<th>F1 Score</th>\n<th>Time Taken</th>\n</tr>\n<tr>\n<th>Model</th>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>BaggingClassifier</th>\n<td>1.00</td>\n<td>1.00</td>\n<td>None</td>\n<td>1.00</td>\n<td>0.18</td>\n</tr>\n<tr>\n<th>DecisionTreeClassifier</th>\n<td>1.00</td>\n<td>1.00</td>\n<td>None</td>\n<td>1.00</td>\n<td>0.11</td>\n</tr>\n<tr>\n<th>KNeighborsClassifier</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.10</td>\n</tr>\n<tr>\n<th>CalibratedClassifierCV</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.24</td>\n</tr>\n<tr>\n<th>SGDClassifier</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.21</td>\n</tr>\n<tr>\n<th>ExtraTreeClassifier</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.10</td>\n</tr>\n<tr>\n<th>RidgeClassifier</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>1.05</td>\n</tr>\n<tr>\n<th>RidgeClassifierCV</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.21</td>\n</tr>\n<tr>\n<th>RandomForestClassifier</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.88</td>\n</tr>\n<tr>\n<th>LogisticRegression</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.14</td>\n</tr>\n<tr>\n<th>LinearSVC</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.11</td>\n</tr>\n<tr>\n<th>PassiveAggressiveClassifier</th>\n<td>0.93</td>\n<td>0.94</td>\n<td>None</td>\n<td>0.93</td>\n<td>0.11</td>\n</tr>\n<tr>\n<th>Perceptron</th>\n<td>0.93</td>\n<td>0.94</td>\n<td>None</td>\n<td>0.93</td>\n<td>0.11</td>\n</tr>\n<tr>\n<th>BernoulliNB</th>\n<td>0.93</td>\n<td>0.94</td>\n<td>None</td>\n<td>0.93</td>\n<td>0.10</td>\n</tr>\n<tr>\n<th>LabelSpreading</th>\n<td>0.93</td>\n<td>0.91</td>\n<td>None</td>\n<td>0.93</td>\n<td>0.31</td>\n</tr>\n<tr>\n<th>LabelPropagation</th>\n<td>0.93</td>\n<td>0.91</td>\n<td>None</td>\n<td>0.93</td>\n<td>0.20</td>\n</tr>\n<tr>\n<th>ExtraTreesClassifier</th>\n<td>0.93</td>\n<td>0.91</td>\n<td>None</td>\n<td>0.93</td>\n<td>0.45</td>\n</tr>\n<tr>\n<th>GaussianNB</th>\n<td>0.90</td>\n<td>0.91</td>\n<td>None</td>\n<td>0.90</td>\n<td>0.10</td>\n</tr>\n<tr>\n<th>AdaBoostClassifier</th>\n<td>0.90</td>\n<td>0.91</td>\n<td>None</td>\n<td>0.90</td>\n<td>0.38</td>\n</tr>\n<tr>\n<th>SVC</th>\n<td>0.87</td>\n<td>0.88</td>\n<td>None</td>\n<td>0.87</td>\n<td>0.19</td>\n</tr>\n<tr>\n<th>NuSVC</th>\n<td>0.87</td>\n<td>0.88</td>\n<td>None</td>\n<td>0.87</td>\n<td>0.12</td>\n</tr>\n<tr>\n<th>NearestCentroid</th>\n<td>0.87</td>\n<td>0.88</td>\n<td>None</td>\n<td>0.87</td>\n<td>0.10</td>\n</tr>\n<tr>\n<th>LinearDiscriminantAnalysis</th>\n<td>0.63</td>\n<td>0.67</td>\n<td>None</td>\n<td>0.54</td>\n<td>0.20</td>\n</tr>\n<tr>\n<th>QuadraticDiscriminantAnalysis</th>\n<td>0.20</td>\n<td>0.33</td>\n<td>None</td>\n<td>0.07</td>\n<td>0.11</td>\n</tr>\n<tr>\n<th>DummyClassifier</th>\n<td>0.20</td>\n<td>0.33</td>\n<td>None</td>\n<td>0.07</td>\n<td>0.10</td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"colab-df-buttons\">\n<div class=\"colab-df-container\">\n<button class=\"colab-df-convert\" data-cf-modified-03fcc77dd779a0debc9da8bf-=\"\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; convertToInteractive('df-91f9a67c-e65b-41bf-9ca4-79f5826d1670')\" style=\"display:none;\" title=\"Convert this dataframe to an interactive table.\">\n<svg height=\"24px\" viewbox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"></path>\n</svg>\n</button>\n\n\n</div>\n<div id=\"df-39c80c73-686d-41f9-bf1d-2877ef4799cc\">\n<button class=\"colab-df-quickchart\" data-cf-modified-03fcc77dd779a0debc9da8bf-=\"\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; quickchart('df-39c80c73-686d-41f9-bf1d-2877ef4799cc')\" style=\"display:none;\" title=\"Suggest charts\">\n<svg height=\"24px\" viewbox=\"0 0 24 24\" width=\"24px\" xmlns=\"http://www.w3.org/2000/svg\">\n<g>\n<path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"></path>\n</g>\n</svg>\n</button>\n\n\n</div>\n</div>\n</div>\n<pre>model_dictionary[\"BaggingClassifier\"]\n</pre>\n\n<pre>CustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=BaggingClassifier(random_state=42))))</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br/>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden=\"\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-91\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-91\">CustomClassifier</label><div class=\"sk-toggleable__content\"><pre>CustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=BaggingClassifier(random_state=42))))</pre><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-92\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-92\">obj: CustomClassifier</label><pre>CustomClassifier(obj=CustomClassifier(obj=BaggingClassifier(random_state=42)))</pre><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-93\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-93\">obj: CustomClassifier</label><pre>CustomClassifier(obj=BaggingClassifier(random_state=42))</pre><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-94\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-94\">obj: BaggingClassifier</label><pre>BaggingClassifier(random_state=42)</pre><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-95\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-95\">BaggingClassifier</label><pre>BaggingClassifier(random_state=42)\r\nprint(classification_report(y_test, model_dictionary[\"BaggingClassifier\"].fit(X_train, y_train).predict(X_test)))\n\r\n              precision    recall  f1-score   support\n\n           0       1.00      1.00      1.00        13\n           1       1.00      1.00      1.00         6\n           2       1.00      1.00      1.00        11\n\n    accuracy                           1.00        30\n   macro avg       1.00      1.00      1.00        30\nweighted avg       1.00      1.00      1.00        30\n\r\nConfusionMatrixDisplay.from_estimator(model_dictionary[\"BaggingClassifier\"], X_test, y_test)\nplt.show()\n</pre>\n<p><img alt=\"image-title-here\" class=\"img-responsive\" data-lazy-src=\"https://i2.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image2.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image-title-here\" class=\"img-responsive\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image2.png?w=578&amp;ssl=1\"/></noscript></p>\n<h1 id=\"3---wine-data\">3 - wine data</h1>\n<p><a href=\"https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#contents\" rel=\"nofollow\" target=\"_blank\">top</a></p>\n<pre>data = load_wine()\nX = data.data\ny= data.target\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = .2, random_state = 123)\n\nclf = ns.LazyDeepClassifier(n_layers=3, verbose=0, ignore_warnings=True)\nstart = time()\nmodels, predictions = clf.fit(X_train, X_test, y_train, y_test)\nprint(f\"\\n\\n Elapsed: {time()-start} seconds \\n\")\nmodel_dictionary = clf.provide_models(X_train, X_test, y_train, y_test)\ndisplay(models)\n\r\n100%|██████████| 27/27 [00:05&lt;00:00,  5.09it/s]\n\n\n\n Elapsed: 5.312330007553101 seconds \n</pre>\n<div class=\"colab-df-container\" id=\"df-87fc304d-4050-431a-b9f9-e653f933c18a\">\n<div>\n\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th></th>\n<th>Accuracy</th>\n<th>Balanced Accuracy</th>\n<th>ROC AUC</th>\n<th>F1 Score</th>\n<th>Time Taken</th>\n</tr>\n<tr>\n<th>Model</th>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>RidgeClassifierCV</th>\n<td>1.00</td>\n<td>1.00</td>\n<td>None</td>\n<td>1.00</td>\n<td>0.15</td>\n</tr>\n<tr>\n<th>RidgeClassifier</th>\n<td>1.00</td>\n<td>1.00</td>\n<td>None</td>\n<td>1.00</td>\n<td>0.13</td>\n</tr>\n<tr>\n<th>Perceptron</th>\n<td>1.00</td>\n<td>1.00</td>\n<td>None</td>\n<td>1.00</td>\n<td>0.15</td>\n</tr>\n<tr>\n<th>SVC</th>\n<td>0.97</td>\n<td>0.98</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.13</td>\n</tr>\n<tr>\n<th>SGDClassifier</th>\n<td>0.97</td>\n<td>0.98</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.13</td>\n</tr>\n<tr>\n<th>CalibratedClassifierCV</th>\n<td>0.97</td>\n<td>0.98</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.27</td>\n</tr>\n<tr>\n<th>PassiveAggressiveClassifier</th>\n<td>0.97</td>\n<td>0.98</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.14</td>\n</tr>\n<tr>\n<th>LogisticRegression</th>\n<td>0.97</td>\n<td>0.98</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.16</td>\n</tr>\n<tr>\n<th>LinearSVC</th>\n<td>0.97</td>\n<td>0.98</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.14</td>\n</tr>\n<tr>\n<th>BaggingClassifier</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.21</td>\n</tr>\n<tr>\n<th>RandomForestClassifier</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.61</td>\n</tr>\n<tr>\n<th>LinearDiscriminantAnalysis</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>0.16</td>\n</tr>\n<tr>\n<th>LabelSpreading</th>\n<td>0.94</td>\n<td>0.94</td>\n<td>None</td>\n<td>0.94</td>\n<td>0.44</td>\n</tr>\n<tr>\n<th>LabelPropagation</th>\n<td>0.94</td>\n<td>0.94</td>\n<td>None</td>\n<td>0.94</td>\n<td>0.26</td>\n</tr>\n<tr>\n<th>ExtraTreesClassifier</th>\n<td>0.94</td>\n<td>0.94</td>\n<td>None</td>\n<td>0.94</td>\n<td>0.50</td>\n</tr>\n<tr>\n<th>KNeighborsClassifier</th>\n<td>0.92</td>\n<td>0.92</td>\n<td>None</td>\n<td>0.92</td>\n<td>0.13</td>\n</tr>\n<tr>\n<th>ExtraTreeClassifier</th>\n<td>0.89</td>\n<td>0.88</td>\n<td>None</td>\n<td>0.89</td>\n<td>0.13</td>\n</tr>\n<tr>\n<th>DecisionTreeClassifier</th>\n<td>0.83</td>\n<td>0.87</td>\n<td>None</td>\n<td>0.83</td>\n<td>0.12</td>\n</tr>\n<tr>\n<th>GaussianNB</th>\n<td>0.86</td>\n<td>0.85</td>\n<td>None</td>\n<td>0.85</td>\n<td>0.13</td>\n</tr>\n<tr>\n<th>NearestCentroid</th>\n<td>0.86</td>\n<td>0.81</td>\n<td>None</td>\n<td>0.86</td>\n<td>0.13</td>\n</tr>\n<tr>\n<th>NuSVC</th>\n<td>0.83</td>\n<td>0.79</td>\n<td>None</td>\n<td>0.84</td>\n<td>0.13</td>\n</tr>\n<tr>\n<th>AdaBoostClassifier</th>\n<td>0.81</td>\n<td>0.78</td>\n<td>None</td>\n<td>0.81</td>\n<td>0.43</td>\n</tr>\n<tr>\n<th>BernoulliNB</th>\n<td>0.81</td>\n<td>0.75</td>\n<td>None</td>\n<td>0.80</td>\n<td>0.15</td>\n</tr>\n<tr>\n<th>QuadraticDiscriminantAnalysis</th>\n<td>0.53</td>\n<td>0.58</td>\n<td>None</td>\n<td>0.52</td>\n<td>0.13</td>\n</tr>\n<tr>\n<th>DummyClassifier</th>\n<td>0.31</td>\n<td>0.33</td>\n<td>None</td>\n<td>0.14</td>\n<td>0.13</td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"colab-df-buttons\">\n<div class=\"colab-df-container\">\n<button class=\"colab-df-convert\" data-cf-modified-03fcc77dd779a0debc9da8bf-=\"\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; convertToInteractive('df-87fc304d-4050-431a-b9f9-e653f933c18a')\" style=\"display:none;\" title=\"Convert this dataframe to an interactive table.\">\n<svg height=\"24px\" viewbox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"></path>\n</svg>\n</button>\n\n\n</div>\n<div id=\"df-dfe4398b-a1e1-4a09-9fb8-c4c415410427\">\n<button class=\"colab-df-quickchart\" data-cf-modified-03fcc77dd779a0debc9da8bf-=\"\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; quickchart('df-dfe4398b-a1e1-4a09-9fb8-c4c415410427')\" style=\"display:none;\" title=\"Suggest charts\">\n<svg height=\"24px\" viewbox=\"0 0 24 24\" width=\"24px\" xmlns=\"http://www.w3.org/2000/svg\">\n<g>\n<path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"></path>\n</g>\n</svg>\n</button>\n\n\n</div>\n</div>\n</div>\n<pre>model_dictionary[\"RidgeClassifierCV\"]\n</pre>\n\n<pre>CustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=RidgeClassifierCV())))</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br/>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden=\"\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-96\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-96\">CustomClassifier</label><div class=\"sk-toggleable__content\"><pre>CustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=RidgeClassifierCV())))</pre><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-97\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-97\">obj: CustomClassifier</label><pre>CustomClassifier(obj=CustomClassifier(obj=RidgeClassifierCV()))</pre><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-98\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-98\">obj: CustomClassifier</label><pre>CustomClassifier(obj=RidgeClassifierCV())</pre><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-99\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-99\">obj: RidgeClassifierCV</label><pre>RidgeClassifierCV()</pre><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-100\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-100\">RidgeClassifierCV</label><pre>RidgeClassifierCV()\r\nprint(classification_report(y_test, model_dictionary[\"RidgeClassifierCV\"].fit(X_train, y_train).predict(X_test)))\n\r\n              precision    recall  f1-score   support\n\n           0       1.00      1.00      1.00         8\n           1       1.00      1.00      1.00        11\n           2       1.00      1.00      1.00        17\n\n    accuracy                           1.00        36\n   macro avg       1.00      1.00      1.00        36\nweighted avg       1.00      1.00      1.00        36\n\r\nConfusionMatrixDisplay.from_estimator(model_dictionary[\"RidgeClassifierCV\"], X_test, y_test)\nplt.show()\n</pre>\n<p><img alt=\"image-title-here\" class=\"img-responsive\" data-lazy-src=\"https://i1.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image3.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image-title-here\" class=\"img-responsive\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image3.png?w=578&amp;ssl=1\"/></noscript></p>\n<h1 id=\"4---digits-data\">4 - digits data</h1>\n<p><a href=\"https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#contents\" rel=\"nofollow\" target=\"_blank\">top</a></p>\n<pre>data = load_digits()\nX = data.data\ny= data.target\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = .2, random_state = 123)\n\nclf = ns.LazyDeepClassifier(n_layers=3, verbose=0, ignore_warnings=True)\nstart = time()\nmodels, predictions = clf.fit(X_train, X_test, y_train, y_test)\nprint(f\"\\n\\n Elapsed: {time()-start} seconds \\n\")\nmodel_dictionary = clf.provide_models(X_train, X_test, y_train, y_test)\ndisplay(models)\n\r\n100%|██████████| 27/27 [01:41&lt;00:00,  3.75s/it]\n\n\n\n Elapsed: 101.15918207168579 seconds \n</pre>\n<div class=\"colab-df-container\" id=\"df-367bea27-c33f-4097-8edb-529f6ccc659b\">\n<div>\n\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th></th>\n<th>Accuracy</th>\n<th>Balanced Accuracy</th>\n<th>ROC AUC</th>\n<th>F1 Score</th>\n<th>Time Taken</th>\n</tr>\n<tr>\n<th>Model</th>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>SVC</th>\n<td>0.99</td>\n<td>0.99</td>\n<td>None</td>\n<td>0.99</td>\n<td>3.47</td>\n</tr>\n<tr>\n<th>LogisticRegression</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>3.67</td>\n</tr>\n<tr>\n<th>CalibratedClassifierCV</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>8.78</td>\n</tr>\n<tr>\n<th>RandomForestClassifier</th>\n<td>0.97</td>\n<td>0.97</td>\n<td>None</td>\n<td>0.97</td>\n<td>4.46</td>\n</tr>\n<tr>\n<th>LinearDiscriminantAnalysis</th>\n<td>0.96</td>\n<td>0.96</td>\n<td>None</td>\n<td>0.96</td>\n<td>4.78</td>\n</tr>\n<tr>\n<th>LinearSVC</th>\n<td>0.96</td>\n<td>0.96</td>\n<td>None</td>\n<td>0.96</td>\n<td>4.18</td>\n</tr>\n<tr>\n<th>ExtraTreesClassifier</th>\n<td>0.96</td>\n<td>0.96</td>\n<td>None</td>\n<td>0.96</td>\n<td>3.50</td>\n</tr>\n<tr>\n<th>PassiveAggressiveClassifier</th>\n<td>0.96</td>\n<td>0.96</td>\n<td>None</td>\n<td>0.96</td>\n<td>2.89</td>\n</tr>\n<tr>\n<th>KNeighborsClassifier</th>\n<td>0.96</td>\n<td>0.96</td>\n<td>None</td>\n<td>0.96</td>\n<td>3.60</td>\n</tr>\n<tr>\n<th>SGDClassifier</th>\n<td>0.96</td>\n<td>0.96</td>\n<td>None</td>\n<td>0.96</td>\n<td>2.62</td>\n</tr>\n<tr>\n<th>RidgeClassifier</th>\n<td>0.94</td>\n<td>0.94</td>\n<td>None</td>\n<td>0.94</td>\n<td>4.45</td>\n</tr>\n<tr>\n<th>Perceptron</th>\n<td>0.94</td>\n<td>0.94</td>\n<td>None</td>\n<td>0.94</td>\n<td>4.38</td>\n</tr>\n<tr>\n<th>RidgeClassifierCV</th>\n<td>0.94</td>\n<td>0.94</td>\n<td>None</td>\n<td>0.93</td>\n<td>3.02</td>\n</tr>\n<tr>\n<th>NuSVC</th>\n<td>0.93</td>\n<td>0.93</td>\n<td>None</td>\n<td>0.93</td>\n<td>4.55</td>\n</tr>\n<tr>\n<th>BaggingClassifier</th>\n<td>0.92</td>\n<td>0.92</td>\n<td>None</td>\n<td>0.92</td>\n<td>4.84</td>\n</tr>\n<tr>\n<th>LabelPropagation</th>\n<td>0.91</td>\n<td>0.91</td>\n<td>None</td>\n<td>0.92</td>\n<td>2.63</td>\n</tr>\n<tr>\n<th>LabelSpreading</th>\n<td>0.91</td>\n<td>0.91</td>\n<td>None</td>\n<td>0.92</td>\n<td>3.64</td>\n</tr>\n<tr>\n<th>QuadraticDiscriminantAnalysis</th>\n<td>0.88</td>\n<td>0.88</td>\n<td>None</td>\n<td>0.88</td>\n<td>2.39</td>\n</tr>\n<tr>\n<th>NearestCentroid</th>\n<td>0.85</td>\n<td>0.85</td>\n<td>None</td>\n<td>0.85</td>\n<td>4.27</td>\n</tr>\n<tr>\n<th>DecisionTreeClassifier</th>\n<td>0.83</td>\n<td>0.83</td>\n<td>None</td>\n<td>0.83</td>\n<td>3.36</td>\n</tr>\n<tr>\n<th>BernoulliNB</th>\n<td>0.82</td>\n<td>0.82</td>\n<td>None</td>\n<td>0.82</td>\n<td>2.85</td>\n</tr>\n<tr>\n<th>GaussianNB</th>\n<td>0.81</td>\n<td>0.81</td>\n<td>None</td>\n<td>0.80</td>\n<td>4.63</td>\n</tr>\n<tr>\n<th>ExtraTreeClassifier</th>\n<td>0.81</td>\n<td>0.80</td>\n<td>None</td>\n<td>0.81</td>\n<td>3.35</td>\n</tr>\n<tr>\n<th>AdaBoostClassifier</th>\n<td>0.39</td>\n<td>0.37</td>\n<td>None</td>\n<td>0.32</td>\n<td>5.05</td>\n</tr>\n<tr>\n<th>DummyClassifier</th>\n<td>0.08</td>\n<td>0.10</td>\n<td>None</td>\n<td>0.01</td>\n<td>4.98</td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"colab-df-buttons\">\n<div class=\"colab-df-container\">\n<button class=\"colab-df-convert\" data-cf-modified-03fcc77dd779a0debc9da8bf-=\"\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; convertToInteractive('df-367bea27-c33f-4097-8edb-529f6ccc659b')\" style=\"display:none;\" title=\"Convert this dataframe to an interactive table.\">\n<svg height=\"24px\" viewbox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"></path>\n</svg>\n</button>\n\n\n</div>\n<div id=\"df-e1caf652-22ca-4a3f-bef7-3ca976401433\">\n<button class=\"colab-df-quickchart\" data-cf-modified-03fcc77dd779a0debc9da8bf-=\"\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; quickchart('df-e1caf652-22ca-4a3f-bef7-3ca976401433')\" style=\"display:none;\" title=\"Suggest charts\">\n<svg height=\"24px\" viewbox=\"0 0 24 24\" width=\"24px\" xmlns=\"http://www.w3.org/2000/svg\">\n<g>\n<path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"></path>\n</g>\n</svg>\n</button>\n\n\n</div>\n</div>\n</div>\n<pre>model_dictionary[\"SVC\"]\n</pre>\n\n<pre>CustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=SVC(random_state=42))))</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br/>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden=\"\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-101\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-101\">CustomClassifier</label><div class=\"sk-toggleable__content\"><pre>CustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=SVC(random_state=42))))</pre><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-102\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-102\">obj: CustomClassifier</label><pre>CustomClassifier(obj=CustomClassifier(obj=SVC(random_state=42)))</pre><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-103\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-103\">obj: CustomClassifier</label><pre>CustomClassifier(obj=SVC(random_state=42))</pre><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-104\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-104\">obj: SVC</label><pre>SVC(random_state=42)</pre><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-105\" type=\"checkbox\"/><label class=\"sk-toggleable__label sk-toggleable__label-arrow\" for=\"sk-estimator-id-105\">SVC</label><pre>SVC(random_state=42)\r\nprint(classification_report(y_test, model_dictionary[\"SVC\"].fit(X_train, y_train).predict(X_test)))\n\r\n              precision    recall  f1-score   support\n\n           0       1.00      1.00      1.00        39\n           1       0.94      1.00      0.97        34\n           2       1.00      0.97      0.99        36\n           3       1.00      1.00      1.00        33\n           4       0.95      1.00      0.98        42\n           5       1.00      0.95      0.97        37\n           6       1.00      1.00      1.00        43\n           7       1.00      1.00      1.00        31\n           8       1.00      0.95      0.97        37\n           9       0.97      1.00      0.98        28\n\n    accuracy                           0.99       360\n   macro avg       0.99      0.99      0.99       360\nweighted avg       0.99      0.99      0.99       360\n\r\nConfusionMatrixDisplay.from_estimator(model_dictionary[\"SVC\"], X_test, y_test)\nplt.show()\n</pre>\n<p><img alt=\"image-title-here\" class=\"img-responsive\" data-lazy-src=\"https://i0.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image4.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image-title-here\" class=\"img-responsive\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image4.png?w=578&amp;ssl=1\"/></noscript></p>\n<pre>ConfusionMatrixDisplay.from_estimator(model_dictionary[\"LogisticRegression\"], X_test, y_test)\nplt.show()\n</pre>\n<p><img alt=\"image-title-here\" class=\"img-responsive\" data-lazy-src=\"https://i2.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image5.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image-title-here\" class=\"img-responsive\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image5.png?w=578&amp;ssl=1\"/></noscript></p>\n<h1 id=\"5---r-examples\">5 - R examples</h1>\n<p><a href=\"https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy#contents\" rel=\"nofollow\" target=\"_blank\">top</a></p>\n<p>I hope this is not too technical: please note that installing the R version of <code>nnetsauce</code> will create an environment in the current directory (more precisely, a folder named <code>r-reticulate</code> will be created where you’ll install the package).</p>\n<p><strong>Classification</strong></p>\n<pre>remotes::install_github(\"Techtonique/nnetsauce_r\") # install nnetsauce from GitHub\n\nlibrary(datasets)\n\nset.seed(123)\nX &lt;- as.matrix(iris[, 1:4])\ny &lt;- as.integer(iris$Species) - 1L\n\n(index_train &lt;- base::sample.int(n = nrow(X),\n                                 size = floor(0.8*nrow(X)),\n                                 replace = FALSE))\nX_train &lt;- X[index_train, ]\ny_train &lt;- y[index_train]\nX_test &lt;- X[-index_train, ]\ny_test &lt;- y[-index_train]\n\nobj &lt;- nnetsauce::LazyDeepClassifier(n_layers = 3L)\nres &lt;- obj$fit(X_train, X_test, y_train, y_test)\nprint(res[[1]]) # best accuracy must be 1.0\n</pre>\n<p><strong>Regression</strong></p>\n<pre>X &lt;- MASS::Boston[,-14] # dataset has an ethical problem\ny &lt;- MASS::Boston$medv\n\nset.seed(13)\n(index_train &lt;- base::sample.int(n = nrow(X),\n                                 size = floor(0.8*nrow(X)),\n                                 replace = FALSE))\nX_train &lt;- X[index_train, ]\ny_train &lt;- y[index_train]\nX_test &lt;- X[-index_train, ]\ny_test &lt;- y[-index_train]\n\nobj &lt;- nnetsauce::LazyDeepRegressor(n_layers = 3L, n_clusters=2L)\nres &lt;- obj$fit(X_train, X_test, y_train, y_test)\nprint(res[[1]]) # best RMSE must be close to 2.8, try n_clusters=3L for 2.69\n</pre>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://thierrymoudiki.github.io//blog/2023/11/12/python/r/quasirandomizednn/nnetsauce-deep-lazy\"> T. Moudiki's Webpage - R</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></article>",
      "main_text": "A classifier that’s very accurate (and deep)\nPosted on\nNovember 11, 2023\nby\nT. Moudiki\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nT. Moudiki's Webpage - R\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nVersion\nv0.15.0\nof\nnnetsauce\nis now available on your favorite platforms:\nPyPI\n,\nconda\nand\nGitHub\nfor Python;\nR universe\nand\nGitHub\nfor R.\nThe changes in this version are mostly related to\nAutomated Machine learning (AutoML)\n:\nlazy\nprediction for classification and regression: see\nthis post\nfor more details on the subject (and remember to use\npip install nnetsauce\ndirectly, instead of installing from a GitHub branch named\nlazy-predict\n)\nlazy\nprediction for multivariate time series (MTS): see\nthis post\nfor more details on the subject (and remember to use\npip install nnetsauce\ndirectly, instead of installing from a GitHub branch named\nlazy-predict\n)\nlazy\nprediction with\ndeep\nquasi-randomized\nnnetworks\nwill be described in this post\nNote that in the example below, for the offically released version (v0.15.0), Gradient boosting classifiers are available. This doesn’t change the best model chosen by the algorithm (which is never Gradient boosting, because\nthe deep model is already doing “too much”\n). Not sure if Gradient boosting will be kept as a default model here because, in this context, it’s relatively slow.\nTo finish, for Windows users, if you run into issues when trying to install\nnnetsauce\n(but you shouldn’t): remember that you can use the\nWindows Subsystem for Linux (WSL)\n.\nContents\n0 – Install and import packages\n1 – breast cancer data\n2 – iris data\n3 – wine data\n4 – digits data\n5 – R examples\nHere is a\njupyter notebook\nallowing you to reproduce these results. Do not hesitate \nto modify these examples by choosing – in\nLazyDeepClassifier\n– a different number of layers\nn_layers\n, or the number of \nengineered features\nper\nlayer,\nn_hidden_features\n.\n0 – Install and import packages\ntop\n!pip install nnetsauce --upgrade\n\nimport os\nimport nnetsauce as ns\nimport matplotlib.pyplot as plt\nfrom sklearn.datasets import load_breast_cancer, load_iris, load_wine, load_digits\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report, ConfusionMatrixDisplay\nfrom time import time\n1 – breast cancer data\ntop\ndata = load_breast_cancer()\nX = data.data\ny= data.target\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = .2, random_state = 123)\n\nclf = ns.LazyDeepClassifier(n_layers=3, verbose=0, ignore_warnings=True)\nstart = time()\nmodels, predictions = clf.fit(X_train, X_test, y_train, y_test)\nprint(f\"\\n\\n Elapsed: {time()-start} seconds \\n\")\nmodel_dictionary = clf.provide_models(X_train, X_test, y_train, y_test)\n\ndisplay(models)\n\n100%|██████████| 27/27 [00:44<00:00,  1.65s/it]\n\n Elapsed: 44.49836850166321 seconds\nAccuracy\nBalanced Accuracy\nROC AUC\nF1 Score\nTime Taken\nModel\nPerceptron\n0.99\n0.99\n0.99\n0.99\n2.15\nSGDClassifier\n0.98\n0.98\n0.98\n0.98\n1.99\nRandomForestClassifier\n0.98\n0.98\n0.98\n0.98\n2.76\nPassiveAggressiveClassifier\n0.98\n0.98\n0.98\n0.98\n1.89\nLogisticRegression\n0.98\n0.98\n0.98\n0.98\n1.14\nExtraTreesClassifier\n0.98\n0.98\n0.98\n0.98\n3.13\nBaggingClassifier\n0.97\n0.97\n0.97\n0.97\n1.62\nLabelPropagation\n0.97\n0.97\n0.97\n0.97\n1.69\nLabelSpreading\n0.97\n0.97\n0.97\n0.97\n1.08\nAdaBoostClassifier\n0.97\n0.97\n0.97\n0.97\n3.42\nLinearSVC\n0.97\n0.97\n0.97\n0.97\n1.65\nKNeighborsClassifier\n0.97\n0.97\n0.97\n0.97\n1.07\nSVC\n0.97\n0.96\n0.96\n0.97\n1.07\nCalibratedClassifierCV\n0.97\n0.96\n0.96\n0.97\n1.82\nDecisionTreeClassifier\n0.96\n0.96\n0.96\n0.96\n1.50\nQuadraticDiscriminantAnalysis\n0.96\n0.95\n0.95\n0.96\n1.16\nLinearDiscriminantAnalysis\n0.96\n0.95\n0.95\n0.96\n1.39\nExtraTreeClassifier\n0.96\n0.94\n0.94\n0.96\n0.83\nRidgeClassifier\n0.96\n0.94\n0.94\n0.96\n3.15\nRidgeClassifierCV\n0.96\n0.94\n0.94\n0.96\n1.51\nGaussianNB\n0.93\n0.90\n0.90\n0.93\n1.50\nNearestCentroid\n0.93\n0.90\n0.90\n0.93\n3.00\nNuSVC\n0.93\n0.90\n0.90\n0.93\n1.27\nBernoulliNB\n0.91\n0.89\n0.89\n0.91\n1.15\nDummyClassifier\n0.64\n0.50\n0.50\n0.50\n0.96\nmodel_dictionary[\"Perceptron\"]\nCustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=Perceptron(random_state=42))))\nIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook.\nOn GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\nCustomClassifier\nCustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=Perceptron(random_state=42))))\nobj: CustomClassifier\nCustomClassifier(obj=CustomClassifier(obj=Perceptron(random_state=42)))\nobj: CustomClassifier\nCustomClassifier(obj=Perceptron(random_state=42))\nobj: Perceptron\nPerceptron(random_state=42)\nPerceptron\nPerceptron(random_state=42)\nprint(classification_report(y_test, model_dictionary[\"Perceptron\"].fit(X_train, y_train).predict(X_test)))\n\n              precision    recall  f1-score   support\n\n           0       1.00      0.98      0.99        41\n           1       0.99      1.00      0.99        73\n\n    accuracy                           0.99       114\n   macro avg       0.99      0.99      0.99       114\nweighted avg       0.99      0.99      0.99       114\n\nConfusionMatrixDisplay.from_estimator(model_dictionary[\"Perceptron\"], X_test, y_test)\nplt.show()\n2 - iris data\ntop\ndata = load_iris()\nX = data.data\ny= data.target\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = .2, random_state = 123)\n\nclf = ns.LazyDeepClassifier(n_layers=3, verbose=0, ignore_warnings=True)\nstart = time()\nmodels, predictions = clf.fit(X_train, X_test, y_train, y_test)\nprint(f\"\\n\\n Elapsed: {time()-start} seconds \\n\")\nmodel_dictionary = clf.provide_models(X_train, X_test, y_train, y_test)\ndisplay(models)\n\n100%|██████████| 27/27 [00:05<00:00,  4.51it/s]\n\n Elapsed: 5.992894172668457 seconds\nAccuracy\nBalanced Accuracy\nROC AUC\nF1 Score\nTime Taken\nModel\nBaggingClassifier\n1.00\n1.00\nNone\n1.00\n0.18\nDecisionTreeClassifier\n1.00\n1.00\nNone\n1.00\n0.11\nKNeighborsClassifier\n0.97\n0.97\nNone\n0.97\n0.10\nCalibratedClassifierCV\n0.97\n0.97\nNone\n0.97\n0.24\nSGDClassifier\n0.97\n0.97\nNone\n0.97\n0.21\nExtraTreeClassifier\n0.97\n0.97\nNone\n0.97\n0.10\nRidgeClassifier\n0.97\n0.97\nNone\n0.97\n1.05\nRidgeClassifierCV\n0.97\n0.97\nNone\n0.97\n0.21\nRandomForestClassifier\n0.97\n0.97\nNone\n0.97\n0.88\nLogisticRegression\n0.97\n0.97\nNone\n0.97\n0.14\nLinearSVC\n0.97\n0.97\nNone\n0.97\n0.11\nPassiveAggressiveClassifier\n0.93\n0.94\nNone\n0.93\n0.11\nPerceptron\n0.93\n0.94\nNone\n0.93\n0.11\nBernoulliNB\n0.93\n0.94\nNone\n0.93\n0.10\nLabelSpreading\n0.93\n0.91\nNone\n0.93\n0.31\nLabelPropagation\n0.93\n0.91\nNone\n0.93\n0.20\nExtraTreesClassifier\n0.93\n0.91\nNone\n0.93\n0.45\nGaussianNB\n0.90\n0.91\nNone\n0.90\n0.10\nAdaBoostClassifier\n0.90\n0.91\nNone\n0.90\n0.38\nSVC\n0.87\n0.88\nNone\n0.87\n0.19\nNuSVC\n0.87\n0.88\nNone\n0.87\n0.12\nNearestCentroid\n0.87\n0.88\nNone\n0.87\n0.10\nLinearDiscriminantAnalysis\n0.63\n0.67\nNone\n0.54\n0.20\nQuadraticDiscriminantAnalysis\n0.20\n0.33\nNone\n0.07\n0.11\nDummyClassifier\n0.20\n0.33\nNone\n0.07\n0.10\nmodel_dictionary[\"BaggingClassifier\"]\nCustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=BaggingClassifier(random_state=42))))\nIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook.\nOn GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\nCustomClassifier\nCustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=BaggingClassifier(random_state=42))))\nobj: CustomClassifier\nCustomClassifier(obj=CustomClassifier(obj=BaggingClassifier(random_state=42)))\nobj: CustomClassifier\nCustomClassifier(obj=BaggingClassifier(random_state=42))\nobj: BaggingClassifier\nBaggingClassifier(random_state=42)\nBaggingClassifier\nBaggingClassifier(random_state=42)\nprint(classification_report(y_test, model_dictionary[\"BaggingClassifier\"].fit(X_train, y_train).predict(X_test)))\n\n              precision    recall  f1-score   support\n\n           0       1.00      1.00      1.00        13\n           1       1.00      1.00      1.00         6\n           2       1.00      1.00      1.00        11\n\n    accuracy                           1.00        30\n   macro avg       1.00      1.00      1.00        30\nweighted avg       1.00      1.00      1.00        30\n\nConfusionMatrixDisplay.from_estimator(model_dictionary[\"BaggingClassifier\"], X_test, y_test)\nplt.show()\n3 - wine data\ntop\ndata = load_wine()\nX = data.data\ny= data.target\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = .2, random_state = 123)\n\nclf = ns.LazyDeepClassifier(n_layers=3, verbose=0, ignore_warnings=True)\nstart = time()\nmodels, predictions = clf.fit(X_train, X_test, y_train, y_test)\nprint(f\"\\n\\n Elapsed: {time()-start} seconds \\n\")\nmodel_dictionary = clf.provide_models(X_train, X_test, y_train, y_test)\ndisplay(models)\n\n100%|██████████| 27/27 [00:05<00:00,  5.09it/s]\n\n Elapsed: 5.312330007553101 seconds\nAccuracy\nBalanced Accuracy\nROC AUC\nF1 Score\nTime Taken\nModel\nRidgeClassifierCV\n1.00\n1.00\nNone\n1.00\n0.15\nRidgeClassifier\n1.00\n1.00\nNone\n1.00\n0.13\nPerceptron\n1.00\n1.00\nNone\n1.00\n0.15\nSVC\n0.97\n0.98\nNone\n0.97\n0.13\nSGDClassifier\n0.97\n0.98\nNone\n0.97\n0.13\nCalibratedClassifierCV\n0.97\n0.98\nNone\n0.97\n0.27\nPassiveAggressiveClassifier\n0.97\n0.98\nNone\n0.97\n0.14\nLogisticRegression\n0.97\n0.98\nNone\n0.97\n0.16\nLinearSVC\n0.97\n0.98\nNone\n0.97\n0.14\nBaggingClassifier\n0.97\n0.97\nNone\n0.97\n0.21\nRandomForestClassifier\n0.97\n0.97\nNone\n0.97\n0.61\nLinearDiscriminantAnalysis\n0.97\n0.97\nNone\n0.97\n0.16\nLabelSpreading\n0.94\n0.94\nNone\n0.94\n0.44\nLabelPropagation\n0.94\n0.94\nNone\n0.94\n0.26\nExtraTreesClassifier\n0.94\n0.94\nNone\n0.94\n0.50\nKNeighborsClassifier\n0.92\n0.92\nNone\n0.92\n0.13\nExtraTreeClassifier\n0.89\n0.88\nNone\n0.89\n0.13\nDecisionTreeClassifier\n0.83\n0.87\nNone\n0.83\n0.12\nGaussianNB\n0.86\n0.85\nNone\n0.85\n0.13\nNearestCentroid\n0.86\n0.81\nNone\n0.86\n0.13\nNuSVC\n0.83\n0.79\nNone\n0.84\n0.13\nAdaBoostClassifier\n0.81\n0.78\nNone\n0.81\n0.43\nBernoulliNB\n0.81\n0.75\nNone\n0.80\n0.15\nQuadraticDiscriminantAnalysis\n0.53\n0.58\nNone\n0.52\n0.13\nDummyClassifier\n0.31\n0.33\nNone\n0.14\n0.13\nmodel_dictionary[\"RidgeClassifierCV\"]\nCustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=RidgeClassifierCV())))\nIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook.\nOn GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\nCustomClassifier\nCustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=RidgeClassifierCV())))\nobj: CustomClassifier\nCustomClassifier(obj=CustomClassifier(obj=RidgeClassifierCV()))\nobj: CustomClassifier\nCustomClassifier(obj=RidgeClassifierCV())\nobj: RidgeClassifierCV\nRidgeClassifierCV()\nRidgeClassifierCV\nRidgeClassifierCV()\nprint(classification_report(y_test, model_dictionary[\"RidgeClassifierCV\"].fit(X_train, y_train).predict(X_test)))\n\n              precision    recall  f1-score   support\n\n           0       1.00      1.00      1.00         8\n           1       1.00      1.00      1.00        11\n           2       1.00      1.00      1.00        17\n\n    accuracy                           1.00        36\n   macro avg       1.00      1.00      1.00        36\nweighted avg       1.00      1.00      1.00        36\n\nConfusionMatrixDisplay.from_estimator(model_dictionary[\"RidgeClassifierCV\"], X_test, y_test)\nplt.show()\n4 - digits data\ntop\ndata = load_digits()\nX = data.data\ny= data.target\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = .2, random_state = 123)\n\nclf = ns.LazyDeepClassifier(n_layers=3, verbose=0, ignore_warnings=True)\nstart = time()\nmodels, predictions = clf.fit(X_train, X_test, y_train, y_test)\nprint(f\"\\n\\n Elapsed: {time()-start} seconds \\n\")\nmodel_dictionary = clf.provide_models(X_train, X_test, y_train, y_test)\ndisplay(models)\n\n100%|██████████| 27/27 [01:41<00:00,  3.75s/it]\n\n Elapsed: 101.15918207168579 seconds\nAccuracy\nBalanced Accuracy\nROC AUC\nF1 Score\nTime Taken\nModel\nSVC\n0.99\n0.99\nNone\n0.99\n3.47\nLogisticRegression\n0.97\n0.97\nNone\n0.97\n3.67\nCalibratedClassifierCV\n0.97\n0.97\nNone\n0.97\n8.78\nRandomForestClassifier\n0.97\n0.97\nNone\n0.97\n4.46\nLinearDiscriminantAnalysis\n0.96\n0.96\nNone\n0.96\n4.78\nLinearSVC\n0.96\n0.96\nNone\n0.96\n4.18\nExtraTreesClassifier\n0.96\n0.96\nNone\n0.96\n3.50\nPassiveAggressiveClassifier\n0.96\n0.96\nNone\n0.96\n2.89\nKNeighborsClassifier\n0.96\n0.96\nNone\n0.96\n3.60\nSGDClassifier\n0.96\n0.96\nNone\n0.96\n2.62\nRidgeClassifier\n0.94\n0.94\nNone\n0.94\n4.45\nPerceptron\n0.94\n0.94\nNone\n0.94\n4.38\nRidgeClassifierCV\n0.94\n0.94\nNone\n0.93\n3.02\nNuSVC\n0.93\n0.93\nNone\n0.93\n4.55\nBaggingClassifier\n0.92\n0.92\nNone\n0.92\n4.84\nLabelPropagation\n0.91\n0.91\nNone\n0.92\n2.63\nLabelSpreading\n0.91\n0.91\nNone\n0.92\n3.64\nQuadraticDiscriminantAnalysis\n0.88\n0.88\nNone\n0.88\n2.39\nNearestCentroid\n0.85\n0.85\nNone\n0.85\n4.27\nDecisionTreeClassifier\n0.83\n0.83\nNone\n0.83\n3.36\nBernoulliNB\n0.82\n0.82\nNone\n0.82\n2.85\nGaussianNB\n0.81\n0.81\nNone\n0.80\n4.63\nExtraTreeClassifier\n0.81\n0.80\nNone\n0.81\n3.35\nAdaBoostClassifier\n0.39\n0.37\nNone\n0.32\n5.05\nDummyClassifier\n0.08\n0.10\nNone\n0.01\n4.98\nmodel_dictionary[\"SVC\"]\nCustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=SVC(random_state=42))))\nIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook.\nOn GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\nCustomClassifier\nCustomClassifier(obj=CustomClassifier(obj=CustomClassifier(obj=SVC(random_state=42))))\nobj: CustomClassifier\nCustomClassifier(obj=CustomClassifier(obj=SVC(random_state=42)))\nobj: CustomClassifier\nCustomClassifier(obj=SVC(random_state=42))\nobj: SVC\nSVC(random_state=42)\nSVC\nSVC(random_state=42)\nprint(classification_report(y_test, model_dictionary[\"SVC\"].fit(X_train, y_train).predict(X_test)))\n\n              precision    recall  f1-score   support\n\n           0       1.00      1.00      1.00        39\n           1       0.94      1.00      0.97        34\n           2       1.00      0.97      0.99        36\n           3       1.00      1.00      1.00        33\n           4       0.95      1.00      0.98        42\n           5       1.00      0.95      0.97        37\n           6       1.00      1.00      1.00        43\n           7       1.00      1.00      1.00        31\n           8       1.00      0.95      0.97        37\n           9       0.97      1.00      0.98        28\n\n    accuracy                           0.99       360\n   macro avg       0.99      0.99      0.99       360\nweighted avg       0.99      0.99      0.99       360\n\nConfusionMatrixDisplay.from_estimator(model_dictionary[\"SVC\"], X_test, y_test)\nplt.show()\nConfusionMatrixDisplay.from_estimator(model_dictionary[\"LogisticRegression\"], X_test, y_test)\nplt.show()\n5 - R examples\ntop\nI hope this is not too technical: please note that installing the R version of\nnnetsauce\nwill create an environment in the current directory (more precisely, a folder named\nr-reticulate\nwill be created where you’ll install the package).\nClassification\nremotes::install_github(\"Techtonique/nnetsauce_r\") # install nnetsauce from GitHub\n\nlibrary(datasets)\n\nset.seed(123)\nX <- as.matrix(iris[, 1:4])\ny <- as.integer(iris$Species) - 1L\n\n(index_train <- base::sample.int(n = nrow(X),\n                                 size = floor(0.8*nrow(X)),\n                                 replace = FALSE))\nX_train <- X[index_train, ]\ny_train <- y[index_train]\nX_test <- X[-index_train, ]\ny_test <- y[-index_train]\n\nobj <- nnetsauce::LazyDeepClassifier(n_layers = 3L)\nres <- obj$fit(X_train, X_test, y_train, y_test)\nprint(res[[1]]) # best accuracy must be 1.0\nRegression\nX <- MASS::Boston[,-14] # dataset has an ethical problem\ny <- MASS::Boston$medv\n\nset.seed(13)\n(index_train <- base::sample.int(n = nrow(X),\n                                 size = floor(0.8*nrow(X)),\n                                 replace = FALSE))\nX_train <- X[index_train, ]\ny_train <- y[index_train]\nX_test <- X[-index_train, ]\ny_test <- y[-index_train]\n\nobj <- nnetsauce::LazyDeepRegressor(n_layers = 3L, n_clusters=2L)\nres <- obj$fit(X_train, X_test, y_train, y_test)\nprint(res[[1]]) # best RMSE must be close to 2.8, try n_clusters=3L for 2.69\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nT. Moudiki's Webpage - R\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "nnetsauce version 0.15.0, an example of a deep-layered classifier calibrated with Automated Machine Learning (AutoML)",
      "meta_keywords": null,
      "og_description": "nnetsauce version 0.15.0, an example of a deep-layered classifier calibrated with Automated Machine Learning (AutoML)",
      "og_image": "https://thierrymoudiki.github.io/images/2023-11-12/2023-11-12-image1.png",
      "og_title": "A classifier that’s very accurate (and deep) | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 13.3,
      "sitemap_lastmod": "2023-11-12T00:00:00+00:00",
      "twitter_description": "nnetsauce version 0.15.0, an example of a deep-layered classifier calibrated with Automated Machine Learning (AutoML)",
      "twitter_title": "A classifier that’s very accurate (and deep) | R-bloggers",
      "url": "https://www.r-bloggers.com/2023/11/a-classifier-thats-very-accurate-and-deep/",
      "word_count": 2659
    }
  }
}