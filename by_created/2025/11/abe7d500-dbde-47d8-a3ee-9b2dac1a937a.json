{
  "uuid": "abe7d500-dbde-47d8-a3ee-9b2dac1a937a",
  "created_at": "2025-11-17 20:38:38",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2024/01/powerquery-puzzle-solved-with-r-8/",
    "crawled_at": "2025-11-17T09:22:01.465965",
    "external_links": [
      {
        "href": "https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-4a3364915b4b",
        "text": "Numbers around us - Medium"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://www.linkedin.com/in/excelbi/",
        "text": "ExcelBI"
      },
      {
        "href": "https://github.com/kgryczan/excelbi_puzzles",
        "text": "Github"
      },
      {
        "href": "https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-4a3364915b4b",
        "text": "PowerQuery Puzzle solved with R"
      },
      {
        "href": "https://medium.com/number-around-us",
        "text": "Numbers around us"
      },
      {
        "href": "https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-4a3364915b4b",
        "text": "Numbers around us - Medium"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "PowerQuery Puzzle solved with R | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*uaDnDrzmH6kIFKNFQMZd5A.jpeg?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*7sv-w9gS0CghCGjOtOxkqA.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*s4yjVzH-NlkvHfLw4qdEIg.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:application/octet-stream;base64,R0lGODlhAQABAO+/vQAA77+977+977+9AAAAIe+/vQQBAAAAACwAAAAAAQABAAACAkQBADs=",
        "src": "https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=4a3364915b4b"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/numbers-around-us/",
        "text": "Numbers around us"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-381388 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">PowerQuery Puzzle solved with R</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">January 9, 2024</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/numbers-around-us/\">Numbers around us</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-4a3364915b4b\"> Numbers around us - Medium</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><p>#145–146</p><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*uaDnDrzmH6kIFKNFQMZd5A.jpeg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*uaDnDrzmH6kIFKNFQMZd5A.jpeg?w=578&amp;ssl=1\"/></noscript></figure><h3>Puzzles</h3><p>Author: <a href=\"https://www.linkedin.com/in/excelbi/\" rel=\"nofollow\" target=\"_blank\">ExcelBI</a></p><p>All files (xlsx with puzzle and R with solution) for each and every puzzle are available on my <a href=\"https://github.com/kgryczan/excelbi_puzzles\" rel=\"nofollow\" target=\"_blank\">Github</a>. Enjoy.</p><h3>Puzzle #145</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*7sv-w9gS0CghCGjOtOxkqA.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*7sv-w9gS0CghCGjOtOxkqA.png?w=578&amp;ssl=1\"/></noscript></figure><p>This time our task is to summarise sales from three stores, but there are strings attached. They shouldn’t be just added, but cummulativelly for store and year. But it would be to easy, we need to base year on date of first sale. So each store has it different here. We need to find year ranges for them and then summarise them separately. Let’s try.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Power Query/PQ_Challenge_145.xlsx\", range = \"A1:C16\")\ntest  = read_excel(\"Power Query/PQ_Challenge_145.xlsx\", range = \"F1:I16\")</pre><h4>Transformation</h4><pre>result = input %&gt;%\n  group_by(Store) %&gt;%\n  mutate(min_date = min(Date),\n         year = case_when(\n           between(Date, min_date, min_date + years(1)) ~ 1,\n           between(Date, min_date + years(1), min_date + years(2)) ~ 2,\n           between(Date, min_date + years(2), min_date + years(3)) ~ 3,\n           between(Date, min_date + years(3), min_date + years(4)) ~ 4,\n           between(Date, min_date + years(4), min_date + years(5)) ~ 5\n         )) %&gt;%\n  ungroup()  %&gt;%\n  group_by(Store, year) %&gt;%\n  mutate(Column1 = cumsum(Sale)) %&gt;%\n  ungroup() %&gt;%\n  select(-year, -min_date)</pre><h4>Validation</h4><pre>identical(result, test)\n#&gt; [1] TRUE</pre><h3>Puzzle #146</h3><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*s4yjVzH-NlkvHfLw4qdEIg.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*s4yjVzH-NlkvHfLw4qdEIg.png?w=578&amp;ssl=1\"/></noscript></figure><p>In this puzzle we have data collected from three groups. It is possibly the sales value or ammount. But each group had certain threshold which they have to achieve. This threshold is depicted as the edge of rocky shelf of cliff. We have to find people that in each group are just below or just above threshold (and there can be more than one person who met conditons). Lets do it.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Power Query/PQ_Challenge_146.xlsx\", range = \"A1:D14\")\ntest  = read_excel(\"Power Query/PQ_Challenge_146.xlsx\", range = \"F1:I7\")</pre><h4>Transformation</h4><pre>result = input %&gt;%\n  group_by(Group) %&gt;%\n  mutate(Category = ifelse(Value == Threshold, \"Equal\",\n                           ifelse(Value &gt; Threshold, \"High\", \"Low\"))) %&gt;%\n  ungroup() %&gt;%\n  filter(Category != \"Equal\") %&gt;%\n  group_by(Group, Category) %&gt;%\n  mutate(valid = ifelse(Category == \"High\", min(Value), max(Value))) %&gt;%\n  ungroup() %&gt;%\n  filter(Value == valid) %&gt;%\n  select(-valid, -Category)</pre><h4>Validation</h4><pre>  identical(result, test)\n# [1] TRUE</pre><p>Thanks for your engagement, and let me know if you have any comments.</p><img alt=\"\" data-lazy-src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=4a3364915b4b\" height=\"1\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"1\"/><noscript><img alt=\"\" height=\"1\" loading=\"lazy\" src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=4a3364915b4b\" width=\"1\"/></noscript><hr/><p><a href=\"https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-4a3364915b4b\" rel=\"nofollow\" target=\"_blank\">PowerQuery Puzzle solved with R</a> was originally published in <a href=\"https://medium.com/number-around-us\" rel=\"nofollow\" target=\"_blank\">Numbers around us</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-4a3364915b4b\"> Numbers around us - Medium</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
    "main_text": "PowerQuery Puzzle solved with R\nPosted on\nJanuary 9, 2024\nby\nNumbers around us\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nNumbers around us - Medium\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\n#145–146\nPuzzles\nAuthor:\nExcelBI\nAll files (xlsx with puzzle and R with solution) for each and every puzzle are available on my\nGithub\n. Enjoy.\nPuzzle #145\nThis time our task is to summarise sales from three stores, but there are strings attached. They shouldn’t be just added, but cummulativelly for store and year. But it would be to easy, we need to base year on date of first sale. So each store has it different here. We need to find year ranges for them and then summarise them separately. Let’s try.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Power Query/PQ_Challenge_145.xlsx\", range = \"A1:C16\")\ntest  = read_excel(\"Power Query/PQ_Challenge_145.xlsx\", range = \"F1:I16\")\nTransformation\nresult = input %>%\n  group_by(Store) %>%\n  mutate(min_date = min(Date),\n         year = case_when(\n           between(Date, min_date, min_date + years(1)) ~ 1,\n           between(Date, min_date + years(1), min_date + years(2)) ~ 2,\n           between(Date, min_date + years(2), min_date + years(3)) ~ 3,\n           between(Date, min_date + years(3), min_date + years(4)) ~ 4,\n           between(Date, min_date + years(4), min_date + years(5)) ~ 5\n         )) %>%\n  ungroup()  %>%\n  group_by(Store, year) %>%\n  mutate(Column1 = cumsum(Sale)) %>%\n  ungroup() %>%\n  select(-year, -min_date)\nValidation\nidentical(result, test)\n#> [1] TRUE\nPuzzle #146\nIn this puzzle we have data collected from three groups. It is possibly the sales value or ammount. But each group had certain threshold which they have to achieve. This threshold is depicted as the edge of rocky shelf of cliff. We have to find people that in each group are just below or just above threshold (and there can be more than one person who met conditons). Lets do it.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Power Query/PQ_Challenge_146.xlsx\", range = \"A1:D14\")\ntest  = read_excel(\"Power Query/PQ_Challenge_146.xlsx\", range = \"F1:I7\")\nTransformation\nresult = input %>%\n  group_by(Group) %>%\n  mutate(Category = ifelse(Value == Threshold, \"Equal\",\n                           ifelse(Value > Threshold, \"High\", \"Low\"))) %>%\n  ungroup() %>%\n  filter(Category != \"Equal\") %>%\n  group_by(Group, Category) %>%\n  mutate(valid = ifelse(Category == \"High\", min(Value), max(Value))) %>%\n  ungroup() %>%\n  filter(Value == valid) %>%\n  select(-valid, -Category)\nValidation\nidentical(result, test)\n# [1] TRUE\nThanks for your engagement, and let me know if you have any comments.\nPowerQuery Puzzle solved with R\nwas originally published in\nNumbers around us\non Medium, where people are continuing the conversation by highlighting and responding to this story.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nNumbers around us - Medium\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "#145–146PuzzlesAuthor: ExcelBIAll files (xlsx with puzzle and R with solution) for each and every puzzle are available on my Github. Enjoy.Puzzle #145This time our task is to summarise sales from three stores, but there are strings attached. They shoul...",
    "meta_keywords": null,
    "og_description": "#145–146PuzzlesAuthor: ExcelBIAll files (xlsx with puzzle and R with solution) for each and every puzzle are available on my Github. Enjoy.Puzzle #145This time our task is to summarise sales from three stores, but there are strings attached. They shoul...",
    "og_image": "https://cdn-images-1.medium.com/max/1024/1*uaDnDrzmH6kIFKNFQMZd5A.jpeg",
    "og_title": "PowerQuery Puzzle solved with R | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 2.6,
    "sitemap_lastmod": "2024-01-09T12:30:58+00:00",
    "twitter_description": "#145–146PuzzlesAuthor: ExcelBIAll files (xlsx with puzzle and R with solution) for each and every puzzle are available on my Github. Enjoy.Puzzle #145This time our task is to summarise sales from three stores, but there are strings attached. They shoul...",
    "twitter_title": "PowerQuery Puzzle solved with R | R-bloggers",
    "url": "https://www.r-bloggers.com/2024/01/powerquery-puzzle-solved-with-r-8/",
    "word_count": 520
  }
}