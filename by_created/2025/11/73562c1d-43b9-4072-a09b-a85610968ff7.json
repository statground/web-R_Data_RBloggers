{
  "uuid": "73562c1d-43b9-4072-a09b-a85610968ff7",
  "created_at": "2025-11-17 20:40:43",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2009/07/sometimes-you-just-need-to-use-a-plyr/",
    "crawled_at": "2025-11-17T10:33:05.153157",
    "external_links": [
      {
        "href": "http://www.imachordata.com/?p=148",
        "text": "i'm a chordata! urochordata! » R"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://www.r-project.ork",
        "text": "R"
      },
      {
        "href": "http://had.co.nz/plyr/",
        "text": "plyr"
      },
      {
        "href": "http://www.imachordata.com/?p=148",
        "text": "i'm a chordata! urochordata! » R"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Sometimes, you just need to use a plyr | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2009/07/pliers1.jpg?resize=183%2C68&ssl=1"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2009/07/pliers1.jpg?resize=183%2C68&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/jebyrnes/",
        "text": "jebyrnes"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/tag/coding/",
        "text": "Coding"
      },
      {
        "href": "https://www.r-bloggers.com/tag/plyr/",
        "text": "plyr"
      },
      {
        "href": "https://www.r-bloggers.com/tag/r/",
        "text": "R"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-48123 post type-post status-publish format-standard hentry category-r-bloggers tag-coding tag-plyr tag-r\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Sometimes, you just need to use a plyr</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">July 10, 2009</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/jebyrnes/\">jebyrnes</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<p class=\"syndicated-attribution\"><!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"http://www.imachordata.com/?p=148\"> i'm a chordata! urochordata! » R</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div></p>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.0--><p><img alt=\"\" class=\"alignleft jetpack-lazy-image\" data-lazy-src=\"https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2009/07/pliers1.jpg?resize=183%2C68&amp;is-pending-load=1#038;ssl=1\" data-recalc-dims=\"1\" height=\"68\" loading=\"lazy\" src=\"https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2009/07/pliers1.jpg?resize=183%2C68&amp;ssl=1\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" title=\"plyr\" width=\"183\"/><noscript><img alt=\"\" class=\"alignleft\" data-recalc-dims=\"1\" height=\"68\" loading=\"lazy\" src=\"https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2009/07/pliers1.jpg?resize=183%2C68&amp;ssl=1\" title=\"plyr\" width=\"183\"/></noscript>I haven’t posted anything about <a href=\"https://www.r-project.ork\" rel=\"nofollow\" target=\"_blank\">R</a>-nerdery in quite some time.  But I have to pause for a moment, and sing the praises of a relatively new package that has made my life exponentially easier.  The <a href=\"http://had.co.nz/plyr/\" rel=\"nofollow\" target=\"_blank\">plyr</a> package.  </p>\n<p>R has the capability to apply a single function to a vector or list using apply or mapply, or their various derivatives.  This returns another vector or list.</p>\n<p>This is great in principal, but in practice, with indexing, odd return objects, and difficulties in using multiple arguments, it can get out of hand for complex functions.  Hence, one often resorts to a for loop.</p>\n<p>Let me give you an example.  Let’s say I have some data from a simple experiment where I wanted to look at the effect of adding urchins, lobsters, or both on a diverse community of sessile invertebrates – mussels, squirts, etc.  Heck, let’s say, I had <b>one gazillion species</b> whose responses I was interested in.  Now let’s say I want a simple summary table of the change in the density each species – and my data has before and after values.  So, my data would look like this.</p>\n<p><center></center></p>\n<table>\n<tr>\n<td>Urchins</td>\n<td>Lobsters</td>\n<td>Before.After</td>\n<td>Replicate</td>\n<td>Species</td>\n<td>Density</td>\n</tr>\n<tr>\n<td>Yes</td>\n<td>No</td>\n<td>Before</td>\n<td>1</td>\n<td>1</td>\n<td>30</td>\n</tr>\n<tr>\n<tr>\n<td>Yes</td>\n<td>No</td>\n<td>After</td>\n<td>1</td>\n<td>1</td>\n<td>10</td>\n</tr>\n<tr>\n<tr>\n<td>Yes</td>\n<td>No</td>\n<td>Before</td>\n<td>1</td>\n<td>2</td>\n<td>45</td>\n</tr>\n<tr>\n<tr>\n<td>Yes</td>\n<td>No</td>\n<td>After</td>\n<td>1</td>\n<td>2</td>\n<td>23</td>\n</tr>\n<tr>\n<td colspan=\"7\">.<br/>.<br/>.<br/>.<br/>.</td>\n</tr>\n<tr>\n<td>Yes</td>\n<td>Yes</td>\n<td>Before</td>\n<td>15</td>\n<td>Gazillion</td>\n<td>10</td>\n</tr>\n<tr>\n<tr>\n<td>Yes</td>\n<td>Yes</td>\n<td>After</td>\n<td>15</td>\n<td>Gazillion</td>\n<td>9</td>\n</tr>\n</tr></tr></tr></tr></table>\n<p></p>\n<p>So, each row represents the measurement for one species in one replicate either before or after the experiment.  Now, previously, to get an output table with the mean change for each species for each treatment, I would have had to do something like this:</p>\n<pre>#first, create blank list of vectors waiting to be filled\n#as well as blank vectors to remember what treatment \n#combinations we're looking at\nmean.list&lt;-list()\nurchin.vec&lt;-vector()\nlobster.vec&lt;-vector()\nfor(i in 1:gazillion) mean.list[[paste(\"sp\",i,sep=\".\")]]==vector()\n \n#then, a for loop for each combination\nfor (i in levels(my.data$Urchins)){\n  for (j in levels(my.data$Lobsters)){\n    urchin.vec&lt;-c(urchin.vec,i)\n    lobster.vec&lt;-c(lobster.vec,j)\n    #get the right subset of the data\n    sub.data&lt;-subset(my.data, my.data$Urchins==i &amp; my.data$Lobster==j)\n \n    #now loop over all species\n    for (k in 1:gazillion){ \n    sub.data&lt;-subset(sub.data, sub.data$Species==k)\n    before.data&lt;-subset(sub.data, sub.data$Before.After==\"Before\")\n    after.data&lt;-subset(sub.data, sub.data$Before.After==\"After\")\n    mean.list[[paste(\"sp\",i-3,sep=\".\")]]&lt;-\n\tc(mean.list[[paste(\"sp\",i-3,sep=\".\")]], mean(after.data[k]-before.data[k])\n \n    }\n  }\n}\n \n#then turn it into a data frame to match back up to the right values\nmean.data&lt;-as.data.frame(mean.list)\nmean.data$urchins&lt;-as.factor(urchin.vec)\nmean.data$lobsters&lt;-as.factor(lobster.vec)</pre>\n<p>Ok, did that exhaust you as much it did me?  Now, here’s how to get the same result using ddply (more on why it’s called ddply in a moment)</p>\n<pre>#a function where, if you give it a data frame with species 1 - gazillion\n#will give you the mean for each species.  Note, the which statement\n#lets me look at before and after data separately\n#Also note the Change= in the return value.  That gives a new column name\n#for multiple return columns, just return a vector, with each \n#new column getting it's own name\n \ntab.means&lt;-function(df){ return(Change = \n\t\t\tdf$Density[which($Before.After==\"After\")]\n\t\t\t- df$Density[which($Before.After==\"After\")]) }\n \n#now use ddply\nmean.data&lt;-ddply(df, c(\"Urchins\", \"Lobsters\", \"Species\"), tab.means))\n \n#ok, in fairness, each species doesn't have it's own column.  But, we can \n#just use reshape\nmean.data&lt;-reshape(mean.data, timevar=\"Species\", idvar=c(\"Urchins\", \"Lobsters\", direction=\"wide)</pre>\n<p>Um.  Whoah.  Notice a small difference there.  Now, perhaps the earlier code could have been cleaned up a bit with reshape, but still, 6 lines of code versus 18 – and most of that 18 was bookkeeping code, not something doing real useful computation.</p>\n<p>Soooo…. Check out plyr!  It will make your life a happier, more relaxed place.  Enjoy!</p>\n<p>(p.s. I’m noticing wordpress is ignoring all of my code indenting – anyone have any quick fixes for that?)</p>\n\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->\n<p class=\"syndicated-attribution\"><div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"http://www.imachordata.com/?p=148\"> i'm a chordata! urochordata! » R</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div></p> </div>\n<div class=\"post-tags clearfix\"><ul><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/coding/\" rel=\"tag\">Coding</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/plyr/\" rel=\"tag\">plyr</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/r/\" rel=\"tag\">R</a></li></ul></div></article>",
    "main_text": "Sometimes, you just need to use a plyr\nPosted on\nJuly 10, 2009\nby\njebyrnes\nin\nR bloggers\n| 0 Comments\n[This article was first published on\ni'm a chordata! urochordata! » R\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nI haven’t posted anything about\nR\n-nerdery in quite some time.  But I have to pause for a moment, and sing the praises of a relatively new package that has made my life exponentially easier.  The\nplyr\npackage.\nR has the capability to apply a single function to a vector or list using apply or mapply, or their various derivatives.  This returns another vector or list.\nThis is great in principal, but in practice, with indexing, odd return objects, and difficulties in using multiple arguments, it can get out of hand for complex functions.  Hence, one often resorts to a for loop.\nLet me give you an example.  Let’s say I have some data from a simple experiment where I wanted to look at the effect of adding urchins, lobsters, or both on a diverse community of sessile invertebrates – mussels, squirts, etc.  Heck, let’s say, I had\none gazillion species\nwhose responses I was interested in.  Now let’s say I want a simple summary table of the change in the density each species – and my data has before and after values.  So, my data would look like this.\nUrchins\nLobsters\nBefore.After\nReplicate\nSpecies\nDensity\nYes\nNo\nBefore\n1\n1\n30\nYes\nNo\nAfter\n1\n1\n10\nYes\nNo\nBefore\n1\n2\n45\nYes\nNo\nAfter\n1\n2\n23\n.\n.\n.\n.\n.\nYes\nYes\nBefore\n15\nGazillion\n10\nYes\nYes\nAfter\n15\nGazillion\n9\nSo, each row represents the measurement for one species in one replicate either before or after the experiment.  Now, previously, to get an output table with the mean change for each species for each treatment, I would have had to do something like this:\n#first, create blank list of vectors waiting to be filled\n#as well as blank vectors to remember what treatment \n#combinations we're looking at\nmean.list<-list()\nurchin.vec<-vector()\nlobster.vec<-vector()\nfor(i in 1:gazillion) mean.list[[paste(\"sp\",i,sep=\".\")]]==vector()\n \n#then, a for loop for each combination\nfor (i in levels(my.data$Urchins)){\n  for (j in levels(my.data$Lobsters)){\n    urchin.vec<-c(urchin.vec,i)\n    lobster.vec<-c(lobster.vec,j)\n    #get the right subset of the data\n    sub.data<-subset(my.data, my.data$Urchins==i & my.data$Lobster==j)\n \n    #now loop over all species\n    for (k in 1:gazillion){ \n    sub.data<-subset(sub.data, sub.data$Species==k)\n    before.data<-subset(sub.data, sub.data$Before.After==\"Before\")\n    after.data<-subset(sub.data, sub.data$Before.After==\"After\")\n    mean.list[[paste(\"sp\",i-3,sep=\".\")]]<-\n\tc(mean.list[[paste(\"sp\",i-3,sep=\".\")]], mean(after.data[k]-before.data[k])\n \n    }\n  }\n}\n \n#then turn it into a data frame to match back up to the right values\nmean.data<-as.data.frame(mean.list)\nmean.data$urchins<-as.factor(urchin.vec)\nmean.data$lobsters<-as.factor(lobster.vec)\nOk, did that exhaust you as much it did me?  Now, here’s how to get the same result using ddply (more on why it’s called ddply in a moment)\n#a function where, if you give it a data frame with species 1 - gazillion\n#will give you the mean for each species.  Note, the which statement\n#lets me look at before and after data separately\n#Also note the Change= in the return value.  That gives a new column name\n#for multiple return columns, just return a vector, with each \n#new column getting it's own name\n \ntab.means<-function(df){ return(Change = \n\t\t\tdf$Density[which($Before.After==\"After\")]\n\t\t\t- df$Density[which($Before.After==\"After\")]) }\n \n#now use ddply\nmean.data<-ddply(df, c(\"Urchins\", \"Lobsters\", \"Species\"), tab.means))\n \n#ok, in fairness, each species doesn't have it's own column.  But, we can \n#just use reshape\nmean.data<-reshape(mean.data, timevar=\"Species\", idvar=c(\"Urchins\", \"Lobsters\", direction=\"wide)\nUm.  Whoah.  Notice a small difference there.  Now, perhaps the earlier code could have been cleaned up a bit with reshape, but still, 6 lines of code versus 18 – and most of that 18 was bookkeeping code, not something doing real useful computation.\nSoooo…. Check out plyr!  It will make your life a happier, more relaxed place.  Enjoy!\n(p.s. I’m noticing wordpress is ignoring all of my code indenting – anyone have any quick fixes for that?)\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\ni'm a chordata! urochordata! » R\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nCoding\nplyr\nR",
    "meta_description": "I haven’t posted anything about R-nerdery in quite some time. But I have to pause for a moment, and sing the praises of a relatively new package that has made my life exponentially easier. The plyr package. R has the capability to apply a single function to a vector or list using apply or mapply, [...]",
    "meta_keywords": "coding,plyr,r",
    "og_description": "I haven’t posted anything about R-nerdery in quite some time. But I have to pause for a moment, and sing the praises of a relatively new package that has made my life exponentially easier. The plyr package. R has the capability to apply a single function to a vector or list using apply or mapply, [...]",
    "og_image": "https://www.r-bloggers.com/wp-content/uploads/2009/07/pliers1.jpg",
    "og_title": "Sometimes, you just need to use a plyr | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 4.3,
    "sitemap_lastmod": "2011-05-11T21:16:51+00:00",
    "twitter_description": "I haven’t posted anything about R-nerdery in quite some time. But I have to pause for a moment, and sing the praises of a relatively new package that has made my life exponentially easier. The plyr package. R has the capability to apply a single function to a vector or list using apply or mapply, [...]",
    "twitter_title": "Sometimes, you just need to use a plyr | R-bloggers",
    "url": "https://www.r-bloggers.com/2009/07/sometimes-you-just-need-to-use-a-plyr/",
    "word_count": 863
  }
}