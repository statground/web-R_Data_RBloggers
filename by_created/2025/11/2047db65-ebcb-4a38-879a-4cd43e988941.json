{
  "uuid": "2047db65-ebcb-4a38-879a-4cd43e988941",
  "created_at": "2025-11-17 20:39:05",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2023/11/back-transformations-with-emmeans/",
    "crawled_at": "2025-11-17T09:44:38.399771",
    "external_links": [
      {
        "href": "https://www.statforbiology.com/2023/stat_emmeans_backtransform/",
        "text": "R on The broken bridge between biologists and statisticians"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://twitter.com/onofriandreapg?ref_src=twsrc%5Etfw",
        "text": "Follow@onofriandreapg"
      },
      {
        "href": "https://www.statforbiology.com/2023/stat_emmeans_backtransform/",
        "text": "R on The broken bridge between biologists and statisticians"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Back-transformations with emmeans() | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/www.statforbiology.com/post/Stat_emmeans_backTransform_files/figure-html/unnamed-chunk-2-1.png?w=450&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/r-on-the-broken-bridge-between-biologists-and-stat/",
        "text": "R on The broken bridge between biologists and statisticians"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/cdn-cgi/l/email-protection#6f0e010b1d0a0e41000100091d062f1a01061f0841061b",
        "text": "[email protected]"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-380445 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Back-transformations with emmeans()</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">November 29, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/r-on-the-broken-bridge-between-biologists-and-stat/\">R on The broken bridge between biologists and statisticians</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://www.statforbiology.com/2023/stat_emmeans_backtransform/\"> R on The broken bridge between biologists and statisticians</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<p>I am one of those old guys who still uses the stabilising transformations, when the data do not conform to the basic assumptions for ANOVA. Indeed, apart from counts and proportions, where GLMs can be very useful, I have not yet found a simple way to deal with heteroscedasticity for continuous variables, such as yield, weight, height and so on. Yes, I know, Generalised Least Squares (GLS) can be useful to fit heteroscedastic models, but I would argue that stabilising transformations are, conceptually, very much simpler and they can be easily thought to PhD students and practitioners, with only a basic level of knowledge about statistics.</p>\n<p>In the recent past, the package <code>emmeans</code> gave me a big boost for its useful way to handle back-transformations. For example, in the box below, I have performed an ANOVA on log-transformed data and retrieved the back-transformed means on the original count scale.</p>\n<pre>library(emmeans)\nfileName &lt;- \"http://www.casaonofri.it/_datasets/insects.csv\"\ndataset &lt;- read.csv(fileName)\nhead(dataset)\n##   Insecticide Rep Count\n## 1          T1   1   448\n## 2          T1   2   906\n## 3          T1   3   484\n## 4          T1   4   477\n## 5          T1   5   634\n## 6          T2   1   211\nmodel &lt;- lm(log(Count) ~ Insecticide, data = dataset)\nemmeans(model, ~Insecticide, type = \"response\")\n##  Insecticide response     SE df lower.CL upper.CL\n##  T1             568.6 101.01 12    386.1    837.3\n##  T2             335.1  59.54 12    227.6    493.5\n##  T3              51.9   9.22 12     35.2     76.4\n## \n## Confidence level used: 0.95 \n## Intervals are back-transformed from the log scale</pre>\n<p>It is very simple: <code>emmeans</code> auto-detects the transformation function (which is made inside the model specification) and automatically produces the back-transformation, when this is requested by using the ‘<code>type = \"response\"</code>’ argument (we can also use the argument ‘<code>regrid = \"response\"</code>’, with slight differences that I will discuss in a future post).</p>\n<p>Unfortunately, not all transformations are auto-detected; for example, let’s consider the dataset ‘Hours_to_failure.csv’, where we have the time-to-failure (in hours) for a device, as affected by the operating temperature. If we regard the temperature as a factor, we can fit an ANOVA model; a check with the <code>boxcox()</code> function in the MASS package suggests that this dataset might require a stabilising transformation into the inverse value.</p>\n<pre>library(MASS)\nlibrary(emmeans)\nfileName &lt;- \"http://www.casaonofri.it/_datasets/Hours_to_failure.csv\"\ndataset &lt;- read.csv(fileName)\ndataset$Temp &lt;- factor(dataset$Temp)\nhead(dataset)\n##   Temp Hours_to_failure\n## 1 1520             1953\n## 2 1520             2135\n## 3 1520             2471\n## 4 1520             4727\n## 5 1520             6134\n## 6 1520             6314\nmodel &lt;- lm(Hours_to_failure ~ Temp, data = dataset)\ntp &lt;- boxcox(model)</pre>\n<p><img data-lazy-src=\"https://i1.wp.com/www.statforbiology.com/post/Stat_emmeans_backTransform_files/figure-html/unnamed-chunk-2-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img data-recalc-dims=\"1\" src=\"https://i1.wp.com/www.statforbiology.com/post/Stat_emmeans_backTransform_files/figure-html/unnamed-chunk-2-1.png?w=450&amp;ssl=1\"/></noscript></p>\n<p>As we see below, the inverse transformation is not auto-detected.</p>\n<pre>model2 &lt;- lm(I(1/Hours_to_failure) ~ Temp, data = dataset)\nemmeans(model2, ~ Temp, type = \"response\")\n##  Temp response       SE df lower.CL upper.CL\n##  1520 0.000320 9.52e-05 20 0.000121 0.000518\n##  1620 0.000579 9.52e-05 20 0.000381 0.000778\n##  1660 0.001043 9.52e-05 20 0.000844 0.001241\n##  1708 0.001565 9.52e-05 20 0.001366 0.001763\n## \n## Confidence level used: 0.95 \n## Intervals are back-transformed from the identity scale</pre>\n<p>In this situation, an alternative approach must be used. The transformation can be made prior to fitting the model; next, we need to update the ‘reference grid’ for the model, specifying what type of transformation we have made (<code>tran = \"inverse\"</code>). Finally, we can pass the updated grid into the <code>emmeans()</code> function. And … the back-transformation is served!</p>\n<pre>dataset$invHours &lt;- 1/dataset$Hours_to_failure\nmodel3 &lt;- lm(invHours ~ Temp, data = dataset)\nupdGrid &lt;- update(ref_grid(model3), tran = \"inverse\")\nemmeans(updGrid, ~Temp, type = \"response\")\n##  Temp response    SE df lower.CL upper.CL\n##  1520     3128 931.6 20     1930     8258\n##  1620     1726 283.6 20     1285     2626\n##  1660      959  87.6 20      806     1185\n##  1708      639  38.9 20      567      732\n## \n## Confidence level used: 0.95 \n## Intervals are back-transformed from the inverse scale</pre>\n<p>I can use this method with several functions, such as: “identity”, “1/mu^2”, “inverse”, “reciprocal”, “log10”, “log2”, “asin.sqrt”, and “asinh.sqrt”.</p>\n<p>Sometimes, I need extra-flexibility. For example, if we look at ‘boxcox’ graph above, we see that the inverse transformation, although acceptable (the value <span class=\"math inline\">\\(-1\\)</span> is within the confidence limits for <span class=\"math inline\">\\(\\lambda\\)</span>) is not the best one. Indeed, the maximum likelihood value is -0.62:</p>\n<pre>tp$x[which.max(tp$y)]\n## [1] -0.6262626</pre>\n<p>Therefore, we might like to use the following transformation, that is within the ‘boxcox’ family:</p>\n<p><span class=\"math display\">\\[W = \\frac{Y^{-0.62} - 1}{-0.62}\\]</span></p>\n<p>This type of transformation is not manageable with the previous code and we need to use the <code>make.tran()</code> function, specifying the value of <span class=\"math inline\">\\(\\lambda\\)</span> (<code>alpha = -0.62</code>) and the value of the displacement parameter (<code>beta = 1</code>).</p>\n<pre>dataset$bcHours &lt;- (dataset$Hours_to_failure^(-0.62) - 1)/(-0.62)\nmodel4 &lt;- lm(bcHours ~ Temp, data = dataset)\nupdGrid &lt;- update(ref_grid(model4), \n                  tran = make.tran(\"boxcox\", alpha = -0.62,\n                                   beta = 1))\nemmeans(updGrid, ~Temp, type = \"response\")\n##  Temp response    SE df lower.CL upper.CL\n##  1520     3265 708.8 20     2191     5556\n##  1620     1763 260.9 20     1329     2483\n##  1660      976 100.0 20      798     1227\n##  1708      642  50.7 20      549      764\n## \n## Confidence level used: 0.95 \n## Intervals are back-transformed from the Box-Cox (lambda = -0.62) of (y - 1) scale</pre>\n<p>The function <code>make.tran()</code> can be used to specify several other transformation functions, such as the angular transformation that is often used for percentages and proportions. You can get a full list by searching help (‘?make.tran’) from inside R.</p>\n<p>In conclusion, stabilising transformations, in spite of their age, can still be useful to fit heteroscedastic models; do not underrate them, just because they are no longer in fashion!</p>\n<p>Thanks for reading!</p>\n<p>Prof. Andrea Onofri<br/>\nDepartment of Agricultural, Food and Environmental Sciences<br/>\nUniversity of Perugia (Italy)<br/>\nSend comments to: <a href=\"/cdn-cgi/l/email-protection#6f0e010b1d0a0e41000100091d062f1a01061f0841061b\" rel=\"nofollow\" target=\"_blank\"><span class=\"__cf_email__\" data-cfemail=\"7e1f101a0c1b1f50111011180c173e0b10170e1950170a\">[email protected]</span></a></p>\n<a class=\"twitter-follow-button\" data-show-count=\"false\" href=\"https://twitter.com/onofriandreapg?ref_src=twsrc%5Etfw\" rel=\"nofollow\" target=\"_blank\">Follow <span class=\"citation\">@onofriandreapg</span></a>\n\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://www.statforbiology.com/2023/stat_emmeans_backtransform/\"> R on The broken bridge between biologists and statisticians</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
    "main_text": "Back-transformations with emmeans()\nPosted on\nNovember 29, 2023\nby\nR on The broken bridge between biologists and statisticians\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nR on The broken bridge between biologists and statisticians\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nI am one of those old guys who still uses the stabilising transformations, when the data do not conform to the basic assumptions for ANOVA. Indeed, apart from counts and proportions, where GLMs can be very useful, I have not yet found a simple way to deal with heteroscedasticity for continuous variables, such as yield, weight, height and so on. Yes, I know, Generalised Least Squares (GLS) can be useful to fit heteroscedastic models, but I would argue that stabilising transformations are, conceptually, very much simpler and they can be easily thought to PhD students and practitioners, with only a basic level of knowledge about statistics.\nIn the recent past, the package\nemmeans\ngave me a big boost for its useful way to handle back-transformations. For example, in the box below, I have performed an ANOVA on log-transformed data and retrieved the back-transformed means on the original count scale.\nlibrary(emmeans)\nfileName <- \"http://www.casaonofri.it/_datasets/insects.csv\"\ndataset <- read.csv(fileName)\nhead(dataset)\n##   Insecticide Rep Count\n## 1          T1   1   448\n## 2          T1   2   906\n## 3          T1   3   484\n## 4          T1   4   477\n## 5          T1   5   634\n## 6          T2   1   211\nmodel <- lm(log(Count) ~ Insecticide, data = dataset)\nemmeans(model, ~Insecticide, type = \"response\")\n##  Insecticide response     SE df lower.CL upper.CL\n##  T1             568.6 101.01 12    386.1    837.3\n##  T2             335.1  59.54 12    227.6    493.5\n##  T3              51.9   9.22 12     35.2     76.4\n## \n## Confidence level used: 0.95 \n## Intervals are back-transformed from the log scale\nIt is very simple:\nemmeans\nauto-detects the transformation function (which is made inside the model specification) and automatically produces the back-transformation, when this is requested by using the ‘\ntype = \"response\"\n’ argument (we can also use the argument ‘\nregrid = \"response\"\n’, with slight differences that I will discuss in a future post).\nUnfortunately, not all transformations are auto-detected; for example, let’s consider the dataset ‘Hours_to_failure.csv’, where we have the time-to-failure (in hours) for a device, as affected by the operating temperature. If we regard the temperature as a factor, we can fit an ANOVA model; a check with the\nboxcox()\nfunction in the MASS package suggests that this dataset might require a stabilising transformation into the inverse value.\nlibrary(MASS)\nlibrary(emmeans)\nfileName <- \"http://www.casaonofri.it/_datasets/Hours_to_failure.csv\"\ndataset <- read.csv(fileName)\ndataset$Temp <- factor(dataset$Temp)\nhead(dataset)\n##   Temp Hours_to_failure\n## 1 1520             1953\n## 2 1520             2135\n## 3 1520             2471\n## 4 1520             4727\n## 5 1520             6134\n## 6 1520             6314\nmodel <- lm(Hours_to_failure ~ Temp, data = dataset)\ntp <- boxcox(model)\nAs we see below, the inverse transformation is not auto-detected.\nmodel2 <- lm(I(1/Hours_to_failure) ~ Temp, data = dataset)\nemmeans(model2, ~ Temp, type = \"response\")\n##  Temp response       SE df lower.CL upper.CL\n##  1520 0.000320 9.52e-05 20 0.000121 0.000518\n##  1620 0.000579 9.52e-05 20 0.000381 0.000778\n##  1660 0.001043 9.52e-05 20 0.000844 0.001241\n##  1708 0.001565 9.52e-05 20 0.001366 0.001763\n## \n## Confidence level used: 0.95 \n## Intervals are back-transformed from the identity scale\nIn this situation, an alternative approach must be used. The transformation can be made prior to fitting the model; next, we need to update the ‘reference grid’ for the model, specifying what type of transformation we have made (\ntran = \"inverse\"\n). Finally, we can pass the updated grid into the\nemmeans()\nfunction. And … the back-transformation is served!\ndataset$invHours <- 1/dataset$Hours_to_failure\nmodel3 <- lm(invHours ~ Temp, data = dataset)\nupdGrid <- update(ref_grid(model3), tran = \"inverse\")\nemmeans(updGrid, ~Temp, type = \"response\")\n##  Temp response    SE df lower.CL upper.CL\n##  1520     3128 931.6 20     1930     8258\n##  1620     1726 283.6 20     1285     2626\n##  1660      959  87.6 20      806     1185\n##  1708      639  38.9 20      567      732\n## \n## Confidence level used: 0.95 \n## Intervals are back-transformed from the inverse scale\nI can use this method with several functions, such as: “identity”, “1/mu^2”, “inverse”, “reciprocal”, “log10”, “log2”, “asin.sqrt”, and “asinh.sqrt”.\nSometimes, I need extra-flexibility. For example, if we look at ‘boxcox’ graph above, we see that the inverse transformation, although acceptable (the value\n\\(-1\\)\nis within the confidence limits for\n\\(\\lambda\\)\n) is not the best one. Indeed, the maximum likelihood value is -0.62:\ntp$x[which.max(tp$y)]\n## [1] -0.6262626\nTherefore, we might like to use the following transformation, that is within the ‘boxcox’ family:\n\\[W = \\frac{Y^{-0.62} - 1}{-0.62}\\]\nThis type of transformation is not manageable with the previous code and we need to use the\nmake.tran()\nfunction, specifying the value of\n\\(\\lambda\\)\n(\nalpha = -0.62\n) and the value of the displacement parameter (\nbeta = 1\n).\ndataset$bcHours <- (dataset$Hours_to_failure^(-0.62) - 1)/(-0.62)\nmodel4 <- lm(bcHours ~ Temp, data = dataset)\nupdGrid <- update(ref_grid(model4), \n                  tran = make.tran(\"boxcox\", alpha = -0.62,\n                                   beta = 1))\nemmeans(updGrid, ~Temp, type = \"response\")\n##  Temp response    SE df lower.CL upper.CL\n##  1520     3265 708.8 20     2191     5556\n##  1620     1763 260.9 20     1329     2483\n##  1660      976 100.0 20      798     1227\n##  1708      642  50.7 20      549      764\n## \n## Confidence level used: 0.95 \n## Intervals are back-transformed from the Box-Cox (lambda = -0.62) of (y - 1) scale\nThe function\nmake.tran()\ncan be used to specify several other transformation functions, such as the angular transformation that is often used for percentages and proportions. You can get a full list by searching help (‘?make.tran’) from inside R.\nIn conclusion, stabilising transformations, in spite of their age, can still be useful to fit heteroscedastic models; do not underrate them, just because they are no longer in fashion!\nThanks for reading!\nProf. Andrea Onofri\nDepartment of Agricultural, Food and Environmental Sciences\nUniversity of Perugia (Italy)\nSend comments to:\n[email protected]\nFollow\n@onofriandreapg\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nR on The broken bridge between biologists and statisticians\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "I am one of those old guys who still uses the stabilising transformations, when the data do not conform to the basic assumptions for ANOVA. Indeed, apart from counts and proportions, where GLMs can be very useful, I have not yet found a simple way t...",
    "meta_keywords": null,
    "og_description": "I am one of those old guys who still uses the stabilising transformations, when the data do not conform to the basic assumptions for ANOVA. Indeed, apart from counts and proportions, where GLMs can be very useful, I have not yet found a simple way t...",
    "og_image": "https://www.statforbiology.com/post/Stat_emmeans_backTransform_files/figure-html/unnamed-chunk-2-1.png",
    "og_title": "Back-transformations with emmeans() | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 5.6,
    "sitemap_lastmod": "2023-11-30T00:00:00+00:00",
    "twitter_description": "I am one of those old guys who still uses the stabilising transformations, when the data do not conform to the basic assumptions for ANOVA. Indeed, apart from counts and proportions, where GLMs can be very useful, I have not yet found a simple way t...",
    "twitter_title": "Back-transformations with emmeans() | R-bloggers",
    "url": "https://www.r-bloggers.com/2023/11/back-transformations-with-emmeans/",
    "word_count": 1128
  }
}