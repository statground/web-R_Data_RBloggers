{
  "id": "83ba611c4eb250871d43525f275c454fd65f6c23",
  "url": "https://www.r-bloggers.com/2023/12/r-solution-for-excel-puzzles-4/",
  "created_at_utc": "2025-11-17T20:38:50Z",
  "data": null,
  "raw_original": {
    "uuid": "226d1907-cbbb-4f12-9b58-58996daae6e0",
    "created_at": "2025-11-17 20:38:50",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2023/12/r-solution-for-excel-puzzles-4/",
      "crawled_at": "2025-11-17T09:32:08.424117",
      "external_links": [
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-6a66c3631f37",
          "text": "Numbers around us - Medium"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://www.linkedin.com/in/excelbi/",
          "text": "ExcelBI"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7139826139807608832-wEOd",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/dmBeJcCH",
          "text": "file"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7140188530521157633-0Evm",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/dPBNkQh8",
          "text": "file"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7140550913924018176-bWKk",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/dQCjfYEQ",
          "text": "file"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7140913305975521281-I89e",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/d533Sxxw",
          "text": "file"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7141275691672662016-DMNt",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/debfV4Qd",
          "text": "file"
        },
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-6a66c3631f37",
          "text": "R Solution for Excel Puzzles"
        },
        {
          "href": "https://medium.com/number-around-us",
          "text": "Numbers around us"
        },
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-6a66c3631f37",
          "text": "Numbers around us - Medium"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "R Solution for Excel Puzzles | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*_Q6xHjNCQA3dXB8iBP_RNQ.jpeg?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*eudy2oKdlMZPtgniy1IAdw.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*CNzhCuLAVBAq9xThy000qg.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*MLUuBK3VpE9hhLTv2Yu32A.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*3eRW-_fHTL8wY29uzL6D9g.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*pA8DPYvx0EW0neVawAdvtQ.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": "data:application/octet-stream;base64,R0lGODlhAQABAO+/vQAA77+977+977+9AAAAIe+/vQQBAAAAACwAAAAAAQABAAACAkQBADs=",
          "src": "https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=6a66c3631f37"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/numbers-around-us/",
          "text": "Numbers around us"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-380943 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">R Solution for Excel Puzzles</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 18, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/numbers-around-us/\">Numbers around us</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-6a66c3631f37\"> Numbers around us - Medium</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><p>Puzzles no. 339–343</p><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*_Q6xHjNCQA3dXB8iBP_RNQ.jpeg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*_Q6xHjNCQA3dXB8iBP_RNQ.jpeg?w=578&amp;ssl=1\"/></noscript></figure><h3>Puzzles</h3><p>Author: <a href=\"https://www.linkedin.com/in/excelbi/\" rel=\"nofollow\" target=\"_blank\">ExcelBI</a></p><p>Puzzles:<br/>#344: <a href=\"https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7139826139807608832-wEOd\" rel=\"nofollow\" target=\"_blank\">content </a><a href=\"https://lnkd.in/dmBeJcCH\" rel=\"nofollow\" target=\"_blank\">file</a><br/>#345: <a href=\"https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7140188530521157633-0Evm\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dPBNkQh8\" rel=\"nofollow\" target=\"_blank\">file</a><br/>#346: <a href=\"https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7140550913924018176-bWKk\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dQCjfYEQ\" rel=\"nofollow\" target=\"_blank\">file</a><br/>#347: <a href=\"https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7140913305975521281-I89e\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/d533Sxxw\" rel=\"nofollow\" target=\"_blank\">file</a><br/>#348: <a href=\"https://www.linkedin.com/posts/excelbi_excel-challenge-problem-activity-7141275691672662016-DMNt\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/debfV4Qd\" rel=\"nofollow\" target=\"_blank\">file</a></p><p>Let dig in those numbers.</p><h3>Puzzle #344</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*eudy2oKdlMZPtgniy1IAdw.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*eudy2oKdlMZPtgniy1IAdw.png?w=578&amp;ssl=1\"/></noscript></figure><p>I am sure that you have heard about palindrome, but did you know katadromes? I haven’t heard about it before this puzzle. And what it is? Number in which digits are decreasing from start to end. And they have to decrease strictly so 432 will be katadrome, but 4332 will not because difference between second and third digit is equal 0.</p><p>So let go to puzzle.</p><h4>Loading data and libraries</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Katadrome Numbers.xlsx\", range = \"A1:A10\")\ntest  = read_excel(\"Katadrome Numbers.xlsx\", range = \"B1:B5\")</pre><h4>Transformations</h4><p>We are checking if difference for each pair of consecutive digits is strictly lower than 0.</p><pre>is_katadrome = function(x) {\n  digits = x %&gt;% as.character(n) %&gt;%\n    str_split(\"\") %&gt;%\n    .[[1]] %&gt;%\n    map_dbl(as.numeric) \n  \n  digits %&gt;% diff() %&gt;% all(. &lt; 0)\n  }\n\nresult = input %&gt;%\n  mutate(`Answer Expected` = map_dbl(Numbers, is_katadrome)) %&gt;%\n  filter(`Answer Expected` == 1)  </pre><h4>Verification</h4><pre>identical(result$Numbers, test$`Answer Expected`)\n#&gt; [1] TRUE</pre><h3>Puzzle #345</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*CNzhCuLAVBAq9xThy000qg.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*CNzhCuLAVBAq9xThy000qg.png?w=578&amp;ssl=1\"/></noscript></figure><p>In this puzzle we were given three tables and three values. And we have to make some number geometry acrobatics: add digits of numbers placed on diagonals. So if we need diagonals my first thought was about… matrices.</p><p>Lets do it.</p><h4>Load data and libraries</h4><pre>library(tidyverse)\nlibrary(readxl)\n\nM1 = read_excel(\"Matrix Sum of Diagonal Digits.xlsx\", range = \"A2:B3\", col_names = F) %&gt;% as.matrix()\nM2 = read_excel(\"Matrix Sum of Diagonal Digits.xlsx\", range = \"A7:D10\", col_names = F) %&gt;% as.matrix()\nM3 = read_excel(\"Matrix Sum of Diagonal Digits.xlsx\", range = \"A13:E17\", col_names = F) %&gt;% as.matrix()\n\nA1 = 47\nA2 = 205\nA3 = 236</pre><h4>Transformation and validation</h4><p>We have diag() function exactly for what we need.</p><pre>diagonals_sum_of_digits = function(M) {\n  d1 = diag(M)\n  d2 = diag(M[, ncol(M):1]) # to get second diagonal we have to flip matrix :)\n  s1 = sum(as.numeric(unlist(strsplit(as.character(d1), \"\"))))\n  s2 = sum(as.numeric(unlist(strsplit(as.character(d2), \"\"))))\n  return(s1 + s2)\n} \n\nidentical(diagonals_sum_of_digits(M1), A1)\n# [1] TRUE\nidentical(diagonals_sum_of_digits(M2), A2)\n# [1] TRUE\nidentical(diagonals_sum_of_digits(M3), A3)\n# [1] TRUE</pre><h3>Puzzle #346</h3><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*MLUuBK3VpE9hhLTv2Yu32A.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*MLUuBK3VpE9hhLTv2Yu32A.png?w=578&amp;ssl=1\"/></noscript></figure><p>Again we have to mess with some letters. Imagine that all consonants are becoming small black holes, and trying to suck inside but only one closest vowel to fill it. Sounds weird but now we have to code it.</p><h4>Load data and libraries</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Vowel Replacement_2.xlsx\", range = \"A1:A11\")\ntest  = read_excel(\"Vowel Replacement_2.xlsx\", range = \"B1:B11\")</pre><h4>Tranformation</h4><pre>closest_vowel &lt;- function(word) {\n  vowels &lt;- c(\"a\", \"e\", \"i\", \"o\", \"u\")\n  word_chars &lt;- str_split(word, \"\")[[1]]\n  \n  find_vowel &lt;- function(char) {\n    is_upper &lt;- identical(char, toupper(char))\n    char_lower &lt;- tolower(char)\n    \n    if (char_lower %in% vowels) {\n      return(char)\n    } else {\n      distances &lt;- abs(match(char_lower, letters) - match(vowels, letters))\n      closest &lt;- which.min(distances)\n      if (length(closest) &gt; 1) {\n        closest &lt;- closest[1]\n      }\n      vowel &lt;- vowels[closest]\n      if (is_upper) vowel &lt;- toupper(vowel)\n      return(vowel)\n    }\n  }\n  \n  transformed_chars &lt;- map_chr(word_chars, find_vowel)\n  paste0(transformed_chars, collapse = \"\")\n}\n\nresult = input %&gt;%\n  mutate(Result = map_chr(String, closest_vowel)) %&gt;%\n  select(-String)</pre><h4>Validation</h4><pre>identical(result$Result, test$Result)\n# [1] TRUE</pre><h3>Puzzle #347</h3><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*3eRW-_fHTL8wY29uzL6D9g.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*3eRW-_fHTL8wY29uzL6D9g.png?w=578&amp;ssl=1\"/></noscript></figure><p>We are provided with 4 chains of numbers and from each chain we have to extract longest possible chain of consecutive numbers.</p><p>Lets do it!</p><h4>Load data and libraries</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Max Consecutive Numbers.xlsx\", range = \"A1:D20\")\ntest  = read_excel(\"Max Consecutive Numbers.xlsx\", range = \"F2:I21\")</pre><h4>Transformation</h4><pre>find_cons_series = function(column) {\n  \n  series_df = tibble(\n    number = column,\n    lagged = lag(column),\n    diff = abs(column - lag(column))\n  ) %&gt;%\n    filter(diff == 1) %&gt;%\n    mutate(series_diff = abs(number - lag(number, default = 1)),\n           series = cumsum(ifelse(series_diff != 1, 1, 0))\n           ) %&gt;%\n    group_by(series) %&gt;%\n    summarise(start = first(lagged),\n              end = last(number),\n              length = n()) %&gt;%\n    ungroup() %&gt;%\n    arrange(desc(length)) \n  \n  longest_series = first(series_df)\n  sequence = seq(longest_series$start, longest_series$end)\n  \n  return(sequence)\n}\n\ncolumns = colnames(input)\n\nresult = map(columns, ~find_cons_series(input[[.x]])) %&gt;%\n  map(~c(., rep(NA, 19 - length(.)))) %&gt;%\n  bind_cols() %&gt;%\n  set_names(columns) %&gt;%\n  mutate_all(as.numeric)</pre><h4>Validation</h4><pre>identical(result, test)\n#&gt; [1] TRUE</pre><h3>Puzzle #348</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*pA8DPYvx0EW0neVawAdvtQ.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*pA8DPYvx0EW0neVawAdvtQ.png?w=578&amp;ssl=1\"/></noscript></figure><p>Have you heard of language game of Pig Latin? In this game you are mutilating… sorry modifying words by cutting it by first vowel, putting this first part at the end and adding “ay” at the very end. Looks difficult, but code is suprisingly short.</p><h4>Load data and libraries</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Pig Latin Cipher.xlsx\", range = \"A1:A10\") %&gt;% janitor::clean_names()\ntest = read_excel(\"Pig Latin Cipher.xlsx\", range = \"B1:B10\") %&gt;% janitor::clean_names()</pre><h4>Modification</h4><pre>pigify = function(word) {\n  chars = str_split(word, \"\")[[1]]\n  vowels = c(\"a\", \"e\", \"i\", \"o\", \"u\")\n  first_vowel = which(chars %in% vowels)[1]\n  \n  if (is.na(first_vowel)) {\n    return(paste0(word, \"ay\"))\n  }\n  else {\n    return(paste0(substr(word, first_vowel, nchar(word)), substr(word, 1, first_vowel - 1), \"ay\"))\n  }\n}\n\nresult = input %&gt;%\n  mutate(answer_expected = str_replace_all(text, \"\\\\w+\", pigify)) </pre><h4>Verification</h4><pre>identical(result$answer_expected, test$answer_expected)</pre><p>Feel free to comment, share and contact me with advices, questions and your ideas how to improve anything.</p><img alt=\"\" data-lazy-src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=6a66c3631f37\" height=\"1\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"1\"/><noscript><img alt=\"\" height=\"1\" loading=\"lazy\" src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=6a66c3631f37\" width=\"1\"/></noscript><hr/><p><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-6a66c3631f37\" rel=\"nofollow\" target=\"_blank\">R Solution for Excel Puzzles</a> was originally published in <a href=\"https://medium.com/number-around-us\" rel=\"nofollow\" target=\"_blank\">Numbers around us</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-6a66c3631f37\"> Numbers around us - Medium</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
      "main_text": "R Solution for Excel Puzzles\nPosted on\nDecember 18, 2023\nby\nNumbers around us\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nNumbers around us - Medium\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nPuzzles no. 339–343\nPuzzles\nAuthor:\nExcelBI\nPuzzles:\n#344:\ncontent\nfile\n#345:\ncontent\nfile\n#346:\ncontent\nfile\n#347:\ncontent\nfile\n#348:\ncontent\nfile\nLet dig in those numbers.\nPuzzle #344\nI am sure that you have heard about palindrome, but did you know katadromes? I haven’t heard about it before this puzzle. And what it is? Number in which digits are decreasing from start to end. And they have to decrease strictly so 432 will be katadrome, but 4332 will not because difference between second and third digit is equal 0.\nSo let go to puzzle.\nLoading data and libraries\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Katadrome Numbers.xlsx\", range = \"A1:A10\")\ntest  = read_excel(\"Katadrome Numbers.xlsx\", range = \"B1:B5\")\nTransformations\nWe are checking if difference for each pair of consecutive digits is strictly lower than 0.\nis_katadrome = function(x) {\n  digits = x %>% as.character(n) %>%\n    str_split(\"\") %>%\n    .[[1]] %>%\n    map_dbl(as.numeric) \n  \n  digits %>% diff() %>% all(. < 0)\n  }\n\nresult = input %>%\n  mutate(`Answer Expected` = map_dbl(Numbers, is_katadrome)) %>%\n  filter(`Answer Expected` == 1)\nVerification\nidentical(result$Numbers, test$`Answer Expected`)\n#> [1] TRUE\nPuzzle #345\nIn this puzzle we were given three tables and three values. And we have to make some number geometry acrobatics: add digits of numbers placed on diagonals. So if we need diagonals my first thought was about… matrices.\nLets do it.\nLoad data and libraries\nlibrary(tidyverse)\nlibrary(readxl)\n\nM1 = read_excel(\"Matrix Sum of Diagonal Digits.xlsx\", range = \"A2:B3\", col_names = F) %>% as.matrix()\nM2 = read_excel(\"Matrix Sum of Diagonal Digits.xlsx\", range = \"A7:D10\", col_names = F) %>% as.matrix()\nM3 = read_excel(\"Matrix Sum of Diagonal Digits.xlsx\", range = \"A13:E17\", col_names = F) %>% as.matrix()\n\nA1 = 47\nA2 = 205\nA3 = 236\nTransformation and validation\nWe have diag() function exactly for what we need.\ndiagonals_sum_of_digits = function(M) {\n  d1 = diag(M)\n  d2 = diag(M[, ncol(M):1]) # to get second diagonal we have to flip matrix :)\n  s1 = sum(as.numeric(unlist(strsplit(as.character(d1), \"\"))))\n  s2 = sum(as.numeric(unlist(strsplit(as.character(d2), \"\"))))\n  return(s1 + s2)\n} \n\nidentical(diagonals_sum_of_digits(M1), A1)\n# [1] TRUE\nidentical(diagonals_sum_of_digits(M2), A2)\n# [1] TRUE\nidentical(diagonals_sum_of_digits(M3), A3)\n# [1] TRUE\nPuzzle #346\nAgain we have to mess with some letters. Imagine that all consonants are becoming small black holes, and trying to suck inside but only one closest vowel to fill it. Sounds weird but now we have to code it.\nLoad data and libraries\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Vowel Replacement_2.xlsx\", range = \"A1:A11\")\ntest  = read_excel(\"Vowel Replacement_2.xlsx\", range = \"B1:B11\")\nTranformation\nclosest_vowel <- function(word) {\n  vowels <- c(\"a\", \"e\", \"i\", \"o\", \"u\")\n  word_chars <- str_split(word, \"\")[[1]]\n  \n  find_vowel <- function(char) {\n    is_upper <- identical(char, toupper(char))\n    char_lower <- tolower(char)\n    \n    if (char_lower %in% vowels) {\n      return(char)\n    } else {\n      distances <- abs(match(char_lower, letters) - match(vowels, letters))\n      closest <- which.min(distances)\n      if (length(closest) > 1) {\n        closest <- closest[1]\n      }\n      vowel <- vowels[closest]\n      if (is_upper) vowel <- toupper(vowel)\n      return(vowel)\n    }\n  }\n  \n  transformed_chars <- map_chr(word_chars, find_vowel)\n  paste0(transformed_chars, collapse = \"\")\n}\n\nresult = input %>%\n  mutate(Result = map_chr(String, closest_vowel)) %>%\n  select(-String)\nValidation\nidentical(result$Result, test$Result)\n# [1] TRUE\nPuzzle #347\nWe are provided with 4 chains of numbers and from each chain we have to extract longest possible chain of consecutive numbers.\nLets do it!\nLoad data and libraries\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Max Consecutive Numbers.xlsx\", range = \"A1:D20\")\ntest  = read_excel(\"Max Consecutive Numbers.xlsx\", range = \"F2:I21\")\nTransformation\nfind_cons_series = function(column) {\n  \n  series_df = tibble(\n    number = column,\n    lagged = lag(column),\n    diff = abs(column - lag(column))\n  ) %>%\n    filter(diff == 1) %>%\n    mutate(series_diff = abs(number - lag(number, default = 1)),\n           series = cumsum(ifelse(series_diff != 1, 1, 0))\n           ) %>%\n    group_by(series) %>%\n    summarise(start = first(lagged),\n              end = last(number),\n              length = n()) %>%\n    ungroup() %>%\n    arrange(desc(length)) \n  \n  longest_series = first(series_df)\n  sequence = seq(longest_series$start, longest_series$end)\n  \n  return(sequence)\n}\n\ncolumns = colnames(input)\n\nresult = map(columns, ~find_cons_series(input[[.x]])) %>%\n  map(~c(., rep(NA, 19 - length(.)))) %>%\n  bind_cols() %>%\n  set_names(columns) %>%\n  mutate_all(as.numeric)\nValidation\nidentical(result, test)\n#> [1] TRUE\nPuzzle #348\nHave you heard of language game of Pig Latin? In this game you are mutilating… sorry modifying words by cutting it by first vowel, putting this first part at the end and adding “ay” at the very end. Looks difficult, but code is suprisingly short.\nLoad data and libraries\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Pig Latin Cipher.xlsx\", range = \"A1:A10\") %>% janitor::clean_names()\ntest = read_excel(\"Pig Latin Cipher.xlsx\", range = \"B1:B10\") %>% janitor::clean_names()\nModification\npigify = function(word) {\n  chars = str_split(word, \"\")[[1]]\n  vowels = c(\"a\", \"e\", \"i\", \"o\", \"u\")\n  first_vowel = which(chars %in% vowels)[1]\n  \n  if (is.na(first_vowel)) {\n    return(paste0(word, \"ay\"))\n  }\n  else {\n    return(paste0(substr(word, first_vowel, nchar(word)), substr(word, 1, first_vowel - 1), \"ay\"))\n  }\n}\n\nresult = input %>%\n  mutate(answer_expected = str_replace_all(text, \"\\\\w+\", pigify))\nVerification\nidentical(result$answer_expected, test$answer_expected)\nFeel free to comment, share and contact me with advices, questions and your ideas how to improve anything.\nR Solution for Excel Puzzles\nwas originally published in\nNumbers around us\non Medium, where people are continuing the conversation by highlighting and responding to this story.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nNumbers around us - Medium\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Puzzles no. 339–343PuzzlesAuthor: ExcelBIPuzzles:#344: content file#345: content file#346: content file#347: content file#348: content fileLet dig in those numbers.Puzzle #344I am sure that you have heard about palindrome, but did you know katadromes? ...",
      "meta_keywords": null,
      "og_description": "Puzzles no. 339–343PuzzlesAuthor: ExcelBIPuzzles:#344: content file#345: content file#346: content file#347: content file#348: content fileLet dig in those numbers.Puzzle #344I am sure that you have heard about palindrome, but did you know katadromes? ...",
      "og_image": "https://cdn-images-1.medium.com/max/1024/1*_Q6xHjNCQA3dXB8iBP_RNQ.jpeg",
      "og_title": "R Solution for Excel Puzzles | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 4.8,
      "sitemap_lastmod": "2023-12-18T16:10:05+00:00",
      "twitter_description": "Puzzles no. 339–343PuzzlesAuthor: ExcelBIPuzzles:#344: content file#345: content file#346: content file#347: content file#348: content fileLet dig in those numbers.Puzzle #344I am sure that you have heard about palindrome, but did you know katadromes? ...",
      "twitter_title": "R Solution for Excel Puzzles | R-bloggers",
      "url": "https://www.r-bloggers.com/2023/12/r-solution-for-excel-puzzles-4/",
      "word_count": 964
    }
  }
}