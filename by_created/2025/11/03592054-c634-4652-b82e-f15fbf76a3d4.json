{
  "uuid": "03592054-c634-4652-b82e-f15fbf76a3d4",
  "created_at": "2025-11-17 20:38:59",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2023/12/a-complete-guide-to-stepwise-regression-in-r/",
    "crawled_at": "2025-11-17T09:39:23.264878",
    "external_links": [
      {
        "href": "https://www.spsanderson.com/steveondata/posts/2023-12-06/index.html",
        "text": "Steve's Data Tips and Tricks"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://www.spsanderson.com/steveondata/posts/2023-12-06/index.html",
        "text": "Steve's Data Tips and Tricks"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "A Complete Guide to Stepwise Regression in R | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/www.spsanderson.com/steveondata/posts/2023-12-06/index_files/figure-html/unnamed-chunk-4-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/www.spsanderson.com/steveondata/posts/2023-12-06/index_files/figure-html/unnamed-chunk-5-1.png?w=450&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/steven-p-sanderson-ii-mph/",
        "text": "Steven P. Sanderson II, MPH"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-380662 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">A Complete Guide to Stepwise Regression in R</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 5, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/steven-p-sanderson-ii-mph/\">Steven P. Sanderson II, MPH</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://www.spsanderson.com/steveondata/posts/2023-12-06/index.html\"> Steve's Data Tips and Tricks</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<section class=\"level1\" id=\"introduction\">\n<h1>Introduction</h1>\n<p>Stepwise regression is a powerful technique used to build predictive models by iteratively adding or removing variables based on statistical criteria. In R, this can be achieved using functions like <code>step()</code> or manually with forward and backward selection.</p>\n</section>\n<section class=\"level1\" id=\"example\">\n<h1>Example</h1>\n<section class=\"level2\" id=\"forward-stepwise-regression\">\n<h2 class=\"anchored\" data-anchor-id=\"forward-stepwise-regression\">Forward Stepwise Regression:</h2>\n<div class=\"cell\">\n<pre># Initialize an empty model\nforward_model &lt;- lm(mpg ~ ., data = mtcars)\n\n# Forward stepwise regression\nforward_model &lt;- step(forward_model, direction = \"forward\", scope = formula(~ .))</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>Start:  AIC=70.9\nmpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb</pre>\n</div>\n</div>\n<p>In simple terms, we start with a model containing no predictors (<code>mpg ~ 1</code>) and iteratively add the most statistically significant variables until no improvement is observed.</p>\n</section>\n<section class=\"level2\" id=\"backward-stepwise-regression\">\n<h2 class=\"anchored\" data-anchor-id=\"backward-stepwise-regression\">Backward Stepwise Regression:</h2>\n<div class=\"cell\">\n<pre># Initialize a model with all predictors\nbackward_model &lt;- lm(mpg ~ ., data = mtcars)\n\n# Backward stepwise regression\nbackward_model &lt;- step(backward_model, direction = \"backward\")</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>Start:  AIC=70.9\nmpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb\n\n       Df Sum of Sq    RSS    AIC\n- cyl   1    0.0799 147.57 68.915\n- vs    1    0.1601 147.66 68.932\n- carb  1    0.4067 147.90 68.986\n- gear  1    1.3531 148.85 69.190\n- drat  1    1.6270 149.12 69.249\n- disp  1    3.9167 151.41 69.736\n- hp    1    6.8399 154.33 70.348\n- qsec  1    8.8641 156.36 70.765\n&lt;none&gt;              147.49 70.898\n- am    1   10.5467 158.04 71.108\n- wt    1   27.0144 174.51 74.280\n\nStep:  AIC=68.92\nmpg ~ disp + hp + drat + wt + qsec + vs + am + gear + carb\n\n       Df Sum of Sq    RSS    AIC\n- vs    1    0.2685 147.84 66.973\n- carb  1    0.5201 148.09 67.028\n- gear  1    1.8211 149.40 67.308\n- drat  1    1.9826 149.56 67.342\n- disp  1    3.9009 151.47 67.750\n- hp    1    7.3632 154.94 68.473\n&lt;none&gt;              147.57 68.915\n- qsec  1   10.0933 157.67 69.032\n- am    1   11.8359 159.41 69.384\n- wt    1   27.0280 174.60 72.297\n\nStep:  AIC=66.97\nmpg ~ disp + hp + drat + wt + qsec + am + gear + carb\n\n       Df Sum of Sq    RSS    AIC\n- carb  1    0.6855 148.53 65.121\n- gear  1    2.1437 149.99 65.434\n- drat  1    2.2139 150.06 65.449\n- disp  1    3.6467 151.49 65.753\n- hp    1    7.1060 154.95 66.475\n&lt;none&gt;              147.84 66.973\n- am    1   11.5694 159.41 67.384\n- qsec  1   15.6830 163.53 68.200\n- wt    1   27.3799 175.22 70.410\n\nStep:  AIC=65.12\nmpg ~ disp + hp + drat + wt + qsec + am + gear\n\n       Df Sum of Sq    RSS    AIC\n- gear  1     1.565 150.09 63.457\n- drat  1     1.932 150.46 63.535\n&lt;none&gt;              148.53 65.121\n- disp  1    10.110 158.64 65.229\n- am    1    12.323 160.85 65.672\n- hp    1    14.826 163.35 66.166\n- qsec  1    26.408 174.94 68.358\n- wt    1    69.127 217.66 75.350\n\nStep:  AIC=63.46\nmpg ~ disp + hp + drat + wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n- drat  1     3.345 153.44 62.162\n- disp  1     8.545 158.64 63.229\n&lt;none&gt;              150.09 63.457\n- hp    1    13.285 163.38 64.171\n- am    1    20.036 170.13 65.466\n- qsec  1    25.574 175.67 66.491\n- wt    1    67.572 217.66 73.351\n\nStep:  AIC=62.16\nmpg ~ disp + hp + wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n- disp  1     6.629 160.07 61.515\n&lt;none&gt;              153.44 62.162\n- hp    1    12.572 166.01 62.682\n- qsec  1    26.470 179.91 65.255\n- am    1    32.198 185.63 66.258\n- wt    1    69.043 222.48 72.051\n\nStep:  AIC=61.52\nmpg ~ hp + wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n- hp    1     9.219 169.29 61.307\n&lt;none&gt;              160.07 61.515\n- qsec  1    20.225 180.29 63.323\n- am    1    25.993 186.06 64.331\n- wt    1    78.494 238.56 72.284\n\nStep:  AIC=61.31\nmpg ~ wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n&lt;none&gt;              169.29 61.307\n- am    1    26.178 195.46 63.908\n- qsec  1   109.034 278.32 75.217\n- wt    1   183.347 352.63 82.790</pre>\n</div>\n</div>\n<p>Here, we begin with a model including all predictors and iteratively remove the least statistically significant variables until the model no longer improves.</p>\n</section>\n<section class=\"level2\" id=\"both-direction-stepwise-regression\">\n<h2 class=\"anchored\" data-anchor-id=\"both-direction-stepwise-regression\">Both-Direction Stepwise Regression:</h2>\n<div class=\"cell\">\n<pre># Initialize a model with all predictors\nboth_model &lt;- lm(mpg ~ ., data = mtcars)\n\n# Both-direction stepwise regression\nboth_model &lt;- step(both_model, direction = \"both\")</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>Start:  AIC=70.9\nmpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb\n\n       Df Sum of Sq    RSS    AIC\n- cyl   1    0.0799 147.57 68.915\n- vs    1    0.1601 147.66 68.932\n- carb  1    0.4067 147.90 68.986\n- gear  1    1.3531 148.85 69.190\n- drat  1    1.6270 149.12 69.249\n- disp  1    3.9167 151.41 69.736\n- hp    1    6.8399 154.33 70.348\n- qsec  1    8.8641 156.36 70.765\n&lt;none&gt;              147.49 70.898\n- am    1   10.5467 158.04 71.108\n- wt    1   27.0144 174.51 74.280\n\nStep:  AIC=68.92\nmpg ~ disp + hp + drat + wt + qsec + vs + am + gear + carb\n\n       Df Sum of Sq    RSS    AIC\n- vs    1    0.2685 147.84 66.973\n- carb  1    0.5201 148.09 67.028\n- gear  1    1.8211 149.40 67.308\n- drat  1    1.9826 149.56 67.342\n- disp  1    3.9009 151.47 67.750\n- hp    1    7.3632 154.94 68.473\n&lt;none&gt;              147.57 68.915\n- qsec  1   10.0933 157.67 69.032\n- am    1   11.8359 159.41 69.384\n+ cyl   1    0.0799 147.49 70.898\n- wt    1   27.0280 174.60 72.297\n\nStep:  AIC=66.97\nmpg ~ disp + hp + drat + wt + qsec + am + gear + carb\n\n       Df Sum of Sq    RSS    AIC\n- carb  1    0.6855 148.53 65.121\n- gear  1    2.1437 149.99 65.434\n- drat  1    2.2139 150.06 65.449\n- disp  1    3.6467 151.49 65.753\n- hp    1    7.1060 154.95 66.475\n&lt;none&gt;              147.84 66.973\n- am    1   11.5694 159.41 67.384\n- qsec  1   15.6830 163.53 68.200\n+ vs    1    0.2685 147.57 68.915\n+ cyl   1    0.1883 147.66 68.932\n- wt    1   27.3799 175.22 70.410\n\nStep:  AIC=65.12\nmpg ~ disp + hp + drat + wt + qsec + am + gear\n\n       Df Sum of Sq    RSS    AIC\n- gear  1     1.565 150.09 63.457\n- drat  1     1.932 150.46 63.535\n&lt;none&gt;              148.53 65.121\n- disp  1    10.110 158.64 65.229\n- am    1    12.323 160.85 65.672\n- hp    1    14.826 163.35 66.166\n+ carb  1     0.685 147.84 66.973\n+ vs    1     0.434 148.09 67.028\n+ cyl   1     0.414 148.11 67.032\n- qsec  1    26.408 174.94 68.358\n- wt    1    69.127 217.66 75.350\n\nStep:  AIC=63.46\nmpg ~ disp + hp + drat + wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n- drat  1     3.345 153.44 62.162\n- disp  1     8.545 158.64 63.229\n&lt;none&gt;              150.09 63.457\n- hp    1    13.285 163.38 64.171\n+ gear  1     1.565 148.53 65.121\n+ cyl   1     1.003 149.09 65.242\n+ vs    1     0.645 149.45 65.319\n+ carb  1     0.107 149.99 65.434\n- am    1    20.036 170.13 65.466\n- qsec  1    25.574 175.67 66.491\n- wt    1    67.572 217.66 73.351\n\nStep:  AIC=62.16\nmpg ~ disp + hp + wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n- disp  1     6.629 160.07 61.515\n&lt;none&gt;              153.44 62.162\n- hp    1    12.572 166.01 62.682\n+ drat  1     3.345 150.09 63.457\n+ gear  1     2.977 150.46 63.535\n+ cyl   1     2.447 150.99 63.648\n+ vs    1     1.121 152.32 63.927\n+ carb  1     0.011 153.43 64.160\n- qsec  1    26.470 179.91 65.255\n- am    1    32.198 185.63 66.258\n- wt    1    69.043 222.48 72.051\n\nStep:  AIC=61.52\nmpg ~ hp + wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n- hp    1     9.219 169.29 61.307\n&lt;none&gt;              160.07 61.515\n+ disp  1     6.629 153.44 62.162\n+ carb  1     3.227 156.84 62.864\n+ drat  1     1.428 158.64 63.229\n- qsec  1    20.225 180.29 63.323\n+ cyl   1     0.249 159.82 63.465\n+ vs    1     0.249 159.82 63.466\n+ gear  1     0.171 159.90 63.481\n- am    1    25.993 186.06 64.331\n- wt    1    78.494 238.56 72.284\n\nStep:  AIC=61.31\nmpg ~ wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n&lt;none&gt;              169.29 61.307\n+ hp    1     9.219 160.07 61.515\n+ carb  1     8.036 161.25 61.751\n+ disp  1     3.276 166.01 62.682\n+ cyl   1     1.501 167.78 63.022\n+ drat  1     1.400 167.89 63.042\n+ gear  1     0.123 169.16 63.284\n+ vs    1     0.000 169.29 63.307\n- am    1    26.178 195.46 63.908\n- qsec  1   109.034 278.32 75.217\n- wt    1   183.347 352.63 82.790</pre>\n</div>\n</div>\n<p>In both-direction regression, the algorithm combines both forward and backward steps, optimizing the model by adding significant variables and removing insignificant ones.</p>\n<section class=\"level4\" id=\"visualizing-data-and-model-fit\">\n<h4 class=\"anchored\" data-anchor-id=\"visualizing-data-and-model-fit\">Visualizing Data and Model Fit:</h4>\n<p>Now, let’s visualize the data and model fit using base R plots.</p>\n<div class=\"cell\">\n<pre># Scatter plot of mpg vs. hp\nplot(mtcars$hp, mtcars$mpg, \n     main = \"Scatter Plot of mpg vs. hp\", \n     xlab = \"hp\", ylab = \"mpg\", pch = 20\n     )\nabline(lm(mpg ~ hp, data = mtcars), col = \"black\", lwd = 2)\npoints(sort(mtcars$hp), forward_model$fitted.values, col = \"red\", pch = 20)\npoints(sort(mtcars$hp), backward_model$fitted.values, col = \"blue\", pch = 20)\npoints(sort(mtcars$hp), both_model$fitted.values, col = \"green\", pch = 20)\n\nlegend(\"topright\", legend = c(\"Forward\", \"Backward\", \"Both-Direction\"), \n       col = c(\"red\", \"blue\", \"green\"), pch = 20)</pre>\n<div class=\"cell-output-display\">\n<p><img class=\"img-fluid\" data-lazy-src=\"https://i1.wp.com/www.spsanderson.com/steveondata/posts/2023-12-06/index_files/figure-html/unnamed-chunk-4-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/www.spsanderson.com/steveondata/posts/2023-12-06/index_files/figure-html/unnamed-chunk-4-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</div>\n</div>\n<p>This plot displays the scatter plot of <code>mpg</code> against <code>hp</code> with fitted lines for each stepwise regression. The colors correspond to the models created earlier.</p>\n</section>\n<section class=\"level4\" id=\"visualizing-residuals\">\n<h4 class=\"anchored\" data-anchor-id=\"visualizing-residuals\">Visualizing Residuals:</h4>\n<div class=\"cell\">\n<pre># Residual plots for each model\npar(mfrow = c(2, 2))\n\n# Forward stepwise regression residuals\nplot(forward_model$residuals, main = \"Forward Residuals\", ylab = \"Residuals\")\n\n# Backward stepwise regression residuals\nplot(backward_model$residuals, main = \"Backward Residuals\", ylab = \"Residuals\")\n\n# Both-direction stepwise regression residuals\nplot(both_model$residuals, main = \"Both-Direction Residuals\", ylab = \"Residuals\")</pre>\n<div class=\"cell-output-display\">\n<p><img class=\"img-fluid\" data-lazy-src=\"https://i1.wp.com/www.spsanderson.com/steveondata/posts/2023-12-06/index_files/figure-html/unnamed-chunk-5-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/www.spsanderson.com/steveondata/posts/2023-12-06/index_files/figure-html/unnamed-chunk-5-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</div>\n</div>\n<p>These plots help assess how well the models fit the data by examining the residuals.</p>\n</section>\n</section>\n</section>\n<section class=\"level1\" id=\"conclusion\">\n<h1>Conclusion</h1>\n<p>Stepwise regression is a valuable tool, but it’s crucial to interpret results cautiously and be aware of potential pitfalls.</p>\n</section>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://www.spsanderson.com/steveondata/posts/2023-12-06/index.html\"> Steve's Data Tips and Tricks</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
    "main_text": "A Complete Guide to Stepwise Regression in R\nPosted on\nDecember 5, 2023\nby\nSteven P. Sanderson II, MPH\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nSteve's Data Tips and Tricks\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nIntroduction\nStepwise regression is a powerful technique used to build predictive models by iteratively adding or removing variables based on statistical criteria. In R, this can be achieved using functions like\nstep()\nor manually with forward and backward selection.\nExample\nForward Stepwise Regression:\n# Initialize an empty model\nforward_model <- lm(mpg ~ ., data = mtcars)\n\n# Forward stepwise regression\nforward_model <- step(forward_model, direction = \"forward\", scope = formula(~ .))\nStart:  AIC=70.9\nmpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb\nIn simple terms, we start with a model containing no predictors (\nmpg ~ 1\n) and iteratively add the most statistically significant variables until no improvement is observed.\nBackward Stepwise Regression:\n# Initialize a model with all predictors\nbackward_model <- lm(mpg ~ ., data = mtcars)\n\n# Backward stepwise regression\nbackward_model <- step(backward_model, direction = \"backward\")\nStart:  AIC=70.9\nmpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb\n\n       Df Sum of Sq    RSS    AIC\n- cyl   1    0.0799 147.57 68.915\n- vs    1    0.1601 147.66 68.932\n- carb  1    0.4067 147.90 68.986\n- gear  1    1.3531 148.85 69.190\n- drat  1    1.6270 149.12 69.249\n- disp  1    3.9167 151.41 69.736\n- hp    1    6.8399 154.33 70.348\n- qsec  1    8.8641 156.36 70.765\n<none>              147.49 70.898\n- am    1   10.5467 158.04 71.108\n- wt    1   27.0144 174.51 74.280\n\nStep:  AIC=68.92\nmpg ~ disp + hp + drat + wt + qsec + vs + am + gear + carb\n\n       Df Sum of Sq    RSS    AIC\n- vs    1    0.2685 147.84 66.973\n- carb  1    0.5201 148.09 67.028\n- gear  1    1.8211 149.40 67.308\n- drat  1    1.9826 149.56 67.342\n- disp  1    3.9009 151.47 67.750\n- hp    1    7.3632 154.94 68.473\n<none>              147.57 68.915\n- qsec  1   10.0933 157.67 69.032\n- am    1   11.8359 159.41 69.384\n- wt    1   27.0280 174.60 72.297\n\nStep:  AIC=66.97\nmpg ~ disp + hp + drat + wt + qsec + am + gear + carb\n\n       Df Sum of Sq    RSS    AIC\n- carb  1    0.6855 148.53 65.121\n- gear  1    2.1437 149.99 65.434\n- drat  1    2.2139 150.06 65.449\n- disp  1    3.6467 151.49 65.753\n- hp    1    7.1060 154.95 66.475\n<none>              147.84 66.973\n- am    1   11.5694 159.41 67.384\n- qsec  1   15.6830 163.53 68.200\n- wt    1   27.3799 175.22 70.410\n\nStep:  AIC=65.12\nmpg ~ disp + hp + drat + wt + qsec + am + gear\n\n       Df Sum of Sq    RSS    AIC\n- gear  1     1.565 150.09 63.457\n- drat  1     1.932 150.46 63.535\n<none>              148.53 65.121\n- disp  1    10.110 158.64 65.229\n- am    1    12.323 160.85 65.672\n- hp    1    14.826 163.35 66.166\n- qsec  1    26.408 174.94 68.358\n- wt    1    69.127 217.66 75.350\n\nStep:  AIC=63.46\nmpg ~ disp + hp + drat + wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n- drat  1     3.345 153.44 62.162\n- disp  1     8.545 158.64 63.229\n<none>              150.09 63.457\n- hp    1    13.285 163.38 64.171\n- am    1    20.036 170.13 65.466\n- qsec  1    25.574 175.67 66.491\n- wt    1    67.572 217.66 73.351\n\nStep:  AIC=62.16\nmpg ~ disp + hp + wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n- disp  1     6.629 160.07 61.515\n<none>              153.44 62.162\n- hp    1    12.572 166.01 62.682\n- qsec  1    26.470 179.91 65.255\n- am    1    32.198 185.63 66.258\n- wt    1    69.043 222.48 72.051\n\nStep:  AIC=61.52\nmpg ~ hp + wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n- hp    1     9.219 169.29 61.307\n<none>              160.07 61.515\n- qsec  1    20.225 180.29 63.323\n- am    1    25.993 186.06 64.331\n- wt    1    78.494 238.56 72.284\n\nStep:  AIC=61.31\nmpg ~ wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n<none>              169.29 61.307\n- am    1    26.178 195.46 63.908\n- qsec  1   109.034 278.32 75.217\n- wt    1   183.347 352.63 82.790\nHere, we begin with a model including all predictors and iteratively remove the least statistically significant variables until the model no longer improves.\nBoth-Direction Stepwise Regression:\n# Initialize a model with all predictors\nboth_model <- lm(mpg ~ ., data = mtcars)\n\n# Both-direction stepwise regression\nboth_model <- step(both_model, direction = \"both\")\nStart:  AIC=70.9\nmpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb\n\n       Df Sum of Sq    RSS    AIC\n- cyl   1    0.0799 147.57 68.915\n- vs    1    0.1601 147.66 68.932\n- carb  1    0.4067 147.90 68.986\n- gear  1    1.3531 148.85 69.190\n- drat  1    1.6270 149.12 69.249\n- disp  1    3.9167 151.41 69.736\n- hp    1    6.8399 154.33 70.348\n- qsec  1    8.8641 156.36 70.765\n<none>              147.49 70.898\n- am    1   10.5467 158.04 71.108\n- wt    1   27.0144 174.51 74.280\n\nStep:  AIC=68.92\nmpg ~ disp + hp + drat + wt + qsec + vs + am + gear + carb\n\n       Df Sum of Sq    RSS    AIC\n- vs    1    0.2685 147.84 66.973\n- carb  1    0.5201 148.09 67.028\n- gear  1    1.8211 149.40 67.308\n- drat  1    1.9826 149.56 67.342\n- disp  1    3.9009 151.47 67.750\n- hp    1    7.3632 154.94 68.473\n<none>              147.57 68.915\n- qsec  1   10.0933 157.67 69.032\n- am    1   11.8359 159.41 69.384\n+ cyl   1    0.0799 147.49 70.898\n- wt    1   27.0280 174.60 72.297\n\nStep:  AIC=66.97\nmpg ~ disp + hp + drat + wt + qsec + am + gear + carb\n\n       Df Sum of Sq    RSS    AIC\n- carb  1    0.6855 148.53 65.121\n- gear  1    2.1437 149.99 65.434\n- drat  1    2.2139 150.06 65.449\n- disp  1    3.6467 151.49 65.753\n- hp    1    7.1060 154.95 66.475\n<none>              147.84 66.973\n- am    1   11.5694 159.41 67.384\n- qsec  1   15.6830 163.53 68.200\n+ vs    1    0.2685 147.57 68.915\n+ cyl   1    0.1883 147.66 68.932\n- wt    1   27.3799 175.22 70.410\n\nStep:  AIC=65.12\nmpg ~ disp + hp + drat + wt + qsec + am + gear\n\n       Df Sum of Sq    RSS    AIC\n- gear  1     1.565 150.09 63.457\n- drat  1     1.932 150.46 63.535\n<none>              148.53 65.121\n- disp  1    10.110 158.64 65.229\n- am    1    12.323 160.85 65.672\n- hp    1    14.826 163.35 66.166\n+ carb  1     0.685 147.84 66.973\n+ vs    1     0.434 148.09 67.028\n+ cyl   1     0.414 148.11 67.032\n- qsec  1    26.408 174.94 68.358\n- wt    1    69.127 217.66 75.350\n\nStep:  AIC=63.46\nmpg ~ disp + hp + drat + wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n- drat  1     3.345 153.44 62.162\n- disp  1     8.545 158.64 63.229\n<none>              150.09 63.457\n- hp    1    13.285 163.38 64.171\n+ gear  1     1.565 148.53 65.121\n+ cyl   1     1.003 149.09 65.242\n+ vs    1     0.645 149.45 65.319\n+ carb  1     0.107 149.99 65.434\n- am    1    20.036 170.13 65.466\n- qsec  1    25.574 175.67 66.491\n- wt    1    67.572 217.66 73.351\n\nStep:  AIC=62.16\nmpg ~ disp + hp + wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n- disp  1     6.629 160.07 61.515\n<none>              153.44 62.162\n- hp    1    12.572 166.01 62.682\n+ drat  1     3.345 150.09 63.457\n+ gear  1     2.977 150.46 63.535\n+ cyl   1     2.447 150.99 63.648\n+ vs    1     1.121 152.32 63.927\n+ carb  1     0.011 153.43 64.160\n- qsec  1    26.470 179.91 65.255\n- am    1    32.198 185.63 66.258\n- wt    1    69.043 222.48 72.051\n\nStep:  AIC=61.52\nmpg ~ hp + wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n- hp    1     9.219 169.29 61.307\n<none>              160.07 61.515\n+ disp  1     6.629 153.44 62.162\n+ carb  1     3.227 156.84 62.864\n+ drat  1     1.428 158.64 63.229\n- qsec  1    20.225 180.29 63.323\n+ cyl   1     0.249 159.82 63.465\n+ vs    1     0.249 159.82 63.466\n+ gear  1     0.171 159.90 63.481\n- am    1    25.993 186.06 64.331\n- wt    1    78.494 238.56 72.284\n\nStep:  AIC=61.31\nmpg ~ wt + qsec + am\n\n       Df Sum of Sq    RSS    AIC\n<none>              169.29 61.307\n+ hp    1     9.219 160.07 61.515\n+ carb  1     8.036 161.25 61.751\n+ disp  1     3.276 166.01 62.682\n+ cyl   1     1.501 167.78 63.022\n+ drat  1     1.400 167.89 63.042\n+ gear  1     0.123 169.16 63.284\n+ vs    1     0.000 169.29 63.307\n- am    1    26.178 195.46 63.908\n- qsec  1   109.034 278.32 75.217\n- wt    1   183.347 352.63 82.790\nIn both-direction regression, the algorithm combines both forward and backward steps, optimizing the model by adding significant variables and removing insignificant ones.\nVisualizing Data and Model Fit:\nNow, let’s visualize the data and model fit using base R plots.\n# Scatter plot of mpg vs. hp\nplot(mtcars$hp, mtcars$mpg, \n     main = \"Scatter Plot of mpg vs. hp\", \n     xlab = \"hp\", ylab = \"mpg\", pch = 20\n     )\nabline(lm(mpg ~ hp, data = mtcars), col = \"black\", lwd = 2)\npoints(sort(mtcars$hp), forward_model$fitted.values, col = \"red\", pch = 20)\npoints(sort(mtcars$hp), backward_model$fitted.values, col = \"blue\", pch = 20)\npoints(sort(mtcars$hp), both_model$fitted.values, col = \"green\", pch = 20)\n\nlegend(\"topright\", legend = c(\"Forward\", \"Backward\", \"Both-Direction\"), \n       col = c(\"red\", \"blue\", \"green\"), pch = 20)\nThis plot displays the scatter plot of\nmpg\nagainst\nhp\nwith fitted lines for each stepwise regression. The colors correspond to the models created earlier.\nVisualizing Residuals:\n# Residual plots for each model\npar(mfrow = c(2, 2))\n\n# Forward stepwise regression residuals\nplot(forward_model$residuals, main = \"Forward Residuals\", ylab = \"Residuals\")\n\n# Backward stepwise regression residuals\nplot(backward_model$residuals, main = \"Backward Residuals\", ylab = \"Residuals\")\n\n# Both-direction stepwise regression residuals\nplot(both_model$residuals, main = \"Both-Direction Residuals\", ylab = \"Residuals\")\nThese plots help assess how well the models fit the data by examining the residuals.\nConclusion\nStepwise regression is a valuable tool, but it’s crucial to interpret results cautiously and be aware of potential pitfalls.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nSteve's Data Tips and Tricks\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "Introduction Stepwise regression is a powerful technique used to build predictive models by iteratively adding or removing variables based on statistical criteria. In R, this can be achieved using functions like step() or manually with forward a...",
    "meta_keywords": null,
    "og_description": "Introduction Stepwise regression is a powerful technique used to build predictive models by iteratively adding or removing variables based on statistical criteria. In R, this can be achieved using functions like step() or manually with forward a...",
    "og_image": "https://www.spsanderson.com/steveondata/posts/2023-12-06/index_files/figure-html/unnamed-chunk-4-1.png",
    "og_title": "A Complete Guide to Stepwise Regression in R | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 9.9,
    "sitemap_lastmod": "2023-12-06T05:00:00+00:00",
    "twitter_description": "Introduction Stepwise regression is a powerful technique used to build predictive models by iteratively adding or removing variables based on statistical criteria. In R, this can be achieved using functions like step() or manually with forward a...",
    "twitter_title": "A Complete Guide to Stepwise Regression in R | R-bloggers",
    "url": "https://www.r-bloggers.com/2023/12/a-complete-guide-to-stepwise-regression-in-r/",
    "word_count": 1975
  }
}