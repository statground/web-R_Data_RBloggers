{
  "id": "a07a854b9bcbb5a8ad88fff7a7c88dbd7a0af0fd",
  "url": "https://www.r-bloggers.com/2006/05/here%E2%80%99s-an-improved-system-time-function-for-r/",
  "created_at_utc": "2025-11-17T20:41:51Z",
  "data": null,
  "raw_original": {
    "uuid": "358f91fd-175d-48b9-8617-beeeaf72ec2a",
    "created_at": "2025-11-17 20:41:51",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2006/05/here%e2%80%99s-an-improved-system-time-function-for-r/",
      "crawled_at": "2025-11-17T10:58:37.291093",
      "external_links": [
        {
          "href": "http://userprimary.net/user/2006/05/14/heres-an-improved-systemtime-function-for-r/",
          "text": "\"R-bloggers\" via Tal Galili in Google Reader"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "http://userprimary.net/user/2006/05/14/heres-an-improved-systemtime-function-for-r/",
          "text": "\"R-bloggers\" via Tal Galili in Google Reader"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Here’s an improved system.time function for R | R-bloggers",
      "images": [],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/seth/",
          "text": "seth"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/tag/r/",
          "text": "R"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-59 post type-post status-publish format-standard hentry category-r-bloggers tag-r\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Here’s an improved system.time function for R</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">May 14, 2006</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/seth/\">seth</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<p class=\"syndicated-attribution\"><!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"http://userprimary.net/user/2006/05/14/heres-an-improved-systemtime-function-for-r/\"> \"R-bloggers\" via Tal Galili in Google Reader</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div></p>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.0--><p>R’s current system.time function doesn’t name the vector of return values.  Doing so makes it easier to understand the output. IMO, the current code has two uglies: it sets an on.exit hook and then calls on.exit() explicitly.  It also computes the elapsed time twice (once for the stdout message and once for the return value).  Another minor shortcoming is that when nested, only the outer call will print anything.</p>\n<p>Anyhow, here’s an improved version that uses tryCatch instead of on.exit.  One thing I wish was easier (maybe it is and I just don’t know) is reproducing the error message.  </p>\n<pre>\ntimeit &lt;- function (expr, gcFirst = TRUE)\n{\n    nms &lt;- c(\"User\", \"System\", \"Elapsed\", \"Sub.User\", \"Sub.System\")\n    if (!exists(\"proc.time\")) {\n        ans &lt;- rep(as.numeric(NA), 5)\n        names(ans) &lt;- nms\n        return(ans)\n    }\n    loc.frame &lt;- parent.frame()\n    if (gcFirst)\n        gc(FALSE)\n    expr &lt;- substitute(expr)\n    time &lt;- proc.time()\n    show_time &lt;- function() {\n        t &lt;- proc.time() - time\n        names(t) &lt;- nms\n        cat(\"Timing stopped at:\\n\")\n        print(t)\n        t\n    }\n    tryCatch(eval(expr, envir = loc.frame),\n             error=function(e) {\n                 msg &lt;- paste(\"Error in\", deparse(conditionCall(e)),\n                              \":\", conditionMessage(e), \"\\n\")\n                 cat(msg)\n             })\n    show_time()\n}\n</pre>\n\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->\n<p class=\"syndicated-attribution\"><div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"http://userprimary.net/user/2006/05/14/heres-an-improved-systemtime-function-for-r/\"> \"R-bloggers\" via Tal Galili in Google Reader</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div></p> </div>\n<div class=\"post-tags clearfix\"><ul><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/r/\" rel=\"tag\">R</a></li></ul></div></article>",
      "main_text": "Here’s an improved system.time function for R\nPosted on\nMay 14, 2006\nby\nseth\nin\nR bloggers\n| 0 Comments\n[This article was first published on\n\"R-bloggers\" via Tal Galili in Google Reader\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nR’s current system.time function doesn’t name the vector of return values.  Doing so makes it easier to understand the output. IMO, the current code has two uglies: it sets an on.exit hook and then calls on.exit() explicitly.  It also computes the elapsed time twice (once for the stdout message and once for the return value).  Another minor shortcoming is that when nested, only the outer call will print anything.\nAnyhow, here’s an improved version that uses tryCatch instead of on.exit.  One thing I wish was easier (maybe it is and I just don’t know) is reproducing the error message.\ntimeit <- function (expr, gcFirst = TRUE)\n{\n    nms <- c(\"User\", \"System\", \"Elapsed\", \"Sub.User\", \"Sub.System\")\n    if (!exists(\"proc.time\")) {\n        ans <- rep(as.numeric(NA), 5)\n        names(ans) <- nms\n        return(ans)\n    }\n    loc.frame <- parent.frame()\n    if (gcFirst)\n        gc(FALSE)\n    expr <- substitute(expr)\n    time <- proc.time()\n    show_time <- function() {\n        t <- proc.time() - time\n        names(t) <- nms\n        cat(\"Timing stopped at:\\n\")\n        print(t)\n        t\n    }\n    tryCatch(eval(expr, envir = loc.frame),\n             error=function(e) {\n                 msg <- paste(\"Error in\", deparse(conditionCall(e)),\n                              \":\", conditionMessage(e), \"\\n\")\n                 cat(msg)\n             })\n    show_time()\n}\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\n\"R-bloggers\" via Tal Galili in Google Reader\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nR",
      "meta_description": "R’s current system.time function doesn’t name the vector of return values. Doing so makes it easier to understand the output. IMO, the current code has two uglies: it sets an on.exit hook and then calls on.exit() explicitly. It also computes the ...",
      "meta_keywords": "r",
      "og_description": "R’s current system.time function doesn’t name the vector of return values. Doing so makes it easier to understand the output. IMO, the current code has two uglies: it sets an on.exit hook and then calls on.exit() explicitly. It also computes the ...",
      "og_image": "https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png",
      "og_title": "Here’s an improved system.time function for R | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 1.7,
      "sitemap_lastmod": "2006-05-14T23:30:01+00:00",
      "twitter_description": "R’s current system.time function doesn’t name the vector of return values. Doing so makes it easier to understand the output. IMO, the current code has two uglies: it sets an on.exit hook and then calls on.exit() explicitly. It also computes the ...",
      "twitter_title": "Here’s an improved system.time function for R | R-bloggers",
      "url": "https://www.r-bloggers.com/2006/05/here%E2%80%99s-an-improved-system-time-function-for-r/",
      "word_count": 344
    }
  }
}