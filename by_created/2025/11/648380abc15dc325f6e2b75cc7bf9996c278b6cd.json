{
  "id": "648380abc15dc325f6e2b75cc7bf9996c278b6cd",
  "url": "https://www.r-bloggers.com/2023/12/simulating-spatial-patterns-with-the-spatial-kinetic-ising-model/",
  "created_at_utc": "2025-11-17T20:38:51Z",
  "data": null,
  "raw_original": {
    "uuid": "b65126b1-1082-4714-97d7-17fdfa3b14c6",
    "created_at": "2025-11-17 20:38:51",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2023/12/simulating-spatial-patterns-with-the-spatial-kinetic-ising-model/",
      "crawled_at": "2025-11-17T09:33:09.841420",
      "external_links": [
        {
          "href": "https://jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index.html",
          "text": "Jakub Nowosad's website"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://github.com/Nowosad/spatialising/",
          "text": "https://github.com/Nowosad/spatialising/"
        },
        {
          "href": "https://doi.org/10.1088/2752-664x/acdbd2",
          "text": "https://doi.org/10.1088/2752-664x/acdbd2"
        },
        {
          "href": "https://doi.org/10.1098/rsos.231005",
          "text": "https://doi.org/10.1098/rsos.231005"
        },
        {
          "href": "https://creativecommons.org/licenses/by/4.0/",
          "text": "https://creativecommons.org/licenses/by/4.0/"
        },
        {
          "href": "https://jakubnowosad.com/posts/2023-12-17-spatialising-bp1",
          "text": "https://jakubnowosad.com/posts/2023-12-17-spatialising-bp1"
        },
        {
          "href": "https://jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index.html",
          "text": "Jakub Nowosad's website"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Simulating spatial patterns with the spatial kinetic Ising model | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-5-1.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-6-1.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-7-1.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-8-1.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-11-1.png?w=450&ssl=1"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/jakub-nowosad/",
          "text": "Jakub Nowosad"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-380905 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Simulating spatial patterns with the spatial kinetic Ising model</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 16, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/jakub-nowosad/\">Jakub Nowosad</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index.html\"> Jakub Nowosad's website</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<p>A two-dimensional Ising model is an idealized physical system that consists of a lattice of binary variables (<em>magnetic spins</em>) that can be in one of two states: up or down. Each spin’s state is influenced by its neighbors: the more neighbors in the same state, the more likely the spin will be in the same state. Thus, the change in the state of a spin impacts the state of its neighbors, which in turn affects the state of their neighbors, and so on. <!-- When the system's temperature is high, the spins are more likely to change their state, while when the temperature is low, they are more likely to keep their state. --> It is a simple model that can be used in physics to study, for example, phase transitions given by the temperature of the system.</p>\n<p>The above idea can be, in principle, applied to other two-dimensional systems, such as geographical (<em>spatial</em>) data. For example, we can think of a binary spatial raster as a two-dimensional system, where each cell can have one of two states: <code>-1</code> or <code>1</code>. These numbers can represent, for example, two land cover categories: forest and non-forest. Next, we can introduce two parameters influencing the state of each cell: <code>B</code> and <code>J</code>. <code>B</code> is an external pressure: it tries to align cells’ values with its sign: are we more likely to have more <code>-1</code> or <code>1</code> values? <code>J</code> is a strength of the local autocorrelation tendency—it tries to align signs of neighboring cells: are we more likely to have more cells of the same value in the neighborhood? The spatial kinetic Ising model is a simulation of such a system, where each cell is given <em>an opportunity</em> to flip its value (<code>1</code> to <code>-1</code> or <code>-1</code> to <code>1</code>). The probability of a flip depends on the value of the cell, the values of its four neighbors (top, left, bottom, and right), and the values of <code>B</code> and <code>J</code>.</p>\n<p>This blog post shows how to use the spatial kinetic Ising model to simulate the change in the spatial pattern of a binary raster using the <strong>spatialising</strong> R package. The package is available on GitHub at <a class=\"uri\" href=\"https://github.com/Nowosad/spatialising/\" rel=\"nofollow\" target=\"_blank\">https://github.com/Nowosad/spatialising/</a>.</p>\n<section class=\"level1\" id=\"setup\">\n<h1>Setup</h1>\n<p>To reproduce the calculations in the following post, you need to attach the following packages:</p>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>library(terra)\nlibrary(spatialising)\nlibrary(ggplot2)</pre>\n</div>\n</section>\n<section class=\"level1\" id=\"data-preparation\">\n<h1>Data preparation</h1>\n<p>The <code>twomaps.tif</code> file contains two maps of the same area, but for different years. The first map represents the year 1, and the second map represents the year 5. Both of them have only two values: <code>1</code> for non-forest and <code>2</code> for forest:</p>\n<div class=\"cell\" data-crop=\"true\" data-layout-align=\"center\">\n<pre>twomaps = rast(\"/vsicurl/https://github.com/Nowosad/bp-data/raw/main/spatialising-bp/twomaps.tif\")\nmap1 = twomaps[[1]]\nmap2 = twomaps[[2]]\nplot(c(map1, map2))</pre>\n<div class=\"cell-output-display\">\n<div class=\"quarto-figure quarto-figure-center\">\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-5-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-5-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n<p>The spatial kinetic Ising model requires binary raster data with just two values: <code>-1</code> and <code>1</code>. Thus, the first step in our case is to reclassify the original binary (<code>1</code>, <code>2</code>) map into new (<code>-1</code>, <code>1</code>) values. This can be done with the <code>classify()</code> function from the <strong>terra</strong> package.<sup>1</sup> Here, we replace the <code>1</code> value with <code>-1</code> and the <code>2</code> value with <code>1</code>:</p>\n<div class=\"cell\" data-crop=\"true\" data-layout-align=\"center\">\n<pre>rcl = matrix(c(1, -1, 2, 1), byrow = TRUE, ncol = 2)\nmap1 = classify(map1, rcl)\nmap2 = classify(map2, rcl)\nplot(c(map1, map2))</pre>\n<div class=\"cell-output-display\">\n<div class=\"quarto-figure quarto-figure-center\">\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-6-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-6-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n</section>\n<section class=\"level1\" id=\"running-the-spatial-kinetic-ising-model\">\n<h1>Running the spatial kinetic Ising model</h1>\n<p>Now, our data is ready for use in the <strong>spatialising</strong> package. Its main function is <code>kinetic_ising()</code>, which simulates the spatial kinetic Ising model. It requires the input raster (<code>x</code>), the strength of the external pressure (<code>B</code>), the strength of the local autocorrelation tendency (<code>J</code>), and also has some optional arguments, such as the number of updates.</p>\n<p>Our goal is to simulate the change in the spatial pattern of the first map (<code>map1</code>) to make it similar to the second map (<code>map2</code>). The code below simulates the spatial kinetic Ising model for the first map (<code>map1</code>) with the value of <code>B</code> of 0.3 (meaning that the external pressure is toward increased forest cover) and the value of <code>J</code> of 0.7 (meaning that the local autocorrelation tendency is strong). We also set the number of updates to 4, which means that it will create four simulations (rasters), each of which will be based on the previous one.<sup>2</sup></p>\n<div class=\"cell\" data-crop=\"true\" data-layout-align=\"center\">\n<pre>sim1 = kinetic_ising(map1, B = 0.3, J = 0.7, updates = 4)\nplot(sim1, nr = 1)</pre>\n<div class=\"cell-output-display\">\n<div class=\"quarto-figure quarto-figure-center\">\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-7-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-7-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n<p>The result consists of four simulated rasters, which are stored in the <code>sim1</code> object. Each of them represents successive simulations of the spatial kinetic Ising model.</p>\n<p>We can also compare the final simulation (<code>sim1[[4]]</code>) with the first (<code>map1</code>) and the second map (<code>map2</code>).</p>\n<div class=\"cell\" data-crop=\"true\" data-layout-align=\"center\">\n<pre>plot(c(map1, map2, sim1[[4]]), nr = 1)</pre>\n<div class=\"cell-output-display\">\n<div class=\"quarto-figure quarto-figure-center\">\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-8-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-8-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n<p>Compared to the first map, the last simulation has slightly more forest cover, which is in line with the provided external pressure (<code>B</code>) toward increased forest cover. The forest category also tends to be spatially clustered, which is in line with the set local autocorrelation tendency (<code>J</code>). On the other hand, the simulation is still quite different from the second map (<code>map2</code>), possibly indicating that we should increase the value of <code>B</code> to make the simulation more like the second map.</p>\n</section>\n<section class=\"level1\" id=\"metrics-of-spatial-patterns\">\n<h1>Metrics of spatial patterns</h1>\n<p>The <strong>spatialising</strong> package also provides two functions to calculate metrics of spatial patterns of binary rasters: <code>composition_index()</code> and <code>texture_index()</code>. The composition imbalance index (<code>composition_index()</code>) is a sum of cell’s values over the entire site divided by the number of cells in the site. It has a range from -1 (site completely dominated by the -1 values) to 1 (site completely dominated by the 1 values). The value of 0 indicates that the site is equally divided between the two values.</p>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>composition_index(c(map1, map2, sim1[[4]]))</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>[1] -0.5000  0.5000 -0.4184</pre>\n</div>\n</div>\n<p>In our case, <code>map1</code> has a dominance of the <code>-1</code> values, <code>map2</code> has a dominance of the <code>1</code> values, and <code>sim1[[4]]</code> has a dominance of the <code>-1</code> values, but it is less pronounced than in <code>map1</code>.</p>\n<p>The texture index (<code>texture_index()</code>) is a measure of the spatial autocorrelation of the values of a raster. Its value is between 0 (fine texture), and 1 (coarse texture).</p>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>texture_index(c(map1, map2, sim1[[4]]))</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>[1] 0.6477551 0.6216327 0.8387755</pre>\n</div>\n</div>\n<p>In our examples, <code>map1</code> and <code>map2</code> have a rather similar texture, while <code>sim1[[4]]</code> has a slightly coarser texture (its values have stronger spatial autocorrelation).</p>\n</section>\n<section class=\"level1\" id=\"spatial-kinetic-ising-model-explained\">\n<h1>Spatial kinetic Ising model explained</h1>\n<p>How does the spatial kinetic Ising model work? The simulation starts with the input binary (<code>-1</code>, <code>1</code>) raster and proceeds with one randomly selected cell at a time. The selected cell is given <em>an opportunity</em> to flip its value (<code>1</code> to <code>-1</code> or <code>-1</code> to <code>1</code>). The probability of a flip depends on the value of the cell and the values of its four neighbors (top, left, bottom, and right). It also depends on the values of <code>B</code> and <code>J</code>. <code>B</code> (positive or negative) is an external pressure: it tries to align cells’ values with its sign. <code>J</code> (always positive) is a strength of the local autocorrelation tendency: it tries to align signs of neighboring cells.</p>\n<p>We can also control the model using a few additional arguments. The <code>iter</code> argument controls the number of iterations—how many times the flip of a cell value is attempted before a new simulated raster is returned. By default, its value equals to the number of cells in the input raster. Next, <code>updates</code> controls the number of simulated rasters returned—each of which is based on the previous one. The <code>inertia</code> parameter (<code>0</code>, by default), when positive makes it less likely for a cell of <code>-1</code> to change its value to <code>1</code> when surrounded by other <code>-1</code> cells. As the effect, it minimizes the possibility of a “salt and pepper” effect, where cells of different values are mixed together. The last important argument is <code>rule</code>, which controls how the probability of a flip is calculated: either using the <code>\"glauber\"</code> (default) or <code>\"metropolis\"</code> rule.</p>\n<p>The code below compares the results of the spatial kinetic Ising model for different values of <code>B</code> and <code>J</code>.</p>\n<div class=\"cell\" data-layout-align=\"center\">\n<pre>sim2 = kinetic_ising(map1, B = -0.7, J = 0.1, updates = 4, inertia = 1)\nsim3 = kinetic_ising(map1, B = -0.7, J = 0.7, updates = 4, inertia = 1)\nsim4 = kinetic_ising(map1, B = 0, J = 0.1, updates = 4, inertia = 1)\nsim5 = kinetic_ising(map1, B = 0, J = 0.7, updates = 4, inertia = 1)\nsim6 = kinetic_ising(map1, B = 0.7, J = 0.1, updates = 4, inertia = 1)\nsim7 = kinetic_ising(map1, B = 0.7, J = 0.7, updates = 4, inertia = 1)\nall_sims = c(sim2[[4]], sim3[[4]], sim4[[4]], sim5[[4]], sim6[[4]], sim7[[4]])\nnames(all_sims) = c(\"B: -0.7, J: 0.1\", \"B: -0.7, J: 0.7\", \"B: 0, J: 0.1\", \n                    \"B: 0, J: 0.7\", \"B: 0.7, J: 0.1\", \"B: 0.7, J: 0.7\")\nplot(all_sims, nc = 2)</pre>\n<div class=\"cell-output-display\">\n<div class=\"quarto-figure quarto-figure-center\">\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-11-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-11-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n<p>The top row shows the results for <code>B</code> values equal to <code>-0.7</code>, the middle row shows the results for <code>B</code> values equal to <code>0</code>, and the bottom row shows the results for <code>B</code> values equal to <code>0.7</code>. The left column shows the results of the spatial kinetic Ising model for values of <code>J</code> equal to <code>0.1</code>, while the right column shows the results for values of <code>J</code> equal to <code>0.7</code>.</p>\n<p>Quick visual comparison underlines that both parameters have a strong effect on the results of the spatial kinetic Ising model. Negative values of <code>B</code> tend to decrease the forest cover, while positive values of <code>B</code> tend to increase the forest cover. The effect of <code>J</code> is, on the other hand, more related to the configuration of the values, with lower values of <code>J</code> leading to more dispersed values, and higher values of <code>J</code> leading to more clustered values.</p>\n</section>\n<section class=\"level1\" id=\"summary\">\n<h1>Summary</h1>\n<p>This blog post showed how to use the <strong>spatialising</strong> package to simulate the spatial kinetic Ising model, how selected parameters influence the results, and how to calculate metrics of spatial patterns. However, it leaves one important question unanswered: how do you find the best values of <code>B</code> and <code>J</code> to make the simulation more like the second map? That is the topic of the next blog post.</p>\n<p>To learn more about the spatial kinetic Ising model, I encourage you to read <span class=\"citation\" data-cites=\"Stepinski2023\">Tomasz F. Stepinski (2023)</span> and <span class=\"citation\" data-cites=\"spatialisingpaper\">Tomasz F. Stepinski and Nowosad (2023)</span>.</p>\n</section>\n<div class=\"default\" id=\"quarto-appendix\"><section class=\"quarto-appendix-contents\"><h2 class=\"anchored quarto-appendix-heading\">References</h2><div class=\"references csl-bib-body hanging-indent\" id=\"refs\">\n<div class=\"csl-entry\" id=\"ref-Stepinski2023\">\nStepinski, Tomasz F. 2023. <span>“Spatially Explicit Simulation of Deforestation Using the Ising-Like Neutral Model.”</span> <em>Environmental Research: Ecology</em> 2 (2): 025003. <a href=\"https://doi.org/10.1088/2752-664x/acdbd2\" rel=\"nofollow\" target=\"_blank\">https://doi.org/10.1088/2752-664x/acdbd2</a>.\n</div>\n<div class=\"csl-entry\" id=\"ref-spatialisingpaper\">\nStepinski, Tomasz F., and Jakub Nowosad. 2023. <span>“The Kinetic Ising Model Encapsulates Essential Dynamics of Land Pattern Change.”</span> <em>Royal Society Open Science</em> 10 (10): 231005. <a href=\"https://doi.org/10.1098/rsos.231005\" rel=\"nofollow\" target=\"_blank\">https://doi.org/10.1098/rsos.231005</a>.\n</div>\n</div></section><section class=\"footnotes footnotes-end-of-document\" id=\"footnotes\"><h2 class=\"anchored quarto-appendix-heading\">Footnotes</h2>\n<ol>\n<li id=\"fn1\"><p>This function can also be used to binarize continuous data or data with many categories.↩︎</p></li>\n<li id=\"fn2\"><p>Here, we can think of each simulation as a year, and the number of updates as the number of years.↩︎</p></li>\n</ol>\n</section><section class=\"quarto-appendix-contents\"><h2 class=\"anchored quarto-appendix-heading\">Reuse</h2><div class=\"quarto-appendix-contents\" id=\"quarto-reuse\"><div><a href=\"https://creativecommons.org/licenses/by/4.0/\" rel=\"nofollow\" target=\"_blank\">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class=\"quarto-appendix-contents\"><h2 class=\"anchored quarto-appendix-heading\">Citation</h2><div><div class=\"quarto-appendix-secondary-label\">BibTeX citation:</div><pre>@online{nowosad2023,\n  author = {Nowosad, Jakub},\n  title = {Simulating Spatial Patterns with the Spatial Kinetic {Ising}\n    Model},\n  date = {2023-12-17},\n  url = {https://jakubnowosad.com/posts/2023-12-17-spatialising-bp1},\n  langid = {en}\n}\n</pre><div class=\"quarto-appendix-secondary-label\">For attribution, please cite this work as:</div><div class=\"csl-entry quarto-appendix-citeas\" id=\"ref-nowosad2023\">\nNowosad, Jakub. 2023. <span>“Simulating Spatial Patterns with the\nSpatial Kinetic Ising Model.”</span> December 17, 2023. <a href=\"https://jakubnowosad.com/posts/2023-12-17-spatialising-bp1\" rel=\"nofollow\" target=\"_blank\">https://jakubnowosad.com/posts/2023-12-17-spatialising-bp1</a>.\n</div></div></section></div>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index.html\"> Jakub Nowosad's website</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
      "main_text": "Simulating spatial patterns with the spatial kinetic Ising model\nPosted on\nDecember 16, 2023\nby\nJakub Nowosad\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nJakub Nowosad's website\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nA two-dimensional Ising model is an idealized physical system that consists of a lattice of binary variables (\nmagnetic spins\n) that can be in one of two states: up or down. Each spin’s state is influenced by its neighbors: the more neighbors in the same state, the more likely the spin will be in the same state. Thus, the change in the state of a spin impacts the state of its neighbors, which in turn affects the state of their neighbors, and so on.\nIt is a simple model that can be used in physics to study, for example, phase transitions given by the temperature of the system.\nThe above idea can be, in principle, applied to other two-dimensional systems, such as geographical (\nspatial\n) data. For example, we can think of a binary spatial raster as a two-dimensional system, where each cell can have one of two states:\n-1\nor\n1\n. These numbers can represent, for example, two land cover categories: forest and non-forest. Next, we can introduce two parameters influencing the state of each cell:\nB\nand\nJ\n.\nB\nis an external pressure: it tries to align cells’ values with its sign: are we more likely to have more\n-1\nor\n1\nvalues?\nJ\nis a strength of the local autocorrelation tendency—it tries to align signs of neighboring cells: are we more likely to have more cells of the same value in the neighborhood? The spatial kinetic Ising model is a simulation of such a system, where each cell is given\nan opportunity\nto flip its value (\n1\nto\n-1\nor\n-1\nto\n1\n). The probability of a flip depends on the value of the cell, the values of its four neighbors (top, left, bottom, and right), and the values of\nB\nand\nJ\n.\nThis blog post shows how to use the spatial kinetic Ising model to simulate the change in the spatial pattern of a binary raster using the\nspatialising\nR package. The package is available on GitHub at\nhttps://github.com/Nowosad/spatialising/\n.\nSetup\nTo reproduce the calculations in the following post, you need to attach the following packages:\nlibrary(terra)\nlibrary(spatialising)\nlibrary(ggplot2)\nData preparation\nThe\ntwomaps.tif\nfile contains two maps of the same area, but for different years. The first map represents the year 1, and the second map represents the year 5. Both of them have only two values:\n1\nfor non-forest and\n2\nfor forest:\ntwomaps = rast(\"/vsicurl/https://github.com/Nowosad/bp-data/raw/main/spatialising-bp/twomaps.tif\")\nmap1 = twomaps[[1]]\nmap2 = twomaps[[2]]\nplot(c(map1, map2))\nThe spatial kinetic Ising model requires binary raster data with just two values:\n-1\nand\n1\n. Thus, the first step in our case is to reclassify the original binary (\n1\n,\n2\n) map into new (\n-1\n,\n1\n) values. This can be done with the\nclassify()\nfunction from the\nterra\npackage.\n1\nHere, we replace the\n1\nvalue with\n-1\nand the\n2\nvalue with\n1\n:\nrcl = matrix(c(1, -1, 2, 1), byrow = TRUE, ncol = 2)\nmap1 = classify(map1, rcl)\nmap2 = classify(map2, rcl)\nplot(c(map1, map2))\nRunning the spatial kinetic Ising model\nNow, our data is ready for use in the\nspatialising\npackage. Its main function is\nkinetic_ising()\n, which simulates the spatial kinetic Ising model. It requires the input raster (\nx\n), the strength of the external pressure (\nB\n), the strength of the local autocorrelation tendency (\nJ\n), and also has some optional arguments, such as the number of updates.\nOur goal is to simulate the change in the spatial pattern of the first map (\nmap1\n) to make it similar to the second map (\nmap2\n). The code below simulates the spatial kinetic Ising model for the first map (\nmap1\n) with the value of\nB\nof 0.3 (meaning that the external pressure is toward increased forest cover) and the value of\nJ\nof 0.7 (meaning that the local autocorrelation tendency is strong). We also set the number of updates to 4, which means that it will create four simulations (rasters), each of which will be based on the previous one.\n2\nsim1 = kinetic_ising(map1, B = 0.3, J = 0.7, updates = 4)\nplot(sim1, nr = 1)\nThe result consists of four simulated rasters, which are stored in the\nsim1\nobject. Each of them represents successive simulations of the spatial kinetic Ising model.\nWe can also compare the final simulation (\nsim1[[4]]\n) with the first (\nmap1\n) and the second map (\nmap2\n).\nplot(c(map1, map2, sim1[[4]]), nr = 1)\nCompared to the first map, the last simulation has slightly more forest cover, which is in line with the provided external pressure (\nB\n) toward increased forest cover. The forest category also tends to be spatially clustered, which is in line with the set local autocorrelation tendency (\nJ\n). On the other hand, the simulation is still quite different from the second map (\nmap2\n), possibly indicating that we should increase the value of\nB\nto make the simulation more like the second map.\nMetrics of spatial patterns\nThe\nspatialising\npackage also provides two functions to calculate metrics of spatial patterns of binary rasters:\ncomposition_index()\nand\ntexture_index()\n. The composition imbalance index (\ncomposition_index()\n) is a sum of cell’s values over the entire site divided by the number of cells in the site. It has a range from -1 (site completely dominated by the -1 values) to 1 (site completely dominated by the 1 values). The value of 0 indicates that the site is equally divided between the two values.\ncomposition_index(c(map1, map2, sim1[[4]]))\n[1] -0.5000  0.5000 -0.4184\nIn our case,\nmap1\nhas a dominance of the\n-1\nvalues,\nmap2\nhas a dominance of the\n1\nvalues, and\nsim1[[4]]\nhas a dominance of the\n-1\nvalues, but it is less pronounced than in\nmap1\n.\nThe texture index (\ntexture_index()\n) is a measure of the spatial autocorrelation of the values of a raster. Its value is between 0 (fine texture), and 1 (coarse texture).\ntexture_index(c(map1, map2, sim1[[4]]))\n[1] 0.6477551 0.6216327 0.8387755\nIn our examples,\nmap1\nand\nmap2\nhave a rather similar texture, while\nsim1[[4]]\nhas a slightly coarser texture (its values have stronger spatial autocorrelation).\nSpatial kinetic Ising model explained\nHow does the spatial kinetic Ising model work? The simulation starts with the input binary (\n-1\n,\n1\n) raster and proceeds with one randomly selected cell at a time. The selected cell is given\nan opportunity\nto flip its value (\n1\nto\n-1\nor\n-1\nto\n1\n). The probability of a flip depends on the value of the cell and the values of its four neighbors (top, left, bottom, and right). It also depends on the values of\nB\nand\nJ\n.\nB\n(positive or negative) is an external pressure: it tries to align cells’ values with its sign.\nJ\n(always positive) is a strength of the local autocorrelation tendency: it tries to align signs of neighboring cells.\nWe can also control the model using a few additional arguments. The\niter\nargument controls the number of iterations—how many times the flip of a cell value is attempted before a new simulated raster is returned. By default, its value equals to the number of cells in the input raster. Next,\nupdates\ncontrols the number of simulated rasters returned—each of which is based on the previous one. The\ninertia\nparameter (\n0\n, by default), when positive makes it less likely for a cell of\n-1\nto change its value to\n1\nwhen surrounded by other\n-1\ncells. As the effect, it minimizes the possibility of a “salt and pepper” effect, where cells of different values are mixed together. The last important argument is\nrule\n, which controls how the probability of a flip is calculated: either using the\n\"glauber\"\n(default) or\n\"metropolis\"\nrule.\nThe code below compares the results of the spatial kinetic Ising model for different values of\nB\nand\nJ\n.\nsim2 = kinetic_ising(map1, B = -0.7, J = 0.1, updates = 4, inertia = 1)\nsim3 = kinetic_ising(map1, B = -0.7, J = 0.7, updates = 4, inertia = 1)\nsim4 = kinetic_ising(map1, B = 0, J = 0.1, updates = 4, inertia = 1)\nsim5 = kinetic_ising(map1, B = 0, J = 0.7, updates = 4, inertia = 1)\nsim6 = kinetic_ising(map1, B = 0.7, J = 0.1, updates = 4, inertia = 1)\nsim7 = kinetic_ising(map1, B = 0.7, J = 0.7, updates = 4, inertia = 1)\nall_sims = c(sim2[[4]], sim3[[4]], sim4[[4]], sim5[[4]], sim6[[4]], sim7[[4]])\nnames(all_sims) = c(\"B: -0.7, J: 0.1\", \"B: -0.7, J: 0.7\", \"B: 0, J: 0.1\", \n                    \"B: 0, J: 0.7\", \"B: 0.7, J: 0.1\", \"B: 0.7, J: 0.7\")\nplot(all_sims, nc = 2)\nThe top row shows the results for\nB\nvalues equal to\n-0.7\n, the middle row shows the results for\nB\nvalues equal to\n0\n, and the bottom row shows the results for\nB\nvalues equal to\n0.7\n. The left column shows the results of the spatial kinetic Ising model for values of\nJ\nequal to\n0.1\n, while the right column shows the results for values of\nJ\nequal to\n0.7\n.\nQuick visual comparison underlines that both parameters have a strong effect on the results of the spatial kinetic Ising model. Negative values of\nB\ntend to decrease the forest cover, while positive values of\nB\ntend to increase the forest cover. The effect of\nJ\nis, on the other hand, more related to the configuration of the values, with lower values of\nJ\nleading to more dispersed values, and higher values of\nJ\nleading to more clustered values.\nSummary\nThis blog post showed how to use the\nspatialising\npackage to simulate the spatial kinetic Ising model, how selected parameters influence the results, and how to calculate metrics of spatial patterns. However, it leaves one important question unanswered: how do you find the best values of\nB\nand\nJ\nto make the simulation more like the second map? That is the topic of the next blog post.\nTo learn more about the spatial kinetic Ising model, I encourage you to read\nTomasz F. Stepinski (2023)\nand\nTomasz F. Stepinski and Nowosad (2023)\n.\nReferences\nStepinski, Tomasz F. 2023.\n“Spatially Explicit Simulation of Deforestation Using the Ising-Like Neutral Model.”\nEnvironmental Research: Ecology\n2 (2): 025003.\nhttps://doi.org/10.1088/2752-664x/acdbd2\n.\nStepinski, Tomasz F., and Jakub Nowosad. 2023.\n“The Kinetic Ising Model Encapsulates Essential Dynamics of Land Pattern Change.”\nRoyal Society Open Science\n10 (10): 231005.\nhttps://doi.org/10.1098/rsos.231005\n.\nFootnotes\nThis function can also be used to binarize continuous data or data with many categories.↩︎\nHere, we can think of each simulation as a year, and the number of updates as the number of years.↩︎\nReuse\nhttps://creativecommons.org/licenses/by/4.0/\nCitation\nBibTeX citation:\n@online{nowosad2023,\n  author = {Nowosad, Jakub},\n  title = {Simulating Spatial Patterns with the Spatial Kinetic {Ising}\n    Model},\n  date = {2023-12-17},\n  url = {https://jakubnowosad.com/posts/2023-12-17-spatialising-bp1},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nNowosad, Jakub. 2023.\n“Simulating Spatial Patterns with the\nSpatial Kinetic Ising Model.”\nDecember 17, 2023.\nhttps://jakubnowosad.com/posts/2023-12-17-spatialising-bp1\n.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nJakub Nowosad's website\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "A two-dimensional Ising model is an idealized physical system that consists of a lattice of binary variables (magnetic spins) that can be in one of two states: up or down. Each spin’s state is influenced by its neighbors: the more neighbors in th...",
      "meta_keywords": null,
      "og_description": "A two-dimensional Ising model is an idealized physical system that consists of a lattice of binary variables (magnetic spins) that can be in one of two states: up or down. Each spin’s state is influenced by its neighbors: the more neighbors in th...",
      "og_image": "https://jakubnowosad.com/posts/2023-12-17-spatialising-bp1/index_files/figure-html/unnamed-chunk-5-1.png",
      "og_title": "Simulating spatial patterns with the spatial kinetic Ising model | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 10.1,
      "sitemap_lastmod": "2023-12-17T00:00:00+00:00",
      "twitter_description": "A two-dimensional Ising model is an idealized physical system that consists of a lattice of binary variables (magnetic spins) that can be in one of two states: up or down. Each spin’s state is influenced by its neighbors: the more neighbors in th...",
      "twitter_title": "Simulating spatial patterns with the spatial kinetic Ising model | R-bloggers",
      "url": "https://www.r-bloggers.com/2023/12/simulating-spatial-patterns-with-the-spatial-kinetic-ising-model/",
      "word_count": 2012
    }
  }
}