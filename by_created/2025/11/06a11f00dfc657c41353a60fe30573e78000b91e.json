{
  "id": "06a11f00dfc657c41353a60fe30573e78000b91e",
  "url": "https://www.r-bloggers.com/2023/11/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/",
  "created_at_utc": "2025-11-17T20:39:22Z",
  "data": null,
  "raw_original": {
    "uuid": "193cdc7b-86af-4fff-ba49-de3ce2094ba1",
    "created_at": "2025-11-17 20:39:22",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2023/11/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/",
      "crawled_at": "2025-11-17T10:00:18.330366",
      "external_links": [
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/",
          "text": "YoungStatS"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-ginestet2017",
          "text": "2017"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-simpson2013permutation",
          "text": "2013"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-severn2020non",
          "text": "2020"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-durante2017nonparametric",
          "text": "2017"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-lunagomez2021modeling",
          "text": "2021"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-chowdhury2019gromov",
          "text": "2019"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-calissano2023populations",
          "text": "2023"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-jain2009structure",
          "text": "2009"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-conte2004thirty",
          "text": "2004"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-vogelstein2015fast",
          "text": "2015"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-lee2013smooth",
          "text": "2013"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-frechet1948elements",
          "text": "1948"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-huckemann",
          "text": "2010"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-calissano2023populations",
          "text": "2023"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-KKMMN2016",
          "text": "2016"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-riesen2008iam",
          "text": "2008"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-calissano2023populations",
          "text": "2023"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-calissano2022graph",
          "text": "2022"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-miolane2020geomstats",
          "text": "2020"
        },
        {
          "href": "https://doi.org/10.1214/16-AOAS1015",
          "text": "https://doi.org/10.1214/16-AOAS1015"
        },
        {
          "href": "http://graphkernels.cs.tu-dortmund.de/",
          "text": "http://graphkernels.cs.tu-dortmund.de"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/",
          "text": "YoungStatS"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Populations of Unlabeled Networks: Graph Space Geometry and Generalized Geodesic Principal Components | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/exampleequivalenceclasses_graphspace.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/graphspace_totalspace_metric.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/AAC_Scheme_correct_fm.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/AAC_Scheme_correct_pca.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/Letters_Plot.png?w=578&ssl=1"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/youngstats/",
          "text": "YoungStatS"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-379712 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Populations of Unlabeled Networks: Graph Space Geometry and Generalized Geodesic Principal Components</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">November 5, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/youngstats/\">YoungStatS</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/\"> YoungStatS</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div class=\"section level2\" id=\"overview\">\n<h2>Overview</h2>\n<p>Sets of graphs arise in many different applications, from medicine to\nfinance, from urban planning to social science. Analysing sets of graphs\nis far from trivial as they are strongly non Euclidean data type. There\nare two main sets of graphs:</p>\n<ul>\n<li>labelled: where there is the same sets of nodes across each\nobservation;</li>\n</ul>\n<!-- -->\n<ul>\n<li>unlabelled: where there is no clear correspondence in the nodes\nacross networks.</li>\n</ul>\n<p>Unlabelled graphs poses high challenges from both the embedding\nprospective (which geometrical embedding is suitable for such graphs)\nand the statistical perspective (how can we extend basic tools to such\nembedding).</p>\n<p>In the past years, scholars have been proposing different embedding\nstrategies for unlabelled graphs. Among existing models: <span class=\"citation\">Ginestet et al. (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-ginestet2017\" rel=\"nofollow\" target=\"_blank\">2017</a>)</span>\nproposes a model where networks’ Laplacian matrices are smoothly\ninjected into a sub-manifold of a Euclidean space;\n<span class=\"citation\">Simpson et al. (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-simpson2013permutation\" rel=\"nofollow\" target=\"_blank\">2013</a>)</span>, <span class=\"citation\">Severn, Dryden, and Preston (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-severn2020non\" rel=\"nofollow\" target=\"_blank\">2020</a>)</span> and <span class=\"citation\">Durante, Dunson, and Vogelstein (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-durante2017nonparametric\" rel=\"nofollow\" target=\"_blank\">2017</a>)</span>\nface the problem of generating and performing tests on a population of\nnetworks; <span class=\"citation\">Lunagómez, Olhede, and Wolfe (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-lunagomez2021modeling\" rel=\"nofollow\" target=\"_blank\">2021</a>)</span> provide Bayesian modelling for discrete\nlabeled graphs, and <span class=\"citation\">Chowdhury and Mémoli (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-chowdhury2019gromov\" rel=\"nofollow\" target=\"_blank\">2019</a>)</span> studies a metric space of\nnetworks up to weak isomorphism, which allows the grouping of similar\nnodes. In <span class=\"citation\">Calissano, Feragen, and Vantini (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-calissano2023populations\" rel=\"nofollow\" target=\"_blank\">2023</a>)</span>, we characterize geometrically the\nGraph Space quotient space introduced by <span class=\"citation\">Jain and Obermayer (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-jain2009structure\" rel=\"nofollow\" target=\"_blank\">2009</a>)</span> and we\nextended principal component analysis to sets of unlabelled graphs.</p>\n</div>\n<div class=\"section level2\" id=\"graph-space\">\n<h2>Graph Space</h2>\n<p>Consider <span class=\"math inline\">\\(G_1,\\dots, G_k\\)</span> where each <span class=\"math inline\">\\(G_i=(N_i,E_i,a_i)\\)</span> sets of nodes\n<span class=\"math inline\">\\(N_i\\)</span>, edges <span class=\"math inline\">\\(E_i\\)</span>, and a real valued attribute function\n<span class=\"math inline\">\\(a_i :E_i \\rightarrow \\mathbb{R}\\)</span>. Each graph can be described as a set\nof adjacency matrix <span class=\"math inline\">\\(x \\in X=\\mathbb{R}^{n\\times n}\\)</span>. We can embed\nunlabelled graphs in a quotient space <span class=\"math inline\">\\(X / T\\)</span> where <span class=\"math inline\">\\(T\\)</span> set of\npermutation matrices. Each graph is now represented by its equivalence\nclass of permuted graphs: <span class=\"math display\">\\[[x]=\\{t^T x t: t\\in T\\}\\]</span></p>\n<p><img data-lazy-src=\"https://i0.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/exampleequivalenceclasses_graphspace.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img data-recalc-dims=\"1\" src=\"https://i0.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/exampleequivalenceclasses_graphspace.png?w=578&amp;ssl=1\"/></noscript></p>\n<p>Figure 1: Conceptual visualization of Graph Space.</p>\n<p>By equipping the total space with a metric <span class=\"math inline\">\\((X,d_X)\\)</span> we can define a\nquotient metric on <span class=\"math inline\">\\(X / T\\)</span> as:\n<span class=\"math display\">\\[d_{X/T}([x_1],[x_2])=min_{t\\in T}d_X (t^T x_1 t, x_2)\\]</span> Such metric\ncorresponds in finding the optimal candidate in the equivalence class\nwhich minimize the distance in the total space. The minimization problem\nis known as the Graph Matching problem, which is a broadly studied\nproblem in optimization <span class=\"citation\">Conte et al. (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-conte2004thirty\" rel=\"nofollow\" target=\"_blank\">2004</a>)</span> for a review). As we select\n<span class=\"math inline\">\\(d_X\\)</span> to be the Frobenius norm, we use the FAQ Graph matching\n<span class=\"citation\">Vogelstein et al. (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-vogelstein2015fast\" rel=\"nofollow\" target=\"_blank\">2015</a>)</span>.</p>\n<p><img data-lazy-src=\"https://i1.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/graphspace_totalspace_metric.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img data-recalc-dims=\"1\" src=\"https://i1.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/graphspace_totalspace_metric.png?w=578&amp;ssl=1\"/></noscript></p>\n<p>Figure 2: Conceptual visualization of the distance in the Graph Space.</p>\n<div class=\"section level3\" id=\"short-geometrical-characterization-of-graph-space\">\n<h3>Short Geometrical Characterization of Graph Space</h3>\n<p>The graph space is a metric space <span class=\"math inline\">\\((X / T,d_{X/T})\\)</span>, but it is not a\nmanifold: The equivalence classes are often not of the same dimensions\n(symmetries or blocks of zeros can cause the permutation to leave the\ngraph unchanged), thus the action is not free and the space is not a\nquotient manifold (see <span class=\"citation\">Lee (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-lee2013smooth\" rel=\"nofollow\" target=\"_blank\">2013</a>)</span> for details on quotient\nmanifolds). However, the total space <span class=\"math inline\">\\(X=\\mathbb{R}^{n\\times n}\\)</span> is\nEuclidean. To overcome the complexity of the Graph Space and perform\nstatistics on unlabelled graphs, we define an algorithm relying on the\ntotal space <span class=\"math inline\">\\(X\\)</span> for the computations.</p>\n</div>\n<div class=\"section level3\" id=\"align-all-and-compute\">\n<h3>Align All and Compute</h3>\n<p>The Align All and Compute Algorithm (AAC) allows to compute intrinsic\nstatistics on Graph Space by computing the estimators on the total\nspace. We illustrate it here for the estimation of the Fréchet Mean\n<span class=\"citation\">Fréchet (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-frechet1948elements\" rel=\"nofollow\" target=\"_blank\">1948</a>)</span>. Consider a set of <span class=\"math inline\">\\(\\{[x_1],\\dots,[x_k]\\}\\)</span> graphs:\n<span class=\"math display\">\\[[\\bar{x}]=min_{[x]\\in X / T }\\sum_{i=1}^{n}d_{X /T}([\\bar{x}],[x_i])\\]</span>\nNotice that the Fréchet Mean results into the arithmetic mean in the\ncase of Euclidean data.</p>\n<p>The AAC operates as follows:</p>\n<p><strong>AAC algorithm for the the Fréchet Mean</strong><br/>\n– Input: <span class=\"math inline\">\\(\\{[x_1],\\dots,[x_k]\\} \\subset X/T\\)</span>; a threshold\n<span class=\"math inline\">\\(\\varepsilon &gt; 0\\)</span><br/>\n– Initialization: Randomly select\n<span class=\"math inline\">\\(\\tilde{x}=\\tilde{x_i}\\in [x_i] \\in \\{ [x_1],\\dots,[x_k]\\}\\)</span><br/>\n– While <span class=\"math inline\">\\(s&gt;\\varepsilon\\)</span>:<br/>\nObtain <span class=\"math inline\">\\(\\tilde{x_i}\\)</span> optimally aligned wrt <span class=\"math inline\">\\(\\tilde{x}\\)</span> for\n<span class=\"math inline\">\\(i =\\{ 1,\\dots, k\\}\\)</span><br/>\nCompute the Fréchet Mean <span class=\"math inline\">\\(\\bar{x}\\)</span> in <span class=\"math inline\">\\(X\\)</span> of\n<span class=\"math inline\">\\(\\{\\tilde{x_1},\\tilde{x_2},\\dots,\\tilde{x_k}\\} \\in X\\)</span><br/>\nCompute <span class=\"math inline\">\\(s=d(\\tilde{x},\\bar{x})\\)</span><br/>\nSet <span class=\"math inline\">\\(\\tilde{x}=\\bar{x}\\)</span><br/>\n– Output: <span class=\"math inline\">\\([\\bar{x}]\\)</span>, an estimate of the Fréchet Mean of\n<span class=\"math inline\">\\(\\{[x_1], \\ldots, [x_k]\\} \\in X/T\\)</span>.<br/>\n</p>\n<p>The Figure 3 represents the algorithm graphically:</p>\n<p><img data-lazy-src=\"https://i0.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/AAC_Scheme_correct_fm.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img data-recalc-dims=\"1\" src=\"https://i0.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/AAC_Scheme_correct_fm.png?w=578&amp;ssl=1\"/></noscript></p>\n<p>Figure 3: Conceptual visualization of the AAC algorithm. The star\nrepresents the current estimation of the Frechet Mean.</p>\n</div>\n</div>\n<div class=\"section level2\" id=\"generalized-geodesic-principal-components\">\n<h2>Generalized Geodesic Principal Components</h2>\n<p>Let’s move now to more complex estimators. To extend the Principal\nComponent Analysis to Graph Space: (1) we firstly extend the concept of\ngeodesic to Graph Space; (2) we define a way to align an equivalent\nclass to a geodesic (i.e. optimal positioning).</p>\n<p><strong>Definition 1 (Generalized Geodesics):</strong><br/>\n<em>Denote by</em> <span class=\"math inline\">\\(\\Gamma(X)\\)</span> <em>the set of all straight lines (geodesics) in</em>\n<span class=\"math inline\">\\(X\\)</span><em>. Following <span class=\"citation\">Huckemann, Hotz, and Munk (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-huckemann\" rel=\"nofollow\" target=\"_blank\">2010</a>)</span>, a curve</em> <span class=\"math inline\">\\(\\delta\\)</span> <em>is a generalized geodesic\non the Graph Space</em> <span class=\"math inline\">\\(X/T\\)</span><em>, if it is a projection of a straight line on</em>\n<span class=\"math inline\">\\(X\\)</span><em>:</em> <span class=\"math display\">\\[\\begin{equation}\n    \\Gamma(X/T)=\\{\\delta=\\pi \\circ \\gamma:\\gamma\\in\\Gamma(X)\\}.\n\\end{equation}\\]</span> <em>Where</em> <span class=\"math inline\">\\(\\pi: X\\rightarrow X/T\\)</span> <em>is the canonical\nquotient space projection.</em></p>\n<p>Since Graph Space is not an inner product space, we define orthogonality\nas:</p>\n<p><strong>Definition 2:</strong> <em>Two generalized geodesics</em>\n<span class=\"math inline\">\\(\\delta_1,\\delta_2\\in\\Gamma(X/T)\\)</span> <em>are orthogonal if they have\nrepresentatives in</em>\n<span class=\"math inline\">\\(\\delta_1=\\pi\\circ\\gamma_1,\\delta_2=\\pi\\circ\\gamma_2, \\gamma_1,\\gamma_2\\in\\Gamma(X)\\)</span>\n<em>which are orthogonal</em> <span class=\"math inline\">\\(&lt;\\gamma_1,\\gamma_2&gt;_X=0\\)</span><em>.</em></p>\n<p>In order to bridge computations in Graph Space <span class=\"math inline\">\\(X/T\\)</span> with computations\nin the total space <span class=\"math inline\">\\(X\\)</span>, we introduce a concept of alignment in <span class=\"math inline\">\\(X\\)</span>.</p>\n<p><strong>Definition 3 (Optimal position):</strong><br/>\n<em>Given</em> <span class=\"math inline\">\\(\\tilde{x} \\in X\\)</span> <em>and</em> <span class=\"math inline\">\\(t \\in T\\)</span><em>, the point</em> <span class=\"math inline\">\\(t^T \\tilde{x} t\\)</span>\n<em>is in</em> <em>if</em> <span class=\"math display\">\\[\nd_X(t^T \\tilde{x}t,x)= d_{X/T}([\\tilde{x}],[x]).\n\\]</span> <em>That is, the equivalence class</em> <span class=\"math inline\">\\([\\tilde{x}] \\in X/T\\)</span> <em>contains (at\nleast) one point</em> <span class=\"math inline\">\\(t^T \\tilde{x} t \\in [\\tilde{x}]\\)</span> <em>which has minimal\ndistance to</em> <span class=\"math inline\">\\(x\\)</span><em>, and this point is in optimal position to</em> <span class=\"math inline\">\\(x\\)</span><em>. Next,\nconsider</em> <span class=\"math inline\">\\([x] \\in X/T\\)</span><em>,</em> <span class=\"math inline\">\\(t \\in T\\)</span> <em>and</em> <span class=\"math inline\">\\(\\delta\\)</span> <em>a generalized\ngeodesic in</em> <span class=\"math inline\">\\(X/T\\)</span> <em>with representative</em> <span class=\"math inline\">\\(\\gamma\\in \\Gamma(X)\\)</span><em>. The\ngraph representative</em> <span class=\"math inline\">\\(t^T x t\\in X\\)</span> <em>is in optimal position to</em>\n<span class=\"math inline\">\\(\\gamma\\in\\Gamma(X)\\)</span> <em>if</em> <span class=\"math display\">\\[d_X(t^T x t ,\\gamma)=d_{X/T}([x],\\delta).\\]</span></p>\n<p>Having concepts of generalized geodesic, optimal position and\northogonality, we now define a set of geodesic principal components:</p>\n<p><strong>Definition 4:</strong> <em>Consider the canonical projection of the Graph Space</em>\n<span class=\"math inline\">\\(\\pi \\colon X \\rightarrow X/T\\)</span> <em>of</em> <span class=\"math inline\">\\(X\\)</span> <em>and consider a set</em>\n<span class=\"math inline\">\\(\\{[x_1],\\dots, [x_k]\\} \\subset X/T\\)</span> <em>of graphs,</em> <span class=\"math inline\">\\([x]\\in X/T\\)</span><em>, and</em>\n<span class=\"math inline\">\\(\\delta \\in \\Gamma(X/T)\\)</span><em>. The Generalized Geodesic Principal Components\n(GGPCs) for the set</em> <span class=\"math inline\">\\(\\{[x_1],\\dots, [x_k]\\}\\)</span> <em>are defined as:</em></p>\n<ul>\n<li><p><em>The first generalized geodesic principal component</em>\n<span class=\"math inline\">\\(\\delta_1 \\in \\Gamma(X/T)\\)</span> <em>is the generalized geodesic minimizing\nthe sum of squared residuals:</em> <span class=\"math display\">\\[\\begin{equation}\\label{eq:wrtdelta}\n    \\delta_1 = \\underset{\\delta \\in \\Gamma(X/T)}{\\operatorname{argmin}} \\sum_{i=1}^{k}{(d_{X/T}^2([x_i],\\delta))}\n\\end{equation}\\]</span></p></li>\n<li><p><em>The second generalized geodesic principal component</em>\n<span class=\"math inline\">\\(\\delta_2 \\in \\Gamma(X/T)\\)</span> <em>minimizes (2) over all</em>\n<span class=\"math inline\">\\(\\delta \\in \\Gamma(X/T)\\)</span><em>, having at least one point in common with</em>\n<span class=\"math inline\">\\(\\delta_1\\)</span> <em>and being orthogonal to</em> <span class=\"math inline\">\\(\\delta_1\\)</span> <em>at all points in\ncommon with</em> <span class=\"math inline\">\\(\\delta_1\\)</span><em>.</em></p></li>\n<li><p><em>The point</em> <span class=\"math inline\">\\(\\mu\\in X/T\\)</span> <em>is called Principal Component Mean if it\nminimizes</em> <span class=\"math display\">\\[\\begin{equation}\\label{eq:wrtpoint}\n     \\sum_{i=1}^{k}{(d_{X/T}^2([x_i],[\\mu])^2)}\n\\end{equation}\\]</span> <em>where</em> <span class=\"math inline\">\\([\\mu]\\)</span> <em>only runs over points</em> <span class=\"math inline\">\\(\\tilde{x}\\)</span>\n<em>in common with</em> <span class=\"math inline\">\\(\\delta_1\\)</span> <em>and</em> <span class=\"math inline\">\\(\\delta_2\\)</span><em>.</em></p></li>\n<li><p><em>The</em> <span class=\"math inline\">\\(j^{th}\\)</span> <em>generalized geodesic principal component is a</em>\n<span class=\"math inline\">\\(\\delta_j \\in \\Gamma(X/T)\\)</span> <em>if it minimizes (2) over all generalized\ngeodesics that meet orthogonally</em> <span class=\"math inline\">\\(\\delta_1,\\dots, \\delta_{j-1}\\)</span>\n<em>and cross</em> <span class=\"math inline\">\\(\\mu\\)</span><em>.</em><br/>\n</p></li>\n</ul>\n<p>Conceptualized in Figure 4, the actual estimation of the GPCA in Graph\nSpace is done via AAC: (1) Randomly pick some candidates in the\nequivalence classes; (2) estimate the standard PCA in <span class=\"math inline\">\\(X\\)</span>; (3) Select\nnew optimally aligned candidates wrt the current PCA estimation.</p>\n<p><img data-lazy-src=\"https://i0.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/AAC_Scheme_correct_pca.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img data-recalc-dims=\"1\" src=\"https://i0.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/AAC_Scheme_correct_pca.png?w=578&amp;ssl=1\"/></noscript></p>\n<p>Figure 4: Conceptual visualization of the AAC for the estimation of the\nfirst generalized geodesic principal component.</p>\n<p>The AAC converge in finite time and to a local minima as proven in\nTheorem 2 and 3 <span class=\"citation\">Calissano, Feragen, and Vantini (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-calissano2023populations\" rel=\"nofollow\" target=\"_blank\">2023</a>)</span>. All the algorithms and the\nframework is implemeted in the geomstats python package.</p>\n</div>\n<div class=\"section level2\" id=\"an-example\">\n<h2>An Example</h2>\n<p>As an intuitive visual example with real data and associated vectors\nattributes, we subsample <span class=\"math inline\">\\(20\\)</span> cases of the letter A from the well known\nhand written letters dataset <span class=\"citation\">Kersting et al. (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-KKMMN2016\" rel=\"nofollow\" target=\"_blank\">2016</a>)</span>, <span class=\"citation\">Riesen and Bunke (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-riesen2008iam\" rel=\"nofollow\" target=\"_blank\">2008</a>)</span>. As shown in the\nleft panel of Figure 5, every network has node attributes consisting of\nthe node’s <span class=\"math inline\">\\(x\\)</span>– and <span class=\"math inline\">\\(y\\)</span>-coordinates, and binary <span class=\"math inline\">\\((0/1\\)</span>) edge attributes\nindicating whether nodes are connected by lines.</p>\n<p><img data-lazy-src=\"https://i1.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/Letters_Plot.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img data-recalc-dims=\"1\" src=\"https://i1.wp.com/youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/Letters_Plot.png?w=578&amp;ssl=1\"/></noscript></p>\n<p>Figure 5: <strong>Left:</strong> A datum extracted from the <span class=\"math inline\">\\(A\\)</span> dataset. Every\nunlabelled node has a bi-dimensional real valued attribute, while every\nedge has a <span class=\"math inline\">\\({0,1}\\)</span> attribute. The Fréchet mean. <strong>Right:</strong> Visualization\nof the GGPCs. <span class=\"math inline\">\\({0.1,0.25,0.5,0.75,0.9}\\)</span> quantile of the projected scores\nare shown for the first three GGPCs.</p>\n</div>\n<div class=\"section level2\" id=\"conclusion\">\n<h2>Conclusion</h2>\n<p>Graph Space is an intuitive embedding for sets of graphs with unlabelled\nsets of nodes. Even if its geometry is far from trivial, we can easily\nestimate intrinsic statistics by using the Align All and Compute\nalgorithm. In <span class=\"citation\">Calissano, Feragen, and Vantini (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-calissano2023populations\" rel=\"nofollow\" target=\"_blank\">2023</a>)</span> we detailed the geometry of\nGraph Space, we define the AAC algorithm and the Generalized Geodesic\nPrincipal Components for a set of graphs. Regression with unlabelled\nnetwork outputs is also available in <span class=\"citation\">Calissano, Feragen, and Vantini (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-calissano2022graph\" rel=\"nofollow\" target=\"_blank\">2022</a>)</span>. All the\nframework is available as part of the geomstats python package\n<span class=\"citation\">Miolane et al. (<a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/#ref-miolane2020geomstats\" rel=\"nofollow\" target=\"_blank\">2020</a>)</span>.</p>\n</div>\n<div class=\"section level2 unnumbered\" id=\"references\">\n<h2>References</h2>\n<div class=\"references csl-bib-body hanging-indent\" id=\"refs\">\n<div class=\"csl-entry\" id=\"ref-calissano2022graph\">\nCalissano, Anna, Aasa Feragen, and Simone Vantini. 2022. <span>“Graph-Valued Regression: Prediction of Unlabelled Networks in a Non-Euclidean Graph Space.”</span> <em>Journal of Multivariate Analysis</em> 190: 104950.\n</div>\n<div class=\"csl-entry\" id=\"ref-calissano2023populations\">\n———. 2023. <span>“Populations of Unlabelled Networks: Graph Space Geometry and Generalized Geodesic Principal Components.”</span> <em>Biometrika</em>, asad024.\n</div>\n<div class=\"csl-entry\" id=\"ref-chowdhury2019gromov\">\nChowdhury, Samir, and Facundo Mémoli. 2019. <span>“The Gromov–Wasserstein Distance Between Networks and Stable Network Invariants.”</span> <em>Information and Inference: A Journal of the IMA</em> 8 (4): 757–87.\n</div>\n<div class=\"csl-entry\" id=\"ref-conte2004thirty\">\nConte, Donatello, Pasquale Foggia, Carlo Sansone, and Mario Vento. 2004. <span>“Thirty Years of Graph Matching in Pattern Recognition.”</span> <em>International Journal of Pattern Recognition and Artificial Intelligence</em> 18 (03): 265–98.\n</div>\n<div class=\"csl-entry\" id=\"ref-durante2017nonparametric\">\nDurante, Daniele, David B Dunson, and Joshua T Vogelstein. 2017. <span>“Nonparametric <span>B</span>ayes Modeling of Populations of Networks.”</span> <em>Journal of the American Statistical Association</em> 112 (520): 1516–30.\n</div>\n<div class=\"csl-entry\" id=\"ref-frechet1948elements\">\nFréchet, Maurice. 1948. <span>“Les <span class=\"nocase\">é</span>l<span>é</span>ments Al<span>é</span>atoires de Nature Quelconque Dans Un Espace Distanci<span>é</span>.”</span> <em>Annales de l’institut Henri Poincar<span>é</span></em> 10 (4): 215–310.\n</div>\n<div class=\"csl-entry\" id=\"ref-ginestet2017\">\nGinestet, C. E., J. Li, P. Balachandran, S. Rosenberg, and E. D. Kolaczyk. 2017. <span>“Hypothesis Testing for Network Data in Functional Neuroimaging.”</span> <em>The Annals of Applied Statistics</em> 11 (2): 725–50. <a href=\"https://doi.org/10.1214/16-AOAS1015\" rel=\"nofollow\" target=\"_blank\">https://doi.org/10.1214/16-AOAS1015</a>.\n</div>\n<div class=\"csl-entry\" id=\"ref-huckemann\">\nHuckemann, S., T. Hotz, and A. Munk. 2010. <span>“Intrinsic Shape Analysis: Geodesic <span>PCA</span> for <span>R</span>iemannian Manifolds Modulo Isometric <span>L</span>ie Group Actions.”</span> <em>Statist. Sinica</em> 20 (1): 1–58.\n</div>\n<div class=\"csl-entry\" id=\"ref-jain2009structure\">\nJain, B. J., and K. Obermayer. 2009. <span>“Structure Spaces.”</span> <em>Journal of Machine Learning Research</em> 10 (Nov): 2667–2714.\n</div>\n<div class=\"csl-entry\" id=\"ref-KKMMN2016\">\nKersting, K., Kriege N. M., C. Morris, Mutzel. P., and M. Neumann. 2016. <span>“Benchmark Data Sets for Graph Kernels.”</span> <a href=\"http://graphkernels.cs.tu-dortmund.de/\" rel=\"nofollow\" target=\"_blank\">http://graphkernels.cs.tu-dortmund.de</a>.\n</div>\n<div class=\"csl-entry\" id=\"ref-lee2013smooth\">\nLee, John M. 2013. <em>Smooth Manifolds</em>. Springer.\n</div>\n<div class=\"csl-entry\" id=\"ref-lunagomez2021modeling\">\nLunagómez, Simón, Sofia C Olhede, and Patrick J Wolfe. 2021. <span>“Modeling Network Populations via Graph Distances.”</span> <em>Journal of the American Statistical Association</em> 116 (536): 2023–40.\n</div>\n<div class=\"csl-entry\" id=\"ref-miolane2020geomstats\">\nMiolane, Nina, Nicolas Guigui, Alice Le Brigant, Johan Mathe, Benjamin Hou, Yann Thanwerdas, Stefan Heyder, et al. 2020. <span>“Geomstats: A Python Package for Riemannian Geometry in Machine Learning.”</span> <em>Journal of Machine Learning Research</em> 21 (223): 1–9.\n</div>\n<div class=\"csl-entry\" id=\"ref-riesen2008iam\">\nRiesen, K., and H. Bunke. 2008. <span>“IAM Graph Database Repository for Graph Based Pattern Recognition and Machine Learning.”</span> In <em>Joint IAPR International Workshops on Statistical Techniques in Pattern Recognition (SPR) and Structural and Syntactic Pattern Recognition (SSPR)</em>, 287–97. Springer.\n</div>\n<div class=\"csl-entry\" id=\"ref-severn2020non\">\nSevern, Katie E, Ian L Dryden, and Simon P Preston. 2020. <span>“Non-Parametric Regression for Networks.”</span> <em>arXiv Preprint arXiv:2010.00050</em>.\n</div>\n<div class=\"csl-entry\" id=\"ref-simpson2013permutation\">\nSimpson, Sean L, Robert G Lyday, Satoru Hayasaka, Anthony P Marsh, and Paul J Laurienti. 2013. <span>“A Permutation Testing Framework to Compare Groups of Brain Networks.”</span> <em>Frontiers in Computational Neuroscience</em> 7: 171.\n</div>\n<div class=\"csl-entry\" id=\"ref-vogelstein2015fast\">\nVogelstein, Joshua T, John M Conroy, Vince Lyzinski, Louis J Podrazik, Steven G Kratzer, Eric T Harley, Donniell E Fishkind, R Jacob Vogelstein, and Carey E Priebe. 2015. <span>“Fast Approximate Quadratic Programming for Graph Matching.”</span> <em>PLOS One</em> 10 (4): e0121002.\n</div>\n</div>\n</div>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://youngstats.github.io/post/2023/11/06/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/\"> YoungStatS</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
      "main_text": "Populations of Unlabeled Networks: Graph Space Geometry and Generalized Geodesic Principal Components\nPosted on\nNovember 5, 2023\nby\nYoungStatS\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nYoungStatS\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nOverview\nSets of graphs arise in many different applications, from medicine to\nfinance, from urban planning to social science. Analysing sets of graphs\nis far from trivial as they are strongly non Euclidean data type. There\nare two main sets of graphs:\nlabelled: where there is the same sets of nodes across each\nobservation;\nunlabelled: where there is no clear correspondence in the nodes\nacross networks.\nUnlabelled graphs poses high challenges from both the embedding\nprospective (which geometrical embedding is suitable for such graphs)\nand the statistical perspective (how can we extend basic tools to such\nembedding).\nIn the past years, scholars have been proposing different embedding\nstrategies for unlabelled graphs. Among existing models:\nGinestet et al. (\n2017\n)\nproposes a model where networks’ Laplacian matrices are smoothly\ninjected into a sub-manifold of a Euclidean space;\nSimpson et al. (\n2013\n)\n,\nSevern, Dryden, and Preston (\n2020\n)\nand\nDurante, Dunson, and Vogelstein (\n2017\n)\nface the problem of generating and performing tests on a population of\nnetworks;\nLunagómez, Olhede, and Wolfe (\n2021\n)\nprovide Bayesian modelling for discrete\nlabeled graphs, and\nChowdhury and Mémoli (\n2019\n)\nstudies a metric space of\nnetworks up to weak isomorphism, which allows the grouping of similar\nnodes. In\nCalissano, Feragen, and Vantini (\n2023\n)\n, we characterize geometrically the\nGraph Space quotient space introduced by\nJain and Obermayer (\n2009\n)\nand we\nextended principal component analysis to sets of unlabelled graphs.\nGraph Space\nConsider\n\\(G_1,\\dots, G_k\\)\nwhere each\n\\(G_i=(N_i,E_i,a_i)\\)\nsets of nodes\n\\(N_i\\)\n, edges\n\\(E_i\\)\n, and a real valued attribute function\n\\(a_i :E_i \\rightarrow \\mathbb{R}\\)\n. Each graph can be described as a set\nof adjacency matrix\n\\(x \\in X=\\mathbb{R}^{n\\times n}\\)\n. We can embed\nunlabelled graphs in a quotient space\n\\(X / T\\)\nwhere\n\\(T\\)\nset of\npermutation matrices. Each graph is now represented by its equivalence\nclass of permuted graphs:\n\\[[x]=\\{t^T x t: t\\in T\\}\\]\nFigure 1: Conceptual visualization of Graph Space.\nBy equipping the total space with a metric\n\\((X,d_X)\\)\nwe can define a\nquotient metric on\n\\(X / T\\)\nas:\n\\[d_{X/T}([x_1],[x_2])=min_{t\\in T}d_X (t^T x_1 t, x_2)\\]\nSuch metric\ncorresponds in finding the optimal candidate in the equivalence class\nwhich minimize the distance in the total space. The minimization problem\nis known as the Graph Matching problem, which is a broadly studied\nproblem in optimization\nConte et al. (\n2004\n)\nfor a review). As we select\n\\(d_X\\)\nto be the Frobenius norm, we use the FAQ Graph matching\nVogelstein et al. (\n2015\n)\n.\nFigure 2: Conceptual visualization of the distance in the Graph Space.\nShort Geometrical Characterization of Graph Space\nThe graph space is a metric space\n\\((X / T,d_{X/T})\\)\n, but it is not a\nmanifold: The equivalence classes are often not of the same dimensions\n(symmetries or blocks of zeros can cause the permutation to leave the\ngraph unchanged), thus the action is not free and the space is not a\nquotient manifold (see\nLee (\n2013\n)\nfor details on quotient\nmanifolds). However, the total space\n\\(X=\\mathbb{R}^{n\\times n}\\)\nis\nEuclidean. To overcome the complexity of the Graph Space and perform\nstatistics on unlabelled graphs, we define an algorithm relying on the\ntotal space\n\\(X\\)\nfor the computations.\nAlign All and Compute\nThe Align All and Compute Algorithm (AAC) allows to compute intrinsic\nstatistics on Graph Space by computing the estimators on the total\nspace. We illustrate it here for the estimation of the Fréchet Mean\nFréchet (\n1948\n)\n. Consider a set of\n\\(\\{[x_1],\\dots,[x_k]\\}\\)\ngraphs:\n\\[[\\bar{x}]=min_{[x]\\in X / T }\\sum_{i=1}^{n}d_{X /T}([\\bar{x}],[x_i])\\]\nNotice that the Fréchet Mean results into the arithmetic mean in the\ncase of Euclidean data.\nThe AAC operates as follows:\nAAC algorithm for the the Fréchet Mean\n– Input:\n\\(\\{[x_1],\\dots,[x_k]\\} \\subset X/T\\)\n; a threshold\n\\(\\varepsilon > 0\\)\n– Initialization: Randomly select\n\\(\\tilde{x}=\\tilde{x_i}\\in [x_i] \\in \\{ [x_1],\\dots,[x_k]\\}\\)\n– While\n\\(s>\\varepsilon\\)\n:\nObtain\n\\(\\tilde{x_i}\\)\noptimally aligned wrt\n\\(\\tilde{x}\\)\nfor\n\\(i =\\{ 1,\\dots, k\\}\\)\nCompute the Fréchet Mean\n\\(\\bar{x}\\)\nin\n\\(X\\)\nof\n\\(\\{\\tilde{x_1},\\tilde{x_2},\\dots,\\tilde{x_k}\\} \\in X\\)\nCompute\n\\(s=d(\\tilde{x},\\bar{x})\\)\nSet\n\\(\\tilde{x}=\\bar{x}\\)\n– Output:\n\\([\\bar{x}]\\)\n, an estimate of the Fréchet Mean of\n\\(\\{[x_1], \\ldots, [x_k]\\} \\in X/T\\)\n.\nThe Figure 3 represents the algorithm graphically:\nFigure 3: Conceptual visualization of the AAC algorithm. The star\nrepresents the current estimation of the Frechet Mean.\nGeneralized Geodesic Principal Components\nLet’s move now to more complex estimators. To extend the Principal\nComponent Analysis to Graph Space: (1) we firstly extend the concept of\ngeodesic to Graph Space; (2) we define a way to align an equivalent\nclass to a geodesic (i.e. optimal positioning).\nDefinition 1 (Generalized Geodesics):\nDenote by\n\\(\\Gamma(X)\\)\nthe set of all straight lines (geodesics) in\n\\(X\\)\n. Following\nHuckemann, Hotz, and Munk (\n2010\n)\n, a curve\n\\(\\delta\\)\nis a generalized geodesic\non the Graph Space\n\\(X/T\\)\n, if it is a projection of a straight line on\n\\(X\\)\n:\n\\[\\begin{equation}\n    \\Gamma(X/T)=\\{\\delta=\\pi \\circ \\gamma:\\gamma\\in\\Gamma(X)\\}.\n\\end{equation}\\]\nWhere\n\\(\\pi: X\\rightarrow X/T\\)\nis the canonical\nquotient space projection.\nSince Graph Space is not an inner product space, we define orthogonality\nas:\nDefinition 2:\nTwo generalized geodesics\n\\(\\delta_1,\\delta_2\\in\\Gamma(X/T)\\)\nare orthogonal if they have\nrepresentatives in\n\\(\\delta_1=\\pi\\circ\\gamma_1,\\delta_2=\\pi\\circ\\gamma_2, \\gamma_1,\\gamma_2\\in\\Gamma(X)\\)\nwhich are orthogonal\n\\(<\\gamma_1,\\gamma_2>_X=0\\)\n.\nIn order to bridge computations in Graph Space\n\\(X/T\\)\nwith computations\nin the total space\n\\(X\\)\n, we introduce a concept of alignment in\n\\(X\\)\n.\nDefinition 3 (Optimal position):\nGiven\n\\(\\tilde{x} \\in X\\)\nand\n\\(t \\in T\\)\n, the point\n\\(t^T \\tilde{x} t\\)\nis in\nif\n\\[\nd_X(t^T \\tilde{x}t,x)= d_{X/T}([\\tilde{x}],[x]).\n\\]\nThat is, the equivalence class\n\\([\\tilde{x}] \\in X/T\\)\ncontains (at\nleast) one point\n\\(t^T \\tilde{x} t \\in [\\tilde{x}]\\)\nwhich has minimal\ndistance to\n\\(x\\)\n, and this point is in optimal position to\n\\(x\\)\n. Next,\nconsider\n\\([x] \\in X/T\\)\n,\n\\(t \\in T\\)\nand\n\\(\\delta\\)\na generalized\ngeodesic in\n\\(X/T\\)\nwith representative\n\\(\\gamma\\in \\Gamma(X)\\)\n. The\ngraph representative\n\\(t^T x t\\in X\\)\nis in optimal position to\n\\(\\gamma\\in\\Gamma(X)\\)\nif\n\\[d_X(t^T x t ,\\gamma)=d_{X/T}([x],\\delta).\\]\nHaving concepts of generalized geodesic, optimal position and\northogonality, we now define a set of geodesic principal components:\nDefinition 4:\nConsider the canonical projection of the Graph Space\n\\(\\pi \\colon X \\rightarrow X/T\\)\nof\n\\(X\\)\nand consider a set\n\\(\\{[x_1],\\dots, [x_k]\\} \\subset X/T\\)\nof graphs,\n\\([x]\\in X/T\\)\n, and\n\\(\\delta \\in \\Gamma(X/T)\\)\n. The Generalized Geodesic Principal Components\n(GGPCs) for the set\n\\(\\{[x_1],\\dots, [x_k]\\}\\)\nare defined as:\nThe first generalized geodesic principal component\n\\(\\delta_1 \\in \\Gamma(X/T)\\)\nis the generalized geodesic minimizing\nthe sum of squared residuals:\n\\[\\begin{equation}\\label{eq:wrtdelta}\n    \\delta_1 = \\underset{\\delta \\in \\Gamma(X/T)}{\\operatorname{argmin}} \\sum_{i=1}^{k}{(d_{X/T}^2([x_i],\\delta))}\n\\end{equation}\\]\nThe second generalized geodesic principal component\n\\(\\delta_2 \\in \\Gamma(X/T)\\)\nminimizes (2) over all\n\\(\\delta \\in \\Gamma(X/T)\\)\n, having at least one point in common with\n\\(\\delta_1\\)\nand being orthogonal to\n\\(\\delta_1\\)\nat all points in\ncommon with\n\\(\\delta_1\\)\n.\nThe point\n\\(\\mu\\in X/T\\)\nis called Principal Component Mean if it\nminimizes\n\\[\\begin{equation}\\label{eq:wrtpoint}\n     \\sum_{i=1}^{k}{(d_{X/T}^2([x_i],[\\mu])^2)}\n\\end{equation}\\]\nwhere\n\\([\\mu]\\)\nonly runs over points\n\\(\\tilde{x}\\)\nin common with\n\\(\\delta_1\\)\nand\n\\(\\delta_2\\)\n.\nThe\n\\(j^{th}\\)\ngeneralized geodesic principal component is a\n\\(\\delta_j \\in \\Gamma(X/T)\\)\nif it minimizes (2) over all generalized\ngeodesics that meet orthogonally\n\\(\\delta_1,\\dots, \\delta_{j-1}\\)\nand cross\n\\(\\mu\\)\n.\nConceptualized in Figure 4, the actual estimation of the GPCA in Graph\nSpace is done via AAC: (1) Randomly pick some candidates in the\nequivalence classes; (2) estimate the standard PCA in\n\\(X\\)\n; (3) Select\nnew optimally aligned candidates wrt the current PCA estimation.\nFigure 4: Conceptual visualization of the AAC for the estimation of the\nfirst generalized geodesic principal component.\nThe AAC converge in finite time and to a local minima as proven in\nTheorem 2 and 3\nCalissano, Feragen, and Vantini (\n2023\n)\n. All the algorithms and the\nframework is implemeted in the geomstats python package.\nAn Example\nAs an intuitive visual example with real data and associated vectors\nattributes, we subsample\n\\(20\\)\ncases of the letter A from the well known\nhand written letters dataset\nKersting et al. (\n2016\n)\n,\nRiesen and Bunke (\n2008\n)\n. As shown in the\nleft panel of Figure 5, every network has node attributes consisting of\nthe node’s\n\\(x\\)\n– and\n\\(y\\)\n-coordinates, and binary\n\\((0/1\\)\n) edge attributes\nindicating whether nodes are connected by lines.\nFigure 5:\nLeft:\nA datum extracted from the\n\\(A\\)\ndataset. Every\nunlabelled node has a bi-dimensional real valued attribute, while every\nedge has a\n\\({0,1}\\)\nattribute. The Fréchet mean.\nRight:\nVisualization\nof the GGPCs.\n\\({0.1,0.25,0.5,0.75,0.9}\\)\nquantile of the projected scores\nare shown for the first three GGPCs.\nConclusion\nGraph Space is an intuitive embedding for sets of graphs with unlabelled\nsets of nodes. Even if its geometry is far from trivial, we can easily\nestimate intrinsic statistics by using the Align All and Compute\nalgorithm. In\nCalissano, Feragen, and Vantini (\n2023\n)\nwe detailed the geometry of\nGraph Space, we define the AAC algorithm and the Generalized Geodesic\nPrincipal Components for a set of graphs. Regression with unlabelled\nnetwork outputs is also available in\nCalissano, Feragen, and Vantini (\n2022\n)\n. All the\nframework is available as part of the geomstats python package\nMiolane et al. (\n2020\n)\n.\nReferences\nCalissano, Anna, Aasa Feragen, and Simone Vantini. 2022.\n“Graph-Valued Regression: Prediction of Unlabelled Networks in a Non-Euclidean Graph Space.”\nJournal of Multivariate Analysis\n190: 104950.\n———. 2023.\n“Populations of Unlabelled Networks: Graph Space Geometry and Generalized Geodesic Principal Components.”\nBiometrika\n, asad024.\nChowdhury, Samir, and Facundo Mémoli. 2019.\n“The Gromov–Wasserstein Distance Between Networks and Stable Network Invariants.”\nInformation and Inference: A Journal of the IMA\n8 (4): 757–87.\nConte, Donatello, Pasquale Foggia, Carlo Sansone, and Mario Vento. 2004.\n“Thirty Years of Graph Matching in Pattern Recognition.”\nInternational Journal of Pattern Recognition and Artificial Intelligence\n18 (03): 265–98.\nDurante, Daniele, David B Dunson, and Joshua T Vogelstein. 2017.\n“Nonparametric\nB\nayes Modeling of Populations of Networks.”\nJournal of the American Statistical Association\n112 (520): 1516–30.\nFréchet, Maurice. 1948.\n“Les\né\nl\né\nments Al\né\natoires de Nature Quelconque Dans Un Espace Distanci\né\n.”\nAnnales de l’institut Henri Poincar\né\n10 (4): 215–310.\nGinestet, C. E., J. Li, P. Balachandran, S. Rosenberg, and E. D. Kolaczyk. 2017.\n“Hypothesis Testing for Network Data in Functional Neuroimaging.”\nThe Annals of Applied Statistics\n11 (2): 725–50.\nhttps://doi.org/10.1214/16-AOAS1015\n.\nHuckemann, S., T. Hotz, and A. Munk. 2010.\n“Intrinsic Shape Analysis: Geodesic\nPCA\nfor\nR\niemannian Manifolds Modulo Isometric\nL\nie Group Actions.”\nStatist. Sinica\n20 (1): 1–58.\nJain, B. J., and K. Obermayer. 2009.\n“Structure Spaces.”\nJournal of Machine Learning Research\n10 (Nov): 2667–2714.\nKersting, K., Kriege N. M., C. Morris, Mutzel. P., and M. Neumann. 2016.\n“Benchmark Data Sets for Graph Kernels.”\nhttp://graphkernels.cs.tu-dortmund.de\n.\nLee, John M. 2013.\nSmooth Manifolds\n. Springer.\nLunagómez, Simón, Sofia C Olhede, and Patrick J Wolfe. 2021.\n“Modeling Network Populations via Graph Distances.”\nJournal of the American Statistical Association\n116 (536): 2023–40.\nMiolane, Nina, Nicolas Guigui, Alice Le Brigant, Johan Mathe, Benjamin Hou, Yann Thanwerdas, Stefan Heyder, et al. 2020.\n“Geomstats: A Python Package for Riemannian Geometry in Machine Learning.”\nJournal of Machine Learning Research\n21 (223): 1–9.\nRiesen, K., and H. Bunke. 2008.\n“IAM Graph Database Repository for Graph Based Pattern Recognition and Machine Learning.”\nIn\nJoint IAPR International Workshops on Statistical Techniques in Pattern Recognition (SPR) and Structural and Syntactic Pattern Recognition (SSPR)\n, 287–97. Springer.\nSevern, Katie E, Ian L Dryden, and Simon P Preston. 2020.\n“Non-Parametric Regression for Networks.”\narXiv Preprint arXiv:2010.00050\n.\nSimpson, Sean L, Robert G Lyday, Satoru Hayasaka, Anthony P Marsh, and Paul J Laurienti. 2013.\n“A Permutation Testing Framework to Compare Groups of Brain Networks.”\nFrontiers in Computational Neuroscience\n7: 171.\nVogelstein, Joshua T, John M Conroy, Vince Lyzinski, Louis J Podrazik, Steven G Kratzer, Eric T Harley, Donniell E Fishkind, R Jacob Vogelstein, and Carey E Priebe. 2015.\n“Fast Approximate Quadratic Programming for Graph Matching.”\nPLOS One\n10 (4): e0121002.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nYoungStatS\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Overview Sets of graphs arise in many different applications, from medicine to finance, from urban planning to social science. Analysing sets of graphs is far from trivial as they are strongly non Euclidean data type. There are two main sets of gra...",
      "meta_keywords": null,
      "og_description": "Overview Sets of graphs arise in many different applications, from medicine to finance, from urban planning to social science. Analysing sets of graphs is far from trivial as they are strongly non Euclidean data type. There are two main sets of gra...",
      "og_image": "https://youngstats.github.io/post/2023-11-06-populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components_files/exampleequivalenceclasses_graphspace.png",
      "og_title": "Populations of Unlabeled Networks: Graph Space Geometry and Generalized Geodesic Principal Components | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 11.3,
      "sitemap_lastmod": "2023-11-06T00:00:00+00:00",
      "twitter_description": "Overview Sets of graphs arise in many different applications, from medicine to finance, from urban planning to social science. Analysing sets of graphs is far from trivial as they are strongly non Euclidean data type. There are two main sets of gra...",
      "twitter_title": "Populations of Unlabeled Networks: Graph Space Geometry and Generalized Geodesic Principal Components | R-bloggers",
      "url": "https://www.r-bloggers.com/2023/11/populations-of-unlabeled-networks-graph-space-geometry-and-generalized-geodesic-principal-components/",
      "word_count": 2251
    }
  }
}