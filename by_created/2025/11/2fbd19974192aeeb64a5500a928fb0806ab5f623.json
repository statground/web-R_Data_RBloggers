{
  "id": "2fbd19974192aeeb64a5500a928fb0806ab5f623",
  "url": "https://www.r-bloggers.com/2024/01/r-solution-for-excel-puzzles-8/",
  "created_at_utc": "2025-11-17T20:38:34Z",
  "data": null,
  "raw_original": {
    "uuid": "9fcaeea0-c2bc-479e-bb96-a71f1dc8b411",
    "created_at": "2025-11-17 20:38:34",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2024/01/r-solution-for-excel-puzzles-8/",
      "crawled_at": "2025-11-17T09:17:59.028728",
      "external_links": [
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-eb2c2ec32237",
          "text": "Numbers around us - Medium"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://www.linkedin.com/in/excelbi/",
          "text": "ExcelBI"
        },
        {
          "href": "https://github.com/kgryczan/excelbi_puzzles",
          "text": "Github"
        },
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-eb2c2ec32237",
          "text": "R Solution for Excel Puzzles"
        },
        {
          "href": "https://medium.com/number-around-us",
          "text": "Numbers around us"
        },
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-eb2c2ec32237",
          "text": "Numbers around us - Medium"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "R Solution for Excel Puzzles | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*P0DSJICnvy8wOXFUk6SOjw.jpeg?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*7hWDdeoCkMfd9Xk_maTIgw.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*gp7uFS6gI5uYEcPYMJIOcg.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*NFyuKiPH8VPBoKBeiU2Dtw.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*7fWBuWtokthmQAMzkl-rKQ.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*9UcOWjoOETcaytTZHjm-eA.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": "data:application/octet-stream;base64,R0lGODlhAQABAO+/vQAA77+977+977+9AAAAIe+/vQQBAAAAACwAAAAAAQABAAACAkQBADs=",
          "src": "https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=eb2c2ec32237"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/numbers-around-us/",
          "text": "Numbers around us"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-381511 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">R Solution for Excel Puzzles</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">January 15, 2024</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/numbers-around-us/\">Numbers around us</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-eb2c2ec32237\"> Numbers around us - Medium</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><p>Puzzles no. 364–368</p><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*P0DSJICnvy8wOXFUk6SOjw.jpeg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*P0DSJICnvy8wOXFUk6SOjw.jpeg?w=578&amp;ssl=1\"/></noscript></figure><h3>Puzzles</h3><p>Author: <a href=\"https://www.linkedin.com/in/excelbi/\" rel=\"nofollow\" target=\"_blank\">ExcelBI</a></p><p>All files (xlsx with puzzle and R with solution) for each and every puzzle are available on my <a href=\"https://github.com/kgryczan/excelbi_puzzles\" rel=\"nofollow\" target=\"_blank\">Github</a>. Enjoy.</p><h3>Puzzle #364</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*7hWDdeoCkMfd9Xk_maTIgw.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*7hWDdeoCkMfd9Xk_maTIgw.png?w=578&amp;ssl=1\"/></noscript></figure><p>In this puzzle we have several numbers to check. But what is the condition those numbers should met? Number should be like this:<br/>1st digit -&gt; 2nd digit = 1st digit +1 or 1st digit-1 -&gt; 3rd digit = 2nd digit +2 or 2nd digit-2 and so on. So absolute value of difference between consecutive digits should increase by 1. Let’s check it.</p><h4>Loading libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/364 Difference Consecutive Digits.xlsx\", range = \"A1:A10\")\ntest  = read_excel(\"Excel/364 Difference Consecutive Digits.xlsx\", range = \"B1:B6\")</pre><h4>Transformation</h4><pre>check_seq_diff = function(x) {\n  digits = as.character(strsplit(as.character(x), \"\")[[1]])\n  diffs = map2_dbl(digits[-length(digits)], \n                   digits[-1], \n                   ~abs(as.numeric(.x) - as.numeric(.y)))\n  all(diffs == 1:length(diffs))\n}\n\nresult = input %&gt;%\n  mutate(test = map_lgl(Number, check_seq_diff)) %&gt;%\n  filter(test) %&gt;%\n  select(-test)</pre><h4>Validation</h4><pre>identical(result$Number, test$`Answer Expected`)\n# [1] TRUE</pre><h3>Puzzle #365</h3><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*gp7uFS6gI5uYEcPYMJIOcg.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*gp7uFS6gI5uYEcPYMJIOcg.png?w=578&amp;ssl=1\"/></noscript></figure><p>Second puzzle was not really hard, but certainly interesting. We need to check if there is any possibility that one of digits in number is a sum of all the others. Logically it should be the largest digits. Lets find out.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/365 One digit is Equal to Sum of other Digits.xlsx\", range = \"A1:A10\")\ntest  = read_excel(\"Excel/365 One digit is Equal to Sum of other Digits.xlsx\", range = \"B1:B5\")</pre><h4>Transformation</h4><pre>evaluate = function(number) {\n  digits = as.numeric(unlist(strsplit(as.character(number), \"\")))\n  check  = purrr::map_lgl(digits, ~ .x == sum(digits[-which(digits == .x)]))\n  return(any(check))\n}\n\nresult = input %&gt;%\n  mutate(eval = map_lgl(Number, evaluate)) %&gt;%\n  filter(eval) %&gt;%\n  select(`Answer Expected` = Number)</pre><h4>Validation</h4><pre>identical(result, test)\n# [1] TRUE</pre><h3>Puzzle #366</h3><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*NFyuKiPH8VPBoKBeiU2Dtw.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*NFyuKiPH8VPBoKBeiU2Dtw.png?w=578&amp;ssl=1\"/></noscript></figure><p>Today we get some weirdly mixed string of letters and digits. We need to make little bit more in order. To do it we need to break it into digits and letters and then treat those vectors as zip fastener: take one element from first, then second, and first again and so on. Lets zip it up!</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/366 Exchange Alphabets and Numbers.xlsx\", range = \"A1:A10\")\ntest  = read_excel(\"Excel/366 Exchange Alphabets and Numbers.xlsx\", range = \"B1:B10\")</pre><h4>Transformation</h4><pre>zip_string = function(string) {\n  letters = str_extract_all(string, \"[a-zA-Z]\")[[1]]\n  digits = str_extract_all(string, \"[0-9]\")[[1]]\n  \n  vec_diff = abs(length(letters) - length(digits))\n  if (vec_diff &gt; 0) {\n    if (length(letters) &gt; length(digits)) {\n      digits = c(digits, rep(\"\", vec_diff))\n    } else {\n      letters = c(letters, rep(\"\", vec_diff))\n    }\n  }\n  result = map2_chr(letters, digits, function(x, y) paste0(x, y)) %&gt;% paste0(collapse = \"\")\n\n  return(result)\n}\n\nresult = input %&gt;%\n  mutate(`Answer Expected` = map_chr(Words, zip_string)) %&gt;%\n  select(-Words)</pre><h4>Validation</h4><pre>identical(result, test)\n# [1] TRUE</pre><h3>Puzzle #367</h3><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*7fWBuWtokthmQAMzkl-rKQ.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*7fWBuWtokthmQAMzkl-rKQ.png?w=578&amp;ssl=1\"/></noscript></figure><p>This puzzle reminded me “Sea Battle” game. We get table with sentence and index. We have to check if index is pointing to first letter of any word in sentence. If this can be confirm, just take word, like we shot vessels in “Sea Battle”.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/367 Extract the Word Starting at an Index.xlsx\", range = \"A1:B10\")\ntest  = read_excel(\"Excel/367 Extract the Word Starting at an Index.xlsx\", range = \"C1:C10\")</pre><h4>Transform</h4><pre>extract_word_by_index = function(sentence, index) {\n  word_pos = str_locate_all(sentence, \"\\\\w+\") %&gt;% as.data.frame()\n  word = word_pos %&gt;% filter(start == index) \n  \n  if (nrow(word) == 0) {\n    word = NA_character_\n  } else {\n    word = sentence %&gt;% str_sub(start = word$start, end = word$end)\n  }\n  \n  return(word)\n}\n\nresult = input %&gt;% \n  mutate(`Answer Expected` = map2_chr(Sentence, Index, extract_word_by_index))</pre><h4>Validation</h4><pre>\nidentical(result$`Answer Expected`, test$`Answer Expected`)\n# [1] FALSE\n# Mistake in the puzzle \n\ninput %&gt;% bind_cols(test) %&gt;% bind_cols(result$`Answer Expected`)</pre><h3>Puzzle #368</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*9UcOWjoOETcaytTZHjm-eA.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*9UcOWjoOETcaytTZHjm-eA.png?w=578&amp;ssl=1\"/></noscript></figure><p>This puzzle brought many memories. When I was teenager and young adult, all “comunicational” revolution happened. Firstly those old-style mobiles, then more inteligent models, and finally smartphones come up in less then 10 years (at least in Poland). And we were texting a lot on those. If somebody get fluent in texting using multitapping, then it is possible in many different ways (below table, in pocket, behind back). <br/>But get back to puzzle. We need to encode given words into multitap cypher.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/368 Multi Tap Cipher.xlsx\", range = \"A1:A10\")\ntest  = read_excel(\"Excel/368 Multi Tap Cipher.xlsx\", range = \"B1:B10\")</pre><h4>Transformation</h4><pre>encode = function(word) {\n  chars = str_split(word, \"\")[[1]]\n  pos = match(chars, letters)\n  tibble = tibble(\n    Letter = chars,\n    Position = pos,\n    Button = calculate_button(pos),\n    Taps = calculate_taps(pos),\n    repetitions = (map2_chr(Button, Taps, ~ rep(.x, .y) %&gt;% paste0(collapse = \"\")))\n  ) %&gt;%\n    pull(repetitions) %&gt;%\n    str_c(collapse = \"\")\n}\n\ncalculate_button &lt;- function(letter_pos) {\n  case_when(\n    letter_pos &lt;= 15 ~ ((letter_pos - 1) %/% 3) + 2,\n    letter_pos &lt;= 19 ~ 7,\n    letter_pos &lt;= 22 ~ 8,\n    TRUE ~ 9\n  )\n}\n\ncalculate_taps &lt;- function(letter_pos) {\n  case_when(\n    letter_pos &lt;= 15 ~ ((letter_pos - 1) %% 3) + 1,\n    letter_pos &lt;= 19 ~ ((letter_pos - 16) %% 4) + 1,\n    letter_pos &lt;= 22 ~ ((letter_pos - 20) %% 3) + 1,\n    TRUE ~ ((letter_pos - 23) %% 4) + 1\n  )\n}\n\nresult = input %&gt;%\n  mutate(`Answer Expected` = map_chr(Words, encode))</pre><h4>Validation</h4><pre>identical(result$`Answer Expected`, test$`Answer Expected`)\n# [1] TRUE</pre><p>Feel free to comment, share and contact me with advices, questions and your ideas how to improve anything. Contact me on Linkedin if you wish as well.</p><img alt=\"\" data-lazy-src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=eb2c2ec32237\" height=\"1\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"1\"/><noscript><img alt=\"\" height=\"1\" loading=\"lazy\" src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=eb2c2ec32237\" width=\"1\"/></noscript><hr/><p><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-eb2c2ec32237\" rel=\"nofollow\" target=\"_blank\">R Solution for Excel Puzzles</a> was originally published in <a href=\"https://medium.com/number-around-us\" rel=\"nofollow\" target=\"_blank\">Numbers around us</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-eb2c2ec32237\"> Numbers around us - Medium</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
      "main_text": "R Solution for Excel Puzzles\nPosted on\nJanuary 15, 2024\nby\nNumbers around us\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nNumbers around us - Medium\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nPuzzles no. 364–368\nPuzzles\nAuthor:\nExcelBI\nAll files (xlsx with puzzle and R with solution) for each and every puzzle are available on my\nGithub\n. Enjoy.\nPuzzle #364\nIn this puzzle we have several numbers to check. But what is the condition those numbers should met? Number should be like this:\n1st digit -> 2nd digit = 1st digit +1 or 1st digit-1 -> 3rd digit = 2nd digit +2 or 2nd digit-2 and so on. So absolute value of difference between consecutive digits should increase by 1. Let’s check it.\nLoading libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/364 Difference Consecutive Digits.xlsx\", range = \"A1:A10\")\ntest  = read_excel(\"Excel/364 Difference Consecutive Digits.xlsx\", range = \"B1:B6\")\nTransformation\ncheck_seq_diff = function(x) {\n  digits = as.character(strsplit(as.character(x), \"\")[[1]])\n  diffs = map2_dbl(digits[-length(digits)], \n                   digits[-1], \n                   ~abs(as.numeric(.x) - as.numeric(.y)))\n  all(diffs == 1:length(diffs))\n}\n\nresult = input %>%\n  mutate(test = map_lgl(Number, check_seq_diff)) %>%\n  filter(test) %>%\n  select(-test)\nValidation\nidentical(result$Number, test$`Answer Expected`)\n# [1] TRUE\nPuzzle #365\nSecond puzzle was not really hard, but certainly interesting. We need to check if there is any possibility that one of digits in number is a sum of all the others. Logically it should be the largest digits. Lets find out.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/365 One digit is Equal to Sum of other Digits.xlsx\", range = \"A1:A10\")\ntest  = read_excel(\"Excel/365 One digit is Equal to Sum of other Digits.xlsx\", range = \"B1:B5\")\nTransformation\nevaluate = function(number) {\n  digits = as.numeric(unlist(strsplit(as.character(number), \"\")))\n  check  = purrr::map_lgl(digits, ~ .x == sum(digits[-which(digits == .x)]))\n  return(any(check))\n}\n\nresult = input %>%\n  mutate(eval = map_lgl(Number, evaluate)) %>%\n  filter(eval) %>%\n  select(`Answer Expected` = Number)\nValidation\nidentical(result, test)\n# [1] TRUE\nPuzzle #366\nToday we get some weirdly mixed string of letters and digits. We need to make little bit more in order. To do it we need to break it into digits and letters and then treat those vectors as zip fastener: take one element from first, then second, and first again and so on. Lets zip it up!\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/366 Exchange Alphabets and Numbers.xlsx\", range = \"A1:A10\")\ntest  = read_excel(\"Excel/366 Exchange Alphabets and Numbers.xlsx\", range = \"B1:B10\")\nTransformation\nzip_string = function(string) {\n  letters = str_extract_all(string, \"[a-zA-Z]\")[[1]]\n  digits = str_extract_all(string, \"[0-9]\")[[1]]\n  \n  vec_diff = abs(length(letters) - length(digits))\n  if (vec_diff > 0) {\n    if (length(letters) > length(digits)) {\n      digits = c(digits, rep(\"\", vec_diff))\n    } else {\n      letters = c(letters, rep(\"\", vec_diff))\n    }\n  }\n  result = map2_chr(letters, digits, function(x, y) paste0(x, y)) %>% paste0(collapse = \"\")\n\n  return(result)\n}\n\nresult = input %>%\n  mutate(`Answer Expected` = map_chr(Words, zip_string)) %>%\n  select(-Words)\nValidation\nidentical(result, test)\n# [1] TRUE\nPuzzle #367\nThis puzzle reminded me “Sea Battle” game. We get table with sentence and index. We have to check if index is pointing to first letter of any word in sentence. If this can be confirm, just take word, like we shot vessels in “Sea Battle”.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/367 Extract the Word Starting at an Index.xlsx\", range = \"A1:B10\")\ntest  = read_excel(\"Excel/367 Extract the Word Starting at an Index.xlsx\", range = \"C1:C10\")\nTransform\nextract_word_by_index = function(sentence, index) {\n  word_pos = str_locate_all(sentence, \"\\\\w+\") %>% as.data.frame()\n  word = word_pos %>% filter(start == index) \n  \n  if (nrow(word) == 0) {\n    word = NA_character_\n  } else {\n    word = sentence %>% str_sub(start = word$start, end = word$end)\n  }\n  \n  return(word)\n}\n\nresult = input %>% \n  mutate(`Answer Expected` = map2_chr(Sentence, Index, extract_word_by_index))\nValidation\nidentical(result$`Answer Expected`, test$`Answer Expected`)\n# [1] FALSE\n# Mistake in the puzzle \n\ninput %>% bind_cols(test) %>% bind_cols(result$`Answer Expected`)\nPuzzle #368\nThis puzzle brought many memories. When I was teenager and young adult, all “comunicational” revolution happened. Firstly those old-style mobiles, then more inteligent models, and finally smartphones come up in less then 10 years (at least in Poland). And we were texting a lot on those. If somebody get fluent in texting using multitapping, then it is possible in many different ways (below table, in pocket, behind back).\nBut get back to puzzle. We need to encode given words into multitap cypher.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Excel/368 Multi Tap Cipher.xlsx\", range = \"A1:A10\")\ntest  = read_excel(\"Excel/368 Multi Tap Cipher.xlsx\", range = \"B1:B10\")\nTransformation\nencode = function(word) {\n  chars = str_split(word, \"\")[[1]]\n  pos = match(chars, letters)\n  tibble = tibble(\n    Letter = chars,\n    Position = pos,\n    Button = calculate_button(pos),\n    Taps = calculate_taps(pos),\n    repetitions = (map2_chr(Button, Taps, ~ rep(.x, .y) %>% paste0(collapse = \"\")))\n  ) %>%\n    pull(repetitions) %>%\n    str_c(collapse = \"\")\n}\n\ncalculate_button <- function(letter_pos) {\n  case_when(\n    letter_pos <= 15 ~ ((letter_pos - 1) %/% 3) + 2,\n    letter_pos <= 19 ~ 7,\n    letter_pos <= 22 ~ 8,\n    TRUE ~ 9\n  )\n}\n\ncalculate_taps <- function(letter_pos) {\n  case_when(\n    letter_pos <= 15 ~ ((letter_pos - 1) %% 3) + 1,\n    letter_pos <= 19 ~ ((letter_pos - 16) %% 4) + 1,\n    letter_pos <= 22 ~ ((letter_pos - 20) %% 3) + 1,\n    TRUE ~ ((letter_pos - 23) %% 4) + 1\n  )\n}\n\nresult = input %>%\n  mutate(`Answer Expected` = map_chr(Words, encode))\nValidation\nidentical(result$`Answer Expected`, test$`Answer Expected`)\n# [1] TRUE\nFeel free to comment, share and contact me with advices, questions and your ideas how to improve anything. Contact me on Linkedin if you wish as well.\nR Solution for Excel Puzzles\nwas originally published in\nNumbers around us\non Medium, where people are continuing the conversation by highlighting and responding to this story.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nNumbers around us - Medium\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Puzzles no. 364–368PuzzlesAuthor: ExcelBIAll files (xlsx with puzzle and R with solution) for each and every puzzle are available on my Github. Enjoy.Puzzle #364In this puzzle we have several numbers to check. But what is the condition those numbers sh...",
      "meta_keywords": null,
      "og_description": "Puzzles no. 364–368PuzzlesAuthor: ExcelBIAll files (xlsx with puzzle and R with solution) for each and every puzzle are available on my Github. Enjoy.Puzzle #364In this puzzle we have several numbers to check. But what is the condition those numbers sh...",
      "og_image": "https://cdn-images-1.medium.com/max/1024/1*P0DSJICnvy8wOXFUk6SOjw.jpeg",
      "og_title": "R Solution for Excel Puzzles | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 5.1,
      "sitemap_lastmod": "2024-01-15T11:46:27+00:00",
      "twitter_description": "Puzzles no. 364–368PuzzlesAuthor: ExcelBIAll files (xlsx with puzzle and R with solution) for each and every puzzle are available on my Github. Enjoy.Puzzle #364In this puzzle we have several numbers to check. But what is the condition those numbers sh...",
      "twitter_title": "R Solution for Excel Puzzles | R-bloggers",
      "url": "https://www.r-bloggers.com/2024/01/r-solution-for-excel-puzzles-8/",
      "word_count": 1027
    }
  }
}