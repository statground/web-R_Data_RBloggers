{
  "id": "3da9ef23a75bc04aed2c3dfcd3141ae8f9318630",
  "url": "https://www.r-bloggers.com/2009/05/negative-scalability-coefficients-in-excel/",
  "created_at_utc": "2025-11-17T20:40:57Z",
  "data": null,
  "raw_original": {
    "uuid": "c8e62f4a-8022-494d-b292-2e6ea3e6a5dd",
    "created_at": "2025-11-17 20:40:57",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2009/05/negative-scalability-coefficients-in-excel/",
      "crawled_at": "2025-11-17T10:38:02.347751",
      "external_links": [
        {
          "href": "https://perfdynamics.blogspot.com/2009/05/negative-usl-coefficients-in-excel.html",
          "text": "Taking the Pith Out of Performance"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "http://www.perfdynamics.com/Manifesto/gcaprules.html#tth_sEc3",
          "text": "universal scalability law"
        },
        {
          "href": "http://www.perfdynamics.com/Classes/Materials/sscalc-class.xls",
          "text": "sscalc.xls"
        },
        {
          "href": "https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/negcoeffs2.png",
          "text": null
        },
        {
          "href": "http://arxiv.org/abs/0808.1431",
          "text": "USL model"
        },
        {
          "href": "http://www.perfdynamics.com/iBook/gcap.html",
          "text": "GCaP book"
        },
        {
          "href": "http://www.perfdynamics.com/iBook/gcap.html",
          "text": "book"
        },
        {
          "href": "http://stat.ethz.ch/R-manual/R-patched/library/stats/html/nls.html",
          "text": "NLS function"
        },
        {
          "href": "http://www.perfdynamics.com/Classes/Outlines/gdata.html",
          "text": "GDAT class"
        },
        {
          "href": "https://perfdynamics.blogspot.com/2009/05/negative-usl-coefficients-in-excel.html",
          "text": "Taking the Pith Out of Performance"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Negative Scalability Coefficients in Excel | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/negcoeffs3.png?w=578"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/negcoeffs3.png?w=578"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://blogger.googleusercontent.com/tracker/6977755959349847093-8040481803251110341?l=perfdynamics.blogspot.com"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://blogger.googleusercontent.com/tracker/6977755959349847093-8040481803251110341?l=perfdynamics.blogspot.com"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/neil-gunther/",
          "text": "Neil Gunther"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/wp-content/uploads/2009/05/parabola__21.png",
          "text": "MacDonald’s arches"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/tag/capacity-management/",
          "text": "capacity management"
        },
        {
          "href": "https://www.r-bloggers.com/tag/capacity-planning/",
          "text": "Capacity Planning"
        },
        {
          "href": "https://www.r-bloggers.com/tag/mathematica/",
          "text": "Mathematica"
        },
        {
          "href": "https://www.r-bloggers.com/tag/modeling/",
          "text": "Modeling"
        },
        {
          "href": "https://www.r-bloggers.com/tag/r/",
          "text": "R"
        },
        {
          "href": "https://www.r-bloggers.com/tag/scalability/",
          "text": "scalability"
        },
        {
          "href": "https://www.r-bloggers.com/tag/statistics/",
          "text": "statistics"
        },
        {
          "href": "https://www.r-bloggers.com/tag/usl/",
          "text": "USL"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-22052 post type-post status-publish format-standard hentry category-r-bloggers tag-capacity-management tag-capacity-planning tag-mathematica tag-modeling tag-r tag-scalability tag-statistics tag-usl\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Negative Scalability Coefficients in Excel</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">May 12, 2009</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/neil-gunther/\">Neil Gunther</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<p class=\"syndicated-attribution\"><!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://perfdynamics.blogspot.com/2009/05/negative-usl-coefficients-in-excel.html\"> Taking the Pith Out of Performance</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div></p>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->Recently, several performance engineers, who have been applying my <a href=\"http://www.perfdynamics.com/Manifesto/gcaprules.html#tth_sEc3\" rel=\"nofollow\" target=\"_blank\">universal scalability law</a> (USL) to their throughput measurements, reported a problem whereby their Excel spreadsheet calculations produced a negative value for the coherency parameter (β &lt; 0) on what otherwise appears to be an application that scales extremely well. You can download the Excel spreadsheet <a href=\"http://www.perfdynamics.com/Classes/Materials/sscalc-class.xls\" rel=\"nofollow\" target=\"_blank\">sscalc.xls</a> from the Guerrilla class materials.  Negative USL parameters are verboten.<br/><a name=\"more\"></a> <br/>Naturally, I’ve seen this kind of negative numbers no-no before, but usually there has been some other problem with the measurements and once that was corrected  everything worked as advertised. Lately, however, something else seemed to be going on and that caused me to investigate things more closely. I discovered that there is a genuine limitation when applying the USL in Excel and that’s what I’m going to explain here. It’s a bit subtle, so fasten your seat-belt.<br/><br/>The following set of plots show a generic situation. The top row shows how things would go in Excel, while the bottom row shows some ideal curves that I’ll explain in a minute.<br/><br/><a data-cf-modified-cf6e886d1c820a084499322b-=\"\" href=\"https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/negcoeffs2.png\" onblur=\"if (!window.__cfRLUnblockHandlers) return false; try {parent.deselectBloggerImageGracefully();} catch(e) {}\" rel=\"nofollow\" target=\"_blank\"><img border=\"0\" class=\"jetpack-lazy-image\" data-lazy-src=\"https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/negcoeffs3.png?w=578&amp;is-pending-load=1\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/negcoeffs3.png?w=578\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" style=\"display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 162px;\"/><noscript><img alt=\"\" border=\"0\" data-recalc-dims=\"1\" id=\"BLOGGER_PHOTO_ID_5334949178307728386\" src=\"https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/negcoeffs3.png?w=578\" style=\"display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 162px;\"/></noscript></a><br/><span style=\"font-weight:bold;\">Excel Curves</span><br/>Referring to the 3 plots in the top row. The series of dots in Figure <span style=\"font-weight:bold;\">A</span> are the throughput X(N) measured at each user load (N on the x-axis). Technically, these data have been <span style=\"font-style:italic;\">normalized</span> to produce the <span style=\"font-style:italic;\">relative capacity</span> C(N) = X(N)/X(1). This is the quantity that we eventually model with the USL function:<br/><center><br/>C(N) = N/{1 + α (N − 1) + β N(N − 1)}<br/></center><br/>where α represents the degree of <span style=\"font-style:italic;\">contention</span>, e.g., queueing, in the system and  β is the <span style=\"font-style:italic;\">coherency</span> delay incurred, e.g., when keeping multiple data copies consistent  across caches. <br/><br/>Most importantly, because these parameters (α, β) have a <span style=\"font-style:italic;\">physical meaning</span>, i.e., they’re not just some curve-fitting parameters, they must <span style=\"font-weight:bold;\">ALWAYS</span> be <span style=\"font-style:italic;\">positive</span>-valued (no ifs,  ands or buts). It’s obedience to this physical constraint that allows us to know when the performance <span style=\"font-weight:bold;\">measurement process is broken</span> (which is more often than you might dare to imagine).<br/><br/>The other thing to notice in Figure <span style=\"font-weight:bold;\">A</span> is that the data points are very close to <span style=\"font-style:italic;\">linear</span>, in that they have been statistically fitted to a <span style=\"font-weight:bold;\">straight line</span> (solid line). Prima facie, that looks very good, but such linear data should not be confused with ideal linear scalability in the sense of <span style=\"font-style:italic;\">maximal bang for the buck</span>. Ideal linearity is represented by the dotted line, which has a higher slope than the solid line.<br/><br/>Figure <span style=\"font-weight:bold;\">B</span> shows the corresponding <span style=\"font-style:italic;\">efficiency</span> C(N)/N or the amount of capacity per user. This is the 4th column in the spreadsheet (depending on how you have things set up). As expected, it <span style=\"font-style:italic;\">decreases</span> gracefully in the direction of the x-axis. You can’t have more than 100% efficiency and, as a general rule, efficiency degrades with N because the degree of overhead increases with more users. In this case, the degradation is very small due to the linearity in Figure A.<br/><br/>Now comes the fun part. In Excel, we must do some handstands to accommodate the USL model. The drawback with Excel is that it still doesn’t know how to fit a <span style=\"font-weight:bold;\">Trend Line</span> to a <span style=\"font-style:italic;\">rational function</span> like the <a href=\"http://arxiv.org/abs/0808.1431\" rel=\"nofollow\" target=\"_blank\">USL model</a>. It’s not a dialog-box option. Sigh! Therefore, we have to tip the USL upside-down, fit the denominator as a 2nd-degree polynomial  (quadratic equation) with coefficients (a, b, c=0), and then transform those coefficients back to the USL parameters using the definitions on pp. 80 and 104 of my <a href=\"http://www.perfdynamics.com/iBook/gcap.html\" rel=\"nofollow\" target=\"_blank\">GCaP book</a>, viz., α = b − a and β = a.<br/><br/>The result of this inversion procedure in Excel appears in Figure <span style=\"font-weight:bold;\">C</span>. It can be interpreted physically as showing the <span style=\"font-style:italic;\">deviation from linearity</span>. Here, I’ve simply labeled it L(N) but it’s the same thing as (N/C) − 1 in the Excel spreadsheet. And this is where the trouble begins.<br/><br/>Notice that the data points tend to bend ever so slightly toward the x-axis as they increase. When we ask Excel to fit these points to a quadratic function—the denominator of C(N)—it produces the dashed line. The denominator of C(N) in the USL model is quadratic in N. A general quadratic function can be written: aN<sup>2</sup> + bN + c and has the shape of a <span style=\"font-weight:bold;\">parabola</span>. We constrain our L(N) parabola to go through the origin by setting c = 0 in the Excel dialog box, which leaves only <i>a</i> and <i>b</i> to be calculated by Excel. But Excel thinks the parabola is upside-down like <a href=\"https://www.r-bloggers.com/wp-content/uploads/2009/05/parabola__21.png\" rel=\"nofollow\" target=\"_blank\">MacDonald’s arches</a> and fits the data points to the dashed line. Whether a parabola looks like like a <span style=\"font-style:italic;\">cup</span> (as demanded by the USL) or a <span style=\"font-style:italic;\">cap</span> (MacDonald’s arch), is controlled by the <span style=\"font-style:italic;\">sign</span> of the a-coefficient. A  MacDonald’s arch has a &lt; 0 (negative), and that in turn causes β in the USL to <span style=\"font-weight:bold;\">incorrectly</span> obtain a negative value!<br/><br/>The problem lies with <span style=\"font-weight:bold;\">Excel</span>, not the USL. There is no way to tell Excel that we want only positive <i>a</i> and <i>b</i> coefficients. At least, I don’t know how to do that in Excel and I don’t plan on wasting time writing a macro either because I’m already worried about numerical precision issues with Excel (as explained in the Preface to <a href=\"http://www.perfdynamics.com/iBook/gcap.html\" rel=\"nofollow\" target=\"_blank\">book</a>). Better to go with a tool like R or Mathematica in this case. So, why is Excel running into trouble?<br/><br/><span style=\"font-weight:bold;\">Idealized Curves</span> <br/>Referring now to the 3 plots in the bottom row, Figure <span style=\"font-weight:bold;\">D</span> shows the near-linear data points represented this time by a continuous red line (it’s the same as the solid blue line in Figure A). The idea here is to see what happens to that <span style=\"font-style:italic;\">continuous</span> line as I push it through the same transformations as are applied to the data in Excel.<br/><br/>In Figure <span style=\"font-weight:bold;\">E</span> the resulting theoretical efficiency curve looks very similar to Figure <span style=\"font-weight:bold;\">B</span>. In fact, it looks like it could be a regression fit to those data. So, that’s cool. It  seems to be consistent. The drama occurs in the next plot.<br/><br/>Figure <span style=\"font-weight:bold;\">F</span> is the result of applying the Excel transformation to determine the deviation from linearity. Very clearly it is a <span style=\"font-weight:bold;\">cap-shaped</span> curve (concave), rather than cup-shaped curve (as required by the USL). Put another way,  the red curve in Figure F looks more like a throughput curve than a throughput curve! But that’s crazy. How can an <span style=\"font-style:italic;\">inverted</span> throughput curve still look like a throughput curve?<br/><ol><br/><li> If you start with <span style=\"font-weight:bold;\">linear</span> data like the points in Figure A, those same data will tend to lie on the red curve shown in Figure F as a result of simply applying the <span style=\"font-weight:bold;\">inversion</span> transformation in <span style=\"font-weight:bold;\">Excel</span>. That’s what you see happening in Figure C.<br/><li> The red curve in Figure F is <span style=\"font-style:italic;\">not</span> a <span style=\"font-weight:bold;\">parabola</span>. I won’t bother explaining what function it is because it’s not salient to this discussion.<br/><li> Excel doesn’t know any of this.<br/><li> When applying the <span style=\"font-weight:bold;\">Trend Line</span> fit in Excel, you tell Excel that you want it to fit the data points in Figure C to a <span style=\"font-weight:bold;\">parabola</span>. That’s the logical equivalent of telling Excel to fit to the USL model, but distanced by several levels of indirection. You do it by choosing “polynomial of degree 2” in the Excel dialog box.<br/><li> When Excel charges off to fulfill your request by doing a linear least-squares fit to a parabola, it senses that the data points in Figure C are “curved” downward and comes back with a chunk of a “MacDonald’s arch”; the dashed line in Figure C.<br/><li> Since Excel knows nothing of the USL, it thinks it has done a good job, e.g., R<sup>2</sup> ~ 0.99.<br/></li></li></li></li></li></li></ol><br/><br/><span style=\"font-weight:bold;\">What To Do?</span><br/>Discretion being the better part of valor, I would not do any additional handstands on behalf of Excel. Rather, I suggest that you avoid all such problems having to do with the signs of <i>a</i> and <i>b</i> by avoiding <i>a</i> and <i>b</i> altogether. Instead, fit the USL parameters directly to the original data. You can do this in R, for example, using its <a href=\"http://stat.ethz.ch/R-manual/R-patched/library/stats/html/nls.html\" rel=\"nofollow\" target=\"_blank\">NLS function</a>:<br/><pre>\n# Do a standard NLS fit ...\nusl &lt;- nls(Norm ~ n/(1 + alpha * (n-1) + beta* n*(n-1)), input, \nstart=c(alpha=0.1, beta=0.01))\n</pre><br/>Simultaneously, you can constrain the values of α and β to be positive. Here's how you do that in R:<br/><pre>\n# Set positivity constraints on USL parameters ...\nusl &lt;- nls(Norm ~ n/(1 + alpha * (n-1) + beta * n*(n-1)), input, \nstart=c(alpha=0.1, beta=0.01), algorithm=\"port\", lower=c(0,0,0))\n</pre><br/>You can learn more about applying R to quantitative scalability analysis and other performance management problems in our upcoming <a href=\"http://www.perfdynamics.com/Classes/Outlines/gdata.html\" rel=\"nofollow\" target=\"_blank\">GDAT class</a>.<br/><br/>As a final sanity check, scalability measurements that are linear rising (like Figure A) suggest the overheads are small. In particular, you can expect that there is relatively little sharing of write-data and therefore the coherency penalty (β parameter) should be vanishingly small. That doesn't mean that your system will scale linearly forever. It means that the maximum in the USL scalability curve is there, but it's going to be off the scale to the right somewhere relative to the physically allowed system size.<div class=\"blogger-post-footer\"><img alt=\"\" class=\"jetpack-lazy-image\" data-lazy-src=\"https://blogger.googleusercontent.com/tracker/6977755959349847093-8040481803251110341?l=perfdynamics.blogspot.com&amp;is-pending-load=1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/6977755959349847093-8040481803251110341?l=perfdynamics.blogspot.com\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" width=\"1\"/><noscript><img alt=\"\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/6977755959349847093-8040481803251110341?l=perfdynamics.blogspot.com\" width=\"1\"/></noscript></div>\n\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->\n<p class=\"syndicated-attribution\"><div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://perfdynamics.blogspot.com/2009/05/negative-usl-coefficients-in-excel.html\"> Taking the Pith Out of Performance</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div></p> </div>\n<div class=\"post-tags clearfix\"><ul><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/capacity-management/\" rel=\"tag\">capacity management</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/capacity-planning/\" rel=\"tag\">Capacity Planning</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/mathematica/\" rel=\"tag\">Mathematica</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/modeling/\" rel=\"tag\">Modeling</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/r/\" rel=\"tag\">R</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/scalability/\" rel=\"tag\">scalability</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/statistics/\" rel=\"tag\">statistics</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/usl/\" rel=\"tag\">USL</a></li></ul></div></article>",
      "main_text": "Negative Scalability Coefficients in Excel\nPosted on\nMay 12, 2009\nby\nNeil Gunther\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nTaking the Pith Out of Performance\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nRecently, several performance engineers, who have been applying my\nuniversal scalability law\n(USL) to their throughput measurements, reported a problem whereby their Excel spreadsheet calculations produced a negative value for the coherency parameter (β < 0) on what otherwise appears to be an application that scales extremely well. You can download the Excel spreadsheet\nsscalc.xls\nfrom the Guerrilla class materials.  Negative USL parameters are verboten.\nNaturally, I’ve seen this kind of negative numbers no-no before, but usually there has been some other problem with the measurements and once that was corrected  everything worked as advertised. Lately, however, something else seemed to be going on and that caused me to investigate things more closely. I discovered that there is a genuine limitation when applying the USL in Excel and that’s what I’m going to explain here. It’s a bit subtle, so fasten your seat-belt.\nThe following set of plots show a generic situation. The top row shows how things would go in Excel, while the bottom row shows some ideal curves that I’ll explain in a minute.\nExcel Curves\nReferring to the 3 plots in the top row. The series of dots in Figure\nA\nare the throughput X(N) measured at each user load (N on the x-axis). Technically, these data have been\nnormalized\nto produce the\nrelative capacity\nC(N) = X(N)/X(1). This is the quantity that we eventually model with the USL function:\nC(N) = N/{1 + α (N − 1) + β N(N − 1)}\nwhere α represents the degree of\ncontention\n, e.g., queueing, in the system and  β is the\ncoherency\ndelay incurred, e.g., when keeping multiple data copies consistent  across caches.\nMost importantly, because these parameters (α, β) have a\nphysical meaning\n, i.e., they’re not just some curve-fitting parameters, they must\nALWAYS\nbe\npositive\n-valued (no ifs,  ands or buts). It’s obedience to this physical constraint that allows us to know when the performance\nmeasurement process is broken\n(which is more often than you might dare to imagine).\nThe other thing to notice in Figure\nA\nis that the data points are very close to\nlinear\n, in that they have been statistically fitted to a\nstraight line\n(solid line). Prima facie, that looks very good, but such linear data should not be confused with ideal linear scalability in the sense of\nmaximal bang for the buck\n. Ideal linearity is represented by the dotted line, which has a higher slope than the solid line.\nFigure\nB\nshows the corresponding\nefficiency\nC(N)/N or the amount of capacity per user. This is the 4th column in the spreadsheet (depending on how you have things set up). As expected, it\ndecreases\ngracefully in the direction of the x-axis. You can’t have more than 100% efficiency and, as a general rule, efficiency degrades with N because the degree of overhead increases with more users. In this case, the degradation is very small due to the linearity in Figure A.\nNow comes the fun part. In Excel, we must do some handstands to accommodate the USL model. The drawback with Excel is that it still doesn’t know how to fit a\nTrend Line\nto a\nrational function\nlike the\nUSL model\n. It’s not a dialog-box option. Sigh! Therefore, we have to tip the USL upside-down, fit the denominator as a 2nd-degree polynomial  (quadratic equation) with coefficients (a, b, c=0), and then transform those coefficients back to the USL parameters using the definitions on pp. 80 and 104 of my\nGCaP book\n, viz., α = b − a and β = a.\nThe result of this inversion procedure in Excel appears in Figure\nC\n. It can be interpreted physically as showing the\ndeviation from linearity\n. Here, I’ve simply labeled it L(N) but it’s the same thing as (N/C) − 1 in the Excel spreadsheet. And this is where the trouble begins.\nNotice that the data points tend to bend ever so slightly toward the x-axis as they increase. When we ask Excel to fit these points to a quadratic function—the denominator of C(N)—it produces the dashed line. The denominator of C(N) in the USL model is quadratic in N. A general quadratic function can be written: aN\n2\n+ bN + c and has the shape of a\nparabola\n. We constrain our L(N) parabola to go through the origin by setting c = 0 in the Excel dialog box, which leaves only\na\nand\nb\nto be calculated by Excel. But Excel thinks the parabola is upside-down like\nMacDonald’s arches\nand fits the data points to the dashed line. Whether a parabola looks like like a\ncup\n(as demanded by the USL) or a\ncap\n(MacDonald’s arch), is controlled by the\nsign\nof the a-coefficient. A  MacDonald’s arch has a < 0 (negative), and that in turn causes β in the USL to\nincorrectly\nobtain a negative value!\nThe problem lies with\nExcel\n, not the USL. There is no way to tell Excel that we want only positive\na\nand\nb\ncoefficients. At least, I don’t know how to do that in Excel and I don’t plan on wasting time writing a macro either because I’m already worried about numerical precision issues with Excel (as explained in the Preface to\nbook\n). Better to go with a tool like R or Mathematica in this case. So, why is Excel running into trouble?\nIdealized Curves\nReferring now to the 3 plots in the bottom row, Figure\nD\nshows the near-linear data points represented this time by a continuous red line (it’s the same as the solid blue line in Figure A). The idea here is to see what happens to that\ncontinuous\nline as I push it through the same transformations as are applied to the data in Excel.\nIn Figure\nE\nthe resulting theoretical efficiency curve looks very similar to Figure\nB\n. In fact, it looks like it could be a regression fit to those data. So, that’s cool. It  seems to be consistent. The drama occurs in the next plot.\nFigure\nF\nis the result of applying the Excel transformation to determine the deviation from linearity. Very clearly it is a\ncap-shaped\ncurve (concave), rather than cup-shaped curve (as required by the USL). Put another way,  the red curve in Figure F looks more like a throughput curve than a throughput curve! But that’s crazy. How can an\ninverted\nthroughput curve still look like a throughput curve?\nIf you start with\nlinear\ndata like the points in Figure A, those same data will tend to lie on the red curve shown in Figure F as a result of simply applying the\ninversion\ntransformation in\nExcel\n. That’s what you see happening in Figure C.\nThe red curve in Figure F is\nnot\na\nparabola\n. I won’t bother explaining what function it is because it’s not salient to this discussion.\nExcel doesn’t know any of this.\nWhen applying the\nTrend Line\nfit in Excel, you tell Excel that you want it to fit the data points in Figure C to a\nparabola\n. That’s the logical equivalent of telling Excel to fit to the USL model, but distanced by several levels of indirection. You do it by choosing “polynomial of degree 2” in the Excel dialog box.\nWhen Excel charges off to fulfill your request by doing a linear least-squares fit to a parabola, it senses that the data points in Figure C are “curved” downward and comes back with a chunk of a “MacDonald’s arch”; the dashed line in Figure C.\nSince Excel knows nothing of the USL, it thinks it has done a good job, e.g., R\n2\n~ 0.99.\nWhat To Do?\nDiscretion being the better part of valor, I would not do any additional handstands on behalf of Excel. Rather, I suggest that you avoid all such problems having to do with the signs of\na\nand\nb\nby avoiding\na\nand\nb\naltogether. Instead, fit the USL parameters directly to the original data. You can do this in R, for example, using its\nNLS function\n:\n# Do a standard NLS fit ...\nusl <- nls(Norm ~ n/(1 + alpha * (n-1) + beta* n*(n-1)), input, \nstart=c(alpha=0.1, beta=0.01))\nSimultaneously, you can constrain the values of α and β to be positive. Here's how you do that in R:\n# Set positivity constraints on USL parameters ...\nusl <- nls(Norm ~ n/(1 + alpha * (n-1) + beta * n*(n-1)), input, \nstart=c(alpha=0.1, beta=0.01), algorithm=\"port\", lower=c(0,0,0))\nYou can learn more about applying R to quantitative scalability analysis and other performance management problems in our upcoming\nGDAT class\n.\nAs a final sanity check, scalability measurements that are linear rising (like Figure A) suggest the overheads are small. In particular, you can expect that there is relatively little sharing of write-data and therefore the coherency penalty (β parameter) should be vanishingly small. That doesn't mean that your system will scale linearly forever. It means that the maximum in the USL scalability curve is there, but it's going to be off the scale to the right somewhere relative to the physically allowed system size.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nTaking the Pith Out of Performance\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\ncapacity management\nCapacity Planning\nMathematica\nModeling\nR\nscalability\nstatistics\nUSL",
      "meta_description": "Recently, several performance engineers, who have been applying my universal scalability law (USL) to their throughput measurements, reported a problem whereby their Excel spreadsheet calculations produced a negative value for the coherency parameter (...",
      "meta_keywords": "capacity management,capacity planning,mathematica,modeling,r,scalability,statistics,usl",
      "og_description": "Recently, several performance engineers, who have been applying my universal scalability law (USL) to their throughput measurements, reported a problem whereby their Excel spreadsheet calculations produced a negative value for the coherency parameter (...",
      "og_image": "https://www.r-bloggers.com/wp-content/uploads/2009/05/negcoeffs3.png",
      "og_title": "Negative Scalability Coefficients in Excel | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 8.6,
      "sitemap_lastmod": "2011-05-11T21:15:04+00:00",
      "twitter_description": "Recently, several performance engineers, who have been applying my universal scalability law (USL) to their throughput measurements, reported a problem whereby their Excel spreadsheet calculations produced a negative value for the coherency parameter (...",
      "twitter_title": "Negative Scalability Coefficients in Excel | R-bloggers",
      "url": "https://www.r-bloggers.com/2009/05/negative-scalability-coefficients-in-excel/",
      "word_count": 1729
    }
  }
}