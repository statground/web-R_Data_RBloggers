{
  "id": "b87683c801be5b5ce0a5de9d7ec428c0ef400db7",
  "url": "https://www.r-bloggers.com/2025/06/thames-for-mixtures-a-reply-from-the-authors/",
  "created_at_utc": "2025-11-22T19:58:16Z",
  "data": null,
  "raw_original": {
    "uuid": "047fd50d-9de8-4242-b8f7-f6ec2a3613e1",
    "created_at": "2025-11-22 19:58:16",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2025/06/thames-for-mixtures-a-reply-from-the-authors/",
      "crawled_at": "2025-11-22T10:46:51.055811",
      "external_links": [
        {
          "href": "https://xianblog.wordpress.com/2025/06/23/thames-for-mixtures-a-reply-from-the-authors/",
          "text": "R – Xi'an's Og"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://amzn.to/4dHxtcU",
          "text": null
        },
        {
          "href": "https://xianblog.wordpress.com/2025/05/25/easily-computed-marginal-likelihoods-for-multivariate-mixture-models-using-the-thames-estimator/",
          "text": "comments on THAMES"
        },
        {
          "href": "https://amzn.to/4dHxtcU",
          "text": "Rivers of London"
        },
        {
          "href": "https://xianblog.wordpress.com/2025/06/23/thames-for-mixtures-a-reply-from-the-authors/",
          "text": "R – Xi'an's Og"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "THAMES for mixtures, a reply from the authors | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/thebookfeed.wordpress.com/wp-content/uploads/2014/09/rivers-of-london-640x400.jpg?w=450&ssl=1"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/xian/",
          "text": "xi'an"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-393278 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">THAMES for mixtures, a reply from the authors</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">June 22, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/xian/\">xi'an</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://xianblog.wordpress.com/2025/06/23/thames-for-mixtures-a-reply-from-the-authors/\"> R – Xi'an's Og</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47--><p style=\"text-align: justify\"><em><a href=\"https://amzn.to/4dHxtcU\" rel=\"nofollow\" target=\"_blank\"><img alt=\"\" class=\"aligncenter\" data-lazy-src=\"https://i1.wp.com/thebookfeed.wordpress.com/wp-content/uploads/2014/09/rivers-of-london-640x400.jpg?w=450&amp;ssl=1\" data-recalc-dims=\"1\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" class=\"aligncenter\" data-recalc-dims=\"1\" loading=\"lazy\" src=\"https://i1.wp.com/thebookfeed.wordpress.com/wp-content/uploads/2014/09/rivers-of-london-640x400.jpg?w=450&amp;ssl=1\"/></noscript></a>[Here is a reply to my <a href=\"https://xianblog.wordpress.com/2025/05/25/easily-computed-marginal-likelihoods-for-multivariate-mixture-models-using-the-thames-estimator/\" rel=\"nofollow\" target=\"_blank\">comments on THAMES</a> sent by the first author of the paper, Martin Metodiev. The above replica of the cover of </em><a href=\"https://amzn.to/4dHxtcU\" rel=\"nofollow\" target=\"_blank\">Rivers of London</a><em> is obviously unrelated with the reply or the original blog, beyond presenting a fantasy map of the Thames!]</em></p>\n<p style=\"text-align: justify\">Thank you for your review of our article! Adapting your previous work in this field has been a pleasure. Before I respond to your comments, I would like to emphasize that the simplicity of our estimator lies in its simple analytic expression (a truncated harmonic mean of reciprocal unnormalized posterior density values). Indeed, our package “thamesmix” (recently submitted to CRAN!) has a function to compute the marginal likelihood of any mixture model. This function requires only two parameters: the unnormalized log-posterior function (the logarithm of the prior plus the log-likelihood) and the MCMC simulations from the posterior.</p>\n<p>Regarding your main comments:</p>\n<p style=\"padding-left: 40px\">1. <em>“the evacuation of earlier methods as not simple or not universal enough is rather disingenuous. For instance, software that do not return (latent) allocation vectors can easily be post-processed.”</em></p>\n<p style=\"padding-left: 40px\">I could not find an example of post-process simulations on top of MCMC outputs applied to compute these methods. It sounds really interesting, and I would be happy to cite it. Is there a reference that you can recommend?</p>\n<p style=\"padding-left: 40px\">In any case, the point still stands. Most estimators which we cite with regards to this point do not just need allocation samplers, but also the analytic expressions of the distribution of the allocation vectors or the distribution of the data conditional on these allocation vectors that come with them. I do not think that a closed form of this distribution is available in general.</p>\n<p style=\"padding-left: 40px\">2.<em>“the handling of the label switching issue—the reason why Larry Wasserman saw mixtures at the same magnitude of evil as tequila!—is problematic for several reasons.”</em></p>\n<p style=\"padding-left: 40px\">The fact that our estimator is invariant to label-switching is indeed the core of our method. The simple Gibbs sampler gets stuck in one mode, and this is why the classical version of bridge sampling is biased by a factor of G! in the simulation setting. As you point out, this is successfully resolved when using fully symmetric bridge sampling in the experiment section. However, the computation cost of this fully symmetric estimator rises super-exponentially with G, so I do not see how it could be evaluated for G=15, where the number of symmetric modes is equal to 15! (over one trillion). One of the main points of our article is that the symmetric THAMES can be evaluated in a feasible amount of time, even in such a high-dimensional multivariate setting.</p>\n<p style=\"padding-left: 40px\">3. <em>“the (legitimate) purpose of using marginal likelihoods for selecting the number G of components is weakened by the intrusion of alternate proposals to assess G from the data”</em></p>\n<p style=\"padding-left: 40px\">I would like to point out that these alternate proposals do not in any way impact the definition of the THAMES. It is the simple definition given in Equation (5). They are only used to speed up the computation.</p>\n<p style=\"padding-left: 40px\">4. <em>“several mentions are made of the other estimators being biased, which is indeed the case for bridge sampling (if not necessarily for importance sampling), but not necessarily a central issue”</em></p>\n<p style=\"padding-left: 40px\">The problem that we see with the classical, non-symmetric bridge sampling method in the setting of mixture models is not simply that it is biased. The problem is that the bias is persistent and often roughly equal to the factor of G! when the MCMC sampler failed to switch between modes. We have not had this experience with the THAMES: it converged even when the MCMC was stuck.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://xianblog.wordpress.com/2025/06/23/thames-for-mixtures-a-reply-from-the-authors/\"> R – Xi'an's Og</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
      "main_text": "THAMES for mixtures, a reply from the authors\nPosted on\nJune 22, 2025\nby\nxi'an\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nR – Xi'an's Og\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\n[Here is a reply to my\ncomments on THAMES\nsent by the first author of the paper, Martin Metodiev. The above replica of the cover of\nRivers of London\nis obviously unrelated with the reply or the original blog, beyond presenting a fantasy map of the Thames!]\nThank you for your review of our article! Adapting your previous work in this field has been a pleasure. Before I respond to your comments, I would like to emphasize that the simplicity of our estimator lies in its simple analytic expression (a truncated harmonic mean of reciprocal unnormalized posterior density values). Indeed, our package “thamesmix” (recently submitted to CRAN!) has a function to compute the marginal likelihood of any mixture model. This function requires only two parameters: the unnormalized log-posterior function (the logarithm of the prior plus the log-likelihood) and the MCMC simulations from the posterior.\nRegarding your main comments:\n1.\n“the evacuation of earlier methods as not simple or not universal enough is rather disingenuous. For instance, software that do not return (latent) allocation vectors can easily be post-processed.”\nI could not find an example of post-process simulations on top of MCMC outputs applied to compute these methods. It sounds really interesting, and I would be happy to cite it. Is there a reference that you can recommend?\nIn any case, the point still stands. Most estimators which we cite with regards to this point do not just need allocation samplers, but also the analytic expressions of the distribution of the allocation vectors or the distribution of the data conditional on these allocation vectors that come with them. I do not think that a closed form of this distribution is available in general.\n2.\n“the handling of the label switching issue—the reason why Larry Wasserman saw mixtures at the same magnitude of evil as tequila!—is problematic for several reasons.”\nThe fact that our estimator is invariant to label-switching is indeed the core of our method. The simple Gibbs sampler gets stuck in one mode, and this is why the classical version of bridge sampling is biased by a factor of G! in the simulation setting. As you point out, this is successfully resolved when using fully symmetric bridge sampling in the experiment section. However, the computation cost of this fully symmetric estimator rises super-exponentially with G, so I do not see how it could be evaluated for G=15, where the number of symmetric modes is equal to 15! (over one trillion). One of the main points of our article is that the symmetric THAMES can be evaluated in a feasible amount of time, even in such a high-dimensional multivariate setting.\n3.\n“the (legitimate) purpose of using marginal likelihoods for selecting the number G of components is weakened by the intrusion of alternate proposals to assess G from the data”\nI would like to point out that these alternate proposals do not in any way impact the definition of the THAMES. It is the simple definition given in Equation (5). They are only used to speed up the computation.\n4.\n“several mentions are made of the other estimators being biased, which is indeed the case for bridge sampling (if not necessarily for importance sampling), but not necessarily a central issue”\nThe problem that we see with the classical, non-symmetric bridge sampling method in the setting of mixture models is not simply that it is biased. The problem is that the bias is persistent and often roughly equal to the factor of G! when the MCMC sampler failed to switch between modes. We have not had this experience with the THAMES: it converged even when the MCMC was stuck.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nR – Xi'an's Og\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "[Here is a reply to my comments on THAMES sent by the first author of the paper, Martin Metodiev. The above replica of the cover of Rivers of London is obviously unrelated with the reply or the original blog, beyond presenting a fantasy map of the Thames!] Thank you for your review of our article! […]",
      "meta_keywords": null,
      "og_description": "[Here is a reply to my comments on THAMES sent by the first author of the paper, Martin Metodiev. The above replica of the cover of Rivers of London is obviously unrelated with the reply or the original blog, beyond presenting a fantasy map of the Thames!] Thank you for your review of our article! […]",
      "og_image": "https://thebookfeed.wordpress.com/wp-content/uploads/2014/09/rivers-of-london-640x400.jpg",
      "og_title": "THAMES for mixtures, a reply from the authors | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 3.8,
      "sitemap_lastmod": null,
      "twitter_description": "[Here is a reply to my comments on THAMES sent by the first author of the paper, Martin Metodiev. The above replica of the cover of Rivers of London is obviously unrelated with the reply or the original blog, beyond presenting a fantasy map of the Thames!] Thank you for your review of our article! […]",
      "twitter_title": "THAMES for mixtures, a reply from the authors | R-bloggers",
      "url": "https://www.r-bloggers.com/2025/06/thames-for-mixtures-a-reply-from-the-authors/",
      "word_count": 765
    }
  }
}