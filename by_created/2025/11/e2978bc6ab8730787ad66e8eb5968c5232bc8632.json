{
  "id": "e2978bc6ab8730787ad66e8eb5968c5232bc8632",
  "url": "https://www.r-bloggers.com/2023/12/r-solution-for-excel-puzzles-2/",
  "created_at_utc": "2025-11-17T20:39:00Z",
  "data": null,
  "raw_original": {
    "uuid": "e36d7a1c-03d6-4320-936a-47d2b5c228e1",
    "created_at": "2025-11-17 20:39:00",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2023/12/r-solution-for-excel-puzzles-2/",
      "crawled_at": "2025-11-17T09:41:42.714009",
      "external_links": [
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-34be0fbb8b1e",
          "text": "Numbers around us - Medium"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://www.linkedin.com/in/excelbi/",
          "text": "ExcelBI"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7134752700826595328-_jzo",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/dVENHNKM",
          "text": "file"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7135115113841238016-fdx-",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/dbDzdjEE",
          "text": "file"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7135477484757659648-v9NR",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/dNQS2SiR",
          "text": "file"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7135839880693039104-Glba",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/dQvEXySc",
          "text": "file"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7136202253958266880-XoDF",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/dH9fMU5q",
          "text": "file"
        },
        {
          "href": "http://cipherfoundation.org/modern-ciphers/feynman-challenge-ciphers/",
          "text": "here"
        },
        {
          "href": "https://en.wikipedia.org/wiki/Damm_algorithm",
          "text": "Damm Algorithm"
        },
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-34be0fbb8b1e",
          "text": "R Solution for Excel Puzzles"
        },
        {
          "href": "https://medium.com/number-around-us",
          "text": "Numbers around us"
        },
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-34be0fbb8b1e",
          "text": "Numbers around us - Medium"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "R Solution for Excel Puzzles | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*nbj082B2hjHEy4OpO61T-A.jpeg?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*lLckbJ3W2h7v4XVvr9E7cA.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*45Xb9sjCXGc9KqmiLwQd4A.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*pVbzd6gzYZ1qGrVXTnJu9Q.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*qFe09KRBG49xE7vZHgxAbw.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*60rL_9TdAshrEqjkrVpK1Q.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": "data:application/octet-stream;base64,R0lGODlhAQABAO+/vQAA77+977+977+9AAAAIe+/vQQBAAAAACwAAAAAAQABAAACAkQBADs=",
          "src": "https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=34be0fbb8b1e"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/numbers-around-us/",
          "text": "Numbers around us"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-380510 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">R Solution for Excel Puzzles</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 4, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/numbers-around-us/\">Numbers around us</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-34be0fbb8b1e\"> Numbers around us - Medium</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><p>Puzzles no. 334–338</p><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*nbj082B2hjHEy4OpO61T-A.jpeg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*nbj082B2hjHEy4OpO61T-A.jpeg?w=578&amp;ssl=1\"/></noscript></figure><h3>Puzzles</h3><p>Author: <a href=\"https://www.linkedin.com/in/excelbi/\" rel=\"nofollow\" target=\"_blank\">ExcelBI</a></p><p>Puzzles:<br/># 334: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7134752700826595328-_jzo\" rel=\"nofollow\" target=\"_blank\">content </a><a href=\"https://lnkd.in/dVENHNKM\" rel=\"nofollow\" target=\"_blank\">file</a><br/># 335: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7135115113841238016-fdx-\" rel=\"nofollow\" target=\"_blank\">content </a><a href=\"https://lnkd.in/dbDzdjEE\" rel=\"nofollow\" target=\"_blank\">file</a><br/># 336: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7135477484757659648-v9NR\" rel=\"nofollow\" target=\"_blank\">content </a><a href=\"https://lnkd.in/dNQS2SiR\" rel=\"nofollow\" target=\"_blank\">file</a><br/># 337: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7135839880693039104-Glba\" rel=\"nofollow\" target=\"_blank\">content </a><a href=\"https://lnkd.in/dQvEXySc\" rel=\"nofollow\" target=\"_blank\">file</a><br/># 338: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7136202253958266880-XoDF\" rel=\"nofollow\" target=\"_blank\">content </a><a href=\"https://lnkd.in/dH9fMU5q\" rel=\"nofollow\" target=\"_blank\">file</a></p><p>Lets dive into solutions!</p><h3>Puzzle 334</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*lLckbJ3W2h7v4XVvr9E7cA.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*lLckbJ3W2h7v4XVvr9E7cA.png?w=578&amp;ssl=1\"/></noscript></figure><p>We are given pairs of numbers and we have to find if they are amicable. But what does it mean? That mean that numbers are like they are complementing each other one fascinating way, like yin and yang. Sum of divisors of one number is equal to the second number and vice versa. So lets find out if they are.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(numbers)\n\ninput = read_excel(\"Amicable Numbers.xlsx\", range = \"A1:B10\") %&gt;% janitor::clean_names()\ntest = read_excel(\"Amicable Numbers.xlsx\", range = \"C1:D6\") %&gt;% janitor::clean_names()</pre><h4>Approach 1: tidyverse</h4><pre>divs = function(x) {\n  divs_x = divisors(x)\n  divs_x[divs_x != x]\n}\n\nare_amicable = function(x, y) {\n  map2_lgl(x, y,  ~ sum(divs(.x)) == .y &amp;&amp; sum(divs(.y)) == .x)\n}\n\nresult = input %&gt;%\n  filter(are_amicable(number_1, number_2))\n\ncolnames(test) &lt;- c(\"number_1\", \"number_2\")</pre><h4>Approach 2: base R</h4><pre>divs_base &lt;- function(x) {\n  divisors &lt;- x : 1\n  divisors &lt;- divisors[x %% divisors == 0]\n  divisors[divisors != x]\n}\n\nare_amicable_base &lt;- function(x, y) {\n  amicable &lt;- logical(length(x))\n  for (i in seq_along(x)) {\n    div_x &lt;- divs_base(x[i])\n    div_y &lt;- divs_base(y[i])\n    sum_x &lt;- sum(div_x)\n    sum_y &lt;- sum(div_y)\n    amicable[i] &lt;- (sum_x == y[i] &amp;&amp; sum_y == x[i])\n  }\n  amicable\n}\n\nresult_base &lt;- input %&gt;% \n  filter(are_amicable_base(number_1, number_2)) %&gt;%\n  select(answer_expected= number_1, x2 = number_2)</pre><h4>Validation:</h4><pre>identical(result, test)\n# [1] TRUE\n\nidentical(result_base, test)\n# [1] TRUE</pre><h3>Puzzle 335</h3><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*45Xb9sjCXGc9KqmiLwQd4A.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*45Xb9sjCXGc9KqmiLwQd4A.png?w=578&amp;ssl=1\"/></noscript></figure><p>This time we had some decryption job to do. If you would like to know more about it, read <a href=\"http://cipherfoundation.org/modern-ciphers/feynman-challenge-ciphers/\" rel=\"nofollow\" target=\"_blank\">here</a>. We have simple clue how to solve it: by reversing long string and break it into 5 strings. Lets do it.</p><h4>Loading library and data</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(stringi)\nlibrary(data.table)\n\ninput = read_excel(\"Feynman Challenge Cipher.xlsx\", range = \"A1:A2\")\ntest = read_excel(\"Feynman Challenge Cipher.xlsx\", range = \"B1:B2\")</pre><h4>Approach 1: tidyverse</h4><pre>result = input$`Encrypted Text` %&gt;%\n  stri_reverse() %&gt;%\n  str_split(\"\") %&gt;%\n  unlist() %&gt;%\n  matrix(ncol = 5, byrow = TRUE) %&gt;%\n  t() %&gt;%\n  as_tibble() %&gt;%\n  pmap_chr(~paste(c(...), collapse = \"\")) %&gt;%\n  paste(collapse = \"\") </pre><h4>Approach 2: base R</h4><pre>reversed_text &lt;- sapply(input$`Encrypted Text`, function(x) paste(rev(strsplit(x, \"\")[[1]]), collapse = \"\"))\nmatrix_formed &lt;- matrix(unlist(strsplit(reversed_text, \"\")), ncol = 5, byrow = TRUE)\ntransposed_matrix &lt;- t(matrix_formed)\nconcatenated_rows &lt;- apply(transposed_matrix, 1, paste, collapse = \"\")\nresult_base &lt;- paste(concatenated_rows, collapse = \"\")</pre><h4>Approach 3: data.table</h4><pre>input_dt &lt;- data.table(input)\n\ninput_dt[, reversed := sapply(`Encrypted Text`, function(x) paste(rev(strsplit(x, \"\")[[1]]), collapse = \"\"))]\nchar_matrix &lt;- matrix(unlist(strsplit(input_dt$reversed, \"\")), ncol = 5, byrow = TRUE)\ntransposed_matrix &lt;- t(char_matrix)\nresult_dt &lt;- paste(apply(transposed_matrix, 1, paste, collapse = \"\"), collapse = \"\")</pre><h4>Validation:</h4><pre>identical(result, test$`Decrypted Text`)\n# [1] TRUE\n\nidentical(result_base, test$`Decrypted Text`)\n# [1] TRUE\n\nidentical(result_dt, test$`Decrypted Text`)\n# [1] TRUE</pre><h3>Puzzle 336</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*pVbzd6gzYZ1qGrVXTnJu9Q.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*pVbzd6gzYZ1qGrVXTnJu9Q.png?w=578&amp;ssl=1\"/></noscript></figure><p>In this case we have two columns of numbers, and we need to find only those pairs that are unique for this table. We have to check if there is no double with reverse order somewhere. So lets find them.</p><h4>Loading libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Unique Pairs.xlsx\", range = \"A1:B10\") %&gt;% janitor::clean_names()\ntest = read_excel(\"Unique Pairs.xlsx\", range = \"D2:E5\") \n\ncolnames(test) = colnames(input)\ntest = test %&gt;% arrange(number2_1)</pre><h4>Approach 1: tidyverse</h4><pre>result = input %&gt;%\n  mutate(pair = map2(number2_1, number2_2, ~ sort(c(.x, .y)))) %&gt;%\n  group_by(pair) %&gt;%\n  filter(n() == 1) %&gt;%\n  ungroup() %&gt;%\n  select(-pair) %&gt;%\n  arrange(number2_1)</pre><h4>Approach 2: base R</h4><pre>input_df = input\n\ninput_df$pair_list &lt;- mapply(function(x, y) list(sort(c(x, y))), input_df$number2_1, input_df$number2_2)\ninput_df$pair_str &lt;- sapply(input_df$pair_list, function(x) paste(x, collapse = \"-\"))\ngrouped_list &lt;- split(input_df, input_df$pair_str)\nfiltered_df &lt;- do.call(rbind, lapply(grouped_list, function(df) if(nrow(df) == 1) df else NULL))\nresult_base &lt;- filtered_df[, !(names(filtered_df) %in% c(\"pair_list\", \"pair_str\"))]\nresult_base &lt;- result_base[order(result_base$number2_1), ]</pre><h4>Approach 3: data.table</h4><pre>input_dt = as.data.table(input)\ninput_dt[, pair_list := mapply(function(x, y) list(sort(c(x, y))), number2_1, number2_2)]\ninput_dt[, pair_str := sapply(pair_list, function(x) paste(x, collapse = \"-\"))]\nresult_dt &lt;- input_dt[, .SD[.N == 1], by = pair_str][, `:=`(pair_list = NULL, pair_str = NULL)]\nresult_dt &lt;- result_dt[order(number2_1), ]\nresult_dt &lt;- as_tibble(as.matrix(result_dt))\n</pre><h4>Validation:</h4><pre>identical(result, test)\n# [1] TRUE\n\nidentical(result_base, test)\n# [1] TRUE\n\nidentical(result_dt, test)\n# [1] TRUE</pre><h3>Puzzle 337</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*qFe09KRBG49xE7vZHgxAbw.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*qFe09KRBG49xE7vZHgxAbw.png?w=578&amp;ssl=1\"/></noscript></figure><p>This puzzle was mastermind. We had two columns of numbers. One represent number of digits (x) and second product of digits (y). And we have to find all numbers with x digits which product of digits is equal to y. Sounds pretty simple… but is really not. We can do it with brute force or find workaround. I tried brute force but looking for each 7-digit number which digits multiplied itself to be 23328, need to generate and process 10 millions of numbers. It is hard and can last very long. But in some of previous puzzles we used divisors, so I tried to get it from that side.</p><p>I found all divisors of “product of digits” and limit them for only those which are single digit. And then (let take first line with 3 digits and 8 as a product) we need to make every possible combination (with digit repetitions) of those divisors. In case of 8 those are 1,2,4,8 and we can make numbers like 111, 112, 248 and so on. When we have them all generated, we still have less than 1000 numbers to check. Then we have to check if product of digits in our list is equal to given at puzzle and filter them out. <br/>When we find out final list, we have to count them, get highest and lowest value, and that is it. Why did I told everything? Because I wanted to show my flow of thoughts, which caused reducing computational time from 10 minutes to 0.84 second. And now code.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(numbers)\n\ninput = read_excel(\"Product Equal To.xlsx\", range = \"A2:B7\") %&gt;% janitor::clean_names()\ntest = read_excel(\"Product Equal To.xlsx\", range = \"C2:E7\")</pre><h4>Approach and validation:</h4><pre>analyze_numbers = function(number_of_digits, products_of_digits) {\n  # get divisors of product (only single digit ones)\n  divs = divisors(products_of_digits)\n  sing_dig_divs = divs[divs &lt; 10]\n  # get all possible combinations of digits\n  all_combos = expand.grid(rep(list(sing_dig_divs), number_of_digits)) %&gt;%\n    # check if any of the combinations are equal to the product\n    mutate(prod_of_combo = reduce(., `*`)) %&gt;%\n    filter(prod_of_combo == products_of_digits) %&gt;%\n    select(-prod_of_combo) %&gt;%\n    # combine the digits into a single number\n    unite(\"number\", everything(), sep = \"\") \n  # summarize the results\n  summary = all_combos %&gt;%\n    summarise(Min = min(as.numeric(number)),\n              Max = max(as.numeric(number)),\n              Count = n() %&gt;% as.numeric()) \n  return(summary)\n}\n\nresult = input %&gt;%\n  mutate(summary = map2(number_of_digits, product_of_digits, analyze_numbers)) %&gt;%\n  unnest(summary) %&gt;%\n  select(-number_of_digits, -product_of_digits) \n\n\nidentical(result, test)  \n#&gt; [1] TRUE</pre><h3>Puzzle 338</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*60rL_9TdAshrEqjkrVpK1Q.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*60rL_9TdAshrEqjkrVpK1Q.png?w=578&amp;ssl=1\"/></noscript></figure><p>In this puzzle we need to check if control numbers for each longer numbers are correct using <a href=\"https://en.wikipedia.org/wiki/Damm_algorithm\" rel=\"nofollow\" target=\"_blank\">Damm Algorithm</a>. It is always basing on some kind of coding matrix and consecutive values of calculations.</p><p>Lets check it!</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Damm Algorithm.xlsx\", range = \"A1:A10\")\ntest = read_excel(\"Damm Algorithm.xlsx\", range = \"B1:B10\")\n\ncode_table = read_excel(\"Damm Algorithm.xlsx\", range = \"D2:N12\", col_names = T) %&gt;%\n  column_to_rownames(\"...1\") %&gt;%\n  as.matrix()</pre><h4>Approach:</h4><pre>compute_damm_check_digit &lt;- function(number, damm_matrix) {\n  digits &lt;- as.integer(unlist(strsplit(as.character(number), \"\")))\n  accumulate(digits, ~ damm_matrix[.x + 1, .y + 1], .init = 0) %&gt;% \n    tail(1)\n}\n\nresult = input %&gt;%\n  mutate(`Check Digit` = map_dbl(input$`Text Number`, compute_damm_check_digit, damm_matrix = code_table))</pre><h4>Validate:</h4><pre>identical(result$`Check Digit`, test$`Check Digit`)\n#&gt; [1] TRUE</pre><p>Feel free to comment, share and contact me with advices, questions and your ideas how to improve anything.</p><img alt=\"\" data-lazy-src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=34be0fbb8b1e\" height=\"1\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"1\"/><noscript><img alt=\"\" height=\"1\" loading=\"lazy\" src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=34be0fbb8b1e\" width=\"1\"/></noscript><hr/><p><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-34be0fbb8b1e\" rel=\"nofollow\" target=\"_blank\">R Solution for Excel Puzzles</a> was originally published in <a href=\"https://medium.com/number-around-us\" rel=\"nofollow\" target=\"_blank\">Numbers around us</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-34be0fbb8b1e\"> Numbers around us - Medium</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
      "main_text": "R Solution for Excel Puzzles\nPosted on\nDecember 4, 2023\nby\nNumbers around us\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nNumbers around us - Medium\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nPuzzles no. 334–338\nPuzzles\nAuthor:\nExcelBI\nPuzzles:\n# 334:\ncontent\nfile\n# 335:\ncontent\nfile\n# 336:\ncontent\nfile\n# 337:\ncontent\nfile\n# 338:\ncontent\nfile\nLets dive into solutions!\nPuzzle 334\nWe are given pairs of numbers and we have to find if they are amicable. But what does it mean? That mean that numbers are like they are complementing each other one fascinating way, like yin and yang. Sum of divisors of one number is equal to the second number and vice versa. So lets find out if they are.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(numbers)\n\ninput = read_excel(\"Amicable Numbers.xlsx\", range = \"A1:B10\") %>% janitor::clean_names()\ntest = read_excel(\"Amicable Numbers.xlsx\", range = \"C1:D6\") %>% janitor::clean_names()\nApproach 1: tidyverse\ndivs = function(x) {\n  divs_x = divisors(x)\n  divs_x[divs_x != x]\n}\n\nare_amicable = function(x, y) {\n  map2_lgl(x, y,  ~ sum(divs(.x)) == .y && sum(divs(.y)) == .x)\n}\n\nresult = input %>%\n  filter(are_amicable(number_1, number_2))\n\ncolnames(test) <- c(\"number_1\", \"number_2\")\nApproach 2: base R\ndivs_base <- function(x) {\n  divisors <- x : 1\n  divisors <- divisors[x %% divisors == 0]\n  divisors[divisors != x]\n}\n\nare_amicable_base <- function(x, y) {\n  amicable <- logical(length(x))\n  for (i in seq_along(x)) {\n    div_x <- divs_base(x[i])\n    div_y <- divs_base(y[i])\n    sum_x <- sum(div_x)\n    sum_y <- sum(div_y)\n    amicable[i] <- (sum_x == y[i] && sum_y == x[i])\n  }\n  amicable\n}\n\nresult_base <- input %>% \n  filter(are_amicable_base(number_1, number_2)) %>%\n  select(answer_expected= number_1, x2 = number_2)\nValidation:\nidentical(result, test)\n# [1] TRUE\n\nidentical(result_base, test)\n# [1] TRUE\nPuzzle 335\nThis time we had some decryption job to do. If you would like to know more about it, read\nhere\n. We have simple clue how to solve it: by reversing long string and break it into 5 strings. Lets do it.\nLoading library and data\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(stringi)\nlibrary(data.table)\n\ninput = read_excel(\"Feynman Challenge Cipher.xlsx\", range = \"A1:A2\")\ntest = read_excel(\"Feynman Challenge Cipher.xlsx\", range = \"B1:B2\")\nApproach 1: tidyverse\nresult = input$`Encrypted Text` %>%\n  stri_reverse() %>%\n  str_split(\"\") %>%\n  unlist() %>%\n  matrix(ncol = 5, byrow = TRUE) %>%\n  t() %>%\n  as_tibble() %>%\n  pmap_chr(~paste(c(...), collapse = \"\")) %>%\n  paste(collapse = \"\")\nApproach 2: base R\nreversed_text <- sapply(input$`Encrypted Text`, function(x) paste(rev(strsplit(x, \"\")[[1]]), collapse = \"\"))\nmatrix_formed <- matrix(unlist(strsplit(reversed_text, \"\")), ncol = 5, byrow = TRUE)\ntransposed_matrix <- t(matrix_formed)\nconcatenated_rows <- apply(transposed_matrix, 1, paste, collapse = \"\")\nresult_base <- paste(concatenated_rows, collapse = \"\")\nApproach 3: data.table\ninput_dt <- data.table(input)\n\ninput_dt[, reversed := sapply(`Encrypted Text`, function(x) paste(rev(strsplit(x, \"\")[[1]]), collapse = \"\"))]\nchar_matrix <- matrix(unlist(strsplit(input_dt$reversed, \"\")), ncol = 5, byrow = TRUE)\ntransposed_matrix <- t(char_matrix)\nresult_dt <- paste(apply(transposed_matrix, 1, paste, collapse = \"\"), collapse = \"\")\nValidation:\nidentical(result, test$`Decrypted Text`)\n# [1] TRUE\n\nidentical(result_base, test$`Decrypted Text`)\n# [1] TRUE\n\nidentical(result_dt, test$`Decrypted Text`)\n# [1] TRUE\nPuzzle 336\nIn this case we have two columns of numbers, and we need to find only those pairs that are unique for this table. We have to check if there is no double with reverse order somewhere. So lets find them.\nLoading libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Unique Pairs.xlsx\", range = \"A1:B10\") %>% janitor::clean_names()\ntest = read_excel(\"Unique Pairs.xlsx\", range = \"D2:E5\") \n\ncolnames(test) = colnames(input)\ntest = test %>% arrange(number2_1)\nApproach 1: tidyverse\nresult = input %>%\n  mutate(pair = map2(number2_1, number2_2, ~ sort(c(.x, .y)))) %>%\n  group_by(pair) %>%\n  filter(n() == 1) %>%\n  ungroup() %>%\n  select(-pair) %>%\n  arrange(number2_1)\nApproach 2: base R\ninput_df = input\n\ninput_df$pair_list <- mapply(function(x, y) list(sort(c(x, y))), input_df$number2_1, input_df$number2_2)\ninput_df$pair_str <- sapply(input_df$pair_list, function(x) paste(x, collapse = \"-\"))\ngrouped_list <- split(input_df, input_df$pair_str)\nfiltered_df <- do.call(rbind, lapply(grouped_list, function(df) if(nrow(df) == 1) df else NULL))\nresult_base <- filtered_df[, !(names(filtered_df) %in% c(\"pair_list\", \"pair_str\"))]\nresult_base <- result_base[order(result_base$number2_1), ]\nApproach 3: data.table\ninput_dt = as.data.table(input)\ninput_dt[, pair_list := mapply(function(x, y) list(sort(c(x, y))), number2_1, number2_2)]\ninput_dt[, pair_str := sapply(pair_list, function(x) paste(x, collapse = \"-\"))]\nresult_dt <- input_dt[, .SD[.N == 1], by = pair_str][, `:=`(pair_list = NULL, pair_str = NULL)]\nresult_dt <- result_dt[order(number2_1), ]\nresult_dt <- as_tibble(as.matrix(result_dt))\nValidation:\nidentical(result, test)\n# [1] TRUE\n\nidentical(result_base, test)\n# [1] TRUE\n\nidentical(result_dt, test)\n# [1] TRUE\nPuzzle 337\nThis puzzle was mastermind. We had two columns of numbers. One represent number of digits (x) and second product of digits (y). And we have to find all numbers with x digits which product of digits is equal to y. Sounds pretty simple… but is really not. We can do it with brute force or find workaround. I tried brute force but looking for each 7-digit number which digits multiplied itself to be 23328, need to generate and process 10 millions of numbers. It is hard and can last very long. But in some of previous puzzles we used divisors, so I tried to get it from that side.\nI found all divisors of “product of digits” and limit them for only those which are single digit. And then (let take first line with 3 digits and 8 as a product) we need to make every possible combination (with digit repetitions) of those divisors. In case of 8 those are 1,2,4,8 and we can make numbers like 111, 112, 248 and so on. When we have them all generated, we still have less than 1000 numbers to check. Then we have to check if product of digits in our list is equal to given at puzzle and filter them out.\nWhen we find out final list, we have to count them, get highest and lowest value, and that is it. Why did I told everything? Because I wanted to show my flow of thoughts, which caused reducing computational time from 10 minutes to 0.84 second. And now code.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(numbers)\n\ninput = read_excel(\"Product Equal To.xlsx\", range = \"A2:B7\") %>% janitor::clean_names()\ntest = read_excel(\"Product Equal To.xlsx\", range = \"C2:E7\")\nApproach and validation:\nanalyze_numbers = function(number_of_digits, products_of_digits) {\n  # get divisors of product (only single digit ones)\n  divs = divisors(products_of_digits)\n  sing_dig_divs = divs[divs < 10]\n  # get all possible combinations of digits\n  all_combos = expand.grid(rep(list(sing_dig_divs), number_of_digits)) %>%\n    # check if any of the combinations are equal to the product\n    mutate(prod_of_combo = reduce(., `*`)) %>%\n    filter(prod_of_combo == products_of_digits) %>%\n    select(-prod_of_combo) %>%\n    # combine the digits into a single number\n    unite(\"number\", everything(), sep = \"\") \n  # summarize the results\n  summary = all_combos %>%\n    summarise(Min = min(as.numeric(number)),\n              Max = max(as.numeric(number)),\n              Count = n() %>% as.numeric()) \n  return(summary)\n}\n\nresult = input %>%\n  mutate(summary = map2(number_of_digits, product_of_digits, analyze_numbers)) %>%\n  unnest(summary) %>%\n  select(-number_of_digits, -product_of_digits) \n\nidentical(result, test)  \n#> [1] TRUE\nPuzzle 338\nIn this puzzle we need to check if control numbers for each longer numbers are correct using\nDamm Algorithm\n. It is always basing on some kind of coding matrix and consecutive values of calculations.\nLets check it!\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Damm Algorithm.xlsx\", range = \"A1:A10\")\ntest = read_excel(\"Damm Algorithm.xlsx\", range = \"B1:B10\")\n\ncode_table = read_excel(\"Damm Algorithm.xlsx\", range = \"D2:N12\", col_names = T) %>%\n  column_to_rownames(\"...1\") %>%\n  as.matrix()\nApproach:\ncompute_damm_check_digit <- function(number, damm_matrix) {\n  digits <- as.integer(unlist(strsplit(as.character(number), \"\")))\n  accumulate(digits, ~ damm_matrix[.x + 1, .y + 1], .init = 0) %>% \n    tail(1)\n}\n\nresult = input %>%\n  mutate(`Check Digit` = map_dbl(input$`Text Number`, compute_damm_check_digit, damm_matrix = code_table))\nValidate:\nidentical(result$`Check Digit`, test$`Check Digit`)\n#> [1] TRUE\nFeel free to comment, share and contact me with advices, questions and your ideas how to improve anything.\nR Solution for Excel Puzzles\nwas originally published in\nNumbers around us\non Medium, where people are continuing the conversation by highlighting and responding to this story.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nNumbers around us - Medium\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Puzzles no. 334–338PuzzlesAuthor: ExcelBIPuzzles:# 334: content file# 335: content file# 336: content file# 337: content file# 338: content fileLets dive into solutions!Puzzle 334We are given pairs of numbers and we have to find if they are amicable. B...",
      "meta_keywords": null,
      "og_description": "Puzzles no. 334–338PuzzlesAuthor: ExcelBIPuzzles:# 334: content file# 335: content file# 336: content file# 337: content file# 338: content fileLets dive into solutions!Puzzle 334We are given pairs of numbers and we have to find if they are amicable. B...",
      "og_image": "https://cdn-images-1.medium.com/max/1024/1*nbj082B2hjHEy4OpO61T-A.jpeg",
      "og_title": "R Solution for Excel Puzzles | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 6.9,
      "sitemap_lastmod": "2023-12-04T19:58:26+00:00",
      "twitter_description": "Puzzles no. 334–338PuzzlesAuthor: ExcelBIPuzzles:# 334: content file# 335: content file# 336: content file# 337: content file# 338: content fileLets dive into solutions!Puzzle 334We are given pairs of numbers and we have to find if they are amicable. B...",
      "twitter_title": "R Solution for Excel Puzzles | R-bloggers",
      "url": "https://www.r-bloggers.com/2023/12/r-solution-for-excel-puzzles-2/",
      "word_count": 1379
    }
  }
}