{
  "uuid": "f2e33eb6-87a1-452d-9c3f-07d37ceeb50e",
  "created_at": "2025-11-22 19:58:25",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2025/06/let-it-flow-recreating-a-facs-plot-with-ggplot/",
    "crawled_at": "2025-11-22T10:47:48.690028",
    "external_links": [
      {
        "href": "https://quantixed.org/2025/06/05/let-it-flow-recreating-a-facs-plot-with-ggplot/",
        "text": "Rstats – quantixed"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://doi.org/10.1101/2024.05.31.596797",
        "text": "https://doi.org/10.1101/2024.05.31.596797"
      },
      {
        "href": "https://quantixed.org/2025/06/05/let-it-flow-recreating-a-facs-plot-with-ggplot/#result",
        "text": "result"
      },
      {
        "href": "https://doi.org/10.5281/zenodo.15582237",
        "text": "here"
      },
      {
        "href": "https://ggplot2.tidyverse.org/reference/geom_path.html",
        "text": "connecting observations"
      },
      {
        "href": "https://quantixed.org/2025/06/05/let-it-flow-recreating-a-facs-plot-with-ggplot/",
        "text": "Rstats – quantixed"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Let It Flow: recreating a FACS plot with ggplot | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/FigS2.jpg?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot1-1024x512.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot2-1024x512.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot3-1024x512.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot4-1024x512.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot5-1024x512.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot6-1024x512.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot7-1024x512.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot8-1024x512.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot9-1024x512.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot10-1024x512.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot11-1024x512.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot12-1024x512.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot13-1024x512.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot14-1024x512.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot15.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/FigS2.jpg?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot15.png?w=450&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/stephen-royle/",
        "text": "Stephen Royle"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-392868 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Let It Flow: recreating a FACS plot with ggplot</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">June 5, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/stephen-royle/\">Stephen Royle</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://quantixed.org/2025/06/05/let-it-flow-recreating-a-facs-plot-with-ggplot/\"> Rstats – quantixed</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<p>It’s plot recreation time! In this post, we’ll look at how we can recreate a plot in R. I thought it might be useful to provide the solution but also to detail the process I went through to get there.</p>\n<p>We have a FACS plot taken from a BD FACS Aria machine:</p>\n<figure class=\"wp-block-image size-full wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce9868958\"}\"=\"\"><img alt=\"\" class=\"wp-image-3462\" data-lazy-sizes=\"(max-width: 716px) 100vw, 716px\" data-lazy-src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/FigS2.jpg?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" fetchpriority=\"high\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/FigS2.jpg?w=450&amp;ssl=1 716w, https://quantixed.org/wp-content/uploads/2025/06/FigS2-300x287.jpg 300w\"/><noscript><img alt=\"\" class=\"wp-image-3462\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" fetchpriority=\"high\" loading=\"lazy\" sizes=\"(max-width: 716px) 100vw, 716px\" src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/FigS2.jpg?w=450&amp;ssl=1\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/FigS2.jpg?w=450&amp;ssl=1 716w, https://quantixed.org/wp-content/uploads/2025/06/FigS2-300x287.jpg 300w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n<p>Briefly, it’s a histogram of the fluorescence levels of 10000 cells from three different sources. The fluorescence is excited by a 488 nm laser and is collected at 515-545 nm, i.e. it’s green fluorescence.</p>\n<h3 class=\"wp-block-heading\">Why do we need to recreate the plot?</h3>\n<p>This plot was in the Supplementary Information of our preprint (Fig S2).</p>\n<p><a href=\"https://doi.org/10.1101/2024.05.31.596797\" rel=\"nofollow\" target=\"_blank\">https://doi.org/10.1101/2024.05.31.596797</a></p>\n<p>The journal requires all numeric data in the plots to be made available. Since the plot was generated in software that I didn’t have access to, it needed to be recreated from the raw data and then the numeric data could be made available.</p>\n<h3 class=\"wp-block-heading\">What do we need to do to recreate it?</h3>\n<p>Just looking at the plot, what difficulties do we anticipate?</p>\n<ul class=\"wp-block-list\">\n<li>It’s a histogram on a log scale – so bin sizes might be problematic</li>\n<li>We need to do line representation and fill – I don’t know how to do this</li>\n<li>We have the raw data, but we will need to verify the count – is all of it plotted or only some?</li>\n</ul>\n<h3 class=\"wp-block-heading\">The process</h3>\n<p>You can skip to the final <a href=\"https://quantixed.org/2025/06/05/let-it-flow-recreating-a-facs-plot-with-ggplot/#result\" rel=\"nofollow\" target=\"_blank\">result</a> if you just want to know how to generate a plot like this.</p>\n<p>If you want to code along, the data is available <a href=\"https://doi.org/10.5281/zenodo.15582237\" rel=\"nofollow\" target=\"_blank\">here</a>.</p>\n<p>First we’ll use the Bioconductor package <code>{flowCore}</code> to load in the raw <code>.fcs</code> files.</p>\n<pre>\n# if (!require(\"BiocManager\", quietly = TRUE))\n#   install.packages(\"BiocManager\")\n# BiocManager::install(\"flowCore\")\n# BiocManager::install(\"flowWorkspace\")\n# BiocManager::install(\"ggcyto\")\n\nlibrary(flowCore)\nlibrary(flowWorkspace)\nlibrary(ggplot2)\nlibrary(ggcyto)\nlibrary(data.table)\nlibrary(dplyr)\nlibrary(cowplot)\n\n# list the fcs files and read them into a flowSet\nfcs_files &lt;- list.files(path = \"Data\",pattern = \".fcs\", full.names = TRUE)\nfs &lt;- read.flowSet(files = unlist(fcs_files))\n# wrangle the flowSet into a data frame\ntflow &lt;- fsApply(fs, exprs, simplify = F)  \ntflow &lt;- lapply(tflow, as.data.frame)  \ntflow &lt;- rbindlist(tflow, idcol = \"file\")\ntflow &lt;- as.data.frame(tflow)\n\n# filter for \"clon 5\" \"pool\" and \"negative\" the three cell sources we're interested in\ntflow &lt;- tflow %&gt;%\n  filter(grepl(\"clon 5\", file) | grepl(\"pool\", file) | grepl(\"negative\", file))\n</pre>\n<p>We can see that this data frame is 30000 rows and that each file had 10000 rows (if we look a bit closer), which means that all the data were plotted originally. We just have to plot the data ourselves. One concern checked off the list.</p>\n<p>In terms of data, to make the plot, we only need the <code>B488-530_30-A</code> column of numerical values and the <code>file</code> column which indicates the cell source.</p>\n<p>Now let’s have a first pass at a plot.</p>\n<pre>\n# ggplot of \"B488-530_30-A\" as histogram on a logicle scale\nggplot(tflow, aes(x = `B488-530/30-A`, colour = file)) +\n  geom_density() +\n  scale_x_logicle() +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot1.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\n</pre>\n<figure class=\"wp-block-image size-large wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce986912e\"}\"=\"\"><img alt=\"\" class=\"wp-image-3463\" data-lazy-sizes=\"(max-width: 1024px) 100vw, 1024px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot1-1024x512.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot1-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot1-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot1-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot1-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot1-2048x1024.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3463\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" sizes=\"(max-width: 1024px) 100vw, 1024px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot1-1024x512.png?w=450&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot1-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot1-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot1-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot1-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot1-2048x1024.png 2048w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n<p>The shape of the data looks approximately correct. I used <code>geom_density()</code> to get a line profile but it’s too smoothed to generate the plot we need. I used the “logicle” scale from <code>{ggcyto}</code> but we only need a regular log scale.</p>\n<p>Let’s switch to a histogram:</p>\n<pre>\n# ggplot of \"B488-530_30-A\" as histogram on a log scale\nggplot(tflow, aes(x = `B488-530/30-A`, colour = file)) +\n  geom_histogram() +\n  scale_x_log10() +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot2.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\n</pre>\n<figure class=\"wp-block-image size-large wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce9869531\"}\"=\"\"><img alt=\"\" class=\"wp-image-3465\" data-lazy-sizes=\"(max-width: 1024px) 100vw, 1024px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot2-1024x512.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot2-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot2-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot2-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot2-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot2-2048x1024.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3465\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" sizes=\"(max-width: 1024px) 100vw, 1024px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot2-1024x512.png?w=450&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot2-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot2-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot2-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot2-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot2-2048x1024.png 2048w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n<p>The first thing is that ggplot understands that the scaling of the x axis means the histogram bins need to be scaled. However this command generates some error messages due to the transformation; likely due to 0 values in the data.</p>\n<p>The idea of ggplot is to let the package do all the work, but sometimes it’s better to refine what goes in. So we’ll transform the values manually. We can then plot the transformed values and sort out the x-axis labelling leter. While we are at it, let’s use the colours from the FACS Aria plot as well.</p>\n<pre>\n# log transform B488-530/30-A to get a plot like FACSAria\ntflow$trans &lt;- log10(tflow$`B488-530/30-A` + 1)\n# colours from the FACSAria output\nmy_colours &lt;- c(rgb(2, 85, 170, maxColorValue = 255),\n                rgb(255, 51, 52, maxColorValue = 255),\n                rgb(131, 130, 1, maxColorValue = 255))\n# plot and refine\nggplot(tflow, aes(x = trans, colour = file)) +\n  geom_histogram(fill = \"white\") +\n  scale_colour_manual(values = my_colours) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot3.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nggplot(tflow, aes(x = trans, colour = file)) +\n  geom_histogram(binwidth = 0.1, fill = \"white\") +\n  scale_colour_manual(values = my_colours) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot4.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nggplot(tflow, aes(x = trans, colour = file)) +\n  geom_histogram(binwidth = 0.01, fill = \"white\") +\n  scale_colour_manual(values = my_colours) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot5.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nggplot(tflow, aes(x = trans, colour = file)) +\n  geom_histogram(binwidth = 0.01, position = \"identity\", fill = \"white\") +\n  scale_colour_manual(values = my_colours) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot6.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nggplot(tflow, aes(x = trans, colour = file)) +\n  geom_histogram(binwidth = 0.02, position = \"identity\", fill = \"white\") +\n  scale_colour_manual(values = my_colours) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot7.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\n</pre>\n<figure class=\"wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-1 is-layout-flex wp-block-gallery-is-layout-flex\">\n<figure class=\"wp-block-image size-large wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce986990e\"}\"=\"\"><img alt=\"\" class=\"wp-image-3466\" data-id=\"3466\" data-lazy-sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot3-1024x512.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot3-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot3-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot3-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot3-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot3-2048x1024.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3466\" data-id=\"3466\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot3-1024x512.png?w=450&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot3-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot3-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot3-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot3-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot3-2048x1024.png 2048w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n<figure class=\"wp-block-image size-large wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce9869c85\"}\"=\"\"><img alt=\"\" class=\"wp-image-3467\" data-id=\"3467\" data-lazy-sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" data-lazy-src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot4-1024x512.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot4-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot4-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot4-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot4-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot4-2048x1024.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3467\" data-id=\"3467\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot4-1024x512.png?w=450&amp;ssl=1\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot4-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot4-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot4-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot4-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot4-2048x1024.png 2048w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n<figure class=\"wp-block-image size-large wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce9869fa3\"}\"=\"\"><img alt=\"\" class=\"wp-image-3470\" data-id=\"3470\" data-lazy-sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot5-1024x512.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot5-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot5-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot5-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot5-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot5-2048x1024.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3470\" data-id=\"3470\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot5-1024x512.png?w=450&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot5-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot5-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot5-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot5-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot5-2048x1024.png 2048w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n<figure class=\"wp-block-image size-large wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce986a415\"}\"=\"\"><img alt=\"\" class=\"wp-image-3468\" data-id=\"3468\" data-lazy-sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" data-lazy-src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot6-1024x512.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot6-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot6-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot6-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot6-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot6-2048x1024.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3468\" data-id=\"3468\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot6-1024x512.png?w=450&amp;ssl=1\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot6-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot6-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot6-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot6-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot6-2048x1024.png 2048w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n<figure class=\"wp-block-image size-large wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce986a761\"}\"=\"\"><img alt=\"\" class=\"wp-image-3469\" data-id=\"3469\" data-lazy-sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" data-lazy-src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot7-1024x512.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot7-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot7-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot7-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot7-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot7-2048x1024.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3469\" data-id=\"3469\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot7-1024x512.png?w=450&amp;ssl=1\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot7-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot7-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot7-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot7-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot7-2048x1024.png 2048w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n</figure>\n<p>By varying the binwidth (bearing in mind that this is in transformed units), we can get closer to the look of the original plot. Using <code>position = \"identity\"</code> means we lose the default “stacked histogram” behaviour and the counts are close to the original which tells us that the binwidth is refined. The axis is still borked, but we’ll fix that later.</p>\n<p>We need to get rid of the borders of each bin in the histogram, but we need the line on the top. We can achieve this effect by using <code>geom_step</code> which gives a cityscape plot, and combine that with <code>geom_histogram</code> to do the fill only.</p>\n<pre>\n# try to lose the histogram look\nggplot(tflow, aes(x = trans, colour = file, fill = file)) +\n  geom_histogram(binwidth = 0.02, position = \"identity\", colour = NA, alpha = 0.3) +\n  scale_fill_manual(values = my_colours) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot8.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nggplot(tflow, aes(x = trans, colour = file, fill = file)) +\n  geom_step(stat = \"bin\", binwidth = 0.02, direction = \"mid\") +\n  geom_histogram(binwidth = 0.02, position = \"identity\", colour = NA, alpha = 0.3) +\n  scale_fill_manual(values = my_colours) +\n  scale_colour_manual(values = my_colours) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot9.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\n</pre>\n<figure class=\"wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-2 is-layout-flex wp-block-gallery-is-layout-flex\">\n<figure class=\"wp-block-image size-large wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce986b081\"}\"=\"\"><img alt=\"\" class=\"wp-image-3472\" data-id=\"3472\" data-lazy-sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" data-lazy-src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot8-1024x512.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot8-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot8-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot8-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot8-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot8-2048x1024.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3472\" data-id=\"3472\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot8-1024x512.png?w=450&amp;ssl=1\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot8-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot8-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot8-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot8-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot8-2048x1024.png 2048w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n<figure class=\"wp-block-image size-large wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce986b3c0\"}\"=\"\"><img alt=\"\" class=\"wp-image-3473\" data-id=\"3473\" data-lazy-sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot9-1024x512.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot9-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot9-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot9-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot9-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot9-2048x1024.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3473\" data-id=\"3473\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot9-1024x512.png?w=450&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot9-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot9-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot9-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot9-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot9-2048x1024.png 2048w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n</figure>\n<p>This is close… but it’s still got the “blocky” look to it. So this is the end of the line for this approach. We need to change tack.</p>\n<p>By looking at the tidyverse manual for geom_step “<a href=\"https://ggplot2.tidyverse.org/reference/geom_path.html\" rel=\"nofollow\" target=\"_blank\">connecting observations</a>“, I can see that geom_line is part of the same family. So let’s do this:</p>\n<pre>\n# use geom_line \nggplot(tflow, aes(x = trans, colour = file, fill = file)) +\n  geom_line(stat = \"bin\", binwidth = 0.02, direction = \"mid\") +\n  geom_histogram(binwidth = 0.02, position = \"identity\", colour = NA, alpha = 0.3) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  scale_colour_manual(values = my_colours) +\n  scale_fill_manual(values = my_colours) +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot10.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\n# use geom_area\nggplot(tflow, aes(x = trans, colour = file, fill = file)) +\n  geom_line(stat = \"bin\", binwidth = 0.02, direction = \"mid\") +\n  geom_area(stat = \"bin\", binwidth = 0.02, position = \"identity\", colour = NA, alpha = 0.3) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  scale_colour_manual(values = my_colours) +\n  scale_fill_manual(values = my_colours) +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot11.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\n# tweak binwidth to match original\nggplot(tflow, aes(x = trans, colour = file, fill = file)) +\n  geom_line(stat = \"bin\", binwidth = 0.018, direction = \"mid\") +\n  geom_area(stat = \"bin\", binwidth = 0.018, position = \"identity\", colour = NA, alpha = 0.3) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  scale_colour_manual(values = my_colours) +\n  scale_fill_manual(values = my_colours) +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot12.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\n# now fix the axis\nggplot(tflow, aes(x = trans, colour = file, fill = file)) +\n  geom_line(stat = \"bin\", binwidth = 0.018, direction = \"mid\") +\n  geom_area(stat = \"bin\", binwidth = 0.018, position = \"identity\", colour = NA, alpha = 0.3) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  scale_x_continuous(limits = c(0.6,5), labels = scales::label_math(10^.x)) +\n  scale_colour_manual(values = my_colours) +\n  scale_fill_manual(values = my_colours) +\n  theme_cowplot(9) +\n  annotation_logticks(sides = \"b\")\nggsave(\"Output/Plots/plot13.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\n</pre>\n<figure class=\"wp-block-gallery has-nested-images columns-2 is-cropped wp-block-gallery-3 is-layout-flex wp-block-gallery-is-layout-flex\">\n<figure class=\"wp-block-image size-large wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce986b830\"}\"=\"\"><img alt=\"\" class=\"wp-image-3474\" data-id=\"3474\" data-lazy-sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" data-lazy-src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot10-1024x512.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot10-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot10-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot10-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot10-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot10-2048x1024.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3474\" data-id=\"3474\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot10-1024x512.png?w=450&amp;ssl=1\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot10-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot10-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot10-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot10-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot10-2048x1024.png 2048w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n<figure class=\"wp-block-image size-large wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce986bb7a\"}\"=\"\"><img alt=\"\" class=\"wp-image-3477\" data-id=\"3477\" data-lazy-sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" data-lazy-src=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot11-1024x512.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot11-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot11-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot11-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot11-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot11-2048x1024.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3477\" data-id=\"3477\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" src=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot11-1024x512.png?w=450&amp;ssl=1\" srcset_temp=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot11-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot11-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot11-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot11-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot11-2048x1024.png 2048w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n<figure class=\"wp-block-image size-large wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce986bf00\"}\"=\"\"><img alt=\"\" class=\"wp-image-3476\" data-id=\"3476\" data-lazy-sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot12-1024x512.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot12-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot12-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot12-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot12-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot12-2048x1024.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3476\" data-id=\"3476\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot12-1024x512.png?w=450&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot12-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot12-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot12-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot12-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot12-2048x1024.png 2048w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n<figure class=\"wp-block-image size-large wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce986c21e\"}\"=\"\"><img alt=\"\" class=\"wp-image-3475\" data-id=\"3475\" data-lazy-sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot13-1024x512.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot13-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot13-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot13-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot13-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot13-2048x1024.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3475\" data-id=\"3475\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot13-1024x512.png?w=450&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/06/plot13-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot13-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot13-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot13-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot13-2048x1024.png 2048w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n</figure>\n<p>Replacing <code>geom_step</code> with <code>geom_line</code> worked right away. Replacing <code>geom_histogram</code> with <code>geom_area</code> means we get the nice fill effect and finally get rid of the blocky look. We also tweaked the binwidth to match the original and finally fixed the axis.</p>\n<p>To make it more presentable, we’ll change the colours (since they didn’t make much sense in the original plot). We’ll move the legend inside the plot just to make scaling the final thing easier to insert to into the figure.</p>\n<pre>\n# the original colours weren't great, so\nmy_colours &lt;- c(\"#00a651\", \"#3f3f3f\", \"#2276b9\")\n# plot the log transformed data as a histogram with binwidth of 0.018\nggplot(tflow, aes(x = trans, colour = file, fill = file)) +\n  geom_line(stat = \"bin\", binwidth = 0.018, direction = \"mid\") +\n  geom_area(stat = \"bin\", binwidth = 0.018, position = \"identity\", colour = NA, alpha = 0.3) +\n  # geom_histogram(binwidth = 0.018, position = \"identity\", colour = NA, alpha = 0.3) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  scale_x_continuous(limits = c(0.6,5), labels = scales::label_math(10^.x)) +\n  scale_colour_manual(values = my_colours) +\n  scale_fill_manual(values = my_colours) +\n  theme_cowplot(9) +\n  # place legend inside the plot, top left\n  theme(legend.position = c(0.1, 0.9),\n        legend.background = element_rect(fill = \"transparent\"),\n        legend.key = element_rect(fill = \"transparent\", colour = \"transparent\")) +\n  annotation_logticks(sides = \"b\")\n# save the plot\nggsave(\"Output/Plots/plot14.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\n</pre>\n<figure class=\"wp-block-image size-large wp-lightbox-container\" data-wp-context=\"{\" data-wp-interactive=\"core/image\" imageid\":\"6841ce986c65c\"}\"=\"\"><img alt=\"\" class=\"wp-image-3478\" data-lazy-sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" data-lazy-src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot14-1024x512.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot14-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot14-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot14-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot14-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot14-2048x1024.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3478\" data-recalc-dims=\"1\" data-wp-class--hide=\"state.isContentHidden\" data-wp-class--show=\"state.isContentVisible\" data-wp-init=\"callbacks.setButtonStyles\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-on-async--load=\"callbacks.setButtonStyles\" data-wp-on-async-window--resize=\"callbacks.setButtonStyles\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot14-1024x512.png?w=450&amp;ssl=1\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/plot14-1024x512.png?w=450&amp;ssl=1 1024w, https://quantixed.org/wp-content/uploads/2025/06/plot14-300x150.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot14-768x384.png 768w, https://quantixed.org/wp-content/uploads/2025/06/plot14-1536x768.png 1536w, https://quantixed.org/wp-content/uploads/2025/06/plot14-2048x1024.png 2048w\"/></noscript><button aria-haspopup=\"dialog\" aria-label=\"Enlarge\" class=\"lightbox-trigger\" data-wp-init=\"callbacks.initTriggerButton\" data-wp-on-async--click=\"actions.showLightbox\" data-wp-style--right=\"state.imageButtonRight\" data-wp-style--top=\"state.imageButtonTop\" type=\"button\">\n<svg fill=\"none\" height=\"12\" viewbox=\"0 0 12 12\" width=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M2 0a2 2 0 0 0-2 2v2h1.5V2a.5.5 0 0 1 .5-.5h2V0H2Zm2 10.5H2a.5.5 0 0 1-.5-.5V8H0v2a2 2 0 0 0 2 2h2v-1.5ZM8 12v-1.5h2a.5.5 0 0 0 .5-.5V8H12v2a2 2 0 0 1-2 2H8Zm2-12a2 2 0 0 1 2 2v2h-1.5V2a.5.5 0 0 0-.5-.5H8V0h2Z\" fill=\"#fff\"></path>\n</svg>\n</button></figure>\n<p id=\"result\">From here we can export at the correct size and slot it into the figure.</p>\n<pre>\nggsave(\"Output/Plots/plot15.png\", last_plot() + theme(legend.position = \"none\"), width = 58, height = 58, dpi = 300, bg = \"white\", units = \"mm\")\n</pre>\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-3479\" data-lazy-sizes=\"auto, (max-width: 685px) 100vw, 685px\" data-lazy-src=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot15.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot15.png?w=450&amp;ssl=1 685w, https://quantixed.org/wp-content/uploads/2025/06/plot15-300x300.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot15-150x150.png 150w\"/><noscript><img alt=\"\" class=\"wp-image-3479\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 685px) 100vw, 685px\" src=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot15.png?w=450&amp;ssl=1\" srcset_temp=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot15.png?w=450&amp;ssl=1 685w, https://quantixed.org/wp-content/uploads/2025/06/plot15-300x300.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot15-150x150.png 150w\"/></noscript></figure>\n<p>Finally, if you remember, the journal wanted the numerical data. We can save it like this:</p>\n<pre>\n## Export results ----\n# if Output/Data directory does not exist, create it\nif (!dir.exists(\"Output/Data\")) {\n  dir.create(\"Output/Data\", recursive = TRUE)\n}\n# extract Protein and IntDen columns to a new dataframe and save as csv\nresults &lt;- tflow %&gt;%\n  select(file, `B488-530/30-A`, trans) %&gt;%\n  mutate(file = gsub(\".fcs\", \"\", file)) %&gt;%\n  mutate(file = gsub(\"Specimen_001_\", \"\", file))\n\nwrite.csv(results, \"Output/Data/S2B.csv\", row.names = FALSE)\n</pre>\n<h3 class=\"wp-block-heading\">How did we do?</h3>\n<p>At the risk of “marking my own homework”, let’s see how we did.</p>\n<ul class=\"wp-block-list\">\n<li>We verified the raw data-to-plot pipeline and produced the numerical data required by the journal</li>\n<li>We produced a plot which is in the same style as the original:\n<ul class=\"wp-block-list\">\n<li>The y-axis scale and the shape of the lines is similar</li>\n<li>We achieved the same look with geom_line and geom_area</li>\n<li>x-axis scaling is correct</li>\n</ul>\n</li>\n<li>The goal was not to reproduce the plot exactly:\n<ul class=\"wp-block-list\">\n<li>We improved the colour scheme</li>\n<li>The x-axis ticks are facing the wrong way (I believe this is because external ticks are clipped by <code>{cowplot}</code>)</li>\n<li>No y-axis minor ticks</li>\n<li>No box or mirrored axes</li>\n<li>Legend will need modifying later in the figure</li>\n</ul>\n</li>\n</ul>\n<figure class=\"wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-4 is-layout-flex wp-block-gallery-is-layout-flex\">\n<figure class=\"wp-block-image size-large\"><img alt=\"\" class=\"wp-image-3462\" data-id=\"3462\" data-lazy-sizes=\"auto, (max-width: 716px) 100vw, 716px\" data-lazy-src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/FigS2.jpg?w=450&amp;ssl=1\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/FigS2.jpg?w=450&amp;ssl=1 716w, https://quantixed.org/wp-content/uploads/2025/06/FigS2-300x287.jpg 300w\"/><noscript><img alt=\"\" class=\"wp-image-3462\" data-id=\"3462\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 716px) 100vw, 716px\" src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/FigS2.jpg?w=450&amp;ssl=1\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/06/FigS2.jpg?w=450&amp;ssl=1 716w, https://quantixed.org/wp-content/uploads/2025/06/FigS2-300x287.jpg 300w\"/></noscript></figure>\n<figure class=\"wp-block-image size-large\"><img alt=\"\" class=\"wp-image-3479\" data-id=\"3479\" data-lazy-sizes=\"auto, (max-width: 685px) 100vw, 685px\" data-lazy-src=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot15.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot15.png?w=450&amp;ssl=1 685w, https://quantixed.org/wp-content/uploads/2025/06/plot15-300x300.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot15-150x150.png 150w\"/><noscript><img alt=\"\" class=\"wp-image-3479\" data-id=\"3479\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 685px) 100vw, 685px\" src=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot15.png?w=450&amp;ssl=1\" srcset_temp=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/06/plot15.png?w=450&amp;ssl=1 685w, https://quantixed.org/wp-content/uploads/2025/06/plot15-300x300.png 300w, https://quantixed.org/wp-content/uploads/2025/06/plot15-150x150.png 150w\"/></noscript></figure>\n</figure>\n<p>—</p>\n<p>The post title comes from “Let It Flow” by Spiritualized, taken from their Pure Phase album.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://quantixed.org/2025/06/05/let-it-flow-recreating-a-facs-plot-with-ggplot/\"> Rstats – quantixed</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
    "main_text": "Let It Flow: recreating a FACS plot with ggplot\nPosted on\nJune 5, 2025\nby\nStephen Royle\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nRstats – quantixed\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nIt’s plot recreation time! In this post, we’ll look at how we can recreate a plot in R. I thought it might be useful to provide the solution but also to detail the process I went through to get there.\nWe have a FACS plot taken from a BD FACS Aria machine:\nBriefly, it’s a histogram of the fluorescence levels of 10000 cells from three different sources. The fluorescence is excited by a 488 nm laser and is collected at 515-545 nm, i.e. it’s green fluorescence.\nWhy do we need to recreate the plot?\nThis plot was in the Supplementary Information of our preprint (Fig S2).\nhttps://doi.org/10.1101/2024.05.31.596797\nThe journal requires all numeric data in the plots to be made available. Since the plot was generated in software that I didn’t have access to, it needed to be recreated from the raw data and then the numeric data could be made available.\nWhat do we need to do to recreate it?\nJust looking at the plot, what difficulties do we anticipate?\nIt’s a histogram on a log scale – so bin sizes might be problematic\nWe need to do line representation and fill – I don’t know how to do this\nWe have the raw data, but we will need to verify the count – is all of it plotted or only some?\nThe process\nYou can skip to the final\nresult\nif you just want to know how to generate a plot like this.\nIf you want to code along, the data is available\nhere\n.\nFirst we’ll use the Bioconductor package\n{flowCore}\nto load in the raw\n.fcs\nfiles.\n# if (!require(\"BiocManager\", quietly = TRUE))\n#   install.packages(\"BiocManager\")\n# BiocManager::install(\"flowCore\")\n# BiocManager::install(\"flowWorkspace\")\n# BiocManager::install(\"ggcyto\")\n\nlibrary(flowCore)\nlibrary(flowWorkspace)\nlibrary(ggplot2)\nlibrary(ggcyto)\nlibrary(data.table)\nlibrary(dplyr)\nlibrary(cowplot)\n\n# list the fcs files and read them into a flowSet\nfcs_files <- list.files(path = \"Data\",pattern = \".fcs\", full.names = TRUE)\nfs <- read.flowSet(files = unlist(fcs_files))\n# wrangle the flowSet into a data frame\ntflow <- fsApply(fs, exprs, simplify = F)  \ntflow <- lapply(tflow, as.data.frame)  \ntflow <- rbindlist(tflow, idcol = \"file\")\ntflow <- as.data.frame(tflow)\n\n# filter for \"clon 5\" \"pool\" and \"negative\" the three cell sources we're interested in\ntflow <- tflow %>%\n  filter(grepl(\"clon 5\", file) | grepl(\"pool\", file) | grepl(\"negative\", file))\nWe can see that this data frame is 30000 rows and that each file had 10000 rows (if we look a bit closer), which means that all the data were plotted originally. We just have to plot the data ourselves. One concern checked off the list.\nIn terms of data, to make the plot, we only need the\nB488-530_30-A\ncolumn of numerical values and the\nfile\ncolumn which indicates the cell source.\nNow let’s have a first pass at a plot.\n# ggplot of \"B488-530_30-A\" as histogram on a logicle scale\nggplot(tflow, aes(x = `B488-530/30-A`, colour = file)) +\n  geom_density() +\n  scale_x_logicle() +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot1.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nThe shape of the data looks approximately correct. I used\ngeom_density()\nto get a line profile but it’s too smoothed to generate the plot we need. I used the “logicle” scale from\n{ggcyto}\nbut we only need a regular log scale.\nLet’s switch to a histogram:\n# ggplot of \"B488-530_30-A\" as histogram on a log scale\nggplot(tflow, aes(x = `B488-530/30-A`, colour = file)) +\n  geom_histogram() +\n  scale_x_log10() +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot2.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nThe first thing is that ggplot understands that the scaling of the x axis means the histogram bins need to be scaled. However this command generates some error messages due to the transformation; likely due to 0 values in the data.\nThe idea of ggplot is to let the package do all the work, but sometimes it’s better to refine what goes in. So we’ll transform the values manually. We can then plot the transformed values and sort out the x-axis labelling leter. While we are at it, let’s use the colours from the FACS Aria plot as well.\n# log transform B488-530/30-A to get a plot like FACSAria\ntflow$trans <- log10(tflow$`B488-530/30-A` + 1)\n# colours from the FACSAria output\nmy_colours <- c(rgb(2, 85, 170, maxColorValue = 255),\n                rgb(255, 51, 52, maxColorValue = 255),\n                rgb(131, 130, 1, maxColorValue = 255))\n# plot and refine\nggplot(tflow, aes(x = trans, colour = file)) +\n  geom_histogram(fill = \"white\") +\n  scale_colour_manual(values = my_colours) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot3.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nggplot(tflow, aes(x = trans, colour = file)) +\n  geom_histogram(binwidth = 0.1, fill = \"white\") +\n  scale_colour_manual(values = my_colours) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot4.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nggplot(tflow, aes(x = trans, colour = file)) +\n  geom_histogram(binwidth = 0.01, fill = \"white\") +\n  scale_colour_manual(values = my_colours) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot5.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nggplot(tflow, aes(x = trans, colour = file)) +\n  geom_histogram(binwidth = 0.01, position = \"identity\", fill = \"white\") +\n  scale_colour_manual(values = my_colours) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot6.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nggplot(tflow, aes(x = trans, colour = file)) +\n  geom_histogram(binwidth = 0.02, position = \"identity\", fill = \"white\") +\n  scale_colour_manual(values = my_colours) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot7.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nBy varying the binwidth (bearing in mind that this is in transformed units), we can get closer to the look of the original plot. Using\nposition = \"identity\"\nmeans we lose the default “stacked histogram” behaviour and the counts are close to the original which tells us that the binwidth is refined. The axis is still borked, but we’ll fix that later.\nWe need to get rid of the borders of each bin in the histogram, but we need the line on the top. We can achieve this effect by using\ngeom_step\nwhich gives a cityscape plot, and combine that with\ngeom_histogram\nto do the fill only.\n# try to lose the histogram look\nggplot(tflow, aes(x = trans, colour = file, fill = file)) +\n  geom_histogram(binwidth = 0.02, position = \"identity\", colour = NA, alpha = 0.3) +\n  scale_fill_manual(values = my_colours) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot8.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nggplot(tflow, aes(x = trans, colour = file, fill = file)) +\n  geom_step(stat = \"bin\", binwidth = 0.02, direction = \"mid\") +\n  geom_histogram(binwidth = 0.02, position = \"identity\", colour = NA, alpha = 0.3) +\n  scale_fill_manual(values = my_colours) +\n  scale_colour_manual(values = my_colours) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot9.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nThis is close… but it’s still got the “blocky” look to it. So this is the end of the line for this approach. We need to change tack.\nBy looking at the tidyverse manual for geom_step “\nconnecting observations\n“, I can see that geom_line is part of the same family. So let’s do this:\n# use geom_line \nggplot(tflow, aes(x = trans, colour = file, fill = file)) +\n  geom_line(stat = \"bin\", binwidth = 0.02, direction = \"mid\") +\n  geom_histogram(binwidth = 0.02, position = \"identity\", colour = NA, alpha = 0.3) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  scale_colour_manual(values = my_colours) +\n  scale_fill_manual(values = my_colours) +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot10.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\n# use geom_area\nggplot(tflow, aes(x = trans, colour = file, fill = file)) +\n  geom_line(stat = \"bin\", binwidth = 0.02, direction = \"mid\") +\n  geom_area(stat = \"bin\", binwidth = 0.02, position = \"identity\", colour = NA, alpha = 0.3) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  scale_colour_manual(values = my_colours) +\n  scale_fill_manual(values = my_colours) +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot11.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\n# tweak binwidth to match original\nggplot(tflow, aes(x = trans, colour = file, fill = file)) +\n  geom_line(stat = \"bin\", binwidth = 0.018, direction = \"mid\") +\n  geom_area(stat = \"bin\", binwidth = 0.018, position = \"identity\", colour = NA, alpha = 0.3) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  scale_colour_manual(values = my_colours) +\n  scale_fill_manual(values = my_colours) +\n  theme_cowplot(9)\nggsave(\"Output/Plots/plot12.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\n# now fix the axis\nggplot(tflow, aes(x = trans, colour = file, fill = file)) +\n  geom_line(stat = \"bin\", binwidth = 0.018, direction = \"mid\") +\n  geom_area(stat = \"bin\", binwidth = 0.018, position = \"identity\", colour = NA, alpha = 0.3) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  scale_x_continuous(limits = c(0.6,5), labels = scales::label_math(10^.x)) +\n  scale_colour_manual(values = my_colours) +\n  scale_fill_manual(values = my_colours) +\n  theme_cowplot(9) +\n  annotation_logticks(sides = \"b\")\nggsave(\"Output/Plots/plot13.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nReplacing\ngeom_step\nwith\ngeom_line\nworked right away. Replacing\ngeom_histogram\nwith\ngeom_area\nmeans we get the nice fill effect and finally get rid of the blocky look. We also tweaked the binwidth to match the original and finally fixed the axis.\nTo make it more presentable, we’ll change the colours (since they didn’t make much sense in the original plot). We’ll move the legend inside the plot just to make scaling the final thing easier to insert to into the figure.\n# the original colours weren't great, so\nmy_colours <- c(\"#00a651\", \"#3f3f3f\", \"#2276b9\")\n# plot the log transformed data as a histogram with binwidth of 0.018\nggplot(tflow, aes(x = trans, colour = file, fill = file)) +\n  geom_line(stat = \"bin\", binwidth = 0.018, direction = \"mid\") +\n  geom_area(stat = \"bin\", binwidth = 0.018, position = \"identity\", colour = NA, alpha = 0.3) +\n  # geom_histogram(binwidth = 0.018, position = \"identity\", colour = NA, alpha = 0.3) +\n  labs(x = \"B488-530_30-A\", y = \"Count\") +\n  scale_x_continuous(limits = c(0.6,5), labels = scales::label_math(10^.x)) +\n  scale_colour_manual(values = my_colours) +\n  scale_fill_manual(values = my_colours) +\n  theme_cowplot(9) +\n  # place legend inside the plot, top left\n  theme(legend.position = c(0.1, 0.9),\n        legend.background = element_rect(fill = \"transparent\"),\n        legend.key = element_rect(fill = \"transparent\", colour = \"transparent\")) +\n  annotation_logticks(sides = \"b\")\n# save the plot\nggsave(\"Output/Plots/plot14.png\", width = 8, height = 4, dpi = 300, bg = \"white\")\nFrom here we can export at the correct size and slot it into the figure.\nggsave(\"Output/Plots/plot15.png\", last_plot() + theme(legend.position = \"none\"), width = 58, height = 58, dpi = 300, bg = \"white\", units = \"mm\")\nFinally, if you remember, the journal wanted the numerical data. We can save it like this:\n## Export results ----\n# if Output/Data directory does not exist, create it\nif (!dir.exists(\"Output/Data\")) {\n  dir.create(\"Output/Data\", recursive = TRUE)\n}\n# extract Protein and IntDen columns to a new dataframe and save as csv\nresults <- tflow %>%\n  select(file, `B488-530/30-A`, trans) %>%\n  mutate(file = gsub(\".fcs\", \"\", file)) %>%\n  mutate(file = gsub(\"Specimen_001_\", \"\", file))\n\nwrite.csv(results, \"Output/Data/S2B.csv\", row.names = FALSE)\nHow did we do?\nAt the risk of “marking my own homework”, let’s see how we did.\nWe verified the raw data-to-plot pipeline and produced the numerical data required by the journal\nWe produced a plot which is in the same style as the original:\nThe y-axis scale and the shape of the lines is similar\nWe achieved the same look with geom_line and geom_area\nx-axis scaling is correct\nThe goal was not to reproduce the plot exactly:\nWe improved the colour scheme\nThe x-axis ticks are facing the wrong way (I believe this is because external ticks are clipped by\n{cowplot}\n)\nNo y-axis minor ticks\nNo box or mirrored axes\nLegend will need modifying later in the figure\n—\nThe post title comes from “Let It Flow” by Spiritualized, taken from their Pure Phase album.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nRstats – quantixed\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "It’s plot recreation time! In this post, we’ll look at how we can recreate a plot in R. I thought it might be useful to provide the solution but also to detail the process I went through to get there. We have a FACS plot taken from a BD FACS Aria machine: Briefly, it’s a […]",
    "meta_keywords": null,
    "og_description": "It’s plot recreation time! In this post, we’ll look at how we can recreate a plot in R. I thought it might be useful to provide the solution but also to detail the process I went through to get there. We have a FACS plot taken from a BD FACS Aria machine: Briefly, it’s a […]",
    "og_image": "https://quantixed.org/wp-content/uploads/2025/06/FigS2.jpg",
    "og_title": "Let It Flow: recreating a FACS plot with ggplot | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 10.6,
    "sitemap_lastmod": null,
    "twitter_description": "It’s plot recreation time! In this post, we’ll look at how we can recreate a plot in R. I thought it might be useful to provide the solution but also to detail the process I went through to get there. We have a FACS plot taken from a BD FACS Aria machine: Briefly, it’s a […]",
    "twitter_title": "Let It Flow: recreating a FACS plot with ggplot | R-bloggers",
    "url": "https://www.r-bloggers.com/2025/06/let-it-flow-recreating-a-facs-plot-with-ggplot/",
    "word_count": 2111
  }
}