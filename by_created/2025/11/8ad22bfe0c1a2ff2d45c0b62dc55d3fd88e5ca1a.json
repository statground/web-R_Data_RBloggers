{
  "id": "8ad22bfe0c1a2ff2d45c0b62dc55d3fd88e5ca1a",
  "url": "https://www.r-bloggers.com/2023/11/r-solution-for-excel-puzzles/",
  "created_at_utc": "2025-11-17T20:39:07Z",
  "data": null,
  "raw_original": {
    "uuid": "5b52bcb2-e013-4fa8-b758-6cf6ebd01570",
    "created_at": "2025-11-17 20:39:07",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2023/11/r-solution-for-excel-puzzles/",
      "crawled_at": "2025-11-17T09:48:25.030380",
      "external_links": [
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-decfde490393",
          "text": "Numbers around us - Medium"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://www.linkedin.com/in/excelbi/",
          "text": "ExcelBI"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7132216012732547074-AGXT?utm_source=share&utm_medium=member_desktop",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/dQWFGfQQ",
          "text": "file"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7132578392989708289-DFO0?utm_source=share&utm_medium=member_desktop",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/dZdTce8m",
          "text": "file"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7132940771883646976-FwVh?utm_source=share&utm_medium=member_desktop",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/dC7zpzK3",
          "text": "file"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7133303162521759745-kTaj?utm_source=share&utm_medium=member_desktop",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/dJxm5yJv",
          "text": "file"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7133665545949691904-hSDb?utm_source=share&utm_medium=member_desktop",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/ddw7fh5s",
          "text": "file"
        },
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-decfde490393",
          "text": "R Solution for Excel Puzzles"
        },
        {
          "href": "https://medium.com/number-around-us",
          "text": "Numbers around us"
        },
        {
          "href": "https://medium.com/number-around-us/r-solution-for-excel-puzzles-decfde490393",
          "text": "Numbers around us - Medium"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "R Solution for Excel Puzzles | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*Kb3wyb7EoD8TUQNvMEN91A.jpeg?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*o3n_Yz39LSvvUJvR63gfqQ.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*gVbxJVSl0x9-zYlgYF3PAQ.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*938kzuMkSG2xYKUK78EoLA.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*NrUTcxQ8vpeOWU6yN58P_g.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*oNgP5twyVns8X_i7tyDqCA.jpeg?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": "data:application/octet-stream;base64,R0lGODlhAQABAO+/vQAA77+977+977+9AAAAIe+/vQQBAAAAACwAAAAAAQABAAACAkQBADs=",
          "src": "https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=decfde490393"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/numbers-around-us/",
          "text": "Numbers around us"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-380342 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">R Solution for Excel Puzzles</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">November 27, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/numbers-around-us/\">Numbers around us</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-decfde490393\"> Numbers around us - Medium</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><p>Week 47 — Puzzles no. 329–333</p><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*Kb3wyb7EoD8TUQNvMEN91A.jpeg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*Kb3wyb7EoD8TUQNvMEN91A.jpeg?w=578&amp;ssl=1\"/></noscript></figure><h4>Puzzles</h4><p>Author: <a href=\"https://www.linkedin.com/in/excelbi/\" rel=\"nofollow\" target=\"_blank\">ExcelBI</a></p><p>Puzzles:<br/># 329: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7132216012732547074-AGXT?utm_source=share&amp;utm_medium=member_desktop\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dQWFGfQQ\" rel=\"nofollow\" target=\"_blank\">file</a><br/># 330: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7132578392989708289-DFO0?utm_source=share&amp;utm_medium=member_desktop\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dZdTce8m\" rel=\"nofollow\" target=\"_blank\">file</a><br/># 331: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7132940771883646976-FwVh?utm_source=share&amp;utm_medium=member_desktop\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dC7zpzK3\" rel=\"nofollow\" target=\"_blank\">file</a><br/># 332: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7133303162521759745-kTaj?utm_source=share&amp;utm_medium=member_desktop\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dJxm5yJv\" rel=\"nofollow\" target=\"_blank\">file</a><br/># 333: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7133665545949691904-hSDb?utm_source=share&amp;utm_medium=member_desktop\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/ddw7fh5s\" rel=\"nofollow\" target=\"_blank\">file</a></p><p>Lets dive into solutions!</p><h3>Puzzle 329</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*o3n_Yz39LSvvUJvR63gfqQ.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*o3n_Yz39LSvvUJvR63gfqQ.png?w=578&amp;ssl=1\"/></noscript></figure><p>In this puzzle we were asked to generate first 50 elements of Iccanobif sequence. Wait what? It is Fibonacci backwords… and that is exactly our goal to generate Fibonacci like sequence with one constraint: next element is a sum of previous two but with digits in reversed order.<br/>As it looks hard, it really isn’t. And this solution is so short in base R, that translating it to another syntax would be just over complicating.</p><h4>Loading data and libraries</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(stringi)\n\ntest = read_excel(\"Iccanobif Numbers.xlsx\", range = \"A2:A51\", col_names = FALSE) %&gt;% pull()</pre><h4>Approach: Base R</h4><pre>reverse_digits &lt;- function(n) {\n  as.numeric(stri_reverse(as.character(n)))\n}\n\ngenerate_iccanobif &lt;- function(N) {\n  iccanobif &lt;- c(0, 1)\n  for (i in 3:N) {\n    next_term &lt;- reverse_digits(iccanobif[i - 1]) + reverse_digits(iccanobif[i - 2])\n    iccanobif &lt;- c(iccanobif, next_term)\n  }\n  iccanobif\n}\n\niccanobif_50 &lt;- generate_iccanobif(50)</pre><h4>Validation</h4><pre>identical(iccanobif_50, test)\n#&gt; [1] TRUE</pre><h3>Puzzle 330</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*gVbxJVSl0x9-zYlgYF3PAQ.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*gVbxJVSl0x9-zYlgYF3PAQ.png?w=578&amp;ssl=1\"/></noscript></figure><p>In puzzle #330 we have sentences in table and our goal is to return matrix populated rowwise containing only words that were longer than average word in original sentence.</p><h4>Load data and libraries</h4><pre>library(tidyverse)\nlibrary(tidytext)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Average Word Length.xlsx\", range= \"A1:A10\")\ntest = read_excel(\"Average Word Length.xlsx\", range = \"B2:D5\", col_names = F)\ncolnames(test) = c(\"1\", \"2\", \"3\")</pre><h4>Approach 1: tidyverse</h4><pre>result = input %&gt;%\n  mutate(number = row_number()) %&gt;%\n  unnest_tokens(word, Books) %&gt;%\n  group_by(number) %&gt;%\n  mutate(word_len = nchar(word)) %&gt;%\n  reframe(number, word, word_len, avg_len = mean(word_len)) %&gt;%\n  ungroup() %&gt;%\n  filter(word_len &gt; avg_len) %&gt;% \n  select(word) %&gt;%\n  mutate(group = rep(1:4, each = 3)) %&gt;%\n  group_by(group) %&gt;%\n  mutate(row = row_number()) %&gt;%\n  pivot_wider(names_from = row, values_from = word) %&gt;%\n  ungroup() %&gt;%\n  select(-group) %&gt;%\n  mutate(across(everything(), ~ str_to_title(.x)))</pre><h4>Approach 2: data.table</h4><pre>input_dt &lt;- setDT(copy(input))\n\ninput_dt[, number := .I]\ninput_dt_long &lt;- input_dt[, .(word = unlist(strsplit(Books, \" \"))), by = number]\ninput_dt_long[, word_len := nchar(word)]\ninput_dt_long[, avg_len := mean(word_len), by = number]\n\ninput_dt_filtered &lt;- input_dt_long[word_len &gt; avg_len, .(word, number)]\ninput_dt_filtered[, group := rep(1:4, each = 3, length.out = .N)]\ninput_dt_filtered[, row := rep(1:3, times = 4, length.out = .N)]\nwider_dt &lt;- dcast(input_dt_filtered, group ~ row, value.var = \"word\")\nsetnames(wider_dt, old = names(wider_dt), new = c(\"group\", \"1\", \"2\", \"3\"))\n\nwider_dt[, group := NULL]</pre><h4>Approach 3: base R</h4><pre>input_base &lt;- input\ninput_base$number = seq_along(input_base$Books)\nwords_list_base = strsplit(input_base$Books, \" \")\nwords_df_base = setNames(data.frame(do.call(rbind, lapply(words_list_base, function(x) data.frame(word = x))), row.names = NULL), c(\"word\"))\nwords_df_base$number = rep(input_base$number, sapply(words_list_base, length))\nwords_df_base$word_len = nchar(as.character(words_df_base$word))\nwords_df_base$avg_len = ave(words_df_base$word_len, words_df_base$number, FUN = mean)\nfiltered_df_base = subset(words_df_base, word_len &gt; avg_len, select = c(\"word\", \"number\"))\nfiltered_df_base$group = rep(1:4, each = 3, length.out = nrow(filtered_df_base))\nmat = matrix(filtered_df_base$word, nrow = 4, ncol = 3, byrow = TRUE)\nwider_df_base = as_tibble(as.data.frame(mat))\ncolnames(wider_df_base) = c(\"1\", \"2\", \"3\")\nwider_df_base[] = lapply(wider_df_base, function(x) if(is.character(x)) tools::toTitleCase(x) else x)</pre><h4>Validation</h4><pre>identical(test, result)\n#&gt; [1] TRUE\n\nidentical(test, wider_dt)\n#&gt; [1] TRUE\n\nidentical(test, wider_df_base)\n#&gt; [1] TRUE</pre><h3>Puzzle 331</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*938kzuMkSG2xYKUK78EoLA.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*938kzuMkSG2xYKUK78EoLA.png?w=578&amp;ssl=1\"/></noscript></figure><p>In this puzzle we were asked to find which of given numbers can be represented as sum of two cubes.</p><h4>Load data and libraries</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Sum of Cube of Two Numbers.xlsx\", range = \"A1:A10\")\ntest = read_excel(\"Sum of Cube of Two Numbers.xlsx\", \n                  range = \"B2:D6\", \n                  col_names = c(\"Number\", \"Factor1\", \"Factor2\"))</pre><h4>Approach 1: tidyverse</h4><pre>check_if_sum_of_cubes = function(number) {\n  x = floor(number^(1/3))\n  \n  range = data.frame(Number = number, Factor1 = 1:x) %&gt;%\n    mutate(diff = number - Factor1^3, \n           is_cube = round(diff^(1/3))^3 == diff) %&gt;%\n    filter(is_cube) %&gt;%\n    mutate(Factor2 = diff^(1/3)) %&gt;%\n    slice(1) %&gt;%\n    select(Number, Factor1, Factor2) \n  return(range)\n}\n\nresult = map_dfr(input$Number, check_if_sum_of_cubes) %&gt;% as_tibble()</pre><h4>Approach 2: data.table</h4><pre>check_if_sum_of_cubes_dt &lt;- function(number) {\n  x &lt;- floor(number^(1/3))\n  \n  DT &lt;- CJ(Factor1 = 1:x, Number = number)\n  DT[, `:=`(diff = Number - Factor1^3)]\n  DT[, `:=`(is_cube = round((diff)^(1/3))^3 == diff,\n            Factor2 = (diff)^(1/3))]\n  \n  result &lt;- DT[is_cube == TRUE, .(Number, Factor1, Factor2)]\n  result &lt;- result[order(Factor1)][1]\n  \n  return(result)\n}\n\ninput_numbers_dt &lt;- as.vector(input$Number)\nresult_dt &lt;- rbindlist(lapply(input_numbers_dt, check_if_sum_of_cubes_dt))\nresult_dt &lt;- as.data.frame(result_dt) %&gt;% drop_na()</pre><h4>Approach 3: base R</h4><pre>check_if_sum_of_cubes_base &lt;- function(number) {\n  x &lt;- floor(number^(1/3))\n  \n  df &lt;- expand.grid(Factor1 = 1:x, Number = number)\n  df$diff &lt;- df$Number - df$Factor1^3\n  df$is_cube &lt;- round(df$diff^(1/3))^3 == df$diff\n  df$Factor2 &lt;- df$diff^(1/3)\n  \n  result &lt;- df[df$is_cube, ]\n  result &lt;- result[order(result$Factor1), ]\n  result &lt;- result[1, c(\"Number\", \"Factor1\", \"Factor2\")]\n  \n  return(result)\n}\n\ninput_numbers &lt;- as.vector(input$Number)\nresult_base &lt;- do.call(\"rbind\", lapply(input_numbers, check_if_sum_of_cubes_base))\nresult_base &lt;- as.data.frame(result_base) %&gt;% drop_na()</pre><h4>Validation</h4><p>Sometimes aligning all structures to be identical generate to much code. Then I we can also check it visually.</p><pre>&gt; test\n# A tibble: 5 × 3\n    Number Factor1 Factor2\n     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n1       35     2         3\n2      855     7         8\n3     3744    10        14\n4   300827     4        67\n5 90000576    44.0     448\n\n&gt; result\n# A tibble: 5 × 3\n    Number Factor1 Factor2\n     &lt;dbl&gt;   &lt;int&gt;   &lt;dbl&gt;\n1       35       2       3\n2      855       7       8\n3     3744      10      14\n4   300827       4      67\n5 90000576      44     448\n\n&gt; result_base\n     Number Factor1 Factor2\n2        35       2       3\n7       855       7       8\n10     3744      10      14\n4    300827       4      67\n44 90000576      44     448\n\n&gt; result_dt\n    Number Factor1 Factor2\n1       35       2       3\n2      855       7       8\n3     3744      10      14\n4   300827       4      67\n5 90000576      44     448</pre><h3>Puzzle 332</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*NrUTcxQ8vpeOWU6yN58P_g.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*NrUTcxQ8vpeOWU6yN58P_g.png?w=578&amp;ssl=1\"/></noscript></figure><p>One of the shortest solutions which I solved so far, but it is linked to the fact that there were new functions introduced in MS Excel. We had to find maximal and minimal value per group.</p><h4>Load data and libraries</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Max Min.xlsx\", range = \"A1:B20\")\ntest = read_excel(\"Max Min.xlsx\", range = \"D2:F6\")</pre><h4>Approach 1: tidyverse</h4><pre>result = input %&gt;%\n  group_by(Zone) %&gt;%\n  summarise(Max = max(Sales), Min = min(Sales)) </pre><h4>Approach 2: data.table</h4><pre>input_dt = setDT(input)\n\nresult_dt = input_dt[, .(Max = max(Sales), Min = min(Sales)), by = Zone][order(Zone)]\nresult_dt = as_tibble(result_dt)</pre><h4>Approach 3: base R</h4><pre>result_base &lt;- do.call(data.frame, aggregate(Sales ~ Zone, data = input, FUN = function(x) c(Max = max(x), Min = min(x))))\nnames(result_base) &lt;- c(\"Zone\",\"Max\", \"Min\")</pre><h4>Validation</h4><pre>identical(test, result)\n#&gt; [1] TRUE\n\nidentical(test, result_dt)\n#&gt; [1] TRUE\n\nidentical(test, as_tibble(result_base))\n#&gt; [1] TRUE</pre><h3>Puzzle 333</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*oNgP5twyVns8X_i7tyDqCA.jpeg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*oNgP5twyVns8X_i7tyDqCA.jpeg?w=578&amp;ssl=1\"/></noscript></figure><p>As we all know words consists of letters, and in many words letters repeat itself. And that is the topic in this puzzle. We have words and we need to cut them… before second occurence of first repeating letter (bull becomes bul, excel becomes exc and so on).</p><h4>Load data and libraries</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Extract String Before a Repeated Character.xlsx\", range = \"A1:A10\")\ntest = read_excel(\"Extract String Before a Repeated Character.xlsx\", range = \"B1:B10\")</pre><h4>Approach 1: tidyverse</h4><pre>result = input %&gt;%\n  mutate(lett = str_split(str_to_lower(String), pattern = \"\"),\n         reps = map(lett, ~ duplicated(.x)),\n         first_reps = map_int(reps, ~ which(.x)[1]),\n         `Answer Expected` = ifelse(!is.na(first_reps), \n                                    str_sub(String, 1, first_reps-1), \n                                    String)) %&gt;%\n  select(`Answer Expected`)</pre><h4>Approach 2: data.table</h4><pre>input_dt &lt;- as.data.table(input)\n\ninput_dt[, lett := strsplit(tolower(String), \"\")]\n\ninput_dt[, reps := lapply(lett, function(x) duplicated(x))]\ninput_dt[, first_reps := sapply(reps, function(x) { pos &lt;- which(x)[1]; if (length(pos) &gt; 0) pos else NA })]\ninput_dt[, `Answer Expected` := ifelse(!is.na(first_reps), substr(String, 1, first_reps - 1), String)]\n\nresult_dt &lt;- input_dt$`Answer Expected`</pre><h4>Approach 3: base R</h4><pre>input_b &lt;- input\ninput_b$lett &lt;- strsplit(tolower(input_b$String), \"\")\ninput_b$reps &lt;- lapply(input_b$lett, function(x) duplicated(x))\ninput_b$first_reps &lt;- sapply(input_b$reps, function(x) { pos &lt;- which(x)[1]; if (length(pos) &gt; 0) pos else NA })\ninput_b$`Answer Expected` &lt;- ifelse(!is.na(input_b$first_reps), substr(input_b$String, 1, input_b$first_reps - 1), input_b$String)\nresult_b &lt;- input_b$`Answer Expected`</pre><h4>Validation</h4><pre>identical(result, test)\n#&gt; [1] TRUE\n\nidentical(result_dt, test$`Answer Expected`)\n#&gt; [1] TRUE\n\nidentical(result_b, test$`Answer Expected`)\n#&gt; [1] TRUE</pre><h3>Conclussion</h3><p>Feel free to comment, share and contact me with advices, questions and your ideas how to improve anything.</p><img alt=\"\" data-lazy-src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=decfde490393\" height=\"1\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"1\"/><noscript><img alt=\"\" height=\"1\" loading=\"lazy\" src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=decfde490393\" width=\"1\"/></noscript><hr/><p><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-decfde490393\" rel=\"nofollow\" target=\"_blank\">R Solution for Excel Puzzles</a> was originally published in <a href=\"https://medium.com/number-around-us\" rel=\"nofollow\" target=\"_blank\">Numbers around us</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://medium.com/number-around-us/r-solution-for-excel-puzzles-decfde490393\"> Numbers around us - Medium</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
      "main_text": "R Solution for Excel Puzzles\nPosted on\nNovember 27, 2023\nby\nNumbers around us\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nNumbers around us - Medium\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nWeek 47 — Puzzles no. 329–333\nPuzzles\nAuthor:\nExcelBI\nPuzzles:\n# 329:\ncontent\nfile\n# 330:\ncontent\nfile\n# 331:\ncontent\nfile\n# 332:\ncontent\nfile\n# 333:\ncontent\nfile\nLets dive into solutions!\nPuzzle 329\nIn this puzzle we were asked to generate first 50 elements of Iccanobif sequence. Wait what? It is Fibonacci backwords… and that is exactly our goal to generate Fibonacci like sequence with one constraint: next element is a sum of previous two but with digits in reversed order.\nAs it looks hard, it really isn’t. And this solution is so short in base R, that translating it to another syntax would be just over complicating.\nLoading data and libraries\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(stringi)\n\ntest = read_excel(\"Iccanobif Numbers.xlsx\", range = \"A2:A51\", col_names = FALSE) %>% pull()\nApproach: Base R\nreverse_digits <- function(n) {\n  as.numeric(stri_reverse(as.character(n)))\n}\n\ngenerate_iccanobif <- function(N) {\n  iccanobif <- c(0, 1)\n  for (i in 3:N) {\n    next_term <- reverse_digits(iccanobif[i - 1]) + reverse_digits(iccanobif[i - 2])\n    iccanobif <- c(iccanobif, next_term)\n  }\n  iccanobif\n}\n\niccanobif_50 <- generate_iccanobif(50)\nValidation\nidentical(iccanobif_50, test)\n#> [1] TRUE\nPuzzle 330\nIn puzzle #330 we have sentences in table and our goal is to return matrix populated rowwise containing only words that were longer than average word in original sentence.\nLoad data and libraries\nlibrary(tidyverse)\nlibrary(tidytext)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Average Word Length.xlsx\", range= \"A1:A10\")\ntest = read_excel(\"Average Word Length.xlsx\", range = \"B2:D5\", col_names = F)\ncolnames(test) = c(\"1\", \"2\", \"3\")\nApproach 1: tidyverse\nresult = input %>%\n  mutate(number = row_number()) %>%\n  unnest_tokens(word, Books) %>%\n  group_by(number) %>%\n  mutate(word_len = nchar(word)) %>%\n  reframe(number, word, word_len, avg_len = mean(word_len)) %>%\n  ungroup() %>%\n  filter(word_len > avg_len) %>% \n  select(word) %>%\n  mutate(group = rep(1:4, each = 3)) %>%\n  group_by(group) %>%\n  mutate(row = row_number()) %>%\n  pivot_wider(names_from = row, values_from = word) %>%\n  ungroup() %>%\n  select(-group) %>%\n  mutate(across(everything(), ~ str_to_title(.x)))\nApproach 2: data.table\ninput_dt <- setDT(copy(input))\n\ninput_dt[, number := .I]\ninput_dt_long <- input_dt[, .(word = unlist(strsplit(Books, \" \"))), by = number]\ninput_dt_long[, word_len := nchar(word)]\ninput_dt_long[, avg_len := mean(word_len), by = number]\n\ninput_dt_filtered <- input_dt_long[word_len > avg_len, .(word, number)]\ninput_dt_filtered[, group := rep(1:4, each = 3, length.out = .N)]\ninput_dt_filtered[, row := rep(1:3, times = 4, length.out = .N)]\nwider_dt <- dcast(input_dt_filtered, group ~ row, value.var = \"word\")\nsetnames(wider_dt, old = names(wider_dt), new = c(\"group\", \"1\", \"2\", \"3\"))\n\nwider_dt[, group := NULL]\nApproach 3: base R\ninput_base <- input\ninput_base$number = seq_along(input_base$Books)\nwords_list_base = strsplit(input_base$Books, \" \")\nwords_df_base = setNames(data.frame(do.call(rbind, lapply(words_list_base, function(x) data.frame(word = x))), row.names = NULL), c(\"word\"))\nwords_df_base$number = rep(input_base$number, sapply(words_list_base, length))\nwords_df_base$word_len = nchar(as.character(words_df_base$word))\nwords_df_base$avg_len = ave(words_df_base$word_len, words_df_base$number, FUN = mean)\nfiltered_df_base = subset(words_df_base, word_len > avg_len, select = c(\"word\", \"number\"))\nfiltered_df_base$group = rep(1:4, each = 3, length.out = nrow(filtered_df_base))\nmat = matrix(filtered_df_base$word, nrow = 4, ncol = 3, byrow = TRUE)\nwider_df_base = as_tibble(as.data.frame(mat))\ncolnames(wider_df_base) = c(\"1\", \"2\", \"3\")\nwider_df_base[] = lapply(wider_df_base, function(x) if(is.character(x)) tools::toTitleCase(x) else x)\nValidation\nidentical(test, result)\n#> [1] TRUE\n\nidentical(test, wider_dt)\n#> [1] TRUE\n\nidentical(test, wider_df_base)\n#> [1] TRUE\nPuzzle 331\nIn this puzzle we were asked to find which of given numbers can be represented as sum of two cubes.\nLoad data and libraries\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Sum of Cube of Two Numbers.xlsx\", range = \"A1:A10\")\ntest = read_excel(\"Sum of Cube of Two Numbers.xlsx\", \n                  range = \"B2:D6\", \n                  col_names = c(\"Number\", \"Factor1\", \"Factor2\"))\nApproach 1: tidyverse\ncheck_if_sum_of_cubes = function(number) {\n  x = floor(number^(1/3))\n  \n  range = data.frame(Number = number, Factor1 = 1:x) %>%\n    mutate(diff = number - Factor1^3, \n           is_cube = round(diff^(1/3))^3 == diff) %>%\n    filter(is_cube) %>%\n    mutate(Factor2 = diff^(1/3)) %>%\n    slice(1) %>%\n    select(Number, Factor1, Factor2) \n  return(range)\n}\n\nresult = map_dfr(input$Number, check_if_sum_of_cubes) %>% as_tibble()\nApproach 2: data.table\ncheck_if_sum_of_cubes_dt <- function(number) {\n  x <- floor(number^(1/3))\n  \n  DT <- CJ(Factor1 = 1:x, Number = number)\n  DT[, `:=`(diff = Number - Factor1^3)]\n  DT[, `:=`(is_cube = round((diff)^(1/3))^3 == diff,\n            Factor2 = (diff)^(1/3))]\n  \n  result <- DT[is_cube == TRUE, .(Number, Factor1, Factor2)]\n  result <- result[order(Factor1)][1]\n  \n  return(result)\n}\n\ninput_numbers_dt <- as.vector(input$Number)\nresult_dt <- rbindlist(lapply(input_numbers_dt, check_if_sum_of_cubes_dt))\nresult_dt <- as.data.frame(result_dt) %>% drop_na()\nApproach 3: base R\ncheck_if_sum_of_cubes_base <- function(number) {\n  x <- floor(number^(1/3))\n  \n  df <- expand.grid(Factor1 = 1:x, Number = number)\n  df$diff <- df$Number - df$Factor1^3\n  df$is_cube <- round(df$diff^(1/3))^3 == df$diff\n  df$Factor2 <- df$diff^(1/3)\n  \n  result <- df[df$is_cube, ]\n  result <- result[order(result$Factor1), ]\n  result <- result[1, c(\"Number\", \"Factor1\", \"Factor2\")]\n  \n  return(result)\n}\n\ninput_numbers <- as.vector(input$Number)\nresult_base <- do.call(\"rbind\", lapply(input_numbers, check_if_sum_of_cubes_base))\nresult_base <- as.data.frame(result_base) %>% drop_na()\nValidation\nSometimes aligning all structures to be identical generate to much code. Then I we can also check it visually.\n> test\n# A tibble: 5 × 3\n    Number Factor1 Factor2\n     <dbl>   <dbl>   <dbl>\n1       35     2         3\n2      855     7         8\n3     3744    10        14\n4   300827     4        67\n5 90000576    44.0     448\n\n> result\n# A tibble: 5 × 3\n    Number Factor1 Factor2\n     <dbl>   <int>   <dbl>\n1       35       2       3\n2      855       7       8\n3     3744      10      14\n4   300827       4      67\n5 90000576      44     448\n\n> result_base\n     Number Factor1 Factor2\n2        35       2       3\n7       855       7       8\n10     3744      10      14\n4    300827       4      67\n44 90000576      44     448\n\n> result_dt\n    Number Factor1 Factor2\n1       35       2       3\n2      855       7       8\n3     3744      10      14\n4   300827       4      67\n5 90000576      44     448\nPuzzle 332\nOne of the shortest solutions which I solved so far, but it is linked to the fact that there were new functions introduced in MS Excel. We had to find maximal and minimal value per group.\nLoad data and libraries\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Max Min.xlsx\", range = \"A1:B20\")\ntest = read_excel(\"Max Min.xlsx\", range = \"D2:F6\")\nApproach 1: tidyverse\nresult = input %>%\n  group_by(Zone) %>%\n  summarise(Max = max(Sales), Min = min(Sales))\nApproach 2: data.table\ninput_dt = setDT(input)\n\nresult_dt = input_dt[, .(Max = max(Sales), Min = min(Sales)), by = Zone][order(Zone)]\nresult_dt = as_tibble(result_dt)\nApproach 3: base R\nresult_base <- do.call(data.frame, aggregate(Sales ~ Zone, data = input, FUN = function(x) c(Max = max(x), Min = min(x))))\nnames(result_base) <- c(\"Zone\",\"Max\", \"Min\")\nValidation\nidentical(test, result)\n#> [1] TRUE\n\nidentical(test, result_dt)\n#> [1] TRUE\n\nidentical(test, as_tibble(result_base))\n#> [1] TRUE\nPuzzle 333\nAs we all know words consists of letters, and in many words letters repeat itself. And that is the topic in this puzzle. We have words and we need to cut them… before second occurence of first repeating letter (bull becomes bul, excel becomes exc and so on).\nLoad data and libraries\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Extract String Before a Repeated Character.xlsx\", range = \"A1:A10\")\ntest = read_excel(\"Extract String Before a Repeated Character.xlsx\", range = \"B1:B10\")\nApproach 1: tidyverse\nresult = input %>%\n  mutate(lett = str_split(str_to_lower(String), pattern = \"\"),\n         reps = map(lett, ~ duplicated(.x)),\n         first_reps = map_int(reps, ~ which(.x)[1]),\n         `Answer Expected` = ifelse(!is.na(first_reps), \n                                    str_sub(String, 1, first_reps-1), \n                                    String)) %>%\n  select(`Answer Expected`)\nApproach 2: data.table\ninput_dt <- as.data.table(input)\n\ninput_dt[, lett := strsplit(tolower(String), \"\")]\n\ninput_dt[, reps := lapply(lett, function(x) duplicated(x))]\ninput_dt[, first_reps := sapply(reps, function(x) { pos <- which(x)[1]; if (length(pos) > 0) pos else NA })]\ninput_dt[, `Answer Expected` := ifelse(!is.na(first_reps), substr(String, 1, first_reps - 1), String)]\n\nresult_dt <- input_dt$`Answer Expected`\nApproach 3: base R\ninput_b <- input\ninput_b$lett <- strsplit(tolower(input_b$String), \"\")\ninput_b$reps <- lapply(input_b$lett, function(x) duplicated(x))\ninput_b$first_reps <- sapply(input_b$reps, function(x) { pos <- which(x)[1]; if (length(pos) > 0) pos else NA })\ninput_b$`Answer Expected` <- ifelse(!is.na(input_b$first_reps), substr(input_b$String, 1, input_b$first_reps - 1), input_b$String)\nresult_b <- input_b$`Answer Expected`\nValidation\nidentical(result, test)\n#> [1] TRUE\n\nidentical(result_dt, test$`Answer Expected`)\n#> [1] TRUE\n\nidentical(result_b, test$`Answer Expected`)\n#> [1] TRUE\nConclussion\nFeel free to comment, share and contact me with advices, questions and your ideas how to improve anything.\nR Solution for Excel Puzzles\nwas originally published in\nNumbers around us\non Medium, where people are continuing the conversation by highlighting and responding to this story.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nNumbers around us - Medium\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Week 47 — Puzzles no. 329–333PuzzlesAuthor: ExcelBIPuzzles:# 329: content file# 330: content file# 331: content file# 332: content file# 333: content fileLets dive into solutions!Puzzle 329In this puzzle we were asked to generate first 50 elements of I...",
      "meta_keywords": null,
      "og_description": "Week 47 — Puzzles no. 329–333PuzzlesAuthor: ExcelBIPuzzles:# 329: content file# 330: content file# 331: content file# 332: content file# 333: content fileLets dive into solutions!Puzzle 329In this puzzle we were asked to generate first 50 elements of I...",
      "og_image": "https://cdn-images-1.medium.com/max/1024/1*Kb3wyb7EoD8TUQNvMEN91A.jpeg",
      "og_title": "R Solution for Excel Puzzles | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 7.5,
      "sitemap_lastmod": "2023-11-27T19:13:44+00:00",
      "twitter_description": "Week 47 — Puzzles no. 329–333PuzzlesAuthor: ExcelBIPuzzles:# 329: content file# 330: content file# 331: content file# 332: content file# 333: content fileLets dive into solutions!Puzzle 329In this puzzle we were asked to generate first 50 elements of I...",
      "twitter_title": "R Solution for Excel Puzzles | R-bloggers",
      "url": "https://www.r-bloggers.com/2023/11/r-solution-for-excel-puzzles/",
      "word_count": 1494
    }
  }
}