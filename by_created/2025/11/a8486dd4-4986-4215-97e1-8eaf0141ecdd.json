{
  "uuid": "a8486dd4-4986-4215-97e1-8eaf0141ecdd",
  "created_at": "2025-11-17 20:39:12",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2023/11/r-solutions-for-excel-puzzles/",
    "crawled_at": "2025-11-17T09:54:26.499147",
    "external_links": [
      {
        "href": "https://medium.com/number-around-us/r-solutions-for-excel-puzzles-5616ca06fa43",
        "text": "Numbers around us - Medium"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://www.linkedin.com/in/excelbi/",
        "text": "ExcelBI"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7128579964114714624-Yxw1?utm_source=share&utm_medium=member_desktop",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dimyJ5fb",
        "text": "file"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7129675458329116673-pV2c?utm_source=share&utm_medium=member_desktop",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dY7UJg5f",
        "text": "file"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7130041654115282945-eMfV?utm_source=share&utm_medium=member_desktop",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dFDFKxKP",
        "text": "file"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7130404074801274880-8MAl?utm_source=share&utm_medium=member_desktop",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dEWMN8Ax",
        "text": "file"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7130766434120458240-oE6W?utm_source=share&utm_medium=member_desktop",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dahRUKwk",
        "text": "file"
      },
      {
        "href": "https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7131152033302151169-65l5?utm_source=share&utm_medium=member_desktop",
        "text": "content"
      },
      {
        "href": "https://lnkd.in/dTmtdhxY",
        "text": "file"
      },
      {
        "href": "https://medium.com/number-around-us/r-solutions-for-excel-puzzles-5616ca06fa43",
        "text": "R Solutions for Excel Puzzles"
      },
      {
        "href": "https://medium.com/number-around-us",
        "text": "Numbers around us"
      },
      {
        "href": "https://medium.com/number-around-us/r-solutions-for-excel-puzzles-5616ca06fa43",
        "text": "Numbers around us - Medium"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "R Solutions for Excel Puzzles | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*fQhRTThOWpWR3RY0h8vlWQ.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*hkVgC2-QE9DlELdWNH-sWw.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*Ew1jn0n-AWcRVO5XCB_QWg.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*HM4cjfjin0FLdFeD-OX5Ng.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*LGUZKnwtJaIcMF2WoSVR6Q.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*koUeUvFpIJdV4B1GJmxK6Q.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*EDsq8FpOBlHtbjqHE9pkVg.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:application/octet-stream;base64,R0lGODlhAQABAO+/vQAA77+977+977+9AAAAIe+/vQQBAAAAACwAAAAAAQABAAACAkQBADs=",
        "src": "https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=5616ca06fa43"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/numbers-around-us/",
        "text": "Numbers around us"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-380177 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">R Solutions for Excel Puzzles</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">November 20, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/numbers-around-us/\">Numbers around us</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://medium.com/number-around-us/r-solutions-for-excel-puzzles-5616ca06fa43\"> Numbers around us - Medium</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><h4>Week 46 — Puzzles no. 323–328</h4><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*fQhRTThOWpWR3RY0h8vlWQ.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*fQhRTThOWpWR3RY0h8vlWQ.png?w=578&amp;ssl=1\"/></noscript></figure><p>First time after few weeks I decided to slightly change my way of publishing this format of content. I used to publish daily, then every 2 or 3 days, but I realized that summary of all puzzles weekly will be my way.</p><p>Host of our puzzles is publishing 7 puzzles a week: 5 for Excel (Mon-Fri) and 2 for Power Query (Sat-Sun). My plan is to show my solutions in two posts according to original tools. Excel puzzle series will contain 5 parts and PQ series — 2 parts. Of course, as I had little break with it today ther will be more puzzles to get on straight path.</p><h3>Puzzles</h3><p>Author: <a href=\"https://www.linkedin.com/in/excelbi/\" rel=\"nofollow\" target=\"_blank\">ExcelBI</a></p><p>Puzzle 323: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7128579964114714624-Yxw1?utm_source=share&amp;utm_medium=member_desktop\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dimyJ5fb\" rel=\"nofollow\" target=\"_blank\">file</a><br/>Puzzle 324: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7129675458329116673-pV2c?utm_source=share&amp;utm_medium=member_desktop\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dY7UJg5f\" rel=\"nofollow\" target=\"_blank\">file</a><br/>Puzzle 325: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7130041654115282945-eMfV?utm_source=share&amp;utm_medium=member_desktop\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dFDFKxKP\" rel=\"nofollow\" target=\"_blank\">file</a><br/>Puzzle 326: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7130404074801274880-8MAl?utm_source=share&amp;utm_medium=member_desktop\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dEWMN8Ax\" rel=\"nofollow\" target=\"_blank\">file</a><br/>Puzzle 327: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7130766434120458240-oE6W?utm_source=share&amp;utm_medium=member_desktop\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dahRUKwk\" rel=\"nofollow\" target=\"_blank\">file</a><br/>Puzzle 328: <a href=\"https://www.linkedin.com/posts/excelbi_excel-excelchallenge-powerquerychallenge-activity-7131152033302151169-65l5?utm_source=share&amp;utm_medium=member_desktop\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dTmtdhxY\" rel=\"nofollow\" target=\"_blank\">file</a></p><p>Lets dive into solutions!</p><h3>Puzzle 323</h3><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*hkVgC2-QE9DlELdWNH-sWw.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*hkVgC2-QE9DlELdWNH-sWw.png?w=578&amp;ssl=1\"/></noscript></figure><p>Goal of puzzle was to find all palindromic substrings in numbers represented like strings.</p><h4>Loading data and libraries:</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(stringi)\n\ninput = read_excel(“Substring Palindromes.xlsx”, range = “A1:A8”)\ntest = read_excel(“Substring Palindromes.xlsx”, range = “B1:B8”)</pre><h4>Approach 1: tidyverse</h4><pre>is_palindrome &lt;- function(s) {\n s == stri_reverse(s)\n} \n\ngenerate_substrings &lt;- function(s) {\n n &lt;- nchar(s)\n positions &lt;- crossing(start = 1:(n-2), end = 3:n) %&gt;%\n filter(end &gt; start, end — start &gt;= 2)\n substrings &lt;- pmap_chr(positions, ~ substr(s, ..1, ..2))\n palindromic_substrings &lt;- substrings[map_lgl(substrings, is_palindrome)]\n palindromic_substrings\n}\n\nresult = input %&gt;%\n rowwise() %&gt;%\n mutate(\n substrings = map(Numbers, generate_substrings),\n final = paste(substrings, collapse = “, “)) %&gt;%\n select(Palindrome = final) %&gt;%\n mutate(Palindrome = if_else(Palindrome == “”, NA, Palindrome)) %&gt;%\n ungroup()</pre><h4>Approach 2: data.table</h4><pre>library(data.table)\n\ninputDT = setDT(input)\n\nis_palindrome &lt;- function(s) {\n s == stringi::stri_reverse(s)\n}\n\ngenerate_substrings_dt &lt;- function(s) {\n n &lt;- nchar(s)\n positions &lt;- CJ(start = 1:(n-2), end = 3:n)[end &gt; start &amp; end — start &gt;= 2]\n substrings &lt;- mapply(function(start, end) substr(s, start, end), positions$start, positions$end)\n palindromic_substrings &lt;- substrings[vapply(substrings, is_palindrome, logical(1))]\n if (length(palindromic_substrings) == 0) {\n return(NA_character_)\n }\n palindromic_substrings\n}\n\nresult_dt &lt;- inputDT[, .(Palindrome = {\n substrings &lt;- lapply(Numbers, generate_substrings)\n final &lt;- sapply(substrings, function(x) paste(x, collapse = “, “))\n if (final == “”) NA_character_ else final\n}), by = 1:nrow(inputDT)]</pre><h4>Approach 3: base R</h4><pre>is_palindrome &lt;- function(s) {\n s == stringi::stri_reverse(s)\n} \n\ngenerate_substrings_base &lt;- function(s) {\n n &lt;- nchar(s)\n substrings &lt;- NULL\n for (start in 1:(n — 2)) {\n for (end in (start + 2):n) {\n substrings &lt;- c(substrings, substr(s, start, end))\n }\n }\n palindromic_substrings &lt;- substrings[sapply(substrings, is_palindrome)]\n palindromic_substrings\n} \n\ngenerate_palindromes_for_row &lt;- function(numbers) {\n substrings &lt;- lapply(numbers, generate_substrings_base)\n final &lt;- sapply(substrings, function(x) paste(x, collapse = “, “))\n if (final == “”) return(NA) else return(final)\n}\n\ninput &lt;- as.data.frame(input) # Ensure ‘input’ is a data frame\ninput$Palindrome &lt;- apply(input, 1, function(row) generate_palindromes_for_row(row[“Numbers”]))</pre><h4>Validation:</h4><pre>identical(test, result)\n#&gt; [1] TRUE\n\nidentical(test$Palindrome, result_dt$Palindrome)\n#&gt; [1] TRUE\n\nidentical(test$Palindrome, input$Palindrome)\n#&gt; [1] TRUE</pre><h3>Puzzle 324</h3><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*Ew1jn0n-AWcRVO5XCB_QWg.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*Ew1jn0n-AWcRVO5XCB_QWg.png?w=578&amp;ssl=1\"/></noscript></figure><p>Goal of this puzzle was to find subjects in two columns (like two classes next to each other) that are in distance of maximum one slot up or down in column.</p><h4>Load data and libraries:</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(“Plus Minus 1 Row.xlsx”, range = “A1:B20”)\ntest = read_excel(“Plus Minus 1 Row.xlsx”, range = “C1:C6”)</pre><h4>Approach 1: tidyverse</h4><pre>r1 = input %&gt;%\n  select(s = 1) %&gt;%\n  mutate(n = row_number()) \n\nr2 = input %&gt;%\n  select(s = 2) %&gt;%\n  mutate(n = row_number())\n\nresult = r1 %&gt;%\n  left_join(r2, by =c(\"s\")) %&gt;%\n  mutate(diff = abs(n.x - n.y)) %&gt;%\n  filter(diff &lt;= 1) %&gt;%\n  select(s)</pre><h4>Approach 2: data.table</h4><pre>inputDT = setDT(input)\nr1_dt &lt;- inputDT[, .(s = .SD[[1]], n1 = .I)]\nr2_dt &lt;- inputDT[, .(s = .SD[[2]], n2 = .I)]\nresult_dt &lt;- r1_dt[r2_dt, on = .(s), nomatch = 0][, diff := abs(n1 - n2)]\nresult_dt &lt;- result_dt[diff &lt;= 1, .(s)]</pre><h4>Approach 3: base R</h4><pre>r1_base &lt;- data.frame(s = input[[1]], n = seq_len(nrow(input)))\nr2_base &lt;- data.frame(s = input[[2]], n = seq_len(nrow(input)))\nresult_base &lt;- merge(r1_base, r2_base, by = \"s\", all.x = TRUE)\nresult_base$diff &lt;- abs(result_base$n.x - result_base$n.y)\nresult_base &lt;- result_base[result_base$diff &lt;= 1, \"s\", drop = FALSE]</pre><h4>Validation:</h4><pre>identical(sort(test$`Answer Expected`), sort(result$s))\n#&gt; [1] TRUE\n\nidentical(sort(test$`Answer Expected`), sort(result_dt$s))\n#&gt; [1] TRUE\n\nidentical(sort(test$`Answer Expected`), sort(result_base$s))\n#&gt; [1] TRUE</pre><h3>Puzzle 325</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*HM4cjfjin0FLdFeD-OX5Ng.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*HM4cjfjin0FLdFeD-OX5Ng.png?w=578&amp;ssl=1\"/></noscript></figure><p>In this puzzle we need to complete given sequence of numbers which like this fence on picture has some spaces and lacks.</p><h4>Read data and libraries:</h4><pre>library(tidyverse)\nlibrary(stringr)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Missing Number in AP_2.xlsx\", range = \"A1:A7\")\ntest = read_excel(\"Missing Number in AP_2.xlsx\", range = \"B1:B7\")</pre><h4>Approach 1: tidyverse</h4><pre>find_missing_numbers &lt;- function(input_string) {\n  elements &lt;- str_split(input_string, \",\\\\s*\")[[1]]\n  numbers &lt;- map(elements, ~ if (str_detect(.x, \"\\\\d+\")) as.numeric(.x) else NA_real_)\n  \n  missing_indices &lt;- which(is.na(numbers))\n  \n  non_missing_indices &lt;- which(!is.na(numbers))\n  if (length(non_missing_indices) &gt;= 2) {\n    first_point &lt;- non_missing_indices[1]\n    last_point &lt;- non_missing_indices[length(non_missing_indices)]\n    common_difference &lt;- (numbers[last_point][[1]] - numbers[first_point][[1]]) / (last_point - first_point)\n  } else {\n    common_difference &lt;- 0\n  }\n  \n  numbers[missing_indices] &lt;- map(missing_indices, ~ numbers[first_point][[1]] + (.x - first_point) * common_difference)\n  missing_numbers_str &lt;- numbers[missing_indices] %&gt;% map_chr(as.character) %&gt;% str_c(collapse = \", \")\n  return(missing_numbers_str)\n}\n\nresult = input %&gt;%\n  mutate(missing_numbers = map_chr(AP, find_missing_numbers)) </pre><h4>Approach 2: base R function</h4><p>As in some previous articles if big part would look similar in base R and data.frame, I would use only one approach. Function is translated to base R, and I will only call her in data.table expression.</p><pre>find_missing_numbers_base &lt;- function(input_string) {\n  elements &lt;- unlist(strsplit(input_string, \",\\\\s*\"))\n  numbers &lt;- sapply(elements, function(x) if (grepl(\"\\\\d+\", x)) as.numeric(x) else NA_real_)\n  \n  missing_indices &lt;- which(is.na(numbers))\n  non_missing_indices &lt;- which(!is.na(numbers))\n  \n  if (length(non_missing_indices) &gt;= 2) {\n    first_point &lt;- non_missing_indices[1]\n    last_point &lt;- non_missing_indices[length(non_missing_indices)]\n    common_difference &lt;- (numbers[last_point] - numbers[first_point]) / (last_point - first_point)\n  } else {\n    common_difference &lt;- 0\n  }\n  \n  numbers[missing_indices] &lt;- sapply(missing_indices, function(i) numbers[first_point] + (i - first_point) * common_difference)\n  missing_numbers_str &lt;- paste(numbers[missing_indices], collapse = \", \")\n  return(missing_numbers_str)\n}\n\ninputDT = setDT(input)\nresultDT &lt;- inputDT[, .(missing_numbers = sapply(AP, find_missing_numbers))]</pre><h4>Validation</h4><pre>identical(test$`Answer Expected`, result$missing_numbers)  \n#&gt; [1] TRUE\n\nidentical(test$`Answer Expected`, resultDT$missing_numbers)\n#&gt; [1] TRUE</pre><h3>Puzzle 326</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*LGUZKnwtJaIcMF2WoSVR6Q.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*LGUZKnwtJaIcMF2WoSVR6Q.png?w=578&amp;ssl=1\"/></noscript></figure><p>Those beautiful spiral takes into mind Fibonacci numbers. And yes indeed, this puzzle is related to Fibonacci numbers. From given numbers we have to leave only “non-Fibonacci” numbers.</p><h4>Load data and libraries</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Non Fibonacci Numbers.xlsx\", range = \"A1:A10\")\ntest = read_excel(\"Non Fibonacci Numbers.xlsx\", range = \"B1:B5\")</pre><p>As function which I wrote is already in base R and it is probably the best approach I will cite function here and in approaches I will show only calling it in three syntaxes.</p><pre>generate_fibonacci_to_limit&lt;- function(){\n  fib &lt;- c(1, 2)\n  while (tail(fib, 1) &lt; 1e7) {\n    fib &lt;- c(fib, sum(tail(fib, 2)))\n  }\n  return(fib)\n}\n\nfib = generate_fibonacci_to_limit()</pre><h4>Approach 1: tidyverse</h4><pre>result = input %&gt;% \n  mutate(is_fibonacci = ifelse(Numbers %in% fib, \"Yes\", \"No\")) %&gt;%\n  filter(is_fibonacci == \"No\") %&gt;%\n  select(Numbers)</pre><h4>Approach 2: data.table</h4><pre>inputDT = setDT(input)\n\nresult_dt &lt;- inputDT[, .(Numbers, is_fibonacci = ifelse(Numbers %in% fib, \"Yes\", \"No\"))]\nresult_dt &lt;- result_dt[is_fibonacci == \"No\", .(Numbers)]</pre><h4>Approach 3: base R</h4><pre>input$is_fibonacci &lt;- ifelse(input$Numbers %in% fib, \"Yes\", \"No\")\nresult_base &lt;- input[input$is_fibonacci == \"No\", \"Numbers\", drop = FALSE]</pre><h4>Validation</h4><pre>identical(result$Numbers, test$`Answer Expected`)\n#&gt; TRUE\n\nidentical(result_dt$Numbers, test$`Answer Expected`)\n#&gt; TRUE\n\nidentical(result_base$Numbers, test$`Answer Expected`)\n#&gt; TRUE</pre><h3>Puzzle 327</h3><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*koUeUvFpIJdV4B1GJmxK6Q.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*koUeUvFpIJdV4B1GJmxK6Q.png?w=578&amp;ssl=1\"/></noscript></figure><p>In puzzle #327 we need to find students with top 3 scores. It is not the same as 3 top students, because there could be more than one student that score max.</p><h4>Loading data and libraries</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Highest Marks Names Subjects.xlsx\", range = \"A1:E10\")\ntest = read_excel(\"Highest Marks Names Subjects.xlsx\", range = \"G1:I7\")</pre><h4>Approach 1: tidyverse</h4><pre>result = input %&gt;%\n  pivot_longer(-c(Names), names_to = \"Subjects\", values_to = \"Marks\") %&gt;%\n  mutate(rank = dense_rank(desc(Marks))) %&gt;%\n  filter(rank &lt;= 3) %&gt;%\n  arrange(desc(Marks), Names, Subjects) %&gt;%\n  select(-rank)</pre><h4>Approach 2: data.table</h4><pre> inputDT = setDT(input)\nresult_dt &lt;- melt(inputDT, id.vars = \"Names\", variable.name = \"Subjects\", value.name = \"Marks\")\nresult_dt &lt;- result_dt[, rank := frank(-Marks, ties.method = \"dense\")][\n  rank &lt;= 3\n][\n  order(-Marks, Names, Subjects)\n][, -\"rank\", with = FALSE]</pre><h4>Approach 3: base R</h4><pre>result_base &lt;- reshape(input, varying = list(names(input)[-1]), v.names = \"Marks\",\n                       timevar = \"Subjects\", times = names(input)[-1], direction = \"long\")\nresult_base &lt;- result_base[order(result_base$Marks, decreasing = TRUE), ]\n\nunique_marks_base &lt;- unique(result_base$Marks)\nresult_base$rank &lt;- match(result_base$Marks, sort(unique_marks_base, decreasing = TRUE))\n\nresult_base &lt;- subset(result_base, rank &lt;= 3)\nresult_base &lt;- result_base[order(-result_base$Marks, result_base$Names, result_base$Subjects), ]\nresult_base &lt;- result_base[, c(\"Names\", \"Subjects\", \"Marks\")]</pre><h4>Validation</h4><p>Validation as ussual (by identical function) would need much more code to unify structure. That’s why I promise… I checked visually and all looks the same. :-)</p><h3>Puzzle 328</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*EDsq8FpOBlHtbjqHE9pkVg.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*EDsq8FpOBlHtbjqHE9pkVg.png?w=578&amp;ssl=1\"/></noscript></figure><p>In this puzzle we need to find duplicated numbers in string and remove, but only first occurance of duplication.</p><h4>Read data and libraries</h4><pre>library(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Remove Minimum.xlsx\", range = \"A1:A7\")\ntest = read_excel(\"Remove Minimum.xlsx\", range = \"B1:B7\")</pre><h4>Aproach 1: tidyverse</h4><pre>remove_last_min &lt;- function(x) {\n  nums &lt;- str_split(x, \",\\\\s*\") %&gt;%\n    map(~as.numeric(.x)) %&gt;%\n    .[[1]]\n  \n  min_num &lt;- min(nums)\n  last_min_index &lt;- max(which(nums == min_num))\n  modified_nums &lt;- nums[-last_min_index]\n  \n  if (length(modified_nums) == 0) {\n    NA_character_\n  } else {\n    str_c(modified_nums, collapse = \", \")\n  }\n}\n\nresult = input %&gt;%\n  mutate(result = map_chr(String, remove_last_min))</pre><h4>Approach 2: base function, data.table call</h4><pre>remove_last_min_base &lt;- function(x) {\n  nums &lt;- as.numeric(unlist(strsplit(x, \",\\\\s*\")))\n  \n  min_num &lt;- min(nums)\n  last_min_index &lt;- max(which(nums == min_num))\n  modified_nums &lt;- nums[-last_min_index]\n  \n  if (length(modified_nums) == 0) {\n    return(NA_character_)\n  } else {\n    return(paste(modified_nums, collapse = \", \"))\n  }\n}\n\ninputDT = setDT(input)\nresult_dt &lt;- inputDT[, .(result = sapply(String, remove_last_min_base))]</pre><h4>Validation</h4><pre>identical(result$result, test$`Answer Expected`)\n#&gt; [1] TRUE\n\nidentical(result_dt$result, test$`Answer Expected`) \n#&gt; [1] TRUE\n</pre><h3>Conclusion</h3><p>This is the first time using this approach, so let me know what do you think went good or wrong. <br/>Look for Power Query Puzzle article as well.</p><h4>Publishing plan:</h4><p>Mon: Excel Puzzles from previous week<br/>Tue: Power Query Puzzle from last weekend<br/>Thu: General R article (currently small series about how to improve, optimize and change functions)</p><img alt=\"\" data-lazy-src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=5616ca06fa43\" height=\"1\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"1\"/><noscript><img alt=\"\" height=\"1\" loading=\"lazy\" src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=5616ca06fa43\" width=\"1\"/></noscript><hr/><p><a href=\"https://medium.com/number-around-us/r-solutions-for-excel-puzzles-5616ca06fa43\" rel=\"nofollow\" target=\"_blank\">R Solutions for Excel Puzzles</a> was originally published in <a href=\"https://medium.com/number-around-us\" rel=\"nofollow\" target=\"_blank\">Numbers around us</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://medium.com/number-around-us/r-solutions-for-excel-puzzles-5616ca06fa43\"> Numbers around us - Medium</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
    "main_text": "R Solutions for Excel Puzzles\nPosted on\nNovember 20, 2023\nby\nNumbers around us\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nNumbers around us - Medium\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nWeek 46 — Puzzles no. 323–328\nFirst time after few weeks I decided to slightly change my way of publishing this format of content. I used to publish daily, then every 2 or 3 days, but I realized that summary of all puzzles weekly will be my way.\nHost of our puzzles is publishing 7 puzzles a week: 5 for Excel (Mon-Fri) and 2 for Power Query (Sat-Sun). My plan is to show my solutions in two posts according to original tools. Excel puzzle series will contain 5 parts and PQ series — 2 parts. Of course, as I had little break with it today ther will be more puzzles to get on straight path.\nPuzzles\nAuthor:\nExcelBI\nPuzzle 323:\ncontent\nfile\nPuzzle 324:\ncontent\nfile\nPuzzle 325:\ncontent\nfile\nPuzzle 326:\ncontent\nfile\nPuzzle 327:\ncontent\nfile\nPuzzle 328:\ncontent\nfile\nLets dive into solutions!\nPuzzle 323\nGoal of puzzle was to find all palindromic substrings in numbers represented like strings.\nLoading data and libraries:\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(stringi)\n\ninput = read_excel(“Substring Palindromes.xlsx”, range = “A1:A8”)\ntest = read_excel(“Substring Palindromes.xlsx”, range = “B1:B8”)\nApproach 1: tidyverse\nis_palindrome <- function(s) {\n s == stri_reverse(s)\n} \n\ngenerate_substrings <- function(s) {\n n <- nchar(s)\n positions <- crossing(start = 1:(n-2), end = 3:n) %>%\n filter(end > start, end — start >= 2)\n substrings <- pmap_chr(positions, ~ substr(s, ..1, ..2))\n palindromic_substrings <- substrings[map_lgl(substrings, is_palindrome)]\n palindromic_substrings\n}\n\nresult = input %>%\n rowwise() %>%\n mutate(\n substrings = map(Numbers, generate_substrings),\n final = paste(substrings, collapse = “, “)) %>%\n select(Palindrome = final) %>%\n mutate(Palindrome = if_else(Palindrome == “”, NA, Palindrome)) %>%\n ungroup()\nApproach 2: data.table\nlibrary(data.table)\n\ninputDT = setDT(input)\n\nis_palindrome <- function(s) {\n s == stringi::stri_reverse(s)\n}\n\ngenerate_substrings_dt <- function(s) {\n n <- nchar(s)\n positions <- CJ(start = 1:(n-2), end = 3:n)[end > start & end — start >= 2]\n substrings <- mapply(function(start, end) substr(s, start, end), positions$start, positions$end)\n palindromic_substrings <- substrings[vapply(substrings, is_palindrome, logical(1))]\n if (length(palindromic_substrings) == 0) {\n return(NA_character_)\n }\n palindromic_substrings\n}\n\nresult_dt <- inputDT[, .(Palindrome = {\n substrings <- lapply(Numbers, generate_substrings)\n final <- sapply(substrings, function(x) paste(x, collapse = “, “))\n if (final == “”) NA_character_ else final\n}), by = 1:nrow(inputDT)]\nApproach 3: base R\nis_palindrome <- function(s) {\n s == stringi::stri_reverse(s)\n} \n\ngenerate_substrings_base <- function(s) {\n n <- nchar(s)\n substrings <- NULL\n for (start in 1:(n — 2)) {\n for (end in (start + 2):n) {\n substrings <- c(substrings, substr(s, start, end))\n }\n }\n palindromic_substrings <- substrings[sapply(substrings, is_palindrome)]\n palindromic_substrings\n} \n\ngenerate_palindromes_for_row <- function(numbers) {\n substrings <- lapply(numbers, generate_substrings_base)\n final <- sapply(substrings, function(x) paste(x, collapse = “, “))\n if (final == “”) return(NA) else return(final)\n}\n\ninput <- as.data.frame(input) # Ensure ‘input’ is a data frame\ninput$Palindrome <- apply(input, 1, function(row) generate_palindromes_for_row(row[“Numbers”]))\nValidation:\nidentical(test, result)\n#> [1] TRUE\n\nidentical(test$Palindrome, result_dt$Palindrome)\n#> [1] TRUE\n\nidentical(test$Palindrome, input$Palindrome)\n#> [1] TRUE\nPuzzle 324\nGoal of this puzzle was to find subjects in two columns (like two classes next to each other) that are in distance of maximum one slot up or down in column.\nLoad data and libraries:\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(“Plus Minus 1 Row.xlsx”, range = “A1:B20”)\ntest = read_excel(“Plus Minus 1 Row.xlsx”, range = “C1:C6”)\nApproach 1: tidyverse\nr1 = input %>%\n  select(s = 1) %>%\n  mutate(n = row_number()) \n\nr2 = input %>%\n  select(s = 2) %>%\n  mutate(n = row_number())\n\nresult = r1 %>%\n  left_join(r2, by =c(\"s\")) %>%\n  mutate(diff = abs(n.x - n.y)) %>%\n  filter(diff <= 1) %>%\n  select(s)\nApproach 2: data.table\ninputDT = setDT(input)\nr1_dt <- inputDT[, .(s = .SD[[1]], n1 = .I)]\nr2_dt <- inputDT[, .(s = .SD[[2]], n2 = .I)]\nresult_dt <- r1_dt[r2_dt, on = .(s), nomatch = 0][, diff := abs(n1 - n2)]\nresult_dt <- result_dt[diff <= 1, .(s)]\nApproach 3: base R\nr1_base <- data.frame(s = input[[1]], n = seq_len(nrow(input)))\nr2_base <- data.frame(s = input[[2]], n = seq_len(nrow(input)))\nresult_base <- merge(r1_base, r2_base, by = \"s\", all.x = TRUE)\nresult_base$diff <- abs(result_base$n.x - result_base$n.y)\nresult_base <- result_base[result_base$diff <= 1, \"s\", drop = FALSE]\nValidation:\nidentical(sort(test$`Answer Expected`), sort(result$s))\n#> [1] TRUE\n\nidentical(sort(test$`Answer Expected`), sort(result_dt$s))\n#> [1] TRUE\n\nidentical(sort(test$`Answer Expected`), sort(result_base$s))\n#> [1] TRUE\nPuzzle 325\nIn this puzzle we need to complete given sequence of numbers which like this fence on picture has some spaces and lacks.\nRead data and libraries:\nlibrary(tidyverse)\nlibrary(stringr)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Missing Number in AP_2.xlsx\", range = \"A1:A7\")\ntest = read_excel(\"Missing Number in AP_2.xlsx\", range = \"B1:B7\")\nApproach 1: tidyverse\nfind_missing_numbers <- function(input_string) {\n  elements <- str_split(input_string, \",\\\\s*\")[[1]]\n  numbers <- map(elements, ~ if (str_detect(.x, \"\\\\d+\")) as.numeric(.x) else NA_real_)\n  \n  missing_indices <- which(is.na(numbers))\n  \n  non_missing_indices <- which(!is.na(numbers))\n  if (length(non_missing_indices) >= 2) {\n    first_point <- non_missing_indices[1]\n    last_point <- non_missing_indices[length(non_missing_indices)]\n    common_difference <- (numbers[last_point][[1]] - numbers[first_point][[1]]) / (last_point - first_point)\n  } else {\n    common_difference <- 0\n  }\n  \n  numbers[missing_indices] <- map(missing_indices, ~ numbers[first_point][[1]] + (.x - first_point) * common_difference)\n  missing_numbers_str <- numbers[missing_indices] %>% map_chr(as.character) %>% str_c(collapse = \", \")\n  return(missing_numbers_str)\n}\n\nresult = input %>%\n  mutate(missing_numbers = map_chr(AP, find_missing_numbers))\nApproach 2: base R function\nAs in some previous articles if big part would look similar in base R and data.frame, I would use only one approach. Function is translated to base R, and I will only call her in data.table expression.\nfind_missing_numbers_base <- function(input_string) {\n  elements <- unlist(strsplit(input_string, \",\\\\s*\"))\n  numbers <- sapply(elements, function(x) if (grepl(\"\\\\d+\", x)) as.numeric(x) else NA_real_)\n  \n  missing_indices <- which(is.na(numbers))\n  non_missing_indices <- which(!is.na(numbers))\n  \n  if (length(non_missing_indices) >= 2) {\n    first_point <- non_missing_indices[1]\n    last_point <- non_missing_indices[length(non_missing_indices)]\n    common_difference <- (numbers[last_point] - numbers[first_point]) / (last_point - first_point)\n  } else {\n    common_difference <- 0\n  }\n  \n  numbers[missing_indices] <- sapply(missing_indices, function(i) numbers[first_point] + (i - first_point) * common_difference)\n  missing_numbers_str <- paste(numbers[missing_indices], collapse = \", \")\n  return(missing_numbers_str)\n}\n\ninputDT = setDT(input)\nresultDT <- inputDT[, .(missing_numbers = sapply(AP, find_missing_numbers))]\nValidation\nidentical(test$`Answer Expected`, result$missing_numbers)  \n#> [1] TRUE\n\nidentical(test$`Answer Expected`, resultDT$missing_numbers)\n#> [1] TRUE\nPuzzle 326\nThose beautiful spiral takes into mind Fibonacci numbers. And yes indeed, this puzzle is related to Fibonacci numbers. From given numbers we have to leave only “non-Fibonacci” numbers.\nLoad data and libraries\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Non Fibonacci Numbers.xlsx\", range = \"A1:A10\")\ntest = read_excel(\"Non Fibonacci Numbers.xlsx\", range = \"B1:B5\")\nAs function which I wrote is already in base R and it is probably the best approach I will cite function here and in approaches I will show only calling it in three syntaxes.\ngenerate_fibonacci_to_limit<- function(){\n  fib <- c(1, 2)\n  while (tail(fib, 1) < 1e7) {\n    fib <- c(fib, sum(tail(fib, 2)))\n  }\n  return(fib)\n}\n\nfib = generate_fibonacci_to_limit()\nApproach 1: tidyverse\nresult = input %>% \n  mutate(is_fibonacci = ifelse(Numbers %in% fib, \"Yes\", \"No\")) %>%\n  filter(is_fibonacci == \"No\") %>%\n  select(Numbers)\nApproach 2: data.table\ninputDT = setDT(input)\n\nresult_dt <- inputDT[, .(Numbers, is_fibonacci = ifelse(Numbers %in% fib, \"Yes\", \"No\"))]\nresult_dt <- result_dt[is_fibonacci == \"No\", .(Numbers)]\nApproach 3: base R\ninput$is_fibonacci <- ifelse(input$Numbers %in% fib, \"Yes\", \"No\")\nresult_base <- input[input$is_fibonacci == \"No\", \"Numbers\", drop = FALSE]\nValidation\nidentical(result$Numbers, test$`Answer Expected`)\n#> TRUE\n\nidentical(result_dt$Numbers, test$`Answer Expected`)\n#> TRUE\n\nidentical(result_base$Numbers, test$`Answer Expected`)\n#> TRUE\nPuzzle 327\nIn puzzle #327 we need to find students with top 3 scores. It is not the same as 3 top students, because there could be more than one student that score max.\nLoading data and libraries\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Highest Marks Names Subjects.xlsx\", range = \"A1:E10\")\ntest = read_excel(\"Highest Marks Names Subjects.xlsx\", range = \"G1:I7\")\nApproach 1: tidyverse\nresult = input %>%\n  pivot_longer(-c(Names), names_to = \"Subjects\", values_to = \"Marks\") %>%\n  mutate(rank = dense_rank(desc(Marks))) %>%\n  filter(rank <= 3) %>%\n  arrange(desc(Marks), Names, Subjects) %>%\n  select(-rank)\nApproach 2: data.table\ninputDT = setDT(input)\nresult_dt <- melt(inputDT, id.vars = \"Names\", variable.name = \"Subjects\", value.name = \"Marks\")\nresult_dt <- result_dt[, rank := frank(-Marks, ties.method = \"dense\")][\n  rank <= 3\n][\n  order(-Marks, Names, Subjects)\n][, -\"rank\", with = FALSE]\nApproach 3: base R\nresult_base <- reshape(input, varying = list(names(input)[-1]), v.names = \"Marks\",\n                       timevar = \"Subjects\", times = names(input)[-1], direction = \"long\")\nresult_base <- result_base[order(result_base$Marks, decreasing = TRUE), ]\n\nunique_marks_base <- unique(result_base$Marks)\nresult_base$rank <- match(result_base$Marks, sort(unique_marks_base, decreasing = TRUE))\n\nresult_base <- subset(result_base, rank <= 3)\nresult_base <- result_base[order(-result_base$Marks, result_base$Names, result_base$Subjects), ]\nresult_base <- result_base[, c(\"Names\", \"Subjects\", \"Marks\")]\nValidation\nValidation as ussual (by identical function) would need much more code to unify structure. That’s why I promise… I checked visually and all looks the same. :-)\nPuzzle 328\nIn this puzzle we need to find duplicated numbers in string and remove, but only first occurance of duplication.\nRead data and libraries\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(data.table)\n\ninput = read_excel(\"Remove Minimum.xlsx\", range = \"A1:A7\")\ntest = read_excel(\"Remove Minimum.xlsx\", range = \"B1:B7\")\nAproach 1: tidyverse\nremove_last_min <- function(x) {\n  nums <- str_split(x, \",\\\\s*\") %>%\n    map(~as.numeric(.x)) %>%\n    .[[1]]\n  \n  min_num <- min(nums)\n  last_min_index <- max(which(nums == min_num))\n  modified_nums <- nums[-last_min_index]\n  \n  if (length(modified_nums) == 0) {\n    NA_character_\n  } else {\n    str_c(modified_nums, collapse = \", \")\n  }\n}\n\nresult = input %>%\n  mutate(result = map_chr(String, remove_last_min))\nApproach 2: base function, data.table call\nremove_last_min_base <- function(x) {\n  nums <- as.numeric(unlist(strsplit(x, \",\\\\s*\")))\n  \n  min_num <- min(nums)\n  last_min_index <- max(which(nums == min_num))\n  modified_nums <- nums[-last_min_index]\n  \n  if (length(modified_nums) == 0) {\n    return(NA_character_)\n  } else {\n    return(paste(modified_nums, collapse = \", \"))\n  }\n}\n\ninputDT = setDT(input)\nresult_dt <- inputDT[, .(result = sapply(String, remove_last_min_base))]\nValidation\nidentical(result$result, test$`Answer Expected`)\n#> [1] TRUE\n\nidentical(result_dt$result, test$`Answer Expected`) \n#> [1] TRUE\nConclusion\nThis is the first time using this approach, so let me know what do you think went good or wrong.\nLook for Power Query Puzzle article as well.\nPublishing plan:\nMon: Excel Puzzles from previous week\nTue: Power Query Puzzle from last weekend\nThu: General R article (currently small series about how to improve, optimize and change functions)\nR Solutions for Excel Puzzles\nwas originally published in\nNumbers around us\non Medium, where people are continuing the conversation by highlighting and responding to this story.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nNumbers around us - Medium\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "Week 46 — Puzzles no. 323–328First time after few weeks I decided to slightly change my way of publishing this format of content. I used to publish daily, then every 2 or 3 days, but I realized that summary of all puzzles weekly will be my way.Host of ...",
    "meta_keywords": null,
    "og_description": "Week 46 — Puzzles no. 323–328First time after few weeks I decided to slightly change my way of publishing this format of content. I used to publish daily, then every 2 or 3 days, but I realized that summary of all puzzles weekly will be my way.Host of ...",
    "og_image": "https://cdn-images-1.medium.com/max/1024/1*fQhRTThOWpWR3RY0h8vlWQ.png",
    "og_title": "R Solutions for Excel Puzzles | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 8.8,
    "sitemap_lastmod": "2023-11-20T14:02:18+00:00",
    "twitter_description": "Week 46 — Puzzles no. 323–328First time after few weeks I decided to slightly change my way of publishing this format of content. I used to publish daily, then every 2 or 3 days, but I realized that summary of all puzzles weekly will be my way.Host of ...",
    "twitter_title": "R Solutions for Excel Puzzles | R-bloggers",
    "url": "https://www.r-bloggers.com/2023/11/r-solutions-for-excel-puzzles/",
    "word_count": 1753
  }
}