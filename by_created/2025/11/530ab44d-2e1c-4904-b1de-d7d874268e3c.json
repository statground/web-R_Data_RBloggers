{
  "uuid": "530ab44d-2e1c-4904-b1de-d7d874268e3c",
  "created_at": "2025-11-22 19:59:07",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2025/03/sample-size-and-statistical-significance-for-chi-squared-tests/",
    "crawled_at": "2025-11-22T10:52:54.564684",
    "external_links": [
      {
        "href": "https://bryer.org/posts/2025-03-04-chi_squared_sample_sizes.html",
        "text": "Jason Bryer"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://en.wikipedia.org/wiki/Power_(statistics)",
        "text": "power"
      },
      {
        "href": "http://adv-r.had.co.nz/S3.html",
        "text": "S3 objected oriented framework"
      },
      {
        "href": "https://cran.r-project.org/web/packages/pwrss/index.html",
        "text": "pwsrr R package"
      },
      {
        "href": "https://pwrss.shinyapps.io/index/",
        "text": "Shiny application"
      },
      {
        "href": "https://bryer.org/posts/2025-03-04-chi_squared_sample_sizes.html",
        "text": "Jason Bryer"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Sample size and statistical significance for chi-squared tests | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAUBAMAAACZjst6AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAVGbNMiJEmd12iRCru5wK044AAAAJcEhZcwAADsQAAA7EAZUrDhsAAAB0SURBVAgdY2AAA6HlEJqBdQLPAgiTxYDpAlSQgQsqxsCwYwNM7AiMwekQAGWmMUxgYFR2YGBNffduAQMruwEDE0SG5SmDAlRNJyOUwbDYG8byc4Cx4hRgrDkwyzkZH0DFZjM8hLAYAxhqucFMNwaGzZNALADbURSxl+Cu/AAAAABJRU5ErkJggg==",
        "src": "https://latex.codecogs.com/png.latex?%5Cchi%5E2"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAAANBAMAAACTPnv+AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAEHariSJm3UTNu1SZMu+2SNqUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABnUlEQVQoFY1RsUrDUBQ9jWkam8R2cHMJdhYFBwWXoMEKXYqCFhwsguggWHHQMSg4iEMHwdEuOmSxi4Pg4OAHdBJRUHAS7WDdBEXP8722llbwDPe+c+49NzfvAYikxt1pRNIfZfwX5vjkLJCu+hNVWpYD6FtAvPSH/bpdz8B8ko59QF8HzFcg4bY0Gr6fkcJ2iy6IeQkUpEMD1rKUisBDRdQ6oH2AnQc86bAQeRMe0kGRO6F9QHwI4GcHYbBfrylT2Go2L3KryR9JDbBfnPqO1vuAqISYYYyVxJl4FMEeFvB4unNOYgGFMDwMwxKFxb1+RonbL14cnv0DxoQnteinzPXoOjWxIKE2yCJPMie3MDcAOm6oJIRsAcYr829oQ4qpAZgX/D5gyALnP44Kyoh5VJaAriLzb3SXFVMDzEq96gTAjnREy9BoZEKPJ+rNOwgWkppQGr9wBsWhsX1UOmzWeRG7TAsBQxNGYTnJvQTkBlZq5Vhy8BUNVzp8StpVfxboPR1TZZmimVymwmPjFfoim4Hq0HV/iu9/dOWP1PANc1xbn0b2mXEAAAAASUVORK5CYII=",
        "src": "https://latex.codecogs.com/png.latex?%20CI%20=%20%5Cbar%7Bx%7D%20%5Cpm%20z%20%5Ccdot%20SE"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAAAmBAMAAAB34dsnAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMARIl2ZiJU75ndu6vNMhBVgMKNAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABiUlEQVQ4EY2TPUjDUBSFv6RprC3ViovgYI0iiIMdxE3M4CIOKrg52MmpCAWR4lS6C90F7ewgFXEQl+LgpBhFEFRwcXKqu3+31rTVpi+5kNzzzvm4XB4J+NTc3JIPUY9NW7fryuetX/X4EL9xeH8rGEh4Mhh4QVcwsEx/MLBv3W6A2sjoCoznrIlcw/MUY2hZiJZgwDN3TS0PRehNQcj1PHvEhiQ8O2B6Aq4ZLcMSzGK4Toduvs/UkgNWOwAN++FrT/S2df7jRM5qlWykrULbhfAHN62e6K/WkrPslwGjikP6H/rnGE/AIMQqMlUJhiQ9gq4kRJDquKPcjpGCNRls1cC2uvtZtYquW8OgXxes0882qGYcerrtZjzf7nk6UbmVQPUYiBLoJCAYLmNOvSw4vnjEYfneNku+4Cuk5wmVleCTpDvyFIilVKC2aNNTEiJLr/qOYkX0hHwrVTKaaiLxN2RFjAoFn9/kkmkBQza3G8qJDDkVNeCm3cdpV6q78a7Om+lmU6qV04y/Af4IWIni275MAAAAAElFTkSuQmCC",
        "src": "https://latex.codecogs.com/png.latex?%20SE%20=%20%20%5Cfrac%7Bs%7D%7B%5Csqrt%7Bn%7D%7D%20"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAAMBAMAAADPH83EAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAme9UMmZ2RLsiqxDdic3tCCnEAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA4ElEQVQYGWNgwAB1DiAhdrGVDAysaZkY0gwM0/zBKuwYeCYwCDNIYVHBwA9WoczAKMDewOCCUwXndwZWBZ4AsDyjMgtYE1wx2AzOLwysv/lNYw2AwmEVaUCScRUIXAApg9jymYH353wBhmagwAQGiFkgSTCAqIhiYPztH8AQAxKaDJGAkxAVrFdDP8wvYLDfAPS4A1wOwoCoYGBge8BvAFZhycAGlMFwRwkDXwFHAkMOAwNzVngnqiH8BQycqxneMgQysBxgeM7AsJn7TAGKir3r3zqwaDK4pQE94JhYwAAAKTUx0BfQ9fUAAAAASUVORK5CYII=",
        "src": "https://latex.codecogs.com/png.latex?z%20=%201.96"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAANBAMAAADoNnt3AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVHZmEKsyIkTvu92Zic2ZjesdAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA1klEQVQYGW2OPQrCQBSEJ8kGRZRYWPuDnVUaG20C1gFv4LYWolhZ2ghWYmnpZdTGQArtcwEhN4jvvV0DolNkvsyXZQP85qDR6O33GgR/sl5q+EVRhAxlVFRiQOcBFyAoo+7lC81VIDXe6U+GYtRzaz+WY97K+M08dM5GjELT4mNihuYY7tTs2D0ExF+tRwK/az06mkl8/oETArpKsrtJsXeOhAyVHG36W86oKyVzPSNm72VIPN7VoMlFCbZA7WzBDbFoEauLpicnnr006qkFs9E90Ye++g1agCzJkBI8cQAAAABJRU5ErkJggg==",
        "src": "https://latex.codecogs.com/png.latex?n%20%3E%20171"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAQBAMAAABQPLQnAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVHYiZpkQRO+Jq7vdMs3/9KjfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABC0lEQVQoFWNgwABFngUgMRBlN0XbAEOegfcBw2OgKJiy+bEYTYEZkM8twKAKowzR5BluhQFF+C8wVMAoiAohZZcAiFJpNRB934DhfgKUMnKZzsDAJvaFIQQkw6YtAKIY6oEqgM4DU0kMPBcY2NkbGGYBJZijLoAVgKSBsjCKdQMDA9MChqVAuYoCiAIG+wsM8gkMMIqpAez2RqAk3Az+AgYJIB9MHWRg+gBkJrAfAIowsM0SAFEM3A4MWjDqMQPIlvsJfBfAUgzeCiCafQMwxKwSwJQbQ4YBA4OqozJEAQND1TQQS0iygOGGAZhi0QwGCmyByQNpUJhigs+YQqgivB9Q+Zi8up+YYigiAMklQETCg9B6AAAAAElFTkSuQmCC",
        "src": "https://latex.codecogs.com/png.latex?p%20%3C%200.05"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/bryer.org/posts/2025-03-04-chi_squared_sample_sizes_files/figure-html/unnamed-chunk-3-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAUBAMAAACZjst6AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAVGbNMiJEmd12iRCru5wK044AAAAJcEhZcwAADsQAAA7EAZUrDhsAAAB0SURBVAgdY2AAA6HlEJqBdQLPAgiTxYDpAlSQgQsqxsCwYwNM7AiMwekQAGWmMUxgYFR2YGBNffduAQMruwEDE0SG5SmDAlRNJyOUwbDYG8byc4Cx4hRgrDkwyzkZH0DFZjM8hLAYAxhqucFMNwaGzZNALADbURSxl+Cu/AAAAABJRU5ErkJggg==",
        "src": "https://latex.codecogs.com/png.latex?%5Cchi%5E2"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJIAAAAoBAMAAADnBL6uAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVGbNMiJEmd12iRCru+/oK7SQAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC5ElEQVRIDa1WS2gTURQ9See1zuRj6EZ3BlwUQWnWumhWblxYN67Exo2upAUXQqW0uBNR025cKDhQRA0VAy5qN6WgC8EqQXAjBLKRgr9GaP3reO8kL3nvzZtYSi/M3HvPOe/OY3JmJsCOxOC9LY9Zile6gCin/XiBzqxQuzQ3VNXR+2uVhbXUBJxCsqYzsZ1bApIvIK7qigytP4dBAj1fZ2K7PmIW6HioK3aXARdMPjF2q+uUji7b/4H6cQWj8ngRSMDLAc90Ir57AyzniealStxBkrr+FbjFUQXuVTaAR7z/ffqCOk7xqgbOoszFFmIGuMayaV37qXKYgaYIAl9n4jpRAH4y+VFTiA0cZYDvYFys//3MsR4EQYk0TgGpH5TdTTqdr1O8pgLJJorIAao3TLcP/2ElmfdgUKOUmgHeU87qdyNNWxU0qUFUOyJuzwT5NrXI22DtBUovue5G1gcGqG10oYjbU+vhAFbs4dMR8l4O5sM1VgIqtC3edidMt49/l5RXpWqWjgcH7kqslb2RycrzX3S78ipuut0LJlQ6tI0KqHWGr9WJiNtHvnQ4KnSxylCtXSbq9uVgVFkgtB0qBJeX1D7q9kRQUAVn1Eavk0Wlt7l9OjS1FAlZRLOkEvuLEKUoj12huy1EHCQGCuGrgfmBVQ6/JRVBr8eppdHPzibyOtLuhn9b4R7glYSdTHd9QA/yf4OGzB+zT+rz7Xg82n2javcJq/FLYpixvJVwNT9ZJSZ4u2YiYb+3aoVD0Ls+WXk1YfJuomlC3DvvbKjE6vRFiUy6he5vJIWUT5eUJlLyq7hsoIlRTKUMjNvLEvNkoWRng5qcAnBJH4fHcwZGbcaX2JAslOw2Y9ysaGQ5JYvFr7JScqYmVpS2V9m2QOrkoaBh0WXfzvsW2AaNdx8O25KxolOyLbNgNy92omqhh+HQf5SdiKc05MRODAq/xxFjbmeyoN/T/EBuZw69h75VFm6Y9+8fQs3bfZULvP0AAAAASUVORK5CYII=",
        "src": "https://latex.codecogs.com/png.latex?%20%5Cchi%5E2%20=%20%5Csum%7B%5Cfrac%7B(O%20-%20E)%5E2%7D%7BE%7D%7D%20"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAAAPBAMAAABOyWF/AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVHZmEKsyIkTvu92Zic2ZjesdAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABCklEQVQYGZ2QMUsDQRBG395dctvEu8JaIiGlciBWaQ6sAzbWudZCDVZ2praQIAiWCVqIiL/BWgy2YhXsA6IhsXRn3AuxdYqd+b43MwsDPqK8rDgvYKtZxzZeFx7xXteL46OCWsYnh6yUnkPxU883JI4PuGRI8OgtSdFb+qscd+qLGbaPaexsi5bYzDQpD8bVOdUpJ/uZGajtnpZuEB4+Yx2fk7YIdj2397lUOh/eOOhaGFGpiwtmkmtWzkM8w0zhiqSrdviuSecrBS/5N6ZP/MGaFdAeeiz7T1M6XMvP4ZhR6Ii9LTFJj1oeXXAm9wkyDlYXSIp2Z1Kw0Uwx60v3/dPyD2HvJPQ+y9M/sZE43HH41eEAAAAASUVORK5CYII=",
        "src": "https://latex.codecogs.com/png.latex?n%20%5Cge%20130"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/bryer.org/posts/2025-03-04-chi_squared_sample_sizes_files/figure-html/unnamed-chunk-5-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAAAQBAMAAAClwj+XAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAVHZmEKsyIkTvu92Zic2ZjesdAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABWklEQVQoFXWQvUvDUBTFT5K2edTEBnFxsH7hJhKQTlUIOBccFEcfbg6S4ORmcJC6aMXFsd1E/CPEwUEoFNycgotToYKoWz3vNbFQ6R3uOfe837v5ANLKBZkTj7vaugv1usSFBE434uwQsHeidChjQtt8v9/3j0KJQoL3IQj7Ob12BedB5S5gAiWJoocVFWSVe/WUtX9gNZQRQEeDZM8BY2mzIlXOWvXZ7C9Yn3qEFWkwjBAGOD7wjeYgB6oe3Qfc70FQo3DdJcEIXhXmVgqK+4CuAifd+DQASZFFG/l5BiyjGyixXtZ6SgEl3HgiMRcANygRZ1lvWtjMRDujQSFYijHDd++hzO8Dai19CpxhMtbWSSgEiz6WuSdB22IgbvUhWxfrsLdpik02rhNN9cNNH4fTDIa1v+ijcM3Z6fA5e12Jqdl4eDzijJF57DgeFHeqvOzmn8mCcfoP/AWk2Eb+cTCKwQAAAABJRU5ErkJggg==",
        "src": "https://latex.codecogs.com/png.latex?n%20%5Cge%209,710"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/bryer.org/posts/2025-03-04-chi_squared_sample_sizes_files/figure-html/unnamed-chunk-6-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/bryer.org/posts/2025-03-04-chi_squared_sample_sizes_files/figure-html/unnamed-chunk-9-1.png?w=450&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/jason-bryer/",
        "text": "Jason Bryer"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-391089 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Sample size and statistical significance for chi-squared tests</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">March 3, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/jason-bryer/\">Jason Bryer</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://bryer.org/posts/2025-03-04-chi_squared_sample_sizes.html\"> Jason Bryer</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<p>In this post we are going to explore the relationship between sample size (<em>n</em>) and statistical significance for the chi-squared (<img data-lazy-src=\"https://latex.codecogs.com/png.latex?%5Cchi%5E2\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?%5Cchi%5E2\"/></noscript>) test. Recall that from the normal distribution, we construct a confidence interval using:</p>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?%20CI%20=%20%5Cbar%7Bx%7D%20%5Cpm%20z%20%5Ccdot%20SE\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?%20CI%20=%20%5Cbar%7Bx%7D%20%5Cpm%20z%20%5Ccdot%20SE\"/></noscript></p>\n<p>where <em>z</em> is the test statistic and:</p>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?%20SE%20=%20%20%5Cfrac%7Bs%7D%7B%5Csqrt%7Bn%7D%7D%20\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?%20SE%20=%20%20%5Cfrac%7Bs%7D%7B%5Csqrt%7Bn%7D%7D%20\"/></noscript></p>\n<p>where <em>s</em> is the sample standard deviation. Typically our <em>null</em> is zero in which case we reject the <em>null</em> hypothesis when the confidence does not span zero. If we wish to construct a 95% confidence interval, then <img data-lazy-src=\"https://latex.codecogs.com/png.latex?z%20=%201.96\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?z%20=%201.96\"/></noscript>. Assuming the sample standard deviation is constant regardless of sample size (a fair assumption), then as <em>n</em> increases the standard error decreases. The following calculates the confidence interval for <em>n</em> ranging from 10 to 400 assuming a sample standard deviation of 0.15 and 95% confidence level. When <img data-lazy-src=\"https://latex.codecogs.com/png.latex?n%20%3E%20171\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?n%20%3E%20171\"/></noscript> then <img data-lazy-src=\"https://latex.codecogs.com/png.latex?p%20%3C%200.05\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?p%20%3C%200.05\"/></noscript>.</p>\n<div class=\"cell\">\n<pre># Define some parameters\nsig_level &lt;- .95  # Significance level, 95% here\nes &lt;- 0.15        # Effect size in standard units\nnull_val &lt;- 0     # null value\n\n#' Calculate the standard error\n#' \n#' This function will calculate the standard error from a vector of observations or with a given\n#' sample standard deviation and sample size.\n#' \n#' @param x numeric vector of observations.\n#' @param sigma the sample standard deviation.\n#' @param n sample size.\nstandard_error &lt;- function(x, sigma = sd(x), n = length(x)) {\n    if(!missing(x)) { # Some basic error checking\n        if(sigma != sd(x)) { warning('The sample standard deviation (sigma) is not equal to sd(x)')}\n        if(n != length(x)) { warning('The sample size (n) is not equal to length(x).' )}\n    }\n    return(sigma / sqrt(n))\n}\n# Create a data.frame with varying sample sizes and the corresponding standard error\ndf &lt;- data.frame(\n    n = 10:400,\n    se = standard_error(sigma = 1, n = 10:400)\n)\ncv &lt;- abs(qnorm((1 - sig_level) / 2)) # Critical value (z test statistic)\ndf$ci_low &lt;- es - cv * df$se\ndf$ci_high &lt;- es + cv * df$se\ndf$sig &lt;- null_val &lt; df$ci_low | null_val &gt; df$ci_high\nmin_n &lt;- df$n[df$sig] |&gt; min()\nggplot(df, aes(x = n, y = se, color = sig)) + \n    geom_path() +\n    geom_point() +\n    scale_color_brewer(paste0('p &lt; ', (1 - sig_level)), type = 'qual', palette = 6) +\n    ggtitle(paste0('Minumum n for p &lt; ', (1 - sig_level), ': ', min_n),\n            subtitle = paste0('effect size: ', es, '; null value: ', null_val))</pre>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/bryer.org/posts/2025-03-04-chi_squared_sample_sizes_files/figure-html/unnamed-chunk-3-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/bryer.org/posts/2025-03-04-chi_squared_sample_sizes_files/figure-html/unnamed-chunk-3-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n<p>The chi-squared (<img data-lazy-src=\"https://latex.codecogs.com/png.latex?%5Cchi%5E2\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?%5Cchi%5E2\"/></noscript>) test statistic is defined as:</p>\n<p><img data-lazy-src=\"https://latex.codecogs.com/png.latex?%20%5Cchi%5E2%20=%20%5Csum%7B%5Cfrac%7B(O%20-%20E)%5E2%7D%7BE%7D%7D%20\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?%20%5Cchi%5E2%20=%20%5Csum%7B%5Cfrac%7B(O%20-%20E)%5E2%7D%7BE%7D%7D%20\"/></noscript></p>\n<p>where <em>O</em> is the observed count and <em>E</em> is the expected count. Unlike the standard error for numerical data, <em>n</em> is not explicitly in the formula and therefore makes it a bit more challenging to determine the impact sample size has rejecting the <em>null</em> hypothesis. Moreover, since the chi-squared is calculated from the cell counts in a table of varying length and dimension (one- or two-dimensions specifically) determining how <em>n</em> impacts rejecting the <em>null</em> or not requires more parameters.</p>\n<p>Answering the question of how large does <em>n</em> need to be to detect a statistically significant result (i.e. to reject the <em>null</em> hypothesis) is refereed to as <a href=\"https://en.wikipedia.org/wiki/Power_(statistics)\" rel=\"nofollow\" target=\"_blank\">power</a>. Whereas for calculating the power for numerical data had one parameter, the sample standard deviation, here we need to consider the proportion of observations within different cells. For example, consider we have a variable with three levels and we expect the proportion of observations in the three groups to be 33%, 25%, and 42%, respectively. If our sample size is 100 then we expect there to be 33, 25, and 42 and observations for the three categories. This function will, for varying sample sizes, calculate the counts for the categories to achieve that sample size, estimate the chi-squared statistic and record the <em>p</em>-value. There are other parameters that are documented below. A <code>plot</code> function is also defined using the <a href=\"http://adv-r.had.co.nz/S3.html\" rel=\"nofollow\" target=\"_blank\">S3 objected oriented framework</a>.</p>\n<div class=\"cell\">\n<pre>#' Calculate p-value from a chi-squared test with varying sample sizes\n#'\n#' This algorithm will start with an initial sample size (`n_start`) and perform a chi-squared test\n#' with a vector of counts equal to `n * probs`. This will repeat increasing the sample size by\n#' `n_step` until the p-value from the chi-squared test is less than `p_stop`.\n#'\n#' @param vector of cell probabilities. The sum of the values must equal 1.\n#' @param sig_level significance level.\n#' @param p_stop the p-value to stop estimating chi-squared tests.\n#' @param max_n maximum n to attempt if `p_value` is never less than `p_stop`.\n#' @param min_cell_size minimum size per cell to perform the chi-square test.\n#' @param n_start the starting sample size.\n#' @param n_step the increment for each iteration.\n#' @return a data.frame with three columns: n (sample size), p_value, and sig (TRUE if\n#'         p_value &lt; sig_level).\n#' @importFrom DescTools power.chisq.test CramerV\nchi_squared_power &lt;- function(\n        probs,\n        sig_level = 0.05,\n        p_stop = 0.01,\n        power = 0.80,\n        power_stop = 0.90,\n        max_n = 100000,\n        min_cell_size = 10,\n        n_start = 10,\n        n_step = 10\n) {\n    if(sum(probs) != 1) { # Make sure the sum is equal to 1\n        stop('The sum of the probabilities must equal 1.')\n    } else if(length(unique(probs)) == 1) {\n        stop('All the probabilities are equal.')\n    }\n\n    n &lt;- n_start\n    p_values &lt;- numeric()\n    power_values &lt;- numeric()\n    df &lt;- ifelse(is.vector(probs),\n                 length(probs) - 1,\n                 min(dim(probs)) - 1) # Degrees of freedom\n    repeat {\n        x &lt;- (probs * n) |&gt; round()\n        if(all(x &gt; min_cell_size)) {\n            cs &lt;- chisq.test(x, rescale.p = TRUE, simulate.p.value = FALSE)\n            p_values[n / n_step] &lt;- cs$p.value\n            pow &lt;- DescTools::power.chisq.test(\n                n = n,\n                w = DescTools::CramerV(as.table(x)),\n                df = df,\n                sig.level = sig_level\n            )\n            power_values[n / n_step] &lt;- pow$power\n            if((cs$p.value &lt; p_stop &amp; pow$power &gt; power_stop) | n &gt; max_n) {\n                break;\n            }\n        } else {\n            p_values[n / n_step] &lt;- NA\n            power_values[n / n_step] &lt;- NA\n        }\n        n &lt;- n + n_step\n    }\n    result &lt;- data.frame(n = seq(10, length(p_values) * n_step, n_step),\n                         p_value = p_values,\n                         sig = p_values &lt; sig_level,\n                         power = power_values)\n    class(result) &lt;- c('chisqpower', 'data.frame')\n    attr(result, 'probs') &lt;- probs\n    attr(result, 'sig_level') &lt;- sig_level\n    attr(result, 'p_stop') &lt;- p_stop\n    attr(result, 'power') &lt;- power\n    attr(result, 'power_stop') &lt;- power_stop\n    attr(result, 'max_n') &lt;- max_n\n    attr(result, 'n_step') &lt;- n_step\n    return(result)\n}\n\n#' Plot the results of chi-squared power estimation\n#'\n#' @param x result of [chi_squared_power()].\n#' @param plot_power whether to plot the power curve.\n#' @param plot_p whether to plot p-values.\n#' @param digits number of digits to round to.\n#' @param segement_color color of the lines marking where power and p values exceed threshold.\n#' @param sgement_linetype linetype of the lines marking where power and p values exceed threshold.\n#' @param p_linetype linetype for the p-values.\n#' @param power_linetype linetype for the power values.\n#' @param title plot title. If missing a title will be automatically generated.\n#' @parma ... currently not used.\n#' @return a ggplot2 expression.\nplot.chisqpower &lt;- function(\n        x,\n        plot_power = TRUE,\n        plot_p = TRUE,\n        digits = 4,\n        segment_color = 'grey60',\n        segment_linetype = 1,\n        p_linetype = 1,\n        power_linetype = 2,\n        title,\n        ...\n) {\n    pow &lt;- attr(x, 'power')\n\n    p &lt;- ggplot(x[!is.na(x$p_value),], aes(x = n, y = p_value))\n\n    if(plot_power) {\n        if(any(x$power &gt; pow, na.rm = TRUE)) {\n            min_n_power &lt;- min(x[x$power &gt; pow,]$n, na.rm = TRUE)\n            p &lt;- p +\n                geom_segment(\n                    x = 0,\n                    xend = min_n_power,\n                    y = pow,\n                    yend = pow,\n                    color = segment_color,\n                    linetype = segment_linetype) +\n                ggplot2::annotate(\n                    geom = 'text',\n                    x = 0,\n                    y =  pow,\n                    label = paste0('Power = ',  pow),\n                    vjust = -1,\n                    hjust = 0) +\n                geom_segment(\n                    x = min_n_power,\n                    xend = min_n_power,\n                    y = pow,\n                    yend = 0,\n                    color = segment_color,\n                    linetype = segment_linetype) +\n                ggplot2::annotate(\n                    geom = 'text',\n                    x = min_n_power, y = 0,\n                    label = paste0('n = ', prettyNum(min_n_power, big.mark = ',')),\n                    vjust = 1,\n                    hjust = -0.1)\n        }\n        p &lt;- p +\n            geom_path(\n                aes(y = power),\n                color = '#7570b3',\n                linetype = power_linetype)\n    }\n    if(plot_p) {\n        if(any(x$sig, na.rm = TRUE)) {\n            p &lt;- p +\n                geom_segment(\n                    x = 0,\n                    xend = min(x[x$sig,]$n, na.rm = TRUE),\n                    y = attr(x, 'sig_level'),\n                    yend = attr(x, 'sig_level'),\n                    color = segment_color,\n                    linetype = segment_linetype) +\n                ggplot2::annotate(\n                    geom = 'text',\n                    x = 0,\n                    y =  attr(x, 'sig_level'),\n                    label = paste0('p = ',  attr(x, 'sig_level')),\n                    vjust = -1,\n                    hjust = 0) +\n                geom_segment(\n                    x = min(x[x$sig,]$n, na.rm = TRUE),\n                    xend = min(x[x$sig,]$n, na.rm = TRUE),\n                    y = attr(x, 'sig_level'),\n                    yend = 0,\n                    color = segment_color,\n                    linetype = segment_linetype) +\n                ggplot2::annotate(\n                    geom = 'text',\n                    x = min(x[x$sig,]$n, na.rm = TRUE),\n                    y = 0,\n                    label = paste0('n = ', prettyNum(min(x[x$sig,]$n, na.rm = TRUE), big.mark = ',')),\n                    vjust = 1,\n                    hjust = -0.1)\n        }\n        p &lt;- p +\n            geom_path(\n                alpha = 0.7,\n                linetype = p_linetype)\n            # geom_point(aes(color = sig), size = 1) +\n            # scale_color_brewer(paste0('p &lt; ', attr(x, 'sig_level')), type = 'qual', palette = 6)\n    }\n\n    if(missing(title)) {\n        if(any(x$power &gt; pow, na.rm = TRUE) &amp; any(x$sig, na.rm = TRUE)) {\n            min_n &lt;- min(x[x$sig &amp; x$power &gt; pow,]$n, na.rm = TRUE)\n            title &lt;- paste0('Smallest n where p &lt; ', attr(x, 'sig_level'), ' and power &gt; ', pow, ': ',\n                            prettyNum(min_n, big.mark = ','))\n        } else {\n            title &lt;- paste0('No n found where p &lt; ', attr(x, 'sig_level'), ' and power &gt; ', pow)\n        }\n    }\n\n    p &lt;- p +\n        ylim(c(0, 1)) +\n        ylab('') +\n        xlab('Sample Size') +\n        ggtitle(title,\n                subtitle = paste0('Probabilities: ', paste0(round(attr(x, 'probs'), digits = digits), collapse = ', ')))\n\n    return(p)\n}</pre>\n</div>\n<p>Returning to our example above where the cell proportions are 33%, 25%, and 42%, we would need <img data-lazy-src=\"https://latex.codecogs.com/png.latex?n%20%5Cge%20130\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?n%20%5Cge%20130\"/></noscript> to reject the <em>null</em> hypothesis.</p>\n<div class=\"cell\">\n<pre>csp1 &lt;- chi_squared_power(probs =  c(.33, .25, .42))\ncsp1[csp1$sig,]$n |&gt; min(na.rm = TRUE) # Smallest n that results in p &lt; 0.05</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>[1] 130</pre>\n</div>\n<pre>plot(csp1)</pre>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/bryer.org/posts/2025-03-04-chi_squared_sample_sizes_files/figure-html/unnamed-chunk-5-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/bryer.org/posts/2025-03-04-chi_squared_sample_sizes_files/figure-html/unnamed-chunk-5-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n<p>In the next example we have much smaller differences between the cells with 25%, 25%, 24%, and 26%. In this example <img data-lazy-src=\"https://latex.codecogs.com/png.latex?n%20%5Cge%209,710\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?n%20%5Cge%209,710\"/></noscript> before rejecting the <em>null</em> hypothesis.</p>\n<div class=\"cell\">\n<pre>csp3 &lt;- chi_squared_power(probs = c(.25, .25, .24, .26), max_n = 20000)\ncsp3[csp3$sig,]$n |&gt; min(na.rm = TRUE) # Smallest n that results in p &lt; 0.05</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>[1] 9710</pre>\n</div>\n<pre>plot(csp3)</pre>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/bryer.org/posts/2025-03-04-chi_squared_sample_sizes_files/figure-html/unnamed-chunk-6-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/bryer.org/posts/2025-03-04-chi_squared_sample_sizes_files/figure-html/unnamed-chunk-6-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n<p>This function will work with two-dimensional data as well (i.e. across two variables). The following example from Agresti (2007) looks at the political affiliation across sex (see the help documentation for <code>chisq.test()</code>.).</p>\n<div class=\"cell\">\n<pre>M &lt;- as.table(rbind(c(762, 327, 468), c(484, 239, 477)))\ndimnames(M) &lt;- list(gender = c(\"Femal\", \"Male\"),\n                    party = c(\"Democrat\", \"Independent\", \"Republican\"))\nM</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>       party\ngender  Democrat Independent Republican\n  Femal      762         327        468\n  Male       484         239        477</pre>\n</div>\n<pre>sum(M)</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>[1] 2757</pre>\n</div>\n</div>\n<p>The chi-squared test suggests we should reject the <em>null</em> hypothesis test.</p>\n<div class=\"cell\">\n<pre>chisq.test(M)</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>\n    Pearson's Chi-squared test\n\ndata:  M\nX-squared = 30.07, df = 2, p-value = 2.954e-07</pre>\n</div>\n<pre>DescTools::CramerV(M) # Effect size</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>[1] 0.1044358</pre>\n</div>\n<pre>DescTools::power.chisq.test(n = sum(M),\n                            w = DescTools::CramerV(M),\n                            df = min(dim(M)) - 1,\n                            sig.level = 1 - sig_level)</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>\n     Chi squared power calculation \n\n              w = 0.1044358\n              n = 2757\n             df = 1\n      sig.level = 0.05\n          power = 0.9997872\n\nNOTE: n is the number of observations</pre>\n</div>\n</div>\n<p>Agresti had a sample size of 2757, but we can ask the question what is the minimum sample size would they need to detect statistical significance? First, we convert the counts to proportions, then we can use the <code>chi_squared_power()</code> function to find the minimum sample size to reject the <em>null</em> hypothesis test.</p>\n<div class=\"cell\">\n<pre>M_prob &lt;- M / sum(M) # Convert the counts to percentages\ncsp4 &lt;- chi_squared_power(probs = M_prob)\nplot(csp4)</pre>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/bryer.org/posts/2025-03-04-chi_squared_sample_sizes_files/figure-html/unnamed-chunk-9-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/bryer.org/posts/2025-03-04-chi_squared_sample_sizes_files/figure-html/unnamed-chunk-9-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n<p>For a more robust application for estimating power for many statistical tests, check out the <a href=\"https://cran.r-project.org/web/packages/pwrss/index.html\" rel=\"nofollow\" target=\"_blank\">pwsrr R package</a> and corresponding <a href=\"https://pwrss.shinyapps.io/index/\" rel=\"nofollow\" target=\"_blank\">Shiny application</a>.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://bryer.org/posts/2025-03-04-chi_squared_sample_sizes.html\"> Jason Bryer</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
    "main_text": "Sample size and statistical significance for chi-squared tests\nPosted on\nMarch 3, 2025\nby\nJason Bryer\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nJason Bryer\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nIn this post we are going to explore the relationship between sample size (\nn\n) and statistical significance for the chi-squared (\n) test. Recall that from the normal distribution, we construct a confidence interval using:\nwhere\nz\nis the test statistic and:\nwhere\ns\nis the sample standard deviation. Typically our\nnull\nis zero in which case we reject the\nnull\nhypothesis when the confidence does not span zero. If we wish to construct a 95% confidence interval, then\n. Assuming the sample standard deviation is constant regardless of sample size (a fair assumption), then as\nn\nincreases the standard error decreases. The following calculates the confidence interval for\nn\nranging from 10 to 400 assuming a sample standard deviation of 0.15 and 95% confidence level. When\nthen\n.\n# Define some parameters\nsig_level <- .95  # Significance level, 95% here\nes <- 0.15        # Effect size in standard units\nnull_val <- 0     # null value\n\n#' Calculate the standard error\n#' \n#' This function will calculate the standard error from a vector of observations or with a given\n#' sample standard deviation and sample size.\n#' \n#' @param x numeric vector of observations.\n#' @param sigma the sample standard deviation.\n#' @param n sample size.\nstandard_error <- function(x, sigma = sd(x), n = length(x)) {\n    if(!missing(x)) { # Some basic error checking\n        if(sigma != sd(x)) { warning('The sample standard deviation (sigma) is not equal to sd(x)')}\n        if(n != length(x)) { warning('The sample size (n) is not equal to length(x).' )}\n    }\n    return(sigma / sqrt(n))\n}\n# Create a data.frame with varying sample sizes and the corresponding standard error\ndf <- data.frame(\n    n = 10:400,\n    se = standard_error(sigma = 1, n = 10:400)\n)\ncv <- abs(qnorm((1 - sig_level) / 2)) # Critical value (z test statistic)\ndf$ci_low <- es - cv * df$se\ndf$ci_high <- es + cv * df$se\ndf$sig <- null_val < df$ci_low | null_val > df$ci_high\nmin_n <- df$n[df$sig] |> min()\nggplot(df, aes(x = n, y = se, color = sig)) + \n    geom_path() +\n    geom_point() +\n    scale_color_brewer(paste0('p < ', (1 - sig_level)), type = 'qual', palette = 6) +\n    ggtitle(paste0('Minumum n for p < ', (1 - sig_level), ': ', min_n),\n            subtitle = paste0('effect size: ', es, '; null value: ', null_val))\nThe chi-squared (\n) test statistic is defined as:\nwhere\nO\nis the observed count and\nE\nis the expected count. Unlike the standard error for numerical data,\nn\nis not explicitly in the formula and therefore makes it a bit more challenging to determine the impact sample size has rejecting the\nnull\nhypothesis. Moreover, since the chi-squared is calculated from the cell counts in a table of varying length and dimension (one- or two-dimensions specifically) determining how\nn\nimpacts rejecting the\nnull\nor not requires more parameters.\nAnswering the question of how large does\nn\nneed to be to detect a statistically significant result (i.e. to reject the\nnull\nhypothesis) is refereed to as\npower\n. Whereas for calculating the power for numerical data had one parameter, the sample standard deviation, here we need to consider the proportion of observations within different cells. For example, consider we have a variable with three levels and we expect the proportion of observations in the three groups to be 33%, 25%, and 42%, respectively. If our sample size is 100 then we expect there to be 33, 25, and 42 and observations for the three categories. This function will, for varying sample sizes, calculate the counts for the categories to achieve that sample size, estimate the chi-squared statistic and record the\np\n-value. There are other parameters that are documented below. A\nplot\nfunction is also defined using the\nS3 objected oriented framework\n.\n#' Calculate p-value from a chi-squared test with varying sample sizes\n#'\n#' This algorithm will start with an initial sample size (`n_start`) and perform a chi-squared test\n#' with a vector of counts equal to `n * probs`. This will repeat increasing the sample size by\n#' `n_step` until the p-value from the chi-squared test is less than `p_stop`.\n#'\n#' @param vector of cell probabilities. The sum of the values must equal 1.\n#' @param sig_level significance level.\n#' @param p_stop the p-value to stop estimating chi-squared tests.\n#' @param max_n maximum n to attempt if `p_value` is never less than `p_stop`.\n#' @param min_cell_size minimum size per cell to perform the chi-square test.\n#' @param n_start the starting sample size.\n#' @param n_step the increment for each iteration.\n#' @return a data.frame with three columns: n (sample size), p_value, and sig (TRUE if\n#'         p_value < sig_level).\n#' @importFrom DescTools power.chisq.test CramerV\nchi_squared_power <- function(\n        probs,\n        sig_level = 0.05,\n        p_stop = 0.01,\n        power = 0.80,\n        power_stop = 0.90,\n        max_n = 100000,\n        min_cell_size = 10,\n        n_start = 10,\n        n_step = 10\n) {\n    if(sum(probs) != 1) { # Make sure the sum is equal to 1\n        stop('The sum of the probabilities must equal 1.')\n    } else if(length(unique(probs)) == 1) {\n        stop('All the probabilities are equal.')\n    }\n\n    n <- n_start\n    p_values <- numeric()\n    power_values <- numeric()\n    df <- ifelse(is.vector(probs),\n                 length(probs) - 1,\n                 min(dim(probs)) - 1) # Degrees of freedom\n    repeat {\n        x <- (probs * n) |> round()\n        if(all(x > min_cell_size)) {\n            cs <- chisq.test(x, rescale.p = TRUE, simulate.p.value = FALSE)\n            p_values[n / n_step] <- cs$p.value\n            pow <- DescTools::power.chisq.test(\n                n = n,\n                w = DescTools::CramerV(as.table(x)),\n                df = df,\n                sig.level = sig_level\n            )\n            power_values[n / n_step] <- pow$power\n            if((cs$p.value < p_stop & pow$power > power_stop) | n > max_n) {\n                break;\n            }\n        } else {\n            p_values[n / n_step] <- NA\n            power_values[n / n_step] <- NA\n        }\n        n <- n + n_step\n    }\n    result <- data.frame(n = seq(10, length(p_values) * n_step, n_step),\n                         p_value = p_values,\n                         sig = p_values < sig_level,\n                         power = power_values)\n    class(result) <- c('chisqpower', 'data.frame')\n    attr(result, 'probs') <- probs\n    attr(result, 'sig_level') <- sig_level\n    attr(result, 'p_stop') <- p_stop\n    attr(result, 'power') <- power\n    attr(result, 'power_stop') <- power_stop\n    attr(result, 'max_n') <- max_n\n    attr(result, 'n_step') <- n_step\n    return(result)\n}\n\n#' Plot the results of chi-squared power estimation\n#'\n#' @param x result of [chi_squared_power()].\n#' @param plot_power whether to plot the power curve.\n#' @param plot_p whether to plot p-values.\n#' @param digits number of digits to round to.\n#' @param segement_color color of the lines marking where power and p values exceed threshold.\n#' @param sgement_linetype linetype of the lines marking where power and p values exceed threshold.\n#' @param p_linetype linetype for the p-values.\n#' @param power_linetype linetype for the power values.\n#' @param title plot title. If missing a title will be automatically generated.\n#' @parma ... currently not used.\n#' @return a ggplot2 expression.\nplot.chisqpower <- function(\n        x,\n        plot_power = TRUE,\n        plot_p = TRUE,\n        digits = 4,\n        segment_color = 'grey60',\n        segment_linetype = 1,\n        p_linetype = 1,\n        power_linetype = 2,\n        title,\n        ...\n) {\n    pow <- attr(x, 'power')\n\n    p <- ggplot(x[!is.na(x$p_value),], aes(x = n, y = p_value))\n\n    if(plot_power) {\n        if(any(x$power > pow, na.rm = TRUE)) {\n            min_n_power <- min(x[x$power > pow,]$n, na.rm = TRUE)\n            p <- p +\n                geom_segment(\n                    x = 0,\n                    xend = min_n_power,\n                    y = pow,\n                    yend = pow,\n                    color = segment_color,\n                    linetype = segment_linetype) +\n                ggplot2::annotate(\n                    geom = 'text',\n                    x = 0,\n                    y =  pow,\n                    label = paste0('Power = ',  pow),\n                    vjust = -1,\n                    hjust = 0) +\n                geom_segment(\n                    x = min_n_power,\n                    xend = min_n_power,\n                    y = pow,\n                    yend = 0,\n                    color = segment_color,\n                    linetype = segment_linetype) +\n                ggplot2::annotate(\n                    geom = 'text',\n                    x = min_n_power, y = 0,\n                    label = paste0('n = ', prettyNum(min_n_power, big.mark = ',')),\n                    vjust = 1,\n                    hjust = -0.1)\n        }\n        p <- p +\n            geom_path(\n                aes(y = power),\n                color = '#7570b3',\n                linetype = power_linetype)\n    }\n    if(plot_p) {\n        if(any(x$sig, na.rm = TRUE)) {\n            p <- p +\n                geom_segment(\n                    x = 0,\n                    xend = min(x[x$sig,]$n, na.rm = TRUE),\n                    y = attr(x, 'sig_level'),\n                    yend = attr(x, 'sig_level'),\n                    color = segment_color,\n                    linetype = segment_linetype) +\n                ggplot2::annotate(\n                    geom = 'text',\n                    x = 0,\n                    y =  attr(x, 'sig_level'),\n                    label = paste0('p = ',  attr(x, 'sig_level')),\n                    vjust = -1,\n                    hjust = 0) +\n                geom_segment(\n                    x = min(x[x$sig,]$n, na.rm = TRUE),\n                    xend = min(x[x$sig,]$n, na.rm = TRUE),\n                    y = attr(x, 'sig_level'),\n                    yend = 0,\n                    color = segment_color,\n                    linetype = segment_linetype) +\n                ggplot2::annotate(\n                    geom = 'text',\n                    x = min(x[x$sig,]$n, na.rm = TRUE),\n                    y = 0,\n                    label = paste0('n = ', prettyNum(min(x[x$sig,]$n, na.rm = TRUE), big.mark = ',')),\n                    vjust = 1,\n                    hjust = -0.1)\n        }\n        p <- p +\n            geom_path(\n                alpha = 0.7,\n                linetype = p_linetype)\n            # geom_point(aes(color = sig), size = 1) +\n            # scale_color_brewer(paste0('p < ', attr(x, 'sig_level')), type = 'qual', palette = 6)\n    }\n\n    if(missing(title)) {\n        if(any(x$power > pow, na.rm = TRUE) & any(x$sig, na.rm = TRUE)) {\n            min_n <- min(x[x$sig & x$power > pow,]$n, na.rm = TRUE)\n            title <- paste0('Smallest n where p < ', attr(x, 'sig_level'), ' and power > ', pow, ': ',\n                            prettyNum(min_n, big.mark = ','))\n        } else {\n            title <- paste0('No n found where p < ', attr(x, 'sig_level'), ' and power > ', pow)\n        }\n    }\n\n    p <- p +\n        ylim(c(0, 1)) +\n        ylab('') +\n        xlab('Sample Size') +\n        ggtitle(title,\n                subtitle = paste0('Probabilities: ', paste0(round(attr(x, 'probs'), digits = digits), collapse = ', ')))\n\n    return(p)\n}\nReturning to our example above where the cell proportions are 33%, 25%, and 42%, we would need\nto reject the\nnull\nhypothesis.\ncsp1 <- chi_squared_power(probs =  c(.33, .25, .42))\ncsp1[csp1$sig,]$n |> min(na.rm = TRUE) # Smallest n that results in p < 0.05\n[1] 130\nplot(csp1)\nIn the next example we have much smaller differences between the cells with 25%, 25%, 24%, and 26%. In this example\nbefore rejecting the\nnull\nhypothesis.\ncsp3 <- chi_squared_power(probs = c(.25, .25, .24, .26), max_n = 20000)\ncsp3[csp3$sig,]$n |> min(na.rm = TRUE) # Smallest n that results in p < 0.05\n[1] 9710\nplot(csp3)\nThis function will work with two-dimensional data as well (i.e. across two variables). The following example from Agresti (2007) looks at the political affiliation across sex (see the help documentation for\nchisq.test()\n.).\nM <- as.table(rbind(c(762, 327, 468), c(484, 239, 477)))\ndimnames(M) <- list(gender = c(\"Femal\", \"Male\"),\n                    party = c(\"Democrat\", \"Independent\", \"Republican\"))\nM\nparty\ngender  Democrat Independent Republican\n  Femal      762         327        468\n  Male       484         239        477\nsum(M)\n[1] 2757\nThe chi-squared test suggests we should reject the\nnull\nhypothesis test.\nchisq.test(M)\nPearson's Chi-squared test\n\ndata:  M\nX-squared = 30.07, df = 2, p-value = 2.954e-07\nDescTools::CramerV(M) # Effect size\n[1] 0.1044358\nDescTools::power.chisq.test(n = sum(M),\n                            w = DescTools::CramerV(M),\n                            df = min(dim(M)) - 1,\n                            sig.level = 1 - sig_level)\nChi squared power calculation \n\n              w = 0.1044358\n              n = 2757\n             df = 1\n      sig.level = 0.05\n          power = 0.9997872\n\nNOTE: n is the number of observations\nAgresti had a sample size of 2757, but we can ask the question what is the minimum sample size would they need to detect statistical significance? First, we convert the counts to proportions, then we can use the\nchi_squared_power()\nfunction to find the minimum sample size to reject the\nnull\nhypothesis test.\nM_prob <- M / sum(M) # Convert the counts to percentages\ncsp4 <- chi_squared_power(probs = M_prob)\nplot(csp4)\nFor a more robust application for estimating power for many statistical tests, check out the\npwsrr R package\nand corresponding\nShiny application\n.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nJason Bryer\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "In this post we are going to explore the relationship between sample size (n) and statistical significance for the chi-squared () test. Recall that from the normal distribution, we construct a confidence interval using: where z is the test stati...",
    "meta_keywords": null,
    "og_description": "In this post we are going to explore the relationship between sample size (n) and statistical significance for the chi-squared () test. Recall that from the normal distribution, we construct a confidence interval using: where z is the test stati...",
    "og_image": "https://latex.codecogs.com/png.latex?%5Cchi%5E2",
    "og_title": "Sample size and statistical significance for chi-squared tests | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 9.4,
    "sitemap_lastmod": null,
    "twitter_description": "In this post we are going to explore the relationship between sample size (n) and statistical significance for the chi-squared () test. Recall that from the normal distribution, we construct a confidence interval using: where z is the test stati...",
    "twitter_title": "Sample size and statistical significance for chi-squared tests | R-bloggers",
    "url": "https://www.r-bloggers.com/2025/03/sample-size-and-statistical-significance-for-chi-squared-tests/",
    "word_count": 1887
  }
}