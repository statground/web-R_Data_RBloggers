{
  "uuid": "43af0c2f-c752-4140-92f2-b66c003b8aad",
  "created_at": "2025-11-22 19:57:34",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2025/10/adding-random-transport-links-to-a-2d-growth-model/",
    "crawled_at": "2025-11-22T10:42:22.412089",
    "external_links": [
      {
        "href": "https://datascienceconfidential.github.io/economics/r/javascript/fermi-estimation/2025/10/02/2d-growth-model.html",
        "text": "datascienceconfidential - r"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://www.researchgate.net/publication/268022690_Population_dynamics_in_a_spatial_Solow_model_with_a_convex-concave_production_function",
        "text": "paper"
      },
      {
        "href": "https://www.amazon.com/Price-Time-Real-Story-Interest/dp/0802160069",
        "text": "The Price of Time"
      },
      {
        "href": "https://datascienceconfidential.github.io/economics/r/javascript/fermi-estimation/2025/10/02/2d-growth-model.html#myfootnote1",
        "text": "1"
      },
      {
        "href": "https://www.animasmuseum.org/online_exhibits/JoyCabin/animas_city.html",
        "text": "Animas City, Colorado"
      },
      {
        "href": "https://www.pbs.org/wgbh/americanexperience/features/grant-panic",
        "text": "According to PBS"
      },
      {
        "href": "https://www.cambridge.org/core/journals/journal-of-economic-history/article/abs/internal-migration-in-the-united-states-rates-selection-and-destination-choice-18501940/1B6567FF34E66FBDF45791BF64B6DDBB",
        "text": "this paper"
      },
      {
        "href": "https://en.wikipedia.org/wiki/Cluedo",
        "text": "Cluedo"
      },
      {
        "href": "https://datascienceconfidential.github.io/economics/r/javascript/fermi-estimation/2025/10/02/2d-growth-model.html",
        "text": "datascienceconfidential - r"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Adding random transport links to a 2D growth model | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/datascienceconfidential.github.io/blog/images/2025/railroad_sims.png?w=578&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/datascienceconfidential-r/",
        "text": "datascienceconfidential - r"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-395838 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Adding random transport links to a 2D growth model</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">October 1, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/datascienceconfidential-r/\">datascienceconfidential - r</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://datascienceconfidential.github.io/economics/r/javascript/fermi-estimation/2025/10/02/2d-growth-model.html\"> datascienceconfidential - r</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47--><p>This post is about economic growth in a region in which labour is free to move around.</p>\n<p>A colleague recently showed me a <a href=\"https://www.researchgate.net/publication/268022690_Population_dynamics_in_a_spatial_Solow_model_with_a_convex-concave_production_function\" rel=\"nofollow\" target=\"_blank\">paper</a> by Capasso, Engbers and La Torre which describes an extension of the Solow growth model in which a spatial element is added. It seemed to me that the model could be extended in various ways. Most interestingly, the paper only gave an example in which capital and labour move around in a one-dimensional latent space, but I thought it would be more interesting if the space was two-dimensional.</p>\n<p>A book called <a href=\"https://www.amazon.com/Price-Time-Real-Story-Interest/dp/0802160069\" rel=\"nofollow\" target=\"_blank\"><em>The Price of Time</em></a> by Edwin Chancellor describes many of the unintended negative consequences of low interest rates, one of which is investment being directed to infrastructure projects which appear to “go nowhere” (think of railways in the 19th century US or 2010s China). I decided to use the Capasso et al model to study the effects of randomly building transport infrastructure. The basic idea is that if a country’s development is modelled by a process in which capital and labour are trying to reach the same location, then any infrastructure will probably speed up growth. But by how much? I want to get a qualitative estimate of that.</p>\n<h1 id=\"model\">Model</h1>\n<p>The model takes place on a domain $\\Omega \\subset \\mathbb{R}^n$. At each point $x \\in \\Omega$ and each time $t$, there is a quantity of capital $K(x,t)$ and labour $L(x,t)$. There is a production function $F$ describing how more capital is produced from labour and capital. I will assume that $F$ is the same everywhere. In other words, there’s an industry of sorts at every point of $\\Omega$.</p>\n<h2 id=\"motion-of-capital\">Motion of Capital</h2>\n<p>Capital evolves in space and time according to the equation</p>\n\n\\[\\frac{\\partial K}{\\partial t}(x,t) = e\\nabla^2 K(x,t) -\\delta K(x,t) + Y(x,t)\\]\n\n<p>where $Y(x,t) = F(K(x,t), L(x,t))$ is output. Here, $e$ is the (exogenous) coefficient of diffusion and $\\delta$ is (exogenous) depreciation.</p>\n<p>This is a version of the heat equation. If $F = 0$ then capital will slowly diffuse through the domain $\\Omega$ until the value of $K$ is the same everywhere, like in the following picture.</p>\n\n<div>\n<canvas height=\"320\" id=\"gridCanvas\" style=\"border:1px solid black;display: block; margin: 0 auto;\" width=\"320\"></canvas>\n</div>\n<h2 id=\"motion-of-labour\">Motion of Labour</h2>\n<p>In the Capasso et al model, labour diffuses in the same way as capital. But what if we assume that labour moves towards the direction of the highest wages?</p>\n<p>Let’s assume that labour is paid its marginal product $w(x,t) = \\frac{\\partial F}{\\partial L}$ and that it moves in the direction of increasing $w$, so we have something like</p>\n\n\\[\\frac{\\partial L}{\\partial t}(x,t) = m\\nabla \\cdot (L(x,t)\\nabla w(x,t)) + gL(x,t)\\]\n\n<p>where $m$ is a diffusion coefficient and $g$ is an exogenous growth rate. In other words, a proportion $m$ of the labour force will migrate in the direction in which the wages are highest.</p>\n<h1 id=\"simulation\">Simulation</h1>\n<p>Now let’s stop pretending that time and space are continuous. The following describes what I actually coded<sup><a href=\"https://datascienceconfidential.github.io/economics/r/javascript/fermi-estimation/2025/10/02/2d-growth-model.html#myfootnote1\" rel=\"nofollow\" target=\"_blank\">1</a></sup>. Assume that time proceeds in discrete steps $t=0, 1, 2, \\dots$ and that the domain $\\Omega$ is a graph. At time step $t$, the model evolves in the following way:</p>\n<ul>\n<li>At each vertex $x$, a proportion $e$ of the current value of capital $K(x)$ is distributed equally among the neighbours of $x$.</li>\n<li>At each vertex $x$, a proportion $m$ of the current value of labour $L(x)$ moves to the node in ${x}\\cup{\\text{neighbours of } x}$ with highest wage. If there is a tie for highest, it is distributed equally among the tied nodes.</li>\n<li>At each vertex $x$, $K(x)$ is incremented by production minus depreciation and $L(x)$ increases by a factor of $(1+g)$.</li>\n</ul>\n<p>If you run the model on a grid and start by drawing labour and capital from a uniform distribution, you will see a sort of self-organisation. Labour and capital accumulate into “towns” where there is a relatively high level of production.</p>\n<h2 id=\"capital\">Capital</h2>\n<div>\n<canvas height=\"320\" id=\"CanvasK\" style=\"border:1px solid black;display: block; margin: 0 auto;\" width=\"320\"></canvas>\n</div>\n<h2 id=\"labour\">Labour</h2>\n<div>\n<canvas height=\"320\" id=\"CanvasL\" style=\"border:1px solid black;display: block; margin: 0 auto;\" width=\"320\"></canvas>\n</div>\n<p><br/><br/></p>\n<p>Here. I used the Cobb-Douglas production function with $TFP = 1$ and $\\alpha = 1/3$. Capasso et al chose to use a different production function. The choice of Cobb-Douglas means that growth is unlimited and eventually the spatial distribution of capital and labour will become uniform. I’m really interested in the rate of growth of aggregate output $Y$ where</p>\n\n\\[Y(t) = \\int_\\Omega Y(x, t) dx.\\]\n\n<p>The graph below shows how $Y(t)$ grows in the simulation above, starting with a random distribution of capital and labour.</p>\n<div>\n<canvas height=\"320\" id=\"CanvasYLine\" style=\"border:1px solid black;display: block; margin: 0 auto;\" width=\"320\"></canvas>\n</div>\n<h1 id=\"adding-infrastructure\">Adding Infrastructure</h1>\n<p>You can add transportation to the model by adding connections between nodes which weren’t previously connected. For example, here’s what happens to the pattern of capital if you add a “railway line” down the diagonal of the grid which makes all the points on the diagonal adjacent to each other.</p>\n<div>\n<canvas height=\"320\" id=\"CanvasRailway\" style=\"border:1px solid black;display: block; margin: 0 auto;\" width=\"320\"></canvas>\n</div>\n<p><br/><br/></p>\n\n<p>Regardless of the initial distribution of labour and capital, the nodes with high adjacency end up having very high relative output. Interestingly, nodes <em>next</em> to nodes with high adjacency end up with lower than average output, even though the model has the property that capital is supposed to trickle outwards due to the $\\nabla^2 K$ term. You are better off being in the hinterland than being near, but not in, an area which is connected to a lot of infrastructure. There are real-world reflections of this in places such as <a href=\"https://www.animasmuseum.org/online_exhibits/JoyCabin/animas_city.html\" rel=\"nofollow\" target=\"_blank\">Animas City, Colorado</a> which became a ghost town after being bypassed by a railroad which went through Durango, two miles to the south, so it makes some sense.</p>\n<h1 id=\"example-the-us-railroad-boom\">Example: the US Railroad Boom</h1>\n<p>Speaking of Colorado, we can try to use this model to estimate how much the railroad boom in the US contributed to growth.</p>\n<p>In the 19th century the US experienced a period of railroad mania. <a href=\"https://www.pbs.org/wgbh/americanexperience/features/grant-panic\" rel=\"nofollow\" target=\"_blank\">According to PBS</a> there were 364 railroads by the time of the Panic of 1873.</p>\n<p>Let’s make some wild estimates. Assume that the US is a $10 \\times 20$ rectangle (the numbers are chosen to make the simulation run quickly). According to <a href=\"https://www.cambridge.org/core/journals/journal-of-economic-history/article/abs/internal-migration-in-the-united-states-rates-selection-and-destination-choice-18501940/1B6567FF34E66FBDF45791BF64B6DDBB\" rel=\"nofollow\" target=\"_blank\">this paper</a> $33\\%$ of people migrated inter-county per decade, and according to various sources it took about six months to cross the US prior to the development of railroads. Therefore, labour should be able to move about 40 grid squares in a year, so we need to take each time step to be $1/40$ of a year, and then the migration rate $m$ should be $1/40 \\times 0.33/10$. Assuming that capital goods were difficult to transport, we’ll take $e=0$. We also assume an annual capital depreciation rate of $0.1$.</p>\n<p>If we start in 1830 with the founding of the Baltimore and Ohio Railroad, the model needs to run for 43 years. The population basically tripled between 1830 and 1873, so we should take an appropriate value of $g$.</p>\n<p>In the following R code, we run two models. <code>model0</code> has no railroads. In <code>model1</code>, railroads are added at regular intervals by joining pairs of random nodes (like the secret passages in <a href=\"https://en.wikipedia.org/wiki/Cluedo\" rel=\"nofollow\" target=\"_blank\"><em>Cluedo</em></a>) so that they become adjacent. We can then calculate the aggregate output of the two models at the end of the simulation and divide one by the other to get the factor by which the presence of the railroads has increased or decreased output.</p>\n<pre>simulate_us &lt;- function(M=10, N=20, years=43, rr_count=364){\n  \n  # number of iterations\n  its &lt;- 2 * N * years\n  \n  m &lt;- 0.33/(10*2*N)\n  e &lt;- 0 \n  g &lt;- 3^(1/its) - 1\n  delta &lt;- 0.1 / years / (2*N)\n  K &lt;- matrix(runif(M*N), nr=M)\n  L &lt;- matrix(runif(M*N), nr=M)\n  A &lt;- 1\n  alpha &lt;- 1/3\n  adjacency &lt;- make_grid(M, N)\n  \n  model0 &lt;- model1 &lt;- make_model(M, N, K, e, m, delta, g, L, adjacency, A, alpha)\n  out &lt;- list()\n  \n  for (i in 1:its){\n    model0 &lt;- update(model0)\n    model1 &lt;- update(model1)\n\n    if (!(i %% floor(its/rr_count))){\n      # add a connection to model1\n      x1 &lt;- x2 &lt;- sample(1:M, 1)\n      y1 &lt;- y2 &lt;- sample(1:N, 1)\n      while((x1==x2) &amp; (y1==y2)){\n        x2 &lt;- sample(1:M, 1)\n        y2 &lt;- sample(1:N, 1)\n      }\n      model1$adjacency &lt;- add_connection(model1$adjacency, x1, y1, x2, y2)\n    }\n    out[[i]] &lt;- list(model0=model0,\n                     model1=model1,\n                     Y0 = model0$production_function(model0$K, model0$L,\n    model0$A, model0$alpha), \n                     Y1 = model1$production_function(model1$K, model1$L,\n     model1$A, model1$alpha))\n  }\n  out\n}\n</pre>\n<p>The graph below shows the result of doing the whole simulation 100 times. Adding the railways increased aggregate output at the end of the period by about 20% compared to the no-railway scenario.</p>\n<pre>set.seed(1873)\nsims &lt;- rep(0, 100)\nfor (i in 1:100){\n  sim1 &lt;- simulate_us(M=10, N=20)\n  sims[i] &lt;- unlist(lapply(sim1, function(x) sum(x$Y1)))[1720]/\n    (unlist(lapply(sim1, function(x) sum(x$Y0))))[1720]\n}\n</pre>\n<div style=\"width:85%; margin:0 auto;\">\n<img data-lazy-src=\"https://i1.wp.com/datascienceconfidential.github.io/blog/images/2025/railroad_sims.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img data-recalc-dims=\"1\" src=\"https://i1.wp.com/datascienceconfidential.github.io/blog/images/2025/railroad_sims.png?w=578&amp;ssl=1\"/></noscript>\n</div>\n<p>That all seems quite reasonable, but the fact that the numbers come out nicely here is largely an artifact of the choice of a $10\\times 20$ grid. You can check this by running the simulation on grids of different sizes. If you double the size of the grid, you won’t find any increase in output when adding railways. So what’s going on?</p>\n<p>It turns out that the choice of grid size in the above example is just enough to make it very likely that two nodes will become connected in such a way that there is a big boost to growth. If you make the grid larger, then the number of possible random connections grows so large that this becomes less likely to happen. The reason why random infrastructure seems to be boosting growth is because we’ve set things up in such a way that random infrastructure is likely to be useful just  by chance.</p>\n<p>This sort-of shows that my original idea was wrong. I had the idea that adding random connections to this model might make it easier for labour to move around and thus to reach areas with a large amount of capital. But in fact, if you put in semi-realistic numbers, the random connections only help if there’s a large chance that they happen to be built in the right places. So my initial idea of showing that vanity projects or “railways to nowhere” can contribute to economic growth is probably wrong.</p>\n<p>However, I still think this model is quite interesting and could be used for other things. That’s all for today! I’m off to see whether I can sell my labour to the owner of some capital.</p>\n<hr/>\n<p><a name=\"myfootnote1\">1</a>: I’m honestly not 100% sure that it matches the continuous model described in the previous section. I included the continuous version for easy comparison with the paper of Capasso et al.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://datascienceconfidential.github.io/economics/r/javascript/fermi-estimation/2025/10/02/2d-growth-model.html\"> datascienceconfidential - r</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
    "main_text": "Adding random transport links to a 2D growth model\nPosted on\nOctober 1, 2025\nby\ndatascienceconfidential - r\nin\nR bloggers\n| 0 Comments\n[This article was first published on\ndatascienceconfidential - r\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nThis post is about economic growth in a region in which labour is free to move around.\nA colleague recently showed me a\npaper\nby Capasso, Engbers and La Torre which describes an extension of the Solow growth model in which a spatial element is added. It seemed to me that the model could be extended in various ways. Most interestingly, the paper only gave an example in which capital and labour move around in a one-dimensional latent space, but I thought it would be more interesting if the space was two-dimensional.\nA book called\nThe Price of Time\nby Edwin Chancellor describes many of the unintended negative consequences of low interest rates, one of which is investment being directed to infrastructure projects which appear to “go nowhere” (think of railways in the 19th century US or 2010s China). I decided to use the Capasso et al model to study the effects of randomly building transport infrastructure. The basic idea is that if a country’s development is modelled by a process in which capital and labour are trying to reach the same location, then any infrastructure will probably speed up growth. But by how much? I want to get a qualitative estimate of that.\nModel\nThe model takes place on a domain $\\Omega \\subset \\mathbb{R}^n$. At each point $x \\in \\Omega$ and each time $t$, there is a quantity of capital $K(x,t)$ and labour $L(x,t)$. There is a production function $F$ describing how more capital is produced from labour and capital. I will assume that $F$ is the same everywhere. In other words, there’s an industry of sorts at every point of $\\Omega$.\nMotion of Capital\nCapital evolves in space and time according to the equation\n\\[\\frac{\\partial K}{\\partial t}(x,t) = e\\nabla^2 K(x,t) -\\delta K(x,t) + Y(x,t)\\]\nwhere $Y(x,t) = F(K(x,t), L(x,t))$ is output. Here, $e$ is the (exogenous) coefficient of diffusion and $\\delta$ is (exogenous) depreciation.\nThis is a version of the heat equation. If $F = 0$ then capital will slowly diffuse through the domain $\\Omega$ until the value of $K$ is the same everywhere, like in the following picture.\nMotion of Labour\nIn the Capasso et al model, labour diffuses in the same way as capital. But what if we assume that labour moves towards the direction of the highest wages?\nLet’s assume that labour is paid its marginal product $w(x,t) = \\frac{\\partial F}{\\partial L}$ and that it moves in the direction of increasing $w$, so we have something like\n\\[\\frac{\\partial L}{\\partial t}(x,t) = m\\nabla \\cdot (L(x,t)\\nabla w(x,t)) + gL(x,t)\\]\nwhere $m$ is a diffusion coefficient and $g$ is an exogenous growth rate. In other words, a proportion $m$ of the labour force will migrate in the direction in which the wages are highest.\nSimulation\nNow let’s stop pretending that time and space are continuous. The following describes what I actually coded\n1\n. Assume that time proceeds in discrete steps $t=0, 1, 2, \\dots$ and that the domain $\\Omega$ is a graph. At time step $t$, the model evolves in the following way:\nAt each vertex $x$, a proportion $e$ of the current value of capital $K(x)$ is distributed equally among the neighbours of $x$.\nAt each vertex $x$, a proportion $m$ of the current value of labour $L(x)$ moves to the node in ${x}\\cup{\\text{neighbours of } x}$ with highest wage. If there is a tie for highest, it is distributed equally among the tied nodes.\nAt each vertex $x$, $K(x)$ is incremented by production minus depreciation and $L(x)$ increases by a factor of $(1+g)$.\nIf you run the model on a grid and start by drawing labour and capital from a uniform distribution, you will see a sort of self-organisation. Labour and capital accumulate into “towns” where there is a relatively high level of production.\nCapital\nLabour\nHere. I used the Cobb-Douglas production function with $TFP = 1$ and $\\alpha = 1/3$. Capasso et al chose to use a different production function. The choice of Cobb-Douglas means that growth is unlimited and eventually the spatial distribution of capital and labour will become uniform. I’m really interested in the rate of growth of aggregate output $Y$ where\n\\[Y(t) = \\int_\\Omega Y(x, t) dx.\\]\nThe graph below shows how $Y(t)$ grows in the simulation above, starting with a random distribution of capital and labour.\nAdding Infrastructure\nYou can add transportation to the model by adding connections between nodes which weren’t previously connected. For example, here’s what happens to the pattern of capital if you add a “railway line” down the diagonal of the grid which makes all the points on the diagonal adjacent to each other.\nRegardless of the initial distribution of labour and capital, the nodes with high adjacency end up having very high relative output. Interestingly, nodes\nnext\nto nodes with high adjacency end up with lower than average output, even though the model has the property that capital is supposed to trickle outwards due to the $\\nabla^2 K$ term. You are better off being in the hinterland than being near, but not in, an area which is connected to a lot of infrastructure. There are real-world reflections of this in places such as\nAnimas City, Colorado\nwhich became a ghost town after being bypassed by a railroad which went through Durango, two miles to the south, so it makes some sense.\nExample: the US Railroad Boom\nSpeaking of Colorado, we can try to use this model to estimate how much the railroad boom in the US contributed to growth.\nIn the 19th century the US experienced a period of railroad mania.\nAccording to PBS\nthere were 364 railroads by the time of the Panic of 1873.\nLet’s make some wild estimates. Assume that the US is a $10 \\times 20$ rectangle (the numbers are chosen to make the simulation run quickly). According to\nthis paper\n$33\\%$ of people migrated inter-county per decade, and according to various sources it took about six months to cross the US prior to the development of railroads. Therefore, labour should be able to move about 40 grid squares in a year, so we need to take each time step to be $1/40$ of a year, and then the migration rate $m$ should be $1/40 \\times 0.33/10$. Assuming that capital goods were difficult to transport, we’ll take $e=0$. We also assume an annual capital depreciation rate of $0.1$.\nIf we start in 1830 with the founding of the Baltimore and Ohio Railroad, the model needs to run for 43 years. The population basically tripled between 1830 and 1873, so we should take an appropriate value of $g$.\nIn the following R code, we run two models.\nmodel0\nhas no railroads. In\nmodel1\n, railroads are added at regular intervals by joining pairs of random nodes (like the secret passages in\nCluedo\n) so that they become adjacent. We can then calculate the aggregate output of the two models at the end of the simulation and divide one by the other to get the factor by which the presence of the railroads has increased or decreased output.\nsimulate_us <- function(M=10, N=20, years=43, rr_count=364){\n  \n  # number of iterations\n  its <- 2 * N * years\n  \n  m <- 0.33/(10*2*N)\n  e <- 0 \n  g <- 3^(1/its) - 1\n  delta <- 0.1 / years / (2*N)\n  K <- matrix(runif(M*N), nr=M)\n  L <- matrix(runif(M*N), nr=M)\n  A <- 1\n  alpha <- 1/3\n  adjacency <- make_grid(M, N)\n  \n  model0 <- model1 <- make_model(M, N, K, e, m, delta, g, L, adjacency, A, alpha)\n  out <- list()\n  \n  for (i in 1:its){\n    model0 <- update(model0)\n    model1 <- update(model1)\n\n    if (!(i %% floor(its/rr_count))){\n      # add a connection to model1\n      x1 <- x2 <- sample(1:M, 1)\n      y1 <- y2 <- sample(1:N, 1)\n      while((x1==x2) & (y1==y2)){\n        x2 <- sample(1:M, 1)\n        y2 <- sample(1:N, 1)\n      }\n      model1$adjacency <- add_connection(model1$adjacency, x1, y1, x2, y2)\n    }\n    out[[i]] <- list(model0=model0,\n                     model1=model1,\n                     Y0 = model0$production_function(model0$K, model0$L,\n    model0$A, model0$alpha), \n                     Y1 = model1$production_function(model1$K, model1$L,\n     model1$A, model1$alpha))\n  }\n  out\n}\nThe graph below shows the result of doing the whole simulation 100 times. Adding the railways increased aggregate output at the end of the period by about 20% compared to the no-railway scenario.\nset.seed(1873)\nsims <- rep(0, 100)\nfor (i in 1:100){\n  sim1 <- simulate_us(M=10, N=20)\n  sims[i] <- unlist(lapply(sim1, function(x) sum(x$Y1)))[1720]/\n    (unlist(lapply(sim1, function(x) sum(x$Y0))))[1720]\n}\nThat all seems quite reasonable, but the fact that the numbers come out nicely here is largely an artifact of the choice of a $10\\times 20$ grid. You can check this by running the simulation on grids of different sizes. If you double the size of the grid, you won’t find any increase in output when adding railways. So what’s going on?\nIt turns out that the choice of grid size in the above example is just enough to make it very likely that two nodes will become connected in such a way that there is a big boost to growth. If you make the grid larger, then the number of possible random connections grows so large that this becomes less likely to happen. The reason why random infrastructure seems to be boosting growth is because we’ve set things up in such a way that random infrastructure is likely to be useful just  by chance.\nThis sort-of shows that my original idea was wrong. I had the idea that adding random connections to this model might make it easier for labour to move around and thus to reach areas with a large amount of capital. But in fact, if you put in semi-realistic numbers, the random connections only help if there’s a large chance that they happen to be built in the right places. So my initial idea of showing that vanity projects or “railways to nowhere” can contribute to economic growth is probably wrong.\nHowever, I still think this model is quite interesting and could be used for other things. That’s all for today! I’m off to see whether I can sell my labour to the owner of some capital.\n1\n: I’m honestly not 100% sure that it matches the continuous model described in the previous section. I included the continuous version for easy comparison with the paper of Capasso et al.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\ndatascienceconfidential - r\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "This post is about economic growth in a region in which labour is free to move around. A colleague recently showed me a paper by Capasso, Engbers and La Torre which describes an extension of the Solow growth model in which a spatial element is added. It seemed to me that the model could be extended in various ways. Most interestingly, the paper only gave an example in which capital and labour move around in a one-dimensional latent space, but I thought it would be more interesting if the space was two-dimensional. A book called The Price of Time by Edwin Chancellor describes many of the unintended negative consequences of low interest rates, one of which is investment being directed to infrastructure projects which appear to “go nowhere” (think of railways in the 19th century US or 2010s China). I decided to use the Capasso et al model to study the effects of randomly building transport infrastructure. The basic idea is that if a country’s development is modelled by a process in which capital and labour are trying to reach the same location, then any infrastructure will probably speed up growth. But by how much? I want to get a qualitative estimate of that. Model The model takes place on a domain $\\Omega \\subset \\mathbb{R}^n$. At each point $x \\in \\Omega$ and each time $t$, there is a quantity of capital $K(x,t)$ and labour $L(x,t)$. There is a production function $F$ describing how more capital is produced from labour and capital. I will assume that $F$ is the same everywhere. In other words, there’s an industry of sorts at every point of $\\Omega$. Motion of Capital Capital evolves in space and time according to the equation \\[\\frac{\\partial K}{\\partial t}(x,t) = e\\nabla^2 K(x,t) -\\delta K(x,t) + Y(x,t)\\] where $Y(x,t) = F(K(x,t), L(x,t))$ is output. Here, $e$ is the (exogenous) coefficient of diffusion and $\\delta$ is (exogenous) depreciation. This is a version of the heat equation. If $F = 0$ then capital will slowly diffuse through the domain $\\Omega$ until the value of $K$ is the same everywhere, like in the following picture. Motion of Labour In the Capasso et al model, labour diffuses in the same way as capital. But what if we assume that labour moves towards the direction of the highest wages? Let’s assume that labour is paid its marginal product $w(x,t) = \\frac{\\partial F}{\\partial L}$ and that it moves in the direction of increasing $w$, so we have something like \\[\\frac{\\partial L}{\\partial t}(x,t) = m\\nabla \\cdot (L(x,t)\\nabla w(x,t)) + gL(x,t)\\] where $m$ is a diffusion coefficient and $g$ is an exogenous growth rate. In other words, a proportion $m$ of the labour force will migrate in the direction in which the wages are highest. Simulation Now let’s stop pretending that time and space are continuous. The following describes what I actually coded1. Assume that time proceeds in discrete steps $t=0, 1, 2, \\dots$ and that the domain $\\Omega$ is a graph. At time step $t$, the model evolves in the following way: At each vertex $x$, a proportion $e$ of the current value of capital $K(x)$ is distributed equally among the neighbours of $x$. At each vertex $x$, a proportion $m$ of the current value of labour $L(x)$ moves to the node in ${x}\\cup{\\text{neighbours of } x}$ with highest wage. If there is a tie for highest, it is distributed equally among the tied nodes. At each vertex $x$, $K(x)$ is incremented by production minus depreciation and $L(x)$ increases by a factor of $(1+g)$. If you run the model on a grid and start by drawing labour and capital from a uniform distribution, you will see a sort of self-organisation. Labour and capital accumulate into “towns” where there is a relatively high level of production. Capital Labour Here. I used the Cobb-Douglas production function with $TFP = 1$ and $\\alpha = 1/3$. Capasso et al chose to use a different production function. The choice of Cobb-Douglas means that growth is unlimited and eventually the spatial distribution of capital and labour will become uniform. I’m really interested in the rate of growth of aggregate output $Y$ where \\[Y(t) = \\int_\\Omega Y(x, t) dx.\\] The graph below shows how $Y(t)$ grows in the simulation above, starting with a random distribution of capital and labour. Adding Infrastructure You can add transportation to the model by adding connections between nodes which weren’t previously connected. For example, here’s what happens to the pattern of capital if you add a “railway line” down the diagonal of the grid which makes all the points on the diagonal adjacent to each other. Regardless of the initial distribution of labour and capital, the nodes with high adjacency end up having very high relative output. Interestingly, nodes next to nodes with high adjacency end up with lower than average output, even though the model has the property that capital is supposed to trickle outwards due to the $\\nabla^2 K$ term. You are better off being in the hinterland than being near, but not in, an area which is connected to a lot of infrastructure. There are real-world reflections of this in places such as Animas City, Colorado which became a ghost town after being bypassed by a railroad which went through Durango, two miles to the south, so it makes some sense. Example: the US Railroad Boom Speaking of Colorado, we can try to use this model to estimate how much the railroad boom in the US contributed to growth. In the 19th century the US experienced a period of railroad mania. According to PBS there were 364 railroads by the time of the Panic of 1873. Let’s make some wild estimates. Assume that the US is a $10 \\times 20$ rectangle (the numbers are chosen to make the simulation run quickly). According to this paper $33\\%$ of people migrated inter-county per decade, and according to various sources it took about six months to cross the US prior to the development of railroads. Therefore, labour should be able to move about 40 grid squares in a year, so we need to take each time step to be $1/40$ of a year, and then the migration rate $m$ should be $1/40 \\times 0.33/10$. Assuming that capital goods were difficult to transport, we’ll take $e=0$. We also assume an annual capital depreciation rate of $0.1$. If we start in 1830 with the founding of the Baltimore and Ohio Railroad, the model needs to run for 43 years. The population basically tripled between 1830 and 1873, so we should take an appropriate value of $g$. In the following R code, we run two models. model0 has no railroads. In model1, railroads are added at regular intervals by joining pairs of random nodes (like the secret passages in Cluedo) so that they become adjacent. We can then calculate the aggregate output of the two models at the end of the simulation and divide one by the other to get the factor by which the presence of the railroads has increased or decreased output. simulate_us",
    "meta_keywords": null,
    "og_description": "This post is about economic growth in a region in which labour is free to move around. A colleague recently showed me a paper by Capasso, Engbers and La Torre which describes an extension of the Solow growth model in which a spatial element is added. It seemed to me that the model could be extended in various ways. Most interestingly, the paper only gave an example in which capital and labour move around in a one-dimensional latent space, but I thought it would be more interesting if the space was two-dimensional. A book called The Price of Time by Edwin Chancellor describes many of the unintended negative consequences of low interest rates, one of which is investment being directed to infrastructure projects which appear to “go nowhere” (think of railways in the 19th century US or 2010s China). I decided to use the Capasso et al model to study the effects of randomly building transport infrastructure. The basic idea is that if a country’s development is modelled by a process in which capital and labour are trying to reach the same location, then any infrastructure will probably speed up growth. But by how much? I want to get a qualitative estimate of that. Model The model takes place on a domain $\\Omega \\subset \\mathbb{R}^n$. At each point $x \\in \\Omega$ and each time $t$, there is a quantity of capital $K(x,t)$ and labour $L(x,t)$. There is a production function $F$ describing how more capital is produced from labour and capital. I will assume that $F$ is the same everywhere. In other words, there’s an industry of sorts at every point of $\\Omega$. Motion of Capital Capital evolves in space and time according to the equation \\[\\frac{\\partial K}{\\partial t}(x,t) = e\\nabla^2 K(x,t) -\\delta K(x,t) + Y(x,t)\\] where $Y(x,t) = F(K(x,t), L(x,t))$ is output. Here, $e$ is the (exogenous) coefficient of diffusion and $\\delta$ is (exogenous) depreciation. This is a version of the heat equation. If $F = 0$ then capital will slowly diffuse through the domain $\\Omega$ until the value of $K$ is the same everywhere, like in the following picture. Motion of Labour In the Capasso et al model, labour diffuses in the same way as capital. But what if we assume that labour moves towards the direction of the highest wages? Let’s assume that labour is paid its marginal product $w(x,t) = \\frac{\\partial F}{\\partial L}$ and that it moves in the direction of increasing $w$, so we have something like \\[\\frac{\\partial L}{\\partial t}(x,t) = m\\nabla \\cdot (L(x,t)\\nabla w(x,t)) + gL(x,t)\\] where $m$ is a diffusion coefficient and $g$ is an exogenous growth rate. In other words, a proportion $m$ of the labour force will migrate in the direction in which the wages are highest. Simulation Now let’s stop pretending that time and space are continuous. The following describes what I actually coded1. Assume that time proceeds in discrete steps $t=0, 1, 2, \\dots$ and that the domain $\\Omega$ is a graph. At time step $t$, the model evolves in the following way: At each vertex $x$, a proportion $e$ of the current value of capital $K(x)$ is distributed equally among the neighbours of $x$. At each vertex $x$, a proportion $m$ of the current value of labour $L(x)$ moves to the node in ${x}\\cup{\\text{neighbours of } x}$ with highest wage. If there is a tie for highest, it is distributed equally among the tied nodes. At each vertex $x$, $K(x)$ is incremented by production minus depreciation and $L(x)$ increases by a factor of $(1+g)$. If you run the model on a grid and start by drawing labour and capital from a uniform distribution, you will see a sort of self-organisation. Labour and capital accumulate into “towns” where there is a relatively high level of production. Capital Labour Here. I used the Cobb-Douglas production function with $TFP = 1$ and $\\alpha = 1/3$. Capasso et al chose to use a different production function. The choice of Cobb-Douglas means that growth is unlimited and eventually the spatial distribution of capital and labour will become uniform. I’m really interested in the rate of growth of aggregate output $Y$ where \\[Y(t) = \\int_\\Omega Y(x, t) dx.\\] The graph below shows how $Y(t)$ grows in the simulation above, starting with a random distribution of capital and labour. Adding Infrastructure You can add transportation to the model by adding connections between nodes which weren’t previously connected. For example, here’s what happens to the pattern of capital if you add a “railway line” down the diagonal of the grid which makes all the points on the diagonal adjacent to each other. Regardless of the initial distribution of labour and capital, the nodes with high adjacency end up having very high relative output. Interestingly, nodes next to nodes with high adjacency end up with lower than average output, even though the model has the property that capital is supposed to trickle outwards due to the $\\nabla^2 K$ term. You are better off being in the hinterland than being near, but not in, an area which is connected to a lot of infrastructure. There are real-world reflections of this in places such as Animas City, Colorado which became a ghost town after being bypassed by a railroad which went through Durango, two miles to the south, so it makes some sense. Example: the US Railroad Boom Speaking of Colorado, we can try to use this model to estimate how much the railroad boom in the US contributed to growth. In the 19th century the US experienced a period of railroad mania. According to PBS there were 364 railroads by the time of the Panic of 1873. Let’s make some wild estimates. Assume that the US is a $10 \\times 20$ rectangle (the numbers are chosen to make the simulation run quickly). According to this paper $33\\%$ of people migrated inter-county per decade, and according to various sources it took about six months to cross the US prior to the development of railroads. Therefore, labour should be able to move about 40 grid squares in a year, so we need to take each time step to be $1/40$ of a year, and then the migration rate $m$ should be $1/40 \\times 0.33/10$. Assuming that capital goods were difficult to transport, we’ll take $e=0$. We also assume an annual capital depreciation rate of $0.1$. If we start in 1830 with the founding of the Baltimore and Ohio Railroad, the model needs to run for 43 years. The population basically tripled between 1830 and 1873, so we should take an appropriate value of $g$. In the following R code, we run two models. model0 has no railroads. In model1, railroads are added at regular intervals by joining pairs of random nodes (like the secret passages in Cluedo) so that they become adjacent. We can then calculate the aggregate output of the two models at the end of the simulation and divide one by the other to get the factor by which the presence of the railroads has increased or decreased output. simulate_us",
    "og_image": "https://datascienceconfidential.github.io/blog/images/2025/railroad_sims.png",
    "og_title": "Adding random transport links to a 2D growth model | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 9.7,
    "sitemap_lastmod": null,
    "twitter_description": "This post is about economic growth in a region in which labour is free to move around. A colleague recently showed me a paper by Capasso, Engbers and La Torre which describes an extension of the Solow growth model in which a spatial element is added. It seemed to me that the model could be extended in various ways. Most interestingly, the paper only gave an example in which capital and labour move around in a one-dimensional latent space, but I thought it would be more interesting if the space was two-dimensional. A book called The Price of Time by Edwin Chancellor describes many of the unintended negative consequences of low interest rates, one of which is investment being directed to infrastructure projects which appear to “go nowhere” (think of railways in the 19th century US or 2010s China). I decided to use the Capasso et al model to study the effects of randomly building transport infrastructure. The basic idea is that if a country’s development is modelled by a process in which capital and labour are trying to reach the same location, then any infrastructure will probably speed up growth. But by how much? I want to get a qualitative estimate of that. Model The model takes place on a domain $\\Omega \\subset \\mathbb{R}^n$. At each point $x \\in \\Omega$ and each time $t$, there is a quantity of capital $K(x,t)$ and labour $L(x,t)$. There is a production function $F$ describing how more capital is produced from labour and capital. I will assume that $F$ is the same everywhere. In other words, there’s an industry of sorts at every point of $\\Omega$. Motion of Capital Capital evolves in space and time according to the equation \\[\\frac{\\partial K}{\\partial t}(x,t) = e\\nabla^2 K(x,t) -\\delta K(x,t) + Y(x,t)\\] where $Y(x,t) = F(K(x,t), L(x,t))$ is output. Here, $e$ is the (exogenous) coefficient of diffusion and $\\delta$ is (exogenous) depreciation. This is a version of the heat equation. If $F = 0$ then capital will slowly diffuse through the domain $\\Omega$ until the value of $K$ is the same everywhere, like in the following picture. Motion of Labour In the Capasso et al model, labour diffuses in the same way as capital. But what if we assume that labour moves towards the direction of the highest wages? Let’s assume that labour is paid its marginal product $w(x,t) = \\frac{\\partial F}{\\partial L}$ and that it moves in the direction of increasing $w$, so we have something like \\[\\frac{\\partial L}{\\partial t}(x,t) = m\\nabla \\cdot (L(x,t)\\nabla w(x,t)) + gL(x,t)\\] where $m$ is a diffusion coefficient and $g$ is an exogenous growth rate. In other words, a proportion $m$ of the labour force will migrate in the direction in which the wages are highest. Simulation Now let’s stop pretending that time and space are continuous. The following describes what I actually coded1. Assume that time proceeds in discrete steps $t=0, 1, 2, \\dots$ and that the domain $\\Omega$ is a graph. At time step $t$, the model evolves in the following way: At each vertex $x$, a proportion $e$ of the current value of capital $K(x)$ is distributed equally among the neighbours of $x$. At each vertex $x$, a proportion $m$ of the current value of labour $L(x)$ moves to the node in ${x}\\cup{\\text{neighbours of } x}$ with highest wage. If there is a tie for highest, it is distributed equally among the tied nodes. At each vertex $x$, $K(x)$ is incremented by production minus depreciation and $L(x)$ increases by a factor of $(1+g)$. If you run the model on a grid and start by drawing labour and capital from a uniform distribution, you will see a sort of self-organisation. Labour and capital accumulate into “towns” where there is a relatively high level of production. Capital Labour Here. I used the Cobb-Douglas production function with $TFP = 1$ and $\\alpha = 1/3$. Capasso et al chose to use a different production function. The choice of Cobb-Douglas means that growth is unlimited and eventually the spatial distribution of capital and labour will become uniform. I’m really interested in the rate of growth of aggregate output $Y$ where \\[Y(t) = \\int_\\Omega Y(x, t) dx.\\] The graph below shows how $Y(t)$ grows in the simulation above, starting with a random distribution of capital and labour. Adding Infrastructure You can add transportation to the model by adding connections between nodes which weren’t previously connected. For example, here’s what happens to the pattern of capital if you add a “railway line” down the diagonal of the grid which makes all the points on the diagonal adjacent to each other. Regardless of the initial distribution of labour and capital, the nodes with high adjacency end up having very high relative output. Interestingly, nodes next to nodes with high adjacency end up with lower than average output, even though the model has the property that capital is supposed to trickle outwards due to the $\\nabla^2 K$ term. You are better off being in the hinterland than being near, but not in, an area which is connected to a lot of infrastructure. There are real-world reflections of this in places such as Animas City, Colorado which became a ghost town after being bypassed by a railroad which went through Durango, two miles to the south, so it makes some sense. Example: the US Railroad Boom Speaking of Colorado, we can try to use this model to estimate how much the railroad boom in the US contributed to growth. In the 19th century the US experienced a period of railroad mania. According to PBS there were 364 railroads by the time of the Panic of 1873. Let’s make some wild estimates. Assume that the US is a $10 \\times 20$ rectangle (the numbers are chosen to make the simulation run quickly). According to this paper $33\\%$ of people migrated inter-county per decade, and according to various sources it took about six months to cross the US prior to the development of railroads. Therefore, labour should be able to move about 40 grid squares in a year, so we need to take each time step to be $1/40$ of a year, and then the migration rate $m$ should be $1/40 \\times 0.33/10$. Assuming that capital goods were difficult to transport, we’ll take $e=0$. We also assume an annual capital depreciation rate of $0.1$. If we start in 1830 with the founding of the Baltimore and Ohio Railroad, the model needs to run for 43 years. The population basically tripled between 1830 and 1873, so we should take an appropriate value of $g$. In the following R code, we run two models. model0 has no railroads. In model1, railroads are added at regular intervals by joining pairs of random nodes (like the secret passages in Cluedo) so that they become adjacent. We can then calculate the aggregate output of the two models at the end of the simulation and divide one by the other to get the factor by which the presence of the railroads has increased or decreased output. simulate_us",
    "twitter_title": "Adding random transport links to a 2D growth model | R-bloggers",
    "url": "https://www.r-bloggers.com/2025/10/adding-random-transport-links-to-a-2d-growth-model/",
    "word_count": 1939
  }
}