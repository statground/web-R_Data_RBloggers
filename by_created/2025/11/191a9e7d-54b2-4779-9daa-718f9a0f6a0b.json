{
  "uuid": "191a9e7d-54b2-4779-9daa-718f9a0f6a0b",
  "created_at": "2025-11-17 20:41:28",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2008/10/using-r-in-consulting-playing-nice-with-microsoft-word/",
    "crawled_at": "2025-11-17T10:49:39.491596",
    "external_links": [
      {
        "href": "https://realizationsinbiostatistics.blogspot.com/2008/10/using-r-in-consulting-playing-nice-with.html",
        "text": "Realizations in Biostatistics"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://realizationsinbiostatistics.blogspot.com/2008/10/using-r-in-consulting-playing-nice-with.html",
        "text": "Realizations in Biostatistics"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Using R in consulting: playing nice with Microsoft Word | R-bloggers",
    "images": [],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/john-johnson/",
        "text": "John Johnson"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-59516 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Using R in consulting: playing nice with Microsoft Word</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">October 17, 2008</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/john-johnson/\">John Johnson</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<p class=\"syndicated-attribution\"><!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://realizationsinbiostatistics.blogspot.com/2008/10/using-r-in-consulting-playing-nice-with.html\"> Realizations in Biostatistics</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div></p>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->As I use R more in consulting, I’m finding the need to make the quick transition from R to Microsoft products (usually Word) more serious. (I’m using a Windows platform, but I’m sure the challenges on the Mac would be similar.) I simply don’t have time to do the text manipulations necessary to convert text to Word tables, for example. There are a few solutions I’ve tried:<br/><br/><ol><li>RWeave and LaTeX2RTF – a bit clunky and producing disastrous results. I really like RWeave, but it’s the LaTeX to RTF conversion that’s the weak link in the chain here. It simply doesn’t work well enough for consulting use. Also, it takes too long to set up when you just want to copy a couple of tables over to Word.</li><li>odfWeave – I’m interested in this solution, but there are a couple of issues. Microsoft support of open document format (ODF) isn’t quite there yet, I have to install OpenOffice writer as an intermediary. And I haven’t quite gotten odfWeave to work yet, as it requires a command line zip utility and wzcline (the command line interface to WinZip required as a separate download) doesn’t seem to work very well yet. Maybe some of the other command lines would work better, but there was a warning as of this writing that the zip utility recommended in the odfWeave help files has a security flaw.</li><li>HTML – I haven’t tried the full R2HTML package, but it still seems that this is too much for what I need. It’s probably possible to use this to output a basic html file which can then be read into Word, but as of right now that requires too much setup for what I’m doing.</li></ol>So, basically, I’ve come up with my own lightweight solution, the <code>my.html.table</code> function which takes a matrix, data.frame, or array and outputs the html code for a table in the console or a file. Here’s the function:<br/><br/><code>\n# function: my.html.table\n# purpose: convert a matrix, array, or table to an html table\n# inputs:\n# file - NULL (default) to output to screen, or file name to output to file\n# header - F (default) to use  for table header, T to use  (ignored if\n#          colnames is F)\n# rownames - F (default) to leave out the rownames attribute of the table, T to\n#            include it in the first column\n# colnames - F (default) to leave out the colnames attribute of the table, T to\n#            include it in the top row (affects header)\n# ... - additional parameters are passed to format, affecting the body of the\n#       table only (not the headers or row names)\n# interactions: header is used only if colnames is T\n# output: html text (output to a file if file is not NULL)\n# tip: use this function, and copy/paste to Excel, and then copy/paste the Excel\n#      table to easily create a table in MS Word\n# note: for more functionality, use the R2HTML package, as this function is\n#       intended for lightweight use only\nmy.html.table &lt;- function(tab,file=NULL,header=F,rownames=F,colnames=F,...) {\n  if (!is.null(file)) sink(file)\n  nr &lt;- nrow(tab)\n  cat(\"&lt;table&gt;\\n\")\n  if (header) {\n    th.tag &lt;- \"&lt;th&gt;\"\n    th.tag.end &lt;- \"&lt;/th&gt;\"\n  } else {\n    th.tag &lt;- \"&lt;td&gt;\"\n    th.tag.end &lt;- \"&lt;/td&gt;\"\n  }\n  if (colnames) {\n    cat(\"&lt;tr&gt;\",th.tag,sep='')\n    if (rownames) {\n      cat(th.tag.end,th.tag,sep='')\n    }\n    cat(colnames(tab),sep=paste(th.tag.end,th.tag,sep=''))\n    cat(th.tag.end,\"&lt;/tr&gt;\\n\",sep='')\n  }\n  for (i in 1:nr) {\n    cat(\"&lt;tr&gt;&lt;td&gt;\")\n    if (rownames) {\n      cat(rownames(tab)[i],'&lt;/td&gt;&lt;td&gt;')\n    }\n    cat(format(tab[i,],...),sep='&lt;/td&gt;&lt;td&gt;')\n    cat(\"&lt;/td&gt;&lt;/tr&gt;\\n\")\n  }\n  cat(\"&lt;/table&gt;\\n\")\n  if (!is.null(file)) sink()\n}\n</code><br/><br/>And here’s an example:<br/><br/><code>\na&lt;-c(0.5290,0.5680,0.6030,0.6380,0.7050,0.7000,0.7090) b&lt;-c(0.0158,0.0157,0.0155,0.0152,0.0144,0.0145,0.0144) c&lt;-c(87.1350,108.5070,128.6900,149.6190,170.7140,190.6750,211.9240) \nfoo &lt;- rbind(a,b,c,d,e,f,g)\ncolnames(foo) &lt;- paste(\"Col\",1:7)\nrownames(foo) &lt;- c(\"Lbl 1\",\"Lbl 2\",\"Lbl 3\",\"Lbl 4\",\"Lbl 5\",\"Lbl 6\",\"Lbl 7\") my.html.table(foo)\nmy.html.table(foo,rownames=T,colnames=T,header=T,digits=2)\nmy.html.table(foo,width=5) \n</code><br/><br/>To easily create a Word table from a matrix, data.frame, or array, just use my.html.table with suitable parameters (including anything that can be passed to format), copy the html from the console, paste into Excel, select and copy from Excel, and paste into Word. It's a little clunky, and maybe through the use of R's clipboard connection I can cut out a step or two, but it's a vast improvement over manual formatting and the bloated solutions listed above.<br/><br/>If you have a better way, feel free to comment.<br/><br/>By the way, using the right-click menu on graphs to copy as a metafile works wonderfully.<br/><br/>If reports are to be updated regularly using changing/updated data, this of course is the wrong solution, and one of the literate programming/weave solutions or appropriately programmed R2HTML is much better.\r\n\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->\n<p class=\"syndicated-attribution\"><div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://realizationsinbiostatistics.blogspot.com/2008/10/using-r-in-consulting-playing-nice-with.html\"> Realizations in Biostatistics</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div></p> </div>\n</article>",
    "main_text": "Using R in consulting: playing nice with Microsoft Word\nPosted on\nOctober 17, 2008\nby\nJohn Johnson\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nRealizations in Biostatistics\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nAs I use R more in consulting, I’m finding the need to make the quick transition from R to Microsoft products (usually Word) more serious. (I’m using a Windows platform, but I’m sure the challenges on the Mac would be similar.) I simply don’t have time to do the text manipulations necessary to convert text to Word tables, for example. There are a few solutions I’ve tried:\nRWeave and LaTeX2RTF – a bit clunky and producing disastrous results. I really like RWeave, but it’s the LaTeX to RTF conversion that’s the weak link in the chain here. It simply doesn’t work well enough for consulting use. Also, it takes too long to set up when you just want to copy a couple of tables over to Word.\nodfWeave – I’m interested in this solution, but there are a couple of issues. Microsoft support of open document format (ODF) isn’t quite there yet, I have to install OpenOffice writer as an intermediary. And I haven’t quite gotten odfWeave to work yet, as it requires a command line zip utility and wzcline (the command line interface to WinZip required as a separate download) doesn’t seem to work very well yet. Maybe some of the other command lines would work better, but there was a warning as of this writing that the zip utility recommended in the odfWeave help files has a security flaw.\nHTML – I haven’t tried the full R2HTML package, but it still seems that this is too much for what I need. It’s probably possible to use this to output a basic html file which can then be read into Word, but as of right now that requires too much setup for what I’m doing.\nSo, basically, I’ve come up with my own lightweight solution, the\nmy.html.table\nfunction which takes a matrix, data.frame, or array and outputs the html code for a table in the console or a file. Here’s the function:\n# function: my.html.table\n# purpose: convert a matrix, array, or table to an html table\n# inputs:\n# file - NULL (default) to output to screen, or file name to output to file\n# header - F (default) to use  for table header, T to use  (ignored if\n#          colnames is F)\n# rownames - F (default) to leave out the rownames attribute of the table, T to\n#            include it in the first column\n# colnames - F (default) to leave out the colnames attribute of the table, T to\n#            include it in the top row (affects header)\n# ... - additional parameters are passed to format, affecting the body of the\n#       table only (not the headers or row names)\n# interactions: header is used only if colnames is T\n# output: html text (output to a file if file is not NULL)\n# tip: use this function, and copy/paste to Excel, and then copy/paste the Excel\n#      table to easily create a table in MS Word\n# note: for more functionality, use the R2HTML package, as this function is\n#       intended for lightweight use only\nmy.html.table <- function(tab,file=NULL,header=F,rownames=F,colnames=F,...) {\n  if (!is.null(file)) sink(file)\n  nr <- nrow(tab)\n  cat(\"<table>\\n\")\n  if (header) {\n    th.tag <- \"<th>\"\n    th.tag.end <- \"</th>\"\n  } else {\n    th.tag <- \"<td>\"\n    th.tag.end <- \"</td>\"\n  }\n  if (colnames) {\n    cat(\"<tr>\",th.tag,sep='')\n    if (rownames) {\n      cat(th.tag.end,th.tag,sep='')\n    }\n    cat(colnames(tab),sep=paste(th.tag.end,th.tag,sep=''))\n    cat(th.tag.end,\"</tr>\\n\",sep='')\n  }\n  for (i in 1:nr) {\n    cat(\"<tr><td>\")\n    if (rownames) {\n      cat(rownames(tab)[i],'</td><td>')\n    }\n    cat(format(tab[i,],...),sep='</td><td>')\n    cat(\"</td></tr>\\n\")\n  }\n  cat(\"</table>\\n\")\n  if (!is.null(file)) sink()\n}\nAnd here’s an example:\na<-c(0.5290,0.5680,0.6030,0.6380,0.7050,0.7000,0.7090) b<-c(0.0158,0.0157,0.0155,0.0152,0.0144,0.0145,0.0144) c<-c(87.1350,108.5070,128.6900,149.6190,170.7140,190.6750,211.9240) \nfoo <- rbind(a,b,c,d,e,f,g)\ncolnames(foo) <- paste(\"Col\",1:7)\nrownames(foo) <- c(\"Lbl 1\",\"Lbl 2\",\"Lbl 3\",\"Lbl 4\",\"Lbl 5\",\"Lbl 6\",\"Lbl 7\") my.html.table(foo)\nmy.html.table(foo,rownames=T,colnames=T,header=T,digits=2)\nmy.html.table(foo,width=5)\nTo easily create a Word table from a matrix, data.frame, or array, just use my.html.table with suitable parameters (including anything that can be passed to format), copy the html from the console, paste into Excel, select and copy from Excel, and paste into Word. It's a little clunky, and maybe through the use of R's clipboard connection I can cut out a step or two, but it's a vast improvement over manual formatting and the bloated solutions listed above.\nIf you have a better way, feel free to comment.\nBy the way, using the right-click menu on graphs to copy as a metafile works wonderfully.\nIf reports are to be updated regularly using changing/updated data, this of course is the wrong solution, and one of the literate programming/weave solutions or appropriately programmed R2HTML is much better.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nRealizations in Biostatistics\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "As I use R more in consulting, I'm finding the need to make the quick transition from R to Microsoft products (usually Word) more serious. (I'm using a Windows platform, but I'm sure the challenges on the Mac would be similar.) I simply don't have time to do the text manipulations necessary to convert text to Word tables, for example. There are a few solutions I've tried:RWeave and LaTeX2RTF - a bit clunky and producing disastrous results. I really like RWeave, but it's the LaTeX to RTF conversion that's the weak link in the chain here. It simply doesn't work well enough for consulting use. Also, it takes too long to set up when you just want to copy a couple of tables over to Word.odfWeave - I'm interested in this solution, but there are a couple of issues. Microsoft support of open document format (ODF) isn't quite there yet, I have to install OpenOffice writer as an intermediary. And I haven't quite gotten odfWeave to work yet, as it requires a command line zip utility and wzcline (the command line interface to WinZip required as a separate download) doesn't seem to work very well yet. Maybe some of the other command lines would work better, but there was a warning as of this writing that the zip utility recommended in the odfWeave help files has a security flaw.HTML - I haven't tried the full R2HTML package, but it still seems that this is too much for what I need. It's probably possible to use this to output a basic html file which can then be read into Word, but as of right now that requires too much setup for what I'm doing.So, basically, I've come up with my own lightweight solution, the my.html.table function which takes a matrix, data.frame, or array and outputs the html code for a table in the console or a file. Here's the function:# function: my.html.table# purpose: convert a matrix, array, or table to an html table# inputs:# file - NULL (default) to output to screen, or file name to output to file# header - F (default) to use for table header, T to use (ignored if# colnames is F)# rownames - F (default) to leave out the rownames attribute of the table, T to# include it in the first column# colnames - F (default) to leave out the colnames attribute of the table, T to# include it in the top row (affects header)# ... - additional parameters are passed to format, affecting the body of the# table only (not the headers or row names)# interactions: header is used only if colnames is T# output: html text (output to a file if file is not NULL)# tip: use this function, and copy/paste to Excel, and then copy/paste the Excel# table to easily create a table in MS Word# note: for more functionality, use the R2HTML package, as this function is# intended for lightweight use onlymy.html.table",
    "meta_keywords": null,
    "og_description": "As I use R more in consulting, I'm finding the need to make the quick transition from R to Microsoft products (usually Word) more serious. (I'm using a Windows platform, but I'm sure the challenges on the Mac would be similar.) I simply don't have time to do the text manipulations necessary to convert text to Word tables, for example. There are a few solutions I've tried:RWeave and LaTeX2RTF - a bit clunky and producing disastrous results. I really like RWeave, but it's the LaTeX to RTF conversion that's the weak link in the chain here. It simply doesn't work well enough for consulting use. Also, it takes too long to set up when you just want to copy a couple of tables over to Word.odfWeave - I'm interested in this solution, but there are a couple of issues. Microsoft support of open document format (ODF) isn't quite there yet, I have to install OpenOffice writer as an intermediary. And I haven't quite gotten odfWeave to work yet, as it requires a command line zip utility and wzcline (the command line interface to WinZip required as a separate download) doesn't seem to work very well yet. Maybe some of the other command lines would work better, but there was a warning as of this writing that the zip utility recommended in the odfWeave help files has a security flaw.HTML - I haven't tried the full R2HTML package, but it still seems that this is too much for what I need. It's probably possible to use this to output a basic html file which can then be read into Word, but as of right now that requires too much setup for what I'm doing.So, basically, I've come up with my own lightweight solution, the my.html.table function which takes a matrix, data.frame, or array and outputs the html code for a table in the console or a file. Here's the function:# function: my.html.table# purpose: convert a matrix, array, or table to an html table# inputs:# file - NULL (default) to output to screen, or file name to output to file# header - F (default) to use for table header, T to use (ignored if# colnames is F)# rownames - F (default) to leave out the rownames attribute of the table, T to# include it in the first column# colnames - F (default) to leave out the colnames attribute of the table, T to# include it in the top row (affects header)# ... - additional parameters are passed to format, affecting the body of the# table only (not the headers or row names)# interactions: header is used only if colnames is T# output: html text (output to a file if file is not NULL)# tip: use this function, and copy/paste to Excel, and then copy/paste the Excel# table to easily create a table in MS Word# note: for more functionality, use the R2HTML package, as this function is# intended for lightweight use onlymy.html.table",
    "og_image": "https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png",
    "og_title": "Using R in consulting: playing nice with Microsoft Word | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 5.1,
    "sitemap_lastmod": "2008-10-17T20:20:25+00:00",
    "twitter_description": "As I use R more in consulting, I'm finding the need to make the quick transition from R to Microsoft products (usually Word) more serious. (I'm using a Windows platform, but I'm sure the challenges on the Mac would be similar.) I simply don't have time to do the text manipulations necessary to convert text to Word tables, for example. There are a few solutions I've tried:RWeave and LaTeX2RTF - a bit clunky and producing disastrous results. I really like RWeave, but it's the LaTeX to RTF conversion that's the weak link in the chain here. It simply doesn't work well enough for consulting use. Also, it takes too long to set up when you just want to copy a couple of tables over to Word.odfWeave - I'm interested in this solution, but there are a couple of issues. Microsoft support of open document format (ODF) isn't quite there yet, I have to install OpenOffice writer as an intermediary. And I haven't quite gotten odfWeave to work yet, as it requires a command line zip utility and wzcline (the command line interface to WinZip required as a separate download) doesn't seem to work very well yet. Maybe some of the other command lines would work better, but there was a warning as of this writing that the zip utility recommended in the odfWeave help files has a security flaw.HTML - I haven't tried the full R2HTML package, but it still seems that this is too much for what I need. It's probably possible to use this to output a basic html file which can then be read into Word, but as of right now that requires too much setup for what I'm doing.So, basically, I've come up with my own lightweight solution, the my.html.table function which takes a matrix, data.frame, or array and outputs the html code for a table in the console or a file. Here's the function:# function: my.html.table# purpose: convert a matrix, array, or table to an html table# inputs:# file - NULL (default) to output to screen, or file name to output to file# header - F (default) to use for table header, T to use (ignored if# colnames is F)# rownames - F (default) to leave out the rownames attribute of the table, T to# include it in the first column# colnames - F (default) to leave out the colnames attribute of the table, T to# include it in the top row (affects header)# ... - additional parameters are passed to format, affecting the body of the# table only (not the headers or row names)# interactions: header is used only if colnames is T# output: html text (output to a file if file is not NULL)# tip: use this function, and copy/paste to Excel, and then copy/paste the Excel# table to easily create a table in MS Word# note: for more functionality, use the R2HTML package, as this function is# intended for lightweight use onlymy.html.table",
    "twitter_title": "Using R in consulting: playing nice with Microsoft Word | R-bloggers",
    "url": "https://www.r-bloggers.com/2008/10/using-r-in-consulting-playing-nice-with-microsoft-word/",
    "word_count": 1017
  }
}