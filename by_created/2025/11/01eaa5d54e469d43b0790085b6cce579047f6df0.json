{
  "id": "01eaa5d54e469d43b0790085b6cce579047f6df0",
  "url": "https://www.r-bloggers.com/2009/08/additive-vs-dominance-two-allele-genetic-model-by-dic/",
  "created_at_utc": "2025-11-17T20:40:33Z",
  "data": null,
  "raw_original": {
    "uuid": "9dc98913-60fc-4af5-9805-972db6e9d4db",
    "created_at": "2025-11-17 20:40:33",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2009/08/additive-vs-dominance-two-allele-genetic-model-by-dic/",
      "crawled_at": "2025-11-17T10:29:22.870744",
      "external_links": [
        {
          "href": "https://ggorjan.blogspot.com/2009/08/additive-vs-dominance-two-allele.html",
          "text": "Gregor Gorjanc (gg)"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "http://www.mrc-bsu.cam.ac.uk/bugs/winbugs/dicpage.shtml",
          "text": "DIC"
        },
        {
          "href": "http://www.mrc-bsu.cam.ac.uk/bugs/",
          "text": "BUGS"
        },
        {
          "href": "https://ggorjan.blogspot.com/2009/08/additive-vs-dominance-two-allele.html",
          "text": "Gregor Gorjanc (gg)"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Additive vs. dominance two-allele genetic model by DIC | R-bloggers",
      "images": [],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/gregor-gorjanc/",
          "text": "Gregor Gorjanc"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-312 post type-post status-publish format-standard hentry\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Additive vs. dominance two-allele genetic model by DIC</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">August 7, 2009</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/gregor-gorjanc/\">Gregor Gorjanc</a></span>  in Uncategorized | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<p class=\"syndicated-attribution\"><!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://ggorjan.blogspot.com/2009/08/additive-vs-dominance-two-allele.html\"> Gregor Gorjanc (gg)</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div></p>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.0--><div style=\"text-align: justify;\">Two-allele model has alleles A1 and A2 and genotypes A1A1, A1A2, and A2A2. This model can be fitted using only additive effect (restricted model) or additve+dominance effect. (full model) The later model has one parameter more than the former. I was using this  model lately and got weird <a href=\"http://www.mrc-bsu.cam.ac.uk/bugs/winbugs/dicpage.shtml\" rel=\"nofollow\" target=\"_blank\">DIC</a> results – the full model had less number of parameters. Bellow is a simulation (using R and <a href=\"http://www.mrc-bsu.cam.ac.uk/bugs/\" rel=\"nofollow\" target=\"_blank\">BUGS</a>), that shows expected DIC results.</div><blockquote><pre>## Needed packages and functions\nlibrary(package=\"e1071\")\nlibrary(package=\"doBy\")\nlibrary(package=\"R2WinBUGS\")\n\nrvalue &lt;- function(n, p, value, mean=0, sdE=0)\n{\n  if(!is.matrix(value)) value &lt;- as.matrix(value)\n \n  ## Frequencies\n  k &lt;- length(p)\n  q &lt;- 1 - p\n  P &lt;- p * p\n  Q &lt;- q * q\n  H &lt;- 2 * p * q\n\n  ## Allocate matrix of arbitrary values by loci\n  x &lt;- matrix(data=1, nrow=n, ncol=k)\n  y &lt;- matrix(data=1, nrow=n, ncol=k)\n\n  ## Simulate arbitrary values\n  for(i in 1:k) {\n    x[, i] &lt;- rdiscrete(n=n, probs=c(P[i], H[i], Q[i]))\n    y[, i] &lt;- value[x[, i], i]\n  }\n  x &lt;- x - 1 ## convert 1:3 to 0:2, i.e., number of A1 alleles\n\n  ## Sum all values\n  y &lt;- rowSums(y)\n\n  ## Add mean and normal deviate (error)\n  y &lt;- y + rnorm(n=n, mean=mean, sd=sdE)\n\n  return(as.data.frame(cbind(y, x)))\n}\n\nprepairData &lt;- function(x, dominance=FALSE)\n{\n  ret &lt;- list()\n  ret$n &lt;- nrow(x)\n  ret$y &lt;- x$y\n  if(!dominance) {\n    ret$x &lt;- x$V2 - 1 ## scale to the mean\n  } else {\n    ret$x &lt;- x$V2 + 1 ## BUGS does not allow zero indexing!\n  }\n  ret\n}\n\n### SIMULATE DATA\n###-----------------------------------------------------------------------\n\n## --- Purely additive ---\n\nset.seed(seed=19791123)\n\n## Model parameters\nn &lt;- 1000\nmu &lt;- 100\nsigma &lt;- 1\nvalue &lt;- c(-1, 0, 1)\np &lt;- 0.5\n\n## Simulate\npodatkiA &lt;- rvalue(n=n, p=p, value=value, mean=mu, sdE=sigma)\n\npar(mfrow=c(2, 1))\nhist(podatkiA$y, xlab=\"Phenotype\")\n\nplot(podatkiA$y ~ jitter(podatkiA$V2), xlab=\"Genotype\", ylab=\"Phenotype\")\n\ntmpA1 &lt;- lm(podatkiA$y ~ podatkiA$V2)\nabline(coef(tmpA1), lwd=\"2\", col=\"blue\")\ntmpA2 &lt;- summaryBy(y ~ V2, data=podatkiA)\npoints(tmpA2$y.mean ~ tmpA2$V2, pch=19, col=\"red\")\n\n## --- Additive + Dominance ---\n\nset.seed(seed=19791123)\n\n## Model parameters\nn &lt;- 1000\nmu &lt;- 100\nsigma &lt;- 1\nvalue &lt;- c(-1, 1, -1)\np &lt;- 0.5\n\n## Simulate\npodatkiD &lt;- rvalue(n=n, p=p, value=value, mean=mu, sdE=sigma)\n\npar(mfrow=c(2, 1))\nhist(podatkiD$y, xlab=\"Phenotype\")\n\nplot(podatkiD$y ~ jitter(podatkiD$V2), xlab=\"Genotype\", ylab=\"Phenotype\")\n\ntmpD1 &lt;- lm(podatkiD$y ~ podatkiD$V2)\nabline(coef(tmpD1), lwd=\"2\", col=\"blue\")\ntmpD2 &lt;- summaryBy(y ~ V2, data=podatkiD)\npoints(tmpD2$y.mean ~ tmpD2$V2, pch=19, col=\"red\")\n\n### ESTIMATE MODEL PARAMETERS AND DIC\n###-----------------------------------------------------------------------\n\nmodelA &lt;- function()\n{\n  ## --- Additive model (regression on gene content) ---\n  ## Phenotypes\n  for(i in 1:n) {\n    y[i] ~ dnorm(mu[i], tau2)\n    mu[i] &lt;- a + b * x[i]\n  }\n  ## Location prior\n  a ~ dnorm(0, 1.0E-6)  \n  b ~ dnorm(0, 1.0E-6)\n  ## Variance prior\n  lsigma ~ dunif(-10, 10) ## sigma between 4.539993e-05 and 2.202647e+04\n  tau2 &lt;- pow(sigma, -2)\n  sigma &lt;- exp(lsigma)\n}\n\nmodelD &lt;- function()\n{\n  ## --- Additive + Dominance model (genotype as a factor) ---\n  ## Phenotypes\n  for(i in 1:n) {\n    y[i] ~ dnorm(mu[i], tau2)\n    mu[i] &lt;- g[x[i]]\n  }\n  ## Location prior\n  g[1] ~ dnorm(0, 1.0E-6)\n  g[2] ~ dnorm(0, 1.0E-6)\n  g[3] ~ dnorm(0, 1.0E-6)  \n  ## Variance prior\n  lsigma ~ dunif(-10, 10) ## sigma between 4.539993e-05 and 2.202647e+04\n  tau2 &lt;- pow(sigma, -2)\n  sigma &lt;- exp(lsigma)\n}\n\ntmpAA &lt;- prepairData(x=podatkiA)\ntmpAD &lt;- prepairData(x=podatkiA, dominance=TRUE)\ntmpDA &lt;- prepairData(x=podatkiD)\ntmpDD &lt;- prepairData(x=podatkiD, dominance=TRUE)\n\ninitsA &lt;- function() list(a=rnorm(n=1, mean=mu), b=rnorm(n=1), lsigma=0)\ninitsD &lt;- function() list(g=rnorm(n=3, mean=mu),               lsigma=0)\n\n(fitAA &lt;- bugs(model=modelA, data=tmpAA, inits=initsA,\n               n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10,\n               bugs.seed=19791123, parameters=c(\"a\", \"b\", \"sigma\"),\n               bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))\n##            mean  sd   2.5%    25%  50%  75%  97.5% Rhat n.eff\n## a          99.9 0.0   99.9   99.9  100  100  100.0    1  1500\n## b           1.0 0.0    0.9    1.0    1    1    1.1    1  1500\n## sigma       1.0 0.0    1.0    1.0    1    1    1.0    1   400\n## deviance 2828.3 2.4 2826.0 2826.0 2828 2829 2834.0    1  1500\n## pD = 2.9 and DIC = 2831.2\n\n(fitAD &lt;- bugs(model=modelD, data=tmpAD, inits=initsD,\n               n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10,\n               bugs.seed=19791123, parameters=c(\"g\", \"sigma\"),\n               bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))\n##            mean  sd   2.5%    25%    50%  75%  97.5% Rhat n.eff\n## g[1]       98.9 0.1   98.8   98.9   98.9   99   99.1    1   660\n## g[2]       99.9 0.0   99.8   99.9   99.9  100  100.0    1  1500\n## g[3]      101.0 0.1  100.8  100.9  101.0  101  101.1    1  1500\n## sigma       1.0 0.0    1.0    1.0    1.0    1    1.0    1  1300\n## deviance 2829.2 2.9 2826.0 2827.0 2829.0 2831 2837.0    1  1500\n## pD = 4.0 and DIC = 2833.2\n\n## pD seem OK and DIC agrees with simulated data - it is worse\n## for AD model for data following additive model\n\n(fitDA &lt;- bugs(model=modelA, data=tmpDA, inits=initsA,\n               n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10,\n               bugs.seed=19791123, parameters=c(\"a\", \"b\", \"sigma\"),\n               bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))\n##            mean  sd   2.5%    25%    50%    75%  97.5% Rhat n.eff\n## a         100.0 0.0   99.9  100.0  100.0  100.0  100.1    1   570\n## b           0.0 0.1   -0.1    0.0    0.0    0.1    0.2    1  1500\n## sigma       1.4 0.0    1.3    1.4    1.4    1.4    1.5    1  1300\n## deviance 3512.9 2.6 3510.0 3511.0 3512.0 3514.0 3520.0    1  1500\n## pD = 3.0 and DIC = 3515.9\n\n(fitDD &lt;- bugs(model=modelD, data=tmpDD, inits=initsD,\n               n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10,\n               bugs.seed=19791123, parameters=c(\"g\", \"sigma\"),\n               bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))\n##            mean  sd   2.5%    25%    50%  75%  97.5% Rhat n.eff\n## g[1]       98.9 0.1   98.8   98.9   99.0   99   99.1    1  1500\n## g[2]      100.9 0.1  100.8  100.9  100.9  101  101.0    1  1500\n## g[3]       99.0 0.1   98.8   98.9   99.0   99   99.1    1  1500\n## sigma       1.0 0.0    1.0    1.0    1.0    1    1.0    1   530\n## deviance 2829.2 2.9 2826.0 2827.0 2829.0 2831 2837.0    1  1500\n## pD = 4.1 and DIC = 2833.3\n\n## pD seems OK and DIC also agrees with the model --&gt; dominance\n## model is better for this dataset</pre></blockquote>\n\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->\n<p class=\"syndicated-attribution\"><div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://ggorjan.blogspot.com/2009/08/additive-vs-dominance-two-allele.html\"> Gregor Gorjanc (gg)</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div></p> </div>\n</article>",
      "main_text": "Additive vs. dominance two-allele genetic model by DIC\nPosted on\nAugust 7, 2009\nby\nGregor Gorjanc\nin Uncategorized | 0 Comments\n[This article was first published on\nGregor Gorjanc (gg)\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nTwo-allele model has alleles A1 and A2 and genotypes A1A1, A1A2, and A2A2. This model can be fitted using only additive effect (restricted model) or additve+dominance effect. (full model) The later model has one parameter more than the former. I was using this  model lately and got weird\nDIC\nresults – the full model had less number of parameters. Bellow is a simulation (using R and\nBUGS\n), that shows expected DIC results.\n## Needed packages and functions\nlibrary(package=\"e1071\")\nlibrary(package=\"doBy\")\nlibrary(package=\"R2WinBUGS\")\n\nrvalue <- function(n, p, value, mean=0, sdE=0)\n{\n  if(!is.matrix(value)) value <- as.matrix(value)\n \n  ## Frequencies\n  k <- length(p)\n  q <- 1 - p\n  P <- p * p\n  Q <- q * q\n  H <- 2 * p * q\n\n  ## Allocate matrix of arbitrary values by loci\n  x <- matrix(data=1, nrow=n, ncol=k)\n  y <- matrix(data=1, nrow=n, ncol=k)\n\n  ## Simulate arbitrary values\n  for(i in 1:k) {\n    x[, i] <- rdiscrete(n=n, probs=c(P[i], H[i], Q[i]))\n    y[, i] <- value[x[, i], i]\n  }\n  x <- x - 1 ## convert 1:3 to 0:2, i.e., number of A1 alleles\n\n  ## Sum all values\n  y <- rowSums(y)\n\n  ## Add mean and normal deviate (error)\n  y <- y + rnorm(n=n, mean=mean, sd=sdE)\n\n  return(as.data.frame(cbind(y, x)))\n}\n\nprepairData <- function(x, dominance=FALSE)\n{\n  ret <- list()\n  ret$n <- nrow(x)\n  ret$y <- x$y\n  if(!dominance) {\n    ret$x <- x$V2 - 1 ## scale to the mean\n  } else {\n    ret$x <- x$V2 + 1 ## BUGS does not allow zero indexing!\n  }\n  ret\n}\n\n### SIMULATE DATA\n###-----------------------------------------------------------------------\n\n## --- Purely additive ---\n\nset.seed(seed=19791123)\n\n## Model parameters\nn <- 1000\nmu <- 100\nsigma <- 1\nvalue <- c(-1, 0, 1)\np <- 0.5\n\n## Simulate\npodatkiA <- rvalue(n=n, p=p, value=value, mean=mu, sdE=sigma)\n\npar(mfrow=c(2, 1))\nhist(podatkiA$y, xlab=\"Phenotype\")\n\nplot(podatkiA$y ~ jitter(podatkiA$V2), xlab=\"Genotype\", ylab=\"Phenotype\")\n\ntmpA1 <- lm(podatkiA$y ~ podatkiA$V2)\nabline(coef(tmpA1), lwd=\"2\", col=\"blue\")\ntmpA2 <- summaryBy(y ~ V2, data=podatkiA)\npoints(tmpA2$y.mean ~ tmpA2$V2, pch=19, col=\"red\")\n\n## --- Additive + Dominance ---\n\nset.seed(seed=19791123)\n\n## Model parameters\nn <- 1000\nmu <- 100\nsigma <- 1\nvalue <- c(-1, 1, -1)\np <- 0.5\n\n## Simulate\npodatkiD <- rvalue(n=n, p=p, value=value, mean=mu, sdE=sigma)\n\npar(mfrow=c(2, 1))\nhist(podatkiD$y, xlab=\"Phenotype\")\n\nplot(podatkiD$y ~ jitter(podatkiD$V2), xlab=\"Genotype\", ylab=\"Phenotype\")\n\ntmpD1 <- lm(podatkiD$y ~ podatkiD$V2)\nabline(coef(tmpD1), lwd=\"2\", col=\"blue\")\ntmpD2 <- summaryBy(y ~ V2, data=podatkiD)\npoints(tmpD2$y.mean ~ tmpD2$V2, pch=19, col=\"red\")\n\n### ESTIMATE MODEL PARAMETERS AND DIC\n###-----------------------------------------------------------------------\n\nmodelA <- function()\n{\n  ## --- Additive model (regression on gene content) ---\n  ## Phenotypes\n  for(i in 1:n) {\n    y[i] ~ dnorm(mu[i], tau2)\n    mu[i] <- a + b * x[i]\n  }\n  ## Location prior\n  a ~ dnorm(0, 1.0E-6)  \n  b ~ dnorm(0, 1.0E-6)\n  ## Variance prior\n  lsigma ~ dunif(-10, 10) ## sigma between 4.539993e-05 and 2.202647e+04\n  tau2 <- pow(sigma, -2)\n  sigma <- exp(lsigma)\n}\n\nmodelD <- function()\n{\n  ## --- Additive + Dominance model (genotype as a factor) ---\n  ## Phenotypes\n  for(i in 1:n) {\n    y[i] ~ dnorm(mu[i], tau2)\n    mu[i] <- g[x[i]]\n  }\n  ## Location prior\n  g[1] ~ dnorm(0, 1.0E-6)\n  g[2] ~ dnorm(0, 1.0E-6)\n  g[3] ~ dnorm(0, 1.0E-6)  \n  ## Variance prior\n  lsigma ~ dunif(-10, 10) ## sigma between 4.539993e-05 and 2.202647e+04\n  tau2 <- pow(sigma, -2)\n  sigma <- exp(lsigma)\n}\n\ntmpAA <- prepairData(x=podatkiA)\ntmpAD <- prepairData(x=podatkiA, dominance=TRUE)\ntmpDA <- prepairData(x=podatkiD)\ntmpDD <- prepairData(x=podatkiD, dominance=TRUE)\n\ninitsA <- function() list(a=rnorm(n=1, mean=mu), b=rnorm(n=1), lsigma=0)\ninitsD <- function() list(g=rnorm(n=3, mean=mu),               lsigma=0)\n\n(fitAA <- bugs(model=modelA, data=tmpAA, inits=initsA,\n               n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10,\n               bugs.seed=19791123, parameters=c(\"a\", \"b\", \"sigma\"),\n               bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))\n##            mean  sd   2.5%    25%  50%  75%  97.5% Rhat n.eff\n## a          99.9 0.0   99.9   99.9  100  100  100.0    1  1500\n## b           1.0 0.0    0.9    1.0    1    1    1.1    1  1500\n## sigma       1.0 0.0    1.0    1.0    1    1    1.0    1   400\n## deviance 2828.3 2.4 2826.0 2826.0 2828 2829 2834.0    1  1500\n## pD = 2.9 and DIC = 2831.2\n\n(fitAD <- bugs(model=modelD, data=tmpAD, inits=initsD,\n               n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10,\n               bugs.seed=19791123, parameters=c(\"g\", \"sigma\"),\n               bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))\n##            mean  sd   2.5%    25%    50%  75%  97.5% Rhat n.eff\n## g[1]       98.9 0.1   98.8   98.9   98.9   99   99.1    1   660\n## g[2]       99.9 0.0   99.8   99.9   99.9  100  100.0    1  1500\n## g[3]      101.0 0.1  100.8  100.9  101.0  101  101.1    1  1500\n## sigma       1.0 0.0    1.0    1.0    1.0    1    1.0    1  1300\n## deviance 2829.2 2.9 2826.0 2827.0 2829.0 2831 2837.0    1  1500\n## pD = 4.0 and DIC = 2833.2\n\n## pD seem OK and DIC agrees with simulated data - it is worse\n## for AD model for data following additive model\n\n(fitDA <- bugs(model=modelA, data=tmpDA, inits=initsA,\n               n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10,\n               bugs.seed=19791123, parameters=c(\"a\", \"b\", \"sigma\"),\n               bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))\n##            mean  sd   2.5%    25%    50%    75%  97.5% Rhat n.eff\n## a         100.0 0.0   99.9  100.0  100.0  100.0  100.1    1   570\n## b           0.0 0.1   -0.1    0.0    0.0    0.1    0.2    1  1500\n## sigma       1.4 0.0    1.3    1.4    1.4    1.4    1.5    1  1300\n## deviance 3512.9 2.6 3510.0 3511.0 3512.0 3514.0 3520.0    1  1500\n## pD = 3.0 and DIC = 3515.9\n\n(fitDD <- bugs(model=modelD, data=tmpDD, inits=initsD,\n               n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10,\n               bugs.seed=19791123, parameters=c(\"g\", \"sigma\"),\n               bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))\n##            mean  sd   2.5%    25%    50%  75%  97.5% Rhat n.eff\n## g[1]       98.9 0.1   98.8   98.9   99.0   99   99.1    1  1500\n## g[2]      100.9 0.1  100.8  100.9  100.9  101  101.0    1  1500\n## g[3]       99.0 0.1   98.8   98.9   99.0   99   99.1    1  1500\n## sigma       1.0 0.0    1.0    1.0    1.0    1    1.0    1   530\n## deviance 2829.2 2.9 2826.0 2827.0 2829.0 2831 2837.0    1  1500\n## pD = 4.1 and DIC = 2833.3\n\n## pD seems OK and DIC also agrees with the model --> dominance\n## model is better for this dataset\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nGregor Gorjanc (gg)\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Two-allele model has alleles A1 and A2 and genotypes A1A1, A1A2, and A2A2. This model can be fitted using only additive effect (restricted model) or additve+dominance effect. (full model) The later model has one parameter more than the former. I was using this model lately and got weird DIC results - the full model had less number of parameters. Bellow is a simulation (using R and BUGS), that shows expected DIC results. ## Needed packages and functionslibrary(package=\"e1071\")library(package=\"doBy\")library(package=\"R2WinBUGS\")rvalue { if(!is.matrix(value)) value ## Frequencies k q P Q H ## Allocate matrix of arbitrary values by loci x y ## Simulate arbitrary values for(i in 1:k) { x[, i] y[, i] } x ## Sum all values y ## Add mean and normal deviate (error) y return(as.data.frame(cbind(y, x)))}prepairData { ret ret$n ret$y if(!dominance) { ret$x } else { ret$x } ret}### SIMULATE DATA###-----------------------------------------------------------------------## --- Purely additive ---set.seed(seed=19791123)## Model parametersn mu sigma value p ## SimulatepodatkiA par(mfrow=c(2, 1))hist(podatkiA$y, xlab=\"Phenotype\")plot(podatkiA$y ~ jitter(podatkiA$V2), xlab=\"Genotype\", ylab=\"Phenotype\")tmpA1 abline(coef(tmpA1), lwd=\"2\", col=\"blue\")tmpA2 points(tmpA2$y.mean ~ tmpA2$V2, pch=19, col=\"red\")## --- Additive + Dominance ---set.seed(seed=19791123)## Model parametersn mu sigma value p ## SimulatepodatkiD par(mfrow=c(2, 1))hist(podatkiD$y, xlab=\"Phenotype\")plot(podatkiD$y ~ jitter(podatkiD$V2), xlab=\"Genotype\", ylab=\"Phenotype\")tmpD1 abline(coef(tmpD1), lwd=\"2\", col=\"blue\")tmpD2 points(tmpD2$y.mean ~ tmpD2$V2, pch=19, col=\"red\")### ESTIMATE MODEL PARAMETERS AND DIC###-----------------------------------------------------------------------modelA { ## --- Additive model (regression on gene content) --- ## Phenotypes for(i in 1:n) { y[i] ~ dnorm(mu[i], tau2) mu[i] } ## Location prior a ~ dnorm(0, 1.0E-6) b ~ dnorm(0, 1.0E-6) ## Variance prior lsigma ~ dunif(-10, 10) ## sigma between 4.539993e-05 and 2.202647e+04 tau2 sigma }modelD { ## --- Additive + Dominance model (genotype as a factor) --- ## Phenotypes for(i in 1:n) { y[i] ~ dnorm(mu[i], tau2) mu[i] } ## Location prior g[1] ~ dnorm(0, 1.0E-6) g[2] ~ dnorm(0, 1.0E-6) g[3] ~ dnorm(0, 1.0E-6) ## Variance prior lsigma ~ dunif(-10, 10) ## sigma between 4.539993e-05 and 2.202647e+04 tau2 sigma }tmpAA tmpAD tmpDA tmpDD initsA initsD (fitAA n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10, bugs.seed=19791123, parameters=c(\"a\", \"b\", \"sigma\"), bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))## mean sd 2.5% 25% 50% 75% 97.5% Rhat n.eff## a 99.9 0.0 99.9 99.9 100 100 100.0 1 1500## b 1.0 0.0 0.9 1.0 1 1 1.1 1 1500## sigma 1.0 0.0 1.0 1.0 1 1 1.0 1 400## deviance 2828.3 2.4 2826.0 2826.0 2828 2829 2834.0 1 1500## pD = 2.9 and DIC = 2831.2(fitAD n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10, bugs.seed=19791123, parameters=c(\"g\", \"sigma\"), bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))## mean sd 2.5% 25% 50% 75% 97.5% Rhat n.eff## g[1] 98.9 0.1 98.8 98.9 98.9 99 99.1 1 660## g[2] 99.9 0.0 99.8 99.9 99.9 100 100.0 1 1500## g[3] 101.0 0.1 100.8 100.9 101.0 101 101.1 1 1500## sigma 1.0 0.0 1.0 1.0 1.0 1 1.0 1 1300## deviance 2829.2 2.9 2826.0 2827.0 2829.0 2831 2837.0 1 1500## pD = 4.0 and DIC = 2833.2## pD seem OK and DIC agrees with simulated data - it is worse## for AD model for data following additive model(fitDA n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10, bugs.seed=19791123, parameters=c(\"a\", \"b\", \"sigma\"), bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))## mean sd 2.5% 25% 50% 75% 97.5% Rhat n.eff## a 100.0 0.0 99.9 100.0 100.0 100.0 100.1 1 570## b 0.0 0.1 -0.1 0.0 0.0 0.1 0.2 1 1500## sigma 1.4 0.0 1.3 1.4 1.4 1.4 1.5 1 1300## deviance 3512.9 2.6 3510.0 3511.0 3512.0 3514.0 3520.0 1 1500## pD = 3.0 and DIC = 3515.9(fitDD n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10, bugs.seed=19791123, parameters=c(\"g\", \"sigma\"), bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))## mean sd 2.5% 25% 50% 75% 97.5% Rhat n.eff## g[1] 98.9 0.1 98.8 98.9 99.0 99 99.1 1 1500## g[2] 100.9 0.1 100.8 100.9 100.9 101 101.0 1 1500## g[3] 99.0 0.1 98.8 98.9 99.0 99 99.1 1 1500## sigma 1.0 0.0 1.0 1.0 1.0 1 1.0 1 530## deviance 2829.2 2.9 2826.0 2827.0 2829.0 2831 2837.0 1 1500## pD = 4.1 and DIC = 2833.3## pD seems OK and DIC also agrees with the model --> dominance## model is better for this dataset",
      "meta_keywords": null,
      "og_description": "Two-allele model has alleles A1 and A2 and genotypes A1A1, A1A2, and A2A2. This model can be fitted using only additive effect (restricted model) or additve+dominance effect. (full model) The later model has one parameter more than the former. I was using this model lately and got weird DIC results - the full model had less number of parameters. Bellow is a simulation (using R and BUGS), that shows expected DIC results. ## Needed packages and functionslibrary(package=\"e1071\")library(package=\"doBy\")library(package=\"R2WinBUGS\")rvalue { if(!is.matrix(value)) value ## Frequencies k q P Q H ## Allocate matrix of arbitrary values by loci x y ## Simulate arbitrary values for(i in 1:k) { x[, i] y[, i] } x ## Sum all values y ## Add mean and normal deviate (error) y return(as.data.frame(cbind(y, x)))}prepairData { ret ret$n ret$y if(!dominance) { ret$x } else { ret$x } ret}### SIMULATE DATA###-----------------------------------------------------------------------## --- Purely additive ---set.seed(seed=19791123)## Model parametersn mu sigma value p ## SimulatepodatkiA par(mfrow=c(2, 1))hist(podatkiA$y, xlab=\"Phenotype\")plot(podatkiA$y ~ jitter(podatkiA$V2), xlab=\"Genotype\", ylab=\"Phenotype\")tmpA1 abline(coef(tmpA1), lwd=\"2\", col=\"blue\")tmpA2 points(tmpA2$y.mean ~ tmpA2$V2, pch=19, col=\"red\")## --- Additive + Dominance ---set.seed(seed=19791123)## Model parametersn mu sigma value p ## SimulatepodatkiD par(mfrow=c(2, 1))hist(podatkiD$y, xlab=\"Phenotype\")plot(podatkiD$y ~ jitter(podatkiD$V2), xlab=\"Genotype\", ylab=\"Phenotype\")tmpD1 abline(coef(tmpD1), lwd=\"2\", col=\"blue\")tmpD2 points(tmpD2$y.mean ~ tmpD2$V2, pch=19, col=\"red\")### ESTIMATE MODEL PARAMETERS AND DIC###-----------------------------------------------------------------------modelA { ## --- Additive model (regression on gene content) --- ## Phenotypes for(i in 1:n) { y[i] ~ dnorm(mu[i], tau2) mu[i] } ## Location prior a ~ dnorm(0, 1.0E-6) b ~ dnorm(0, 1.0E-6) ## Variance prior lsigma ~ dunif(-10, 10) ## sigma between 4.539993e-05 and 2.202647e+04 tau2 sigma }modelD { ## --- Additive + Dominance model (genotype as a factor) --- ## Phenotypes for(i in 1:n) { y[i] ~ dnorm(mu[i], tau2) mu[i] } ## Location prior g[1] ~ dnorm(0, 1.0E-6) g[2] ~ dnorm(0, 1.0E-6) g[3] ~ dnorm(0, 1.0E-6) ## Variance prior lsigma ~ dunif(-10, 10) ## sigma between 4.539993e-05 and 2.202647e+04 tau2 sigma }tmpAA tmpAD tmpDA tmpDD initsA initsD (fitAA n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10, bugs.seed=19791123, parameters=c(\"a\", \"b\", \"sigma\"), bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))## mean sd 2.5% 25% 50% 75% 97.5% Rhat n.eff## a 99.9 0.0 99.9 99.9 100 100 100.0 1 1500## b 1.0 0.0 0.9 1.0 1 1 1.1 1 1500## sigma 1.0 0.0 1.0 1.0 1 1 1.0 1 400## deviance 2828.3 2.4 2826.0 2826.0 2828 2829 2834.0 1 1500## pD = 2.9 and DIC = 2831.2(fitAD n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10, bugs.seed=19791123, parameters=c(\"g\", \"sigma\"), bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))## mean sd 2.5% 25% 50% 75% 97.5% Rhat n.eff## g[1] 98.9 0.1 98.8 98.9 98.9 99 99.1 1 660## g[2] 99.9 0.0 99.8 99.9 99.9 100 100.0 1 1500## g[3] 101.0 0.1 100.8 100.9 101.0 101 101.1 1 1500## sigma 1.0 0.0 1.0 1.0 1.0 1 1.0 1 1300## deviance 2829.2 2.9 2826.0 2827.0 2829.0 2831 2837.0 1 1500## pD = 4.0 and DIC = 2833.2## pD seem OK and DIC agrees with simulated data - it is worse## for AD model for data following additive model(fitDA n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10, bugs.seed=19791123, parameters=c(\"a\", \"b\", \"sigma\"), bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))## mean sd 2.5% 25% 50% 75% 97.5% Rhat n.eff## a 100.0 0.0 99.9 100.0 100.0 100.0 100.1 1 570## b 0.0 0.1 -0.1 0.0 0.0 0.1 0.2 1 1500## sigma 1.4 0.0 1.3 1.4 1.4 1.4 1.5 1 1300## deviance 3512.9 2.6 3510.0 3511.0 3512.0 3514.0 3520.0 1 1500## pD = 3.0 and DIC = 3515.9(fitDD n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10, bugs.seed=19791123, parameters=c(\"g\", \"sigma\"), bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))## mean sd 2.5% 25% 50% 75% 97.5% Rhat n.eff## g[1] 98.9 0.1 98.8 98.9 99.0 99 99.1 1 1500## g[2] 100.9 0.1 100.8 100.9 100.9 101 101.0 1 1500## g[3] 99.0 0.1 98.8 98.9 99.0 99 99.1 1 1500## sigma 1.0 0.0 1.0 1.0 1.0 1 1.0 1 530## deviance 2829.2 2.9 2826.0 2827.0 2829.0 2831 2837.0 1 1500## pD = 4.1 and DIC = 2833.3## pD seems OK and DIC also agrees with the model --> dominance## model is better for this dataset",
      "og_image": "https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png",
      "og_title": "Additive vs. dominance two-allele genetic model by DIC | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 6.5,
      "sitemap_lastmod": "2009-08-07T11:57:23+00:00",
      "twitter_description": "Two-allele model has alleles A1 and A2 and genotypes A1A1, A1A2, and A2A2. This model can be fitted using only additive effect (restricted model) or additve+dominance effect. (full model) The later model has one parameter more than the former. I was using this model lately and got weird DIC results - the full model had less number of parameters. Bellow is a simulation (using R and BUGS), that shows expected DIC results. ## Needed packages and functionslibrary(package=\"e1071\")library(package=\"doBy\")library(package=\"R2WinBUGS\")rvalue { if(!is.matrix(value)) value ## Frequencies k q P Q H ## Allocate matrix of arbitrary values by loci x y ## Simulate arbitrary values for(i in 1:k) { x[, i] y[, i] } x ## Sum all values y ## Add mean and normal deviate (error) y return(as.data.frame(cbind(y, x)))}prepairData { ret ret$n ret$y if(!dominance) { ret$x } else { ret$x } ret}### SIMULATE DATA###-----------------------------------------------------------------------## --- Purely additive ---set.seed(seed=19791123)## Model parametersn mu sigma value p ## SimulatepodatkiA par(mfrow=c(2, 1))hist(podatkiA$y, xlab=\"Phenotype\")plot(podatkiA$y ~ jitter(podatkiA$V2), xlab=\"Genotype\", ylab=\"Phenotype\")tmpA1 abline(coef(tmpA1), lwd=\"2\", col=\"blue\")tmpA2 points(tmpA2$y.mean ~ tmpA2$V2, pch=19, col=\"red\")## --- Additive + Dominance ---set.seed(seed=19791123)## Model parametersn mu sigma value p ## SimulatepodatkiD par(mfrow=c(2, 1))hist(podatkiD$y, xlab=\"Phenotype\")plot(podatkiD$y ~ jitter(podatkiD$V2), xlab=\"Genotype\", ylab=\"Phenotype\")tmpD1 abline(coef(tmpD1), lwd=\"2\", col=\"blue\")tmpD2 points(tmpD2$y.mean ~ tmpD2$V2, pch=19, col=\"red\")### ESTIMATE MODEL PARAMETERS AND DIC###-----------------------------------------------------------------------modelA { ## --- Additive model (regression on gene content) --- ## Phenotypes for(i in 1:n) { y[i] ~ dnorm(mu[i], tau2) mu[i] } ## Location prior a ~ dnorm(0, 1.0E-6) b ~ dnorm(0, 1.0E-6) ## Variance prior lsigma ~ dunif(-10, 10) ## sigma between 4.539993e-05 and 2.202647e+04 tau2 sigma }modelD { ## --- Additive + Dominance model (genotype as a factor) --- ## Phenotypes for(i in 1:n) { y[i] ~ dnorm(mu[i], tau2) mu[i] } ## Location prior g[1] ~ dnorm(0, 1.0E-6) g[2] ~ dnorm(0, 1.0E-6) g[3] ~ dnorm(0, 1.0E-6) ## Variance prior lsigma ~ dunif(-10, 10) ## sigma between 4.539993e-05 and 2.202647e+04 tau2 sigma }tmpAA tmpAD tmpDA tmpDD initsA initsD (fitAA n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10, bugs.seed=19791123, parameters=c(\"a\", \"b\", \"sigma\"), bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))## mean sd 2.5% 25% 50% 75% 97.5% Rhat n.eff## a 99.9 0.0 99.9 99.9 100 100 100.0 1 1500## b 1.0 0.0 0.9 1.0 1 1 1.1 1 1500## sigma 1.0 0.0 1.0 1.0 1 1 1.0 1 400## deviance 2828.3 2.4 2826.0 2826.0 2828 2829 2834.0 1 1500## pD = 2.9 and DIC = 2831.2(fitAD n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10, bugs.seed=19791123, parameters=c(\"g\", \"sigma\"), bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))## mean sd 2.5% 25% 50% 75% 97.5% Rhat n.eff## g[1] 98.9 0.1 98.8 98.9 98.9 99 99.1 1 660## g[2] 99.9 0.0 99.8 99.9 99.9 100 100.0 1 1500## g[3] 101.0 0.1 100.8 100.9 101.0 101 101.1 1 1500## sigma 1.0 0.0 1.0 1.0 1.0 1 1.0 1 1300## deviance 2829.2 2.9 2826.0 2827.0 2829.0 2831 2837.0 1 1500## pD = 4.0 and DIC = 2833.2## pD seem OK and DIC agrees with simulated data - it is worse## for AD model for data following additive model(fitDA n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10, bugs.seed=19791123, parameters=c(\"a\", \"b\", \"sigma\"), bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))## mean sd 2.5% 25% 50% 75% 97.5% Rhat n.eff## a 100.0 0.0 99.9 100.0 100.0 100.0 100.1 1 570## b 0.0 0.1 -0.1 0.0 0.0 0.1 0.2 1 1500## sigma 1.4 0.0 1.3 1.4 1.4 1.4 1.5 1 1300## deviance 3512.9 2.6 3510.0 3511.0 3512.0 3514.0 3520.0 1 1500## pD = 3.0 and DIC = 3515.9(fitDD n.chains=3, n.burnin=5000, n.iter=10000, n.thin=10, bugs.seed=19791123, parameters=c(\"g\", \"sigma\"), bugs.directory=\"C:/Programs/BUGS/WinBUGS14_orig\"))## mean sd 2.5% 25% 50% 75% 97.5% Rhat n.eff## g[1] 98.9 0.1 98.8 98.9 99.0 99 99.1 1 1500## g[2] 100.9 0.1 100.8 100.9 100.9 101 101.0 1 1500## g[3] 99.0 0.1 98.8 98.9 99.0 99 99.1 1 1500## sigma 1.0 0.0 1.0 1.0 1.0 1 1.0 1 530## deviance 2829.2 2.9 2826.0 2827.0 2829.0 2831 2837.0 1 1500## pD = 4.1 and DIC = 2833.3## pD seems OK and DIC also agrees with the model --> dominance## model is better for this dataset",
      "twitter_title": "Additive vs. dominance two-allele genetic model by DIC | R-bloggers",
      "url": "https://www.r-bloggers.com/2009/08/additive-vs-dominance-two-allele-genetic-model-by-dic/",
      "word_count": 1291
    }
  }
}