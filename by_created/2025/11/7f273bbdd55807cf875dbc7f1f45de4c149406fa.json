{
  "id": "7f273bbdd55807cf875dbc7f1f45de4c149406fa",
  "url": "https://www.r-bloggers.com/2023/12/meteo-france-open-data/",
  "created_at_utc": "2025-11-17T20:38:54Z",
  "data": null,
  "raw_original": {
    "uuid": "e511cf71-b468-414e-9f9e-83947f750b6b",
    "created_at": "2025-11-17 20:38:54",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2023/12/meteo-france-open-data/",
      "crawled_at": "2025-11-17T09:34:56.639684",
      "external_links": [
        {
          "href": "https://r.iresmi.net/posts/2023/meteofrance/index.html",
          "text": "r.iresmi.net"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://flic.kr/p/4Zr3JW",
          "text": null
        },
        {
          "href": "https://social.numerique.gouv.fr/@datagouvfr/111568182572319268",
          "text": "has started"
        },
        {
          "href": "https://meteo.data.gouv.fr/",
          "text": "open archive data"
        },
        {
          "href": "https://meteo.data.gouv.fr/datasets/6569b51ae64326786e4e8e1a",
          "text": "Données climatologiques de base - quotidiennes"
        },
        {
          "href": "https://r.iresmi.net/posts/2023/meteofrance/index.html",
          "text": "r.iresmi.net"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Météo-France Open Data | R-bloggers",
      "images": [
        {
          "alt": "A photo of a thermometer",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "A photo of a thermometer",
          "base64": null,
          "src": "https://i0.wp.com/r.iresmi.net/posts/2023/meteofrance/images/2618997594_9eab6a5141_c.jpg?w=578&ssl=1"
        },
        {
          "alt": "Map of weather stations status in Auvergne-Rhône-Alpes",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "Map of weather stations status in Auvergne-Rhône-Alpes",
          "base64": null,
          "src": "https://i0.wp.com/r.iresmi.net/posts/2023/meteofrance/index_files/figure-html/fig-map-1.png?w=578&ssl=1"
        },
        {
          "alt": "Min and max temperature smoothed",
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": "Min and max temperature smoothed",
          "base64": null,
          "src": "https://i1.wp.com/r.iresmi.net/posts/2023/meteofrance/index_files/figure-html/fig-temp-1.png?w=578&ssl=1"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/michael/",
          "text": "Michael"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-380819 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Météo-France Open Data</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 13, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/michael/\">Michael</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://r.iresmi.net/posts/2023/meteofrance/index.html\"> r.iresmi.net</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div class=\"quarto-figure quarto-figure-center\">\n<figure class=\"figure\">\n<p><a href=\"https://flic.kr/p/4Zr3JW\" rel=\"nofollow\" target=\"_blank\"><img alt=\"A photo of a thermometer\" class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/r.iresmi.net/posts/2023/meteofrance/images/2618997594_9eab6a5141_c.jpg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"A photo of a thermometer\" class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/r.iresmi.net/posts/2023/meteofrance/images/2618997594_9eab6a5141_c.jpg?w=578&amp;ssl=1\"/></noscript></a></p>\n<figcaption class=\"figure-caption\">Temperature – CC-BY-SA by domollie</figcaption>\n</figure>\n</div>\n<p>Great news! Météo-France <a href=\"https://social.numerique.gouv.fr/@datagouvfr/111568182572319268\" rel=\"nofollow\" target=\"_blank\">has started</a> to widen its <a href=\"https://meteo.data.gouv.fr/\" rel=\"nofollow\" target=\"_blank\">open archive data</a>. No API so far and a lot of files… What can we do?</p>\n<div class=\"cell\">\n<pre>library(tidyverse)\nlibrary(httr)\nlibrary(glue)\nlibrary(janitor)\nlibrary(jsonlite)\nlibrary(sf)\n\nround_any &lt;- function(x, accuracy, f = round) {\n  f(x / accuracy) * accuracy\n}</pre>\n</div>\n<p>We can start by selecting a few <em>départements</em>, here the 12 from Auvergne-Rhône-Alpes.</p>\n<div class=\"cell\">\n<pre># which départements to download\nsel_dep &lt;- c(\"01\", \"03\", \"07\", \"15\", \"26\", \"38\", \"42\", \"43\", \"63\", \"69\", \"73\", \"74\")\n\n# for the map (code INSEE région)\nsel_reg &lt;- \"84\"</pre>\n</div>\n<section class=\"level2\" id=\"scraping\">\n<h2 class=\"anchored\" data-anchor-id=\"scraping\">Scraping</h2>\n<p>Get some information about the available files for the daily data (<a href=\"https://meteo.data.gouv.fr/datasets/6569b51ae64326786e4e8e1a\" rel=\"nofollow\" target=\"_blank\"><em>Données climatologiques de base - quotidiennes</em></a>).</p>\n<div class=\"cell\">\n<pre># count files available\nn_files &lt;- GET(\"https://www.data.gouv.fr/api/2/datasets/6569b51ae64326786e4e8e1a/\") |&gt;\n  content() |&gt; \n  pluck(\"resources\", \"total\")\n\n# get files informations\nfiles_available &lt;- GET(glue(\"https://www.data.gouv.fr/api/2/datasets/6569b51ae64326786e4e8e1a/resources/?page=1&amp;page_size={n_files}&amp;type=main\")) |&gt; \n  content(as = \"text\", encoding = \"UTF-8\") |&gt; \n  fromJSON(flatten = TRUE) |&gt; \n  pluck(\"data\") |&gt; \n  as_tibble(.name_repair = make_clean_names)</pre>\n</div>\n</section>\n<section class=\"level2\" id=\"download-and-open-the-files\">\n<h2 class=\"anchored\" data-anchor-id=\"download-and-open-the-files\">Download and open the files</h2>\n<div class=\"cell\">\n<pre>if (!length(list.files(\"data\"))) {\n  files_available |&gt; \n    mutate(dep = str_extract(title, \"(?&lt;=departement_)[:alnum:]{2,3}(?=_)\")) |&gt; \n    filter(dep %in% sel_dep,\n           str_detect(title, \"RR-T-Vent\")) |&gt; \n    pwalk(\\(url, title, format, ...) {\n      GET(url,\n          write_disk(glue(\"data/{title}.{format}\"),\n                     overwrite = TRUE))\n  })\n}</pre>\n</div>\n<p>We get 36 files…Each département has 3 files representing the recent years, 1950-2021 and before 1950.</p>\n<div class=\"cell\">\n<pre># parsing problems with readr::read_delim\n# we use read.delim instead\nmeteo &lt;- list.files(\"data\", full.names = TRUE) |&gt; \n  map(read.delim,\n      sep = \";\",\n      colClasses = c(\"NUM_POSTE\" = \"character\",\n                     \"AAAAMMJJ\" = \"character\")) |&gt; \n  list_rbind() |&gt; \n  as_tibble(.name_repair = make_clean_names) |&gt;\n  mutate(num_poste = str_trim(num_poste),\n         aaaammjj = ymd(aaaammjj))\n\n# Map data\n# See https://r.iresmi.net/posts/2021/simplifying_polygons_layers/\ndep_sig &lt;- read_sf(\"~/data/adminexpress/adminexpress_cog_simpl_000_2022.gpkg\",\n                   layer = \"departement\") |&gt; \n  filter(insee_reg == sel_reg) |&gt; \n  st_transform(\"EPSG:2154\")</pre>\n</div>\n<p>That’s a nice dataset of 19,222,848 rows!</p>\n</section>\n<section class=\"level1\" id=\"exploring\">\n<h1>Exploring</h1>\n<div class=\"cell\">\n<pre>meteo |&gt; \n  summarise(.by= c(nom_usuel, num_poste, lat, lon),\n            annee_max = max(year(aaaammjj))) |&gt; \n  st_as_sf(coords = c(\"lon\", \"lat\"), crs = \"EPSG:4326\") |&gt; \n  st_transform(\"EPSG:2154\") |&gt; \n  ggplot() +\n  geom_sf(data = dep_sig) +\n  geom_sf(aes(color = annee_max == year(Sys.Date()),\n              shape = annee_max == year(Sys.Date())),\n          size = 2, alpha = 0.5) +\n  scale_color_manual(name = \"statut\",\n                     values = c(\"FALSE\" = \"chocolate4\",\n                                \"TRUE\" = \"chartreuse3\"),\n                     labels = c(\"FALSE\" = \"inactive\",\n                                \"TRUE\" = \"active\")) +\n  scale_shape_manual(name = \"statut\",\n                     values = c(\"FALSE\" = 16,\n                                \"TRUE\" = 17),\n                     labels = c(\"FALSE\" = \"inactive\",\n                                \"TRUE\" = \"active\")) +\n  labs(title = \"Stations météo\",\n       subtitle = \"Auvergne-Rhône-Alpes\",\n       caption = glue(\"données Météo-France (https://meteo.data.gouv.fr/)\n                      carto : d'après IGN Admin Express 2022\n                      https://r.iresmi.net/ {Sys.Date()}\")) +\n  guides(color = guide_legend(reverse = TRUE),\n         shape = guide_legend(reverse = TRUE)) +\n  theme_minimal() +\n  theme(plot.caption = element_text(size = 6))</pre>\n<div class=\"cell-output-display\">\n<div class=\"quarto-figure quarto-figure-center anchored\" id=\"fig-map\">\n<figure class=\"figure\">\n<p><img alt=\"Map of weather stations status in Auvergne-Rhône-Alpes\" class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/r.iresmi.net/posts/2023/meteofrance/index_files/figure-html/fig-map-1.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" style=\"width:100.0%\"/><noscript><img alt=\"Map of weather stations status in Auvergne-Rhône-Alpes\" class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/r.iresmi.net/posts/2023/meteofrance/index_files/figure-html/fig-map-1.png?w=578&amp;ssl=1\" style=\"width:100.0%\"/></noscript></p>\n<figcaption class=\"figure-caption\">Figure 1: Weather stations in Auvergne-Rhône-Alpes</figcaption>\n</figure>\n</div>\n</div>\n</div>\n<p>What would be an interesting station?</p>\n<div class=\"cell\">\n<pre># longest temperature time series (possibly discontinuous)\nmeteo |&gt;\n  filter(!is.na(tx)) |&gt;\n  summarise(.by = c(nom_usuel, num_poste),\n            deb = min(year(aaaammjj)),\n            fin = max(year(aaaammjj)),\n            n_annee = n_distinct(year(aaaammjj))) |&gt;\n  mutate(etendue = fin - deb) |&gt;\n  arrange(desc(n_annee))</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre># A tibble: 922 × 6\n   nom_usuel       num_poste   deb   fin n_annee etendue\n   &lt;chr&gt;           &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;int&gt;   &lt;dbl&gt;\n 1 ST-GENIS-LAVAL  69204002   1881  2023     129     142\n 2 CHAMONIX        74056001   1880  2023     110     143\n 3 MONESTIER       38242001   1916  2023     107     107\n 4 MONTELIMAR      26198001   1920  2023     104     103\n 5 LYON-BRON       69029001   1920  2023     104     103\n 6 BOURG EN BRESSE 01053001   1890  1992     103     102\n 7 CLERMONT-FD     63113001   1923  2023     101     100\n 8 PRIVAS          07186002   1865  1968      98     103\n 9 ANNECY          74010001   1876  1976      97     100\n10 LE PUY-CHADRAC  43046001   1928  2023      96      95\n# ℹ 912 more rows</pre>\n</div>\n</div>\n<p>Choosing the longest time series:</p>\n<div class=\"cell\">\n<pre>meteo |&gt;\n  filter(num_poste == \"69204002\") |&gt;\n  mutate(tm = if_else(is.na(tm), (tx + tn) / 2, tm)) |&gt; \n  select(num_poste, nom_usuel, aaaammjj, tn, tm, tx) |&gt; \n  pivot_longer(c(tn, tm, tx),\n               names_to = \"mesure\", \n               values_to = \"temp\") |&gt; \n  mutate(mesure = factor(mesure, \n                       levels = c(\"tx\", \"tm\", \"tn\"),\n                       labels = c(\"Tmax\", \"Tmoy\", \"Tmin\"))) %&gt;% {\n    ggplot(data = ., aes(aaaammjj, temp, color = mesure)) +\n    geom_point(size = 1, alpha = 0.01) +\n    geom_smooth(method = \"gam\", \n                formula = y ~ s(x, bs = \"cs\", k = 30)) +\n    scale_x_date(date_breaks = \"10 years\", \n                 date_labels = \"%Y\",expand = expansion(),\n                 limits = ymd(paste0(c(\n                   round_any(min(year(.$aaaammjj), na.rm = TRUE), 10, floor),\n                   round_any(max(year(.$aaaammjj), na.rm = TRUE), 10, ceiling)), \"0101\"))) +\n    scale_y_continuous(breaks = scales::breaks_pretty(4),\n                       minor_breaks = scales::breaks_pretty(40)) +\n    scale_color_manual(values = c(\"Tmin\" = \"deepskyblue2\",\n                                  \"Tmoy\" = \"grey50\",\n                                  \"Tmax\" = \"firebrick2\"),\n                       labels = list(\"Tmax\" = bquote(T[max]), \n                                     \"Tmoy\"= bquote(T[moy]),\n                                     \"Tmin\"= bquote(T[min]))) +\n    labs(title = glue(\"{.$nom_usuel[[1]]} ({str_sub(.$num_poste[[1]], 1, 2)})\"),\n         subtitle = \"Températures quotidiennes\",\n         x = \"année\",\n         y = \"℃\",\n         caption = glue(\"données Météo-France (https://meteo.data.gouv.fr/)\n                        https://r.iresmi.net/ {Sys.Date()}\")) +\n    theme_minimal() +\n    theme(plot.caption = element_text(size = 6),\n            axis.title.y = element_text(angle = 0, vjust = 0.5))\n  }</pre>\n<div class=\"cell-output-display\">\n<div class=\"quarto-figure quarto-figure-center anchored\" id=\"fig-temp\">\n<figure class=\"figure\">\n<p><img alt=\"Min and max temperature smoothed\" class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/r.iresmi.net/posts/2023/meteofrance/index_files/figure-html/fig-temp-1.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" style=\"width:100.0%\"/><noscript><img alt=\"Min and max temperature smoothed\" class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/r.iresmi.net/posts/2023/meteofrance/index_files/figure-html/fig-temp-1.png?w=578&amp;ssl=1\" style=\"width:100.0%\"/></noscript></p>\n<figcaption class=\"figure-caption\">Figure 2: oldest/longest regional temperature series</figcaption>\n</figure>\n</div>\n</div>\n</div>\n<!-- -->\n</section>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://r.iresmi.net/posts/2023/meteofrance/index.html\"> r.iresmi.net</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
      "main_text": "Météo-France Open Data\nPosted on\nDecember 13, 2023\nby\nMichael\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nr.iresmi.net\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nTemperature – CC-BY-SA by domollie\nGreat news! Météo-France\nhas started\nto widen its\nopen archive data\n. No API so far and a lot of files… What can we do?\nlibrary(tidyverse)\nlibrary(httr)\nlibrary(glue)\nlibrary(janitor)\nlibrary(jsonlite)\nlibrary(sf)\n\nround_any <- function(x, accuracy, f = round) {\n  f(x / accuracy) * accuracy\n}\nWe can start by selecting a few\ndépartements\n, here the 12 from Auvergne-Rhône-Alpes.\n# which départements to download\nsel_dep <- c(\"01\", \"03\", \"07\", \"15\", \"26\", \"38\", \"42\", \"43\", \"63\", \"69\", \"73\", \"74\")\n\n# for the map (code INSEE région)\nsel_reg <- \"84\"\nScraping\nGet some information about the available files for the daily data (\nDonnées climatologiques de base - quotidiennes\n).\n# count files available\nn_files <- GET(\"https://www.data.gouv.fr/api/2/datasets/6569b51ae64326786e4e8e1a/\") |>\n  content() |> \n  pluck(\"resources\", \"total\")\n\n# get files informations\nfiles_available <- GET(glue(\"https://www.data.gouv.fr/api/2/datasets/6569b51ae64326786e4e8e1a/resources/?page=1&page_size={n_files}&type=main\")) |> \n  content(as = \"text\", encoding = \"UTF-8\") |> \n  fromJSON(flatten = TRUE) |> \n  pluck(\"data\") |> \n  as_tibble(.name_repair = make_clean_names)\nDownload and open the files\nif (!length(list.files(\"data\"))) {\n  files_available |> \n    mutate(dep = str_extract(title, \"(?<=departement_)[:alnum:]{2,3}(?=_)\")) |> \n    filter(dep %in% sel_dep,\n           str_detect(title, \"RR-T-Vent\")) |> \n    pwalk(\\(url, title, format, ...) {\n      GET(url,\n          write_disk(glue(\"data/{title}.{format}\"),\n                     overwrite = TRUE))\n  })\n}\nWe get 36 files…Each département has 3 files representing the recent years, 1950-2021 and before 1950.\n# parsing problems with readr::read_delim\n# we use read.delim instead\nmeteo <- list.files(\"data\", full.names = TRUE) |> \n  map(read.delim,\n      sep = \";\",\n      colClasses = c(\"NUM_POSTE\" = \"character\",\n                     \"AAAAMMJJ\" = \"character\")) |> \n  list_rbind() |> \n  as_tibble(.name_repair = make_clean_names) |>\n  mutate(num_poste = str_trim(num_poste),\n         aaaammjj = ymd(aaaammjj))\n\n# Map data\n# See https://r.iresmi.net/posts/2021/simplifying_polygons_layers/\ndep_sig <- read_sf(\"~/data/adminexpress/adminexpress_cog_simpl_000_2022.gpkg\",\n                   layer = \"departement\") |> \n  filter(insee_reg == sel_reg) |> \n  st_transform(\"EPSG:2154\")\nThat’s a nice dataset of 19,222,848 rows!\nExploring\nmeteo |> \n  summarise(.by= c(nom_usuel, num_poste, lat, lon),\n            annee_max = max(year(aaaammjj))) |> \n  st_as_sf(coords = c(\"lon\", \"lat\"), crs = \"EPSG:4326\") |> \n  st_transform(\"EPSG:2154\") |> \n  ggplot() +\n  geom_sf(data = dep_sig) +\n  geom_sf(aes(color = annee_max == year(Sys.Date()),\n              shape = annee_max == year(Sys.Date())),\n          size = 2, alpha = 0.5) +\n  scale_color_manual(name = \"statut\",\n                     values = c(\"FALSE\" = \"chocolate4\",\n                                \"TRUE\" = \"chartreuse3\"),\n                     labels = c(\"FALSE\" = \"inactive\",\n                                \"TRUE\" = \"active\")) +\n  scale_shape_manual(name = \"statut\",\n                     values = c(\"FALSE\" = 16,\n                                \"TRUE\" = 17),\n                     labels = c(\"FALSE\" = \"inactive\",\n                                \"TRUE\" = \"active\")) +\n  labs(title = \"Stations météo\",\n       subtitle = \"Auvergne-Rhône-Alpes\",\n       caption = glue(\"données Météo-France (https://meteo.data.gouv.fr/)\n                      carto : d'après IGN Admin Express 2022\n                      https://r.iresmi.net/ {Sys.Date()}\")) +\n  guides(color = guide_legend(reverse = TRUE),\n         shape = guide_legend(reverse = TRUE)) +\n  theme_minimal() +\n  theme(plot.caption = element_text(size = 6))\nFigure 1: Weather stations in Auvergne-Rhône-Alpes\nWhat would be an interesting station?\n# longest temperature time series (possibly discontinuous)\nmeteo |>\n  filter(!is.na(tx)) |>\n  summarise(.by = c(nom_usuel, num_poste),\n            deb = min(year(aaaammjj)),\n            fin = max(year(aaaammjj)),\n            n_annee = n_distinct(year(aaaammjj))) |>\n  mutate(etendue = fin - deb) |>\n  arrange(desc(n_annee))\n# A tibble: 922 × 6\n   nom_usuel       num_poste   deb   fin n_annee etendue\n   <chr>           <chr>     <dbl> <dbl>   <int>   <dbl>\n 1 ST-GENIS-LAVAL  69204002   1881  2023     129     142\n 2 CHAMONIX        74056001   1880  2023     110     143\n 3 MONESTIER       38242001   1916  2023     107     107\n 4 MONTELIMAR      26198001   1920  2023     104     103\n 5 LYON-BRON       69029001   1920  2023     104     103\n 6 BOURG EN BRESSE 01053001   1890  1992     103     102\n 7 CLERMONT-FD     63113001   1923  2023     101     100\n 8 PRIVAS          07186002   1865  1968      98     103\n 9 ANNECY          74010001   1876  1976      97     100\n10 LE PUY-CHADRAC  43046001   1928  2023      96      95\n# ℹ 912 more rows\nChoosing the longest time series:\nmeteo |>\n  filter(num_poste == \"69204002\") |>\n  mutate(tm = if_else(is.na(tm), (tx + tn) / 2, tm)) |> \n  select(num_poste, nom_usuel, aaaammjj, tn, tm, tx) |> \n  pivot_longer(c(tn, tm, tx),\n               names_to = \"mesure\", \n               values_to = \"temp\") |> \n  mutate(mesure = factor(mesure, \n                       levels = c(\"tx\", \"tm\", \"tn\"),\n                       labels = c(\"Tmax\", \"Tmoy\", \"Tmin\"))) %>% {\n    ggplot(data = ., aes(aaaammjj, temp, color = mesure)) +\n    geom_point(size = 1, alpha = 0.01) +\n    geom_smooth(method = \"gam\", \n                formula = y ~ s(x, bs = \"cs\", k = 30)) +\n    scale_x_date(date_breaks = \"10 years\", \n                 date_labels = \"%Y\",expand = expansion(),\n                 limits = ymd(paste0(c(\n                   round_any(min(year(.$aaaammjj), na.rm = TRUE), 10, floor),\n                   round_any(max(year(.$aaaammjj), na.rm = TRUE), 10, ceiling)), \"0101\"))) +\n    scale_y_continuous(breaks = scales::breaks_pretty(4),\n                       minor_breaks = scales::breaks_pretty(40)) +\n    scale_color_manual(values = c(\"Tmin\" = \"deepskyblue2\",\n                                  \"Tmoy\" = \"grey50\",\n                                  \"Tmax\" = \"firebrick2\"),\n                       labels = list(\"Tmax\" = bquote(T[max]), \n                                     \"Tmoy\"= bquote(T[moy]),\n                                     \"Tmin\"= bquote(T[min]))) +\n    labs(title = glue(\"{.$nom_usuel[[1]]} ({str_sub(.$num_poste[[1]], 1, 2)})\"),\n         subtitle = \"Températures quotidiennes\",\n         x = \"année\",\n         y = \"℃\",\n         caption = glue(\"données Météo-France (https://meteo.data.gouv.fr/)\n                        https://r.iresmi.net/ {Sys.Date()}\")) +\n    theme_minimal() +\n    theme(plot.caption = element_text(size = 6),\n            axis.title.y = element_text(angle = 0, vjust = 0.5))\n  }\nFigure 2: oldest/longest regional temperature series\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nr.iresmi.net\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Temperature – CC-BY-SA by domollie Great news! Météo-France has started to widen its open archive data. No API so far and a lot of files… What can we do? library(tidyverse) library(httr) library(glue) library(janitor) library(jsonlite) libr...",
      "meta_keywords": null,
      "og_description": "Temperature – CC-BY-SA by domollie Great news! Météo-France has started to widen its open archive data. No API so far and a lot of files… What can we do? library(tidyverse) library(httr) library(glue) library(janitor) library(jsonlite) libr...",
      "og_image": "https://r.iresmi.net/posts/2023/meteofrance/images/2618997594_9eab6a5141_c.jpg",
      "og_title": "Météo-France Open Data | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 4.5,
      "sitemap_lastmod": "2023-12-13T11:00:00+00:00",
      "twitter_description": "Temperature – CC-BY-SA by domollie Great news! Météo-France has started to widen its open archive data. No API so far and a lot of files… What can we do? library(tidyverse) library(httr) library(glue) library(janitor) library(jsonlite) libr...",
      "twitter_title": "Météo-France Open Data | R-bloggers",
      "url": "https://www.r-bloggers.com/2023/12/meteo-france-open-data/",
      "word_count": 896
    }
  }
}