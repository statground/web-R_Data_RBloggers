{
  "uuid": "9fbc2a4c-e1ba-40d3-b47c-1be000567bde",
  "created_at": "2025-11-17 20:39:24",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2023/11/clustering-points-to-polygons/",
    "crawled_at": "2025-11-17T10:00:47.772081",
    "external_links": [
      {
        "href": "https://r.iresmi.net/posts/2023/clustering_points_polygons/index.html",
        "text": "r.iresmi.net"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://flic.kr/p/2kTZwHw",
        "text": null
      },
      {
        "href": "https://30daymapchallenge.com/",
        "text": "30DayMapChallenge"
      },
      {
        "href": "https://r.iresmi.net/#category=30DayMapChallenge",
        "text": "previously"
      },
      {
        "href": "https://r.iresmi.net/posts/2023/lynx_from_gbif/",
        "text": "previous post"
      },
      {
        "href": "https://en.wikipedia.org/wiki/Eurasian_lynx",
        "text": "lynx"
      },
      {
        "href": "https://en.wikipedia.org/wiki/Jura_Mountains",
        "text": "Jura"
      },
      {
        "href": "https://en.wikipedia.org/wiki/Vosges",
        "text": "Vosges"
      },
      {
        "href": "https://en.wikipedia.org/wiki/Dijon",
        "text": "Dijon"
      },
      {
        "href": "https://r.iresmi.net/posts/2023/clustering_points_polygons/index.html",
        "text": "r.iresmi.net"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Clustering points to polygons | R-bloggers",
    "images": [
      {
        "alt": "A photo of a female lynx posing on a dead tree",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "A photo of a female lynx posing on a dead tree",
        "base64": null,
        "src": "https://i1.wp.com/r.iresmi.net/posts/2023/clustering_points_polygons/images/51127837144_35ffc137e0_c.jpg?w=578&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/michael/",
        "text": "Michael"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-379628 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Clustering points to polygons</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">November 3, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/michael/\">Michael</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://r.iresmi.net/posts/2023/clustering_points_polygons/index.html\"> r.iresmi.net</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div class=\"quarto-figure quarto-figure-center\">\n<figure class=\"figure\">\n<p><a href=\"https://flic.kr/p/2kTZwHw\" rel=\"nofollow\" target=\"_blank\"><img alt=\"A photo of a female lynx posing on a dead tree\" class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/r.iresmi.net/posts/2023/clustering_points_polygons/images/51127837144_35ffc137e0_c.jpg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"A photo of a female lynx posing on a dead tree\" class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/r.iresmi.net/posts/2023/clustering_points_polygons/images/51127837144_35ffc137e0_c.jpg?w=578&amp;ssl=1\"/></noscript></a></p>\n<figcaption class=\"figure-caption\">Female lynx posing on the dead tree – CC-BY-ND by Tambako The Jaguar</figcaption>\n</figure>\n</div>\n<p>Day 3 of <a href=\"https://30daymapchallenge.com/\" rel=\"nofollow\" target=\"_blank\">30DayMapChallenge</a>: « Polygons » (<a href=\"https://r.iresmi.net/#category=30DayMapChallenge\" rel=\"nofollow\" target=\"_blank\">previously</a>). Using data from a <a href=\"https://r.iresmi.net/posts/2023/lynx_from_gbif/\" rel=\"nofollow\" target=\"_blank\">previous post</a> on <a href=\"https://en.wikipedia.org/wiki/Eurasian_lynx\" rel=\"nofollow\" target=\"_blank\">lynx</a> occurrences.</p>\n<p>So we mapped the sightings of lynx, but there are a lot of outliers; how can we map the core habitat of the species?</p>\n<p>We will use DBSCAN to cluster the points, then we will build a concave hull of these clusters. We arbitrary chose a minimal distance of 12 km between clusters and at least 5 points per clusters. Many coordinates are duplicated so we’ll get rid of artificial one-dimension polygons.</p>\n<div class=\"cell\">\n<pre>library(rgbif)\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(leaflet)\nlibrary(dbscan)\nlibrary(concaveman)\n\n# use existing data from GBIF\n# keep valid and recent sightings in France.\nlynx &lt;- occ_download_get(\"0034730-231002084531237\") |&gt; \n  occ_download_import() |&gt; \n  drop_na(decimalLongitude, decimalLatitude) |&gt;\n  filter(year &gt;= \"2015\", \n         countryCode == \"FR\",\n         occurrenceStatus == \"PRESENT\") |&gt; \n  st_as_sf(coords = c(\"decimalLongitude\", \"decimalLatitude\"), \n           crs = \"EPSG:4326\", \n           remove = FALSE)\n\n# Create clusters\n# we reproject to a Lambert projection to have units in meters\nclusters &lt;- lynx |&gt; \n  st_transform(\"EPSG:2154\") |&gt; \n  st_coordinates() |&gt; \n  dbscan(eps = 12000, minPts = 5)\n\n# Create concave hulls\n# we can chose an appropriate concavity parameter\nconcave_hulls &lt;- lynx |&gt; \n  bind_cols(tibble(cluster = clusters$cluster)) |&gt;\n  filter(cluster != 0) |&gt; \n  group_by(cluster) |&gt;\n  summarise(nd = n_distinct(decimalLongitude, decimalLatitude),\n            .groups = \"drop\") |&gt; \n  filter(nd &gt; 2) |&gt; \n  mutate(geom = map(geometry, ~ concaveman(st_sf(st_sfc(.x)),\n                                           concavity = 1.7))) |&gt; \n  st_drop_geometry() |&gt; \n  unnest(geom) |&gt; \n  st_sf(crs = \"EPSG:4326\") |&gt; \n  st_zm()</pre>\n</div>\n<div class=\"cell\">\n<pre>lynx |&gt; \n  leaflet() |&gt; \n  addCircleMarkers(radius = 0.1, opacity = 0.1) |&gt; \n  addPolygons(data = concave_hulls, color = \"red\") |&gt; \n  addTiles()</pre>\n<div class=\"quarto-figure quarto-figure-center anchored\" id=\"fig-lynx-map\">\n<figure class=\"figure\">\n<div class=\"leaflet html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-020f8ba5689d5c27997d\" style=\"width:100%;height:464px;\"></div>\n\n<figcaption class=\"figure-caption\">Figure 1: Lynx occurrence 2015-2023</figcaption>\n</figure>\n</div>\n</div>\n<p>We get 4 clusters: <a href=\"https://en.wikipedia.org/wiki/Jura_Mountains\" rel=\"nofollow\" target=\"_blank\">Jura</a>, <a href=\"https://en.wikipedia.org/wiki/Vosges\" rel=\"nofollow\" target=\"_blank\">Vosges</a> (North and South) and West of <a href=\"https://en.wikipedia.org/wiki/Dijon\" rel=\"nofollow\" target=\"_blank\">Dijon</a>. We could estimate a rough lynx occupancy area in France:</p>\n<div class=\"cell\">\n<pre>concave_hulls |&gt; \n  st_area() |&gt; \n  sum() |&gt; \n  units::set_units(km^2)</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>17925.6 [km^2]</pre>\n</div>\n</div>\n<!-- -->\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://r.iresmi.net/posts/2023/clustering_points_polygons/index.html\"> r.iresmi.net</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
    "main_text": "Clustering points to polygons\nPosted on\nNovember 3, 2023\nby\nMichael\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nr.iresmi.net\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nFemale lynx posing on the dead tree – CC-BY-ND by Tambako The Jaguar\nDay 3 of\n30DayMapChallenge\n: « Polygons » (\npreviously\n). Using data from a\nprevious post\non\nlynx\noccurrences.\nSo we mapped the sightings of lynx, but there are a lot of outliers; how can we map the core habitat of the species?\nWe will use DBSCAN to cluster the points, then we will build a concave hull of these clusters. We arbitrary chose a minimal distance of 12 km between clusters and at least 5 points per clusters. Many coordinates are duplicated so we’ll get rid of artificial one-dimension polygons.\nlibrary(rgbif)\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(leaflet)\nlibrary(dbscan)\nlibrary(concaveman)\n\n# use existing data from GBIF\n# keep valid and recent sightings in France.\nlynx <- occ_download_get(\"0034730-231002084531237\") |> \n  occ_download_import() |> \n  drop_na(decimalLongitude, decimalLatitude) |>\n  filter(year >= \"2015\", \n         countryCode == \"FR\",\n         occurrenceStatus == \"PRESENT\") |> \n  st_as_sf(coords = c(\"decimalLongitude\", \"decimalLatitude\"), \n           crs = \"EPSG:4326\", \n           remove = FALSE)\n\n# Create clusters\n# we reproject to a Lambert projection to have units in meters\nclusters <- lynx |> \n  st_transform(\"EPSG:2154\") |> \n  st_coordinates() |> \n  dbscan(eps = 12000, minPts = 5)\n\n# Create concave hulls\n# we can chose an appropriate concavity parameter\nconcave_hulls <- lynx |> \n  bind_cols(tibble(cluster = clusters$cluster)) |>\n  filter(cluster != 0) |> \n  group_by(cluster) |>\n  summarise(nd = n_distinct(decimalLongitude, decimalLatitude),\n            .groups = \"drop\") |> \n  filter(nd > 2) |> \n  mutate(geom = map(geometry, ~ concaveman(st_sf(st_sfc(.x)),\n                                           concavity = 1.7))) |> \n  st_drop_geometry() |> \n  unnest(geom) |> \n  st_sf(crs = \"EPSG:4326\") |> \n  st_zm()\nlynx |> \n  leaflet() |> \n  addCircleMarkers(radius = 0.1, opacity = 0.1) |> \n  addPolygons(data = concave_hulls, color = \"red\") |> \n  addTiles()\nFigure 1: Lynx occurrence 2015-2023\nWe get 4 clusters:\nJura\n,\nVosges\n(North and South) and West of\nDijon\n. We could estimate a rough lynx occupancy area in France:\nconcave_hulls |> \n  st_area() |> \n  sum() |> \n  units::set_units(km^2)\n17925.6 [km^2]\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nr.iresmi.net\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "Female lynx posing on the dead tree – CC-BY-ND by Tambako The Jaguar Day 3 of 30DayMapChallenge: « Polygons » (previously). Using data from a previous post on lynx occurrences. So we mapped the sightings of lynx, but there are a lot of outliers; how can we map the core habitat of the species? We will use DBSCAN to cluster the points, then we will build a concave hull of these clusters. We arbitrary chose a minimal distance of 12 km between clusters and at least 5 points per clusters. Many coordinates are duplicated so we’ll get rid of artificial one-dimension polygons. library(rgbif) library(tidyverse) library(sf) library(leaflet) library(dbscan) library(concaveman) # use existing data from GBIF # keep valid and recent sightings in France. lynx occ_download_import() |> drop_na(decimalLongitude, decimalLatitude) |> filter(year >= \"2015\", countryCode == \"FR\", occurrenceStatus == \"PRESENT\") |> st_as_sf(coords = c(\"decimalLongitude\", \"decimalLatitude\"), crs = \"EPSG:4326\", remove = FALSE) # Create clusters # we reproject to a Lambert projection to have units in meters clusters st_transform(\"EPSG:2154\") |> st_coordinates() |> dbscan(eps = 12000, minPts = 5) # Create concave hulls # we can chose an appropriate concavity parameter concave_hulls bind_cols(tibble(cluster = clusters$cluster)) |> filter(cluster != 0) |> group_by(cluster) |> summarise(nd = n_distinct(decimalLongitude, decimalLatitude), .groups = \"drop\") |> filter(nd > 2) |> mutate(geom = map(geometry, ~ concaveman(st_sf(st_sfc(.x)), concavity = 1.7))) |> st_drop_geometry() |> unnest(geom) |> st_sf(crs = \"EPSG:4326\") |> st_zm() lynx |> leaflet() |> addCircleMarkers(radius = 0.1, opacity = 0.1) |> addPolygons(data = concave_hulls, color = \"red\") |> addTiles() Figure 1: Lynx occurrence 2015-2023 We get 4 clusters: Jura, Vosges (North and South) and West of Dijon. We could estimate a rough lynx occupancy area in France: concave_hulls |> st_area() |> sum() |> units::set_units(km^2) 17925.6 [km^2]",
    "meta_keywords": null,
    "og_description": "Female lynx posing on the dead tree – CC-BY-ND by Tambako The Jaguar Day 3 of 30DayMapChallenge: « Polygons » (previously). Using data from a previous post on lynx occurrences. So we mapped the sightings of lynx, but there are a lot of outliers; how can we map the core habitat of the species? We will use DBSCAN to cluster the points, then we will build a concave hull of these clusters. We arbitrary chose a minimal distance of 12 km between clusters and at least 5 points per clusters. Many coordinates are duplicated so we’ll get rid of artificial one-dimension polygons. library(rgbif) library(tidyverse) library(sf) library(leaflet) library(dbscan) library(concaveman) # use existing data from GBIF # keep valid and recent sightings in France. lynx occ_download_import() |> drop_na(decimalLongitude, decimalLatitude) |> filter(year >= \"2015\", countryCode == \"FR\", occurrenceStatus == \"PRESENT\") |> st_as_sf(coords = c(\"decimalLongitude\", \"decimalLatitude\"), crs = \"EPSG:4326\", remove = FALSE) # Create clusters # we reproject to a Lambert projection to have units in meters clusters st_transform(\"EPSG:2154\") |> st_coordinates() |> dbscan(eps = 12000, minPts = 5) # Create concave hulls # we can chose an appropriate concavity parameter concave_hulls bind_cols(tibble(cluster = clusters$cluster)) |> filter(cluster != 0) |> group_by(cluster) |> summarise(nd = n_distinct(decimalLongitude, decimalLatitude), .groups = \"drop\") |> filter(nd > 2) |> mutate(geom = map(geometry, ~ concaveman(st_sf(st_sfc(.x)), concavity = 1.7))) |> st_drop_geometry() |> unnest(geom) |> st_sf(crs = \"EPSG:4326\") |> st_zm() lynx |> leaflet() |> addCircleMarkers(radius = 0.1, opacity = 0.1) |> addPolygons(data = concave_hulls, color = \"red\") |> addTiles() Figure 1: Lynx occurrence 2015-2023 We get 4 clusters: Jura, Vosges (North and South) and West of Dijon. We could estimate a rough lynx occupancy area in France: concave_hulls |> st_area() |> sum() |> units::set_units(km^2) 17925.6 [km^2]",
    "og_image": "https://r.iresmi.net/posts/2023/clustering_points_polygons/images/51127837144_35ffc137e0_c.jpg",
    "og_title": "Clustering points to polygons | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 2.1,
    "sitemap_lastmod": "2023-11-03T17:00:00+00:00",
    "twitter_description": "Female lynx posing on the dead tree – CC-BY-ND by Tambako The Jaguar Day 3 of 30DayMapChallenge: « Polygons » (previously). Using data from a previous post on lynx occurrences. So we mapped the sightings of lynx, but there are a lot of outliers; how can we map the core habitat of the species? We will use DBSCAN to cluster the points, then we will build a concave hull of these clusters. We arbitrary chose a minimal distance of 12 km between clusters and at least 5 points per clusters. Many coordinates are duplicated so we’ll get rid of artificial one-dimension polygons. library(rgbif) library(tidyverse) library(sf) library(leaflet) library(dbscan) library(concaveman) # use existing data from GBIF # keep valid and recent sightings in France. lynx occ_download_import() |> drop_na(decimalLongitude, decimalLatitude) |> filter(year >= \"2015\", countryCode == \"FR\", occurrenceStatus == \"PRESENT\") |> st_as_sf(coords = c(\"decimalLongitude\", \"decimalLatitude\"), crs = \"EPSG:4326\", remove = FALSE) # Create clusters # we reproject to a Lambert projection to have units in meters clusters st_transform(\"EPSG:2154\") |> st_coordinates() |> dbscan(eps = 12000, minPts = 5) # Create concave hulls # we can chose an appropriate concavity parameter concave_hulls bind_cols(tibble(cluster = clusters$cluster)) |> filter(cluster != 0) |> group_by(cluster) |> summarise(nd = n_distinct(decimalLongitude, decimalLatitude), .groups = \"drop\") |> filter(nd > 2) |> mutate(geom = map(geometry, ~ concaveman(st_sf(st_sfc(.x)), concavity = 1.7))) |> st_drop_geometry() |> unnest(geom) |> st_sf(crs = \"EPSG:4326\") |> st_zm() lynx |> leaflet() |> addCircleMarkers(radius = 0.1, opacity = 0.1) |> addPolygons(data = concave_hulls, color = \"red\") |> addTiles() Figure 1: Lynx occurrence 2015-2023 We get 4 clusters: Jura, Vosges (North and South) and West of Dijon. We could estimate a rough lynx occupancy area in France: concave_hulls |> st_area() |> sum() |> units::set_units(km^2) 17925.6 [km^2]",
    "twitter_title": "Clustering points to polygons | R-bloggers",
    "url": "https://www.r-bloggers.com/2023/11/clustering-points-to-polygons/",
    "word_count": 421
  }
}