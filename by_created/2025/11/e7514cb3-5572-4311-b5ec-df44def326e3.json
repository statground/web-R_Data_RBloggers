{
  "uuid": "e7514cb3-5572-4311-b5ec-df44def326e3",
  "created_at": "2025-11-22 19:58:29",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2025/05/a-pace-far-different-finding-best-running-pace-with-r/",
    "crawled_at": "2025-11-22T10:48:13.777811",
    "external_links": [
      {
        "href": "https://quantixed.org/2025/05/27/a-pace-far-different-finding-best-running-pace-with-r/",
        "text": "Rstats – quantixed"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://quantixed.org/2025/05/27/a-pace-far-different-finding-best-running-pace-with-r/#the-code",
        "text": "click here to see the code"
      },
      {
        "href": "https://quantixed.org/2025/05/27/a-pace-far-different-finding-best-running-pace-with-r/",
        "text": "Rstats – quantixed"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "A Pace Far Different: finding best running pace with R | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/bestefforts-240x300.png?resize=240%2C300&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/stephen-royle/",
        "text": "Stephen Royle"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-392669 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">A Pace Far Different: finding best running pace with R</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">May 27, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/stephen-royle/\">Stephen Royle</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://quantixed.org/2025/05/27/a-pace-far-different-finding-best-running-pace-with-r/\"> Rstats – quantixed</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<p>If you are into running, chances are that you will be chasing your PB (personal best) times. This post is about using R to search for your PBs, and to monitor them over time.</p>\n<p>Usually runners target four distances for PBs: 5 km, 10 km, half marathon and full marathon. It’s likely that a PB will come in a race of exactly that distance, but not necessarily. For example, you can hit a 5K PB during a 10K race. Therefore we need a way to scan our runs for the fastest segment at each distance to track our PBs correctly. Similarly, your best ever half marathon event time may be slightly longer than the half marathon distance, so what was your “real” PB for that distance?</p>\n<p>Strava and other fitness tracking software will find your best time for a given distance within your activities, but here we’ll use R. We’ll look at the data first. Scroll down or <a href=\"https://quantixed.org/2025/05/27/a-pace-far-different-finding-best-running-pace-with-r/#the-code\" rel=\"nofollow\" target=\"_blank\">click here to see the code</a>.</p>\n<h2 class=\"wp-block-heading\">Tracking PBs</h2>\n<p>Here we are looking at all running data over several years. Each run is shown as a dot, and the blue line represents my PB. We can look at 5K, 10K, half and full marathon. For all distances, my PB has come down over time (obviously) but satisfyingly, I set PBs in all four distances this year.</p>\n<p>Notice that the density of dots is highest for the 5K plot. It shows all runs of 5K <em>or more</em>. The same for the other distances. We search all runs to find the fastest segment at the set distance shown on the plot.</p>\n<figure class=\"wp-block-gallery has-nested-images columns-2 is-cropped wp-block-gallery-1 is-layout-flex wp-block-gallery-is-layout-flex\">\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-3440\" data-id=\"3440\" data-lazy-sizes=\"(max-width: 2400px) 100vw, 2400px\" data-lazy-src=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" decoding=\"async\" fetchpriority=\"high\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot.png?w=450&amp;ssl=1 2400w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot-300x225.png 300w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot-1024x768.png 1024w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot-768x576.png 768w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot-1536x1152.png 1536w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot-2048x1536.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3440\" data-id=\"3440\" data-recalc-dims=\"1\" decoding=\"async\" fetchpriority=\"high\" loading=\"lazy\" sizes=\"(max-width: 2400px) 100vw, 2400px\" src=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot.png?w=450&amp;ssl=1\" srcset_temp=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot.png?w=450&amp;ssl=1 2400w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot-300x225.png 300w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot-1024x768.png 1024w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot-768x576.png 768w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot-1536x1152.png 1536w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot-2048x1536.png 2048w\"/></noscript></figure>\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-3441\" data-id=\"3441\" data-lazy-sizes=\"(max-width: 2400px) 100vw, 2400px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot.png?w=450&amp;ssl=1 2400w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot-300x225.png 300w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot-1024x768.png 1024w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot-768x576.png 768w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot-1536x1152.png 1536w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot-2048x1536.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3441\" data-id=\"3441\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"(max-width: 2400px) 100vw, 2400px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot.png?w=450&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot.png?w=450&amp;ssl=1 2400w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot-300x225.png 300w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot-1024x768.png 1024w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot-768x576.png 768w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot-1536x1152.png 1536w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_plot-2048x1536.png 2048w\"/></noscript></figure>\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-3442\" data-id=\"3442\" data-lazy-sizes=\"(max-width: 2400px) 100vw, 2400px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot.png?w=450&amp;ssl=1 2400w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot-300x225.png 300w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot-1024x768.png 1024w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot-768x576.png 768w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot-1536x1152.png 1536w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot-2048x1536.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3442\" data-id=\"3442\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"(max-width: 2400px) 100vw, 2400px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot.png?w=450&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot.png?w=450&amp;ssl=1 2400w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot-300x225.png 300w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot-1024x768.png 1024w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot-768x576.png 768w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot-1536x1152.png 1536w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_plot-2048x1536.png 2048w\"/></noscript></figure>\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-3443\" data-id=\"3443\" data-lazy-sizes=\"auto, (max-width: 2400px) 100vw, 2400px\" data-lazy-src=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot.png?w=450&amp;ssl=1 2400w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot-300x225.png 300w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot-1024x768.png 1024w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot-768x576.png 768w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot-1536x1152.png 1536w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot-2048x1536.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3443\" data-id=\"3443\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 2400px) 100vw, 2400px\" src=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot.png?w=450&amp;ssl=1\" srcset_temp=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot.png?w=450&amp;ssl=1 2400w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot-300x225.png 300w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot-1024x768.png 1024w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot-768x576.png 768w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot-1536x1152.png 1536w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_full_plot-2048x1536.png 2048w\"/></noscript></figure>\n</figure>\n<p>In the plots above, we cannot see what the total distance of each run is. Did the PB times come from the set distance or a longer run? To show this we can plot the fastest segment versus the total distance of the run.</p>\n<figure class=\"wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-2 is-layout-flex wp-block-gallery-is-layout-flex\">\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-3444\" data-id=\"3444\" data-lazy-sizes=\"auto, (max-width: 2400px) 100vw, 2400px\" data-lazy-src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot.png?w=450&amp;ssl=1 2400w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot-300x225.png 300w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot-1024x768.png 1024w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot-768x576.png 768w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot-1536x1152.png 1536w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot-2048x1536.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3444\" data-id=\"3444\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 2400px) 100vw, 2400px\" src=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot.png?w=450&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot.png?w=450&amp;ssl=1 2400w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot-300x225.png 300w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot-1024x768.png 1024w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot-768x576.png 768w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot-1536x1152.png 1536w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_max_distance_plot-2048x1536.png 2048w\"/></noscript></figure>\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-3445\" data-id=\"3445\" data-lazy-sizes=\"auto, (max-width: 2400px) 100vw, 2400px\" data-lazy-src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot.png?w=450&amp;ssl=1 2400w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot-300x225.png 300w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot-1024x768.png 1024w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot-768x576.png 768w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot-1536x1152.png 1536w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot-2048x1536.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3445\" data-id=\"3445\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 2400px) 100vw, 2400px\" src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot.png?w=450&amp;ssl=1\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot.png?w=450&amp;ssl=1 2400w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot-300x225.png 300w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot-1024x768.png 1024w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot-768x576.png 768w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot-1536x1152.png 1536w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_10k_max_distance_plot-2048x1536.png 2048w\"/></noscript></figure>\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-3446\" data-id=\"3446\" data-lazy-sizes=\"auto, (max-width: 2400px) 100vw, 2400px\" data-lazy-src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot.png?w=450&amp;ssl=1 2400w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot-300x225.png 300w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot-1024x768.png 1024w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot-768x576.png 768w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot-1536x1152.png 1536w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot-2048x1536.png 2048w\"/><noscript><img alt=\"\" class=\"wp-image-3446\" data-id=\"3446\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"auto, (max-width: 2400px) 100vw, 2400px\" src=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot.png?w=450&amp;ssl=1\" srcset_temp=\"https://i1.wp.com/quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot.png?w=450&amp;ssl=1 2400w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot-300x225.png 300w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot-1024x768.png 1024w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot-768x576.png 768w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot-1536x1152.png 1536w, https://quantixed.org/wp-content/uploads/2025/05/activityDF_half_max_distance_plot-2048x1536.png 2048w\"/></noscript></figure>\n</figure>\n<p>These plots show that my 10K PB currently comes from a half marathon run. Also, I managed a few sub-20 min 5K times during runs of that distance too. Apart from 10K, my PBs came from running the set distance.</p>\n<p>The script analyses the four main distances, but obviously it could search for any distance at all. Examples that others like to track include 1K, 30K and integer mile distances.</p>\n<p>As mentioned above, Strava calculates these in what it calls Best Efforts. It allows you to enter your real PBs in a separate section.</p>\n<figure class=\"wp-block-image size-medium\"><img alt=\"\" class=\"wp-image-3448\" data-lazy-sizes=\"auto, (max-width: 240px) 100vw, 240px\" data-lazy-src=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/bestefforts-240x300.png?resize=240%2C300&amp;ssl=1\" data-recalc-dims=\"1\" decoding=\"async\" height=\"300\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/bestefforts-240x300.png?resize=240%2C300&amp;ssl=1 240w, https://quantixed.org/wp-content/uploads/2025/05/bestefforts.png 720w\" width=\"240\"/><noscript><img alt=\"\" class=\"wp-image-3448\" data-recalc-dims=\"1\" decoding=\"async\" height=\"300\" loading=\"lazy\" sizes=\"auto, (max-width: 240px) 100vw, 240px\" src=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/bestefforts-240x300.png?resize=240%2C300&amp;ssl=1\" srcset_temp=\"https://i2.wp.com/quantixed.org/wp-content/uploads/2025/05/bestefforts-240x300.png?resize=240%2C300&amp;ssl=1 240w, https://quantixed.org/wp-content/uploads/2025/05/bestefforts.png 720w\" width=\"240\"/></noscript></figure>\n<p>How does this compare? The code finds these PBs:</p>\n<ul class=\"wp-block-list\">\n<li>5K = 18:56</li>\n<li>10K = 40:01</li>\n<li>HM = 1:25:44</li>\n<li>Marathon = 3:25:29</li>\n</ul>\n<p>These are all faster than the Strava best efforts. All GPS data is noisy and different platforms and software make different assumptions, which makes comparisons quite difficult. Note that shortest set distance times are more error prone due to GPS blips. My 400 m PB is definitely <em>not</em> 45 s. The current world record is 43 s.</p>\n<p>My actual PBs, measured by chip timing are longer than both.</p>\n<ul class=\"wp-block-list\">\n<li>5K = 19:01</li>\n<li>10K = 40:04 (from HM)</li>\n<li>HM = 1:26:19</li>\n<li>Marathon = 3:26:39</li>\n</ul>\n<p>Yes, I really need to work on the that marathon time…</p>\n<p><strong>According to this analysis my calculated PBs are a little bit better than my actual PBs.</strong></p>\n<p>I think it’s best to be consistent and either go off one set of numbers or another, because ultimately, the only point of tracking PBs is to try to improve on them. For this, a single goal to shoot for is necessary.</p>\n<h2 class=\"wp-block-heading\" id=\"the-code\">The code</h2>\n<p>I’m starting this script with a large GPX file containing all of my runs. Other starting points might be a bunch of GPX files, one for each run, but we need to assemble a data frame of the timepoints and distances form all runs to do this calculation.</p>\n<p>We use <code>trackeR</code> for loading in the gpx files and a few other libraries to help with wrangling dates/times and for plotting.</p>\n<p>The code needs to search for the fastest segment of a set distance. My solution is far from optimal but it uses a few steps to reduce computation time. First, only runs of the set distance or grater are considered by first subsetting the large dataframe. Second, for each time point we can calculate the distance to every other point <em>as a vector</em> and then find the correct set distance, we take its time and compare to the minimum time found so far, and continue the search. This is considerably faster than comparing each point to every other point in nested for-loops. Third, if the max distance of the vector is less than the set distance, we have run out of points and we can stop the search. Further improvements would come from parallelising the code.</p>\n<pre>\nlibrary(trackeR)\nlibrary(ggplot2)\nlibrary(zoo)\nlibrary(hms)\nlibrary(lubridate)\n\n## Functions ----\n\nfind_fastest_segment &lt;- function(data, dist) {\n  data$best_segment &lt;- NA\n  # for each activity id in activityDF, we will subset runDF and calculate the\n  # speed for the fastest segment\n  for (i in 1:nrow(data)) {\n    activity_id &lt;- data$activity_id[i]\n    # check that max_distance is greater than the segment distance, if not, break\n    if (data$max_distance[i] &lt; dist * 0.99) {\n      data$best_segment[i] &lt;- NA\n      next\n    }\n    subsetDF &lt;- runDF[runDF$activity_id == activity_id, ]\n    # add progress bar for every 10th activity\n    if (i %% 10 == 0) {\n      cat(\"Processing activity\", i, \"of\", nrow(data), \"\\n\")\n    }\n    # calculate the best segment\n    best_segment &lt;- 0\n    for (j in 1:(nrow(subsetDF) - 1)) {\n      these_dists &lt;- subsetDF$distance_id - subsetDF$distance_id[j]\n      # check if the maximum distance is less than the segment distance\n      if (max(these_dists, na.rm = TRUE) &lt; dist * 0.99) {\n        break\n      }\n      these_times &lt;- subsetDF$time_id - subsetDF$time_id[j]\n      target_dists &lt;- these_dists[these_dists &gt; (dist * 0.99) &amp;\n                                    these_dists &lt; (dist * 1.01)]\n      # check we have some target distances\n      if (length(target_dists) == 0) {\n        # should not encounter this but we will go again if so (rather than break)\n        next\n      }\n      target_times &lt;- these_times[these_dists &gt; (dist * 0.99) &amp;\n                                    these_dists &lt; (dist * 1.01)]\n      target_speeds &lt;- target_dists / target_times\n      segment_speed &lt;- max(target_speeds, na.rm = TRUE)\n      if (segment_speed &gt; best_segment) {\n        best_segment &lt;- segment_speed\n        data$best_segment[i] &lt;- best_segment\n      }\n    }\n  }\n  # for each of the best_segment column, convert the speed to km/h\n  # and convert to a pace in min:ss per the distance\n  # the column best_segment is in m/s convert to km/h\n  data$best_kmh &lt;- data$best_segment * 3.6\n  # convert the column best_fullkmh to a pace in min:ss per 42.195 km\n  data$pace &lt;- (3600 / data$best_kmh) * (dist / 1000)\n  # convert the pace to a hms object\n  data$pace &lt;- hms::as_hms(data$pace)\n  \n  # remove rows with &gt; 16 kmh because there are gps blips in the data\n  data &lt;- data[data$best_kmh &lt; 16, ]\n  # remove rows with NA in the best_segment column\n  data &lt;- data[!is.na(data$best_segment), ]\n  \n  return(data)\n}\n\ncalculate_pb_pace &lt;- function(data) {\n  # make a new column the best pace at that point in time, i.e. if the pace is\n  # faster than previous that becomes the new best until it is surpassed\n  data$best_pace &lt;- NA\n  for (i in 1:nrow(data)) {\n    if (i == 1) {\n      data$best_pace[i] &lt;- data$pace[i]\n    } else {\n      if (data$pace[i] &lt; data$best_pace[i - 1]) {\n        data$best_pace[i] &lt;- data$pace[i]\n      } else {\n        data$best_pace[i] &lt;- data$best_pace[i - 1]\n      }\n    }\n  }\n  return(data)\n}\n\n## Script ----\n\n# find the gpx file in Data/ if there is more than one, select a gpx file\n# in the Data/ folder\nfiles &lt;- list.files(path = \"Data\", pattern = \"*.gpx\", full.names = TRUE)\nif (length(files) &gt; 1) {\n  cat(\"Please select a GPX file:\\n\")\n  for (i in seq_along(files)) {\n    cat(i, \": \", basename(files[i]), \"\\n\", sep = \"\")\n  }\n  choice &lt;- as.integer(readline(prompt = \"Enter the number of the file: \"))\n  filepath &lt;- files[choice]\n} else {\n  filepath &lt;- files[1]\n}\nrunDF &lt;- readGPX(file = filepath, timezone = \"GMT\")\n# save runDF as an r data object\nsave(runDF, file = \"Output/Data/runDF.RData\")\n# .. or load the runDF object\nload(\"Output/Data/runDF.RData\")\n\n# calculate point-to-point distance from the cumulative distance\nrunDF$dist_point &lt;- c(0, diff(runDF$distance, lag=1))\n# time calculations\nrunDF$time_temp &lt;- strptime(runDF$time, format = \"%Y-%m-%d %H:%M:%S\")\nrunDF$time_temp &lt;- as.numeric(runDF$time_temp)\nrunDF$time_point &lt;- c(0, diff(runDF$time_temp, lag=1))\n\n# if time_point is greater than 380 s it means that it is a different activity\n# so we set it to 0\nrunDF$time_point[runDF$time_point &gt; 380] &lt;- 0\n# if time_point is 0 we set the dist_point to 0\nrunDF$dist_point[runDF$time_point == 0] &lt;- 0\n# recalculate the cumulative distance\nrunDF$distance &lt;- cumsum(runDF$dist_point)\n\n# label the activities with an id number that we can use to refer to them\nrunDF$activity_id &lt;- cumsum(runDF$time_point == 0)\n\n# for each activity calculate the cumulative distance and time\nrunDF$distance_id &lt;- ave(runDF$dist_point, runDF$activity_id, FUN = function(x) cumsum(x))\nrunDF$time_id &lt;- ave(runDF$time_point, runDF$activity_id, FUN = function(x) cumsum(x))\n\n# make a dataframe with the activity id and maximum cumulative distance\nrunDF$max_distance &lt;- ave(runDF$distance_id, runDF$activity_id, FUN = max)\nrunDF$the_time &lt;- ave(runDF$time, runDF$activity_id, FUN = min)\nactivityDF &lt;- data.frame(activity_id = unique(runDF$activity_id),\n                         max_distance = unique(runDF$max_distance),\n                         time = unique(runDF$the_time))\nrunDF$max_distance &lt;- runDF$the_time &lt;- NULL\n\n# make separate dataframes for each distance\nactivityDF_5k &lt;- activityDF[activityDF$max_distance &gt; 5000 * 0.99, ]\nactivityDF_10k &lt;- activityDF[activityDF$max_distance &gt; 10000 * 0.99, ]\nactivityDF_half &lt;- activityDF[activityDF$max_distance &gt; 21097.5 * 0.99, ]\nactivityDF_full &lt;- activityDF[activityDF$max_distance &gt; 42195 * 0.99, ]\n\n# do the calculations for each distance\nactivityDF_5k &lt;- find_fastest_segment(activityDF_5k, 5000)\nactivityDF_10k &lt;- find_fastest_segment(activityDF_10k, 10000)\nactivityDF_half &lt;- find_fastest_segment(activityDF_half, 21097.5)\nactivityDF_full &lt;- find_fastest_segment(activityDF_full, 42195)\n\n# remove activity 410\nactivityDF_5k &lt;- activityDF_5k[activityDF_5k$activity_id != 410, ]\n\n# find pb over time\nactivityDF_5k &lt;- calculate_pb_pace(activityDF_5k)\nactivityDF_10k &lt;- calculate_pb_pace(activityDF_10k)\nactivityDF_half &lt;- calculate_pb_pace(activityDF_half)\nactivityDF_full &lt;- calculate_pb_pace(activityDF_full)\n\n# save each of these dfs as an r data object\nsave(activityDF_5k, file = \"Output/Data/activityDF_5k.RData\")\nsave(activityDF_10k, file = \"Output/Data/activityDF_10k.RData\")\nsave(activityDF_half, file = \"Output/Data/activityDF_half.RData\")\nsave(activityDF_full, file = \"Output/Data/activityDF_full.RData\")\n\n## Plots ----\n\nggplot(activityDF_5k, aes(x = time, y = pace)) +\n  geom_point(aes(color = \"Pace\")) +\n  geom_line(aes(y = best_pace, color = \"Best Pace\")) +\n  labs(x = \"Time\",\n       y = \"5K Time\") +\n  # scale y from 0 to 30 min\n  scale_y_continuous(limits = c(0, 1800), breaks = seq(0, 1800, by = 300), labels = function(x) {\n    paste0(floor(x / 60), \":\", sprintf(\"%02d\", x %% 60))\n  }) +\n  scale_color_manual(values = c(\"blue\", \"#ff00003f\")) +\n  theme_bw() +\n  theme(legend.position = \"none\")\nggsave(\"Output/Plots/activityDF_5k_plot.png\", width = 8, height = 6, bg = \"white\", dpi = 300)\n\nggplot(activityDF_10k, aes(x = time, y = pace)) +\n  geom_point(aes(color = \"Pace\")) +\n  geom_line(aes(y = best_pace, color = \"Best Pace\")) +\n  labs(x = \"Time\",\n       y = \"10K Time\") +\n  # scale y from 0 to 70 min\n  scale_y_continuous(limits = c(0, 4200), breaks = seq(0, 4200, by = 300), labels = function(x) {\n    paste0(floor(x / 60), \":\", sprintf(\"%02d\", x %% 60))\n  }) +\n  scale_color_manual(values = c(\"blue\", \"#ff00003f\")) +\n  theme_bw() +\n  theme(legend.position = \"none\")  \nggsave(\"Output/Plots/activityDF_10k_plot.png\", width = 8, height = 6, bg = \"white\", dpi = 300)\n\nggplot(activityDF_half, aes(x = time, y = pace)) +\n  geom_point(aes(color = \"Pace\")) +\n  geom_line(aes(y = best_pace, color = \"Best Pace\")) +\n  labs(x = \"Time\",\n       y = \"HM Time\") +\n  # scale y from 0 to 150 min\n  scale_y_continuous(limits = c(0, 9000), breaks = seq(0, 9000, by = 600), labels = function(x) {\n    paste0(floor(x / 3600), \":\", sprintf(\"%02d\", floor(x / 60) %% 60), \":\", sprintf(\"%02d\", x %% 60))\n  }) +\n  scale_color_manual(values = c(\"blue\", \"#ff00003f\")) +\n  theme_bw() +\n  theme(legend.position = \"none\")  \nggsave(\"Output/Plots/activityDF_half_plot.png\", width = 8, height = 6, bg = \"white\", dpi = 300)\n\nggplot(activityDF_full, aes(x = time, y = pace)) +\n  geom_point(aes(color = \"Pace\")) +\n  geom_line(aes(y = best_pace, color = \"Best Pace\")) +\n  labs(x = \"Time\",\n       y = \"Marathon Time\") +\n  # scale y from 0 to 300 min\n  scale_y_continuous(limits = c(0, 18000), breaks = seq(0, 18000, by = 1200), labels = function(x) {\n    paste0(floor(x / 3600), \":\", sprintf(\"%02d\", floor(x / 60) %% 60), \":\", sprintf(\"%02d\", x %% 60))\n  }) +\n  scale_color_manual(values = c(\"blue\", \"#ff00003f\")) +\n  theme_bw() +\n  theme(legend.position = \"none\")  \nggsave(\"Output/Plots/activityDF_full_plot.png\", width = 8, height = 6, bg = \"white\", dpi = 300)\n\n# graph of best 5k pace as a function of max_distance\nggplot(activityDF_5k, aes(x = max_distance, y = pace)) +\n  geom_point(color = \"#ff00003f\") +\n  labs(x = \"Max Distance\",\n       y = \"Best 5K Pace\") +\n  # scale y from 0 to 30 min\n  scale_y_continuous(limits = c(0, 1800), breaks = seq(0, 1800, by = 300), labels = function(x) {\n    paste0(floor(x / 60), \":\", sprintf(\"%02d\", x %% 60))\n  }) +\n  lims(x = c(0, 70000)) +\n  scale_color_manual(values = c(\"blue\", \"#ff00003f\")) +\n  theme_bw() +\n  theme(legend.position = \"none\")\nggsave(\"Output/Plots/activityDF_5k_max_distance_plot.png\", width = 8, height = 6, bg = \"white\", dpi = 300)\n\n# graph of best 10k pace as a function of max_distance\nggplot(activityDF_10k, aes(x = max_distance, y = pace)) +\n  geom_point(color = \"#ff00003f\") +\n  labs(x = \"Max Distance\",\n       y = \"Best 10K Pace\") +\n  # scale y from 0 to 70 min\n  scale_y_continuous(limits = c(0, 4200), breaks = seq(0, 4200, by = 300), labels = function(x) {\n    paste0(floor(x / 60), \":\", sprintf(\"%02d\", x %% 60))\n  }) +\n  lims(x = c(0, 70000)) +\n  theme_bw() +\n  theme(legend.position = \"none\")\nggsave(\"Output/Plots/activityDF_10k_max_distance_plot.png\", width = 8, height = 6, bg = \"white\", dpi = 300)\n\n# graph of best half pace as a function of max_distance\nggplot(activityDF_half, aes(x = max_distance, y = pace)) +\n  geom_point(color = \"#ff00003f\") +\n  labs(x = \"Max Distance\",\n       y = \"Best Half Pace\") +\n  # scale y from 0 to 150 min\n  scale_y_continuous(limits = c(0, 9000), breaks = seq(0, 9000, by = 600), labels = function(x) {\n    paste0(floor(x / 3600), \":\", sprintf(\"%02d\", floor(x / 60) %% 60), \":\", sprintf(\"%02d\", x %% 60))\n  }) +\n  lims(x = c(0, 70000)) +\n  theme_bw() +\n  theme(legend.position = \"none\")\nggsave(\"Output/Plots/activityDF_half_max_distance_plot.png\", width = 8, height = 6, bg = \"white\", dpi = 300)\n\n# what is the last value of best pace?\n# it's in seconds - covert to minutes and seconds\nlast_5k_pace &lt;- activityDF_5k$best_pace[nrow(activityDF_5k)]\nlast_10k_pace &lt;- activityDF_10k$best_pace[nrow(activityDF_10k)]\nlast_half_pace &lt;- activityDF_half$best_pace[nrow(activityDF_half)]\nlast_full_pace &lt;- activityDF_full$best_pace[nrow(activityDF_full)]\ncat(\"Last 5K pace:\", floor(last_5k_pace / 60), \"min\", last_5k_pace %% 60, \"sec\\n\")\ncat(\"Last 10K pace:\", floor(last_10k_pace / 60), \"min\", last_10k_pace %% 60, \"sec\\n\")\ncat(\"Last Half pace:\", floor(last_half_pace / 60), \"min\", last_half_pace %% 60, \"sec\\n\")\ncat(\"Last Full pace:\", floor(last_full_pace / 60), \"min\", last_full_pace %% 60, \"sec\\n\")\n</pre>\n<p>—</p>\n<p>The post title comes from “A Pace Far Different” by Gladie from their Safe Sins album.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://quantixed.org/2025/05/27/a-pace-far-different-finding-best-running-pace-with-r/\"> Rstats – quantixed</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
    "main_text": "A Pace Far Different: finding best running pace with R\nPosted on\nMay 27, 2025\nby\nStephen Royle\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nRstats – quantixed\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nIf you are into running, chances are that you will be chasing your PB (personal best) times. This post is about using R to search for your PBs, and to monitor them over time.\nUsually runners target four distances for PBs: 5 km, 10 km, half marathon and full marathon. It’s likely that a PB will come in a race of exactly that distance, but not necessarily. For example, you can hit a 5K PB during a 10K race. Therefore we need a way to scan our runs for the fastest segment at each distance to track our PBs correctly. Similarly, your best ever half marathon event time may be slightly longer than the half marathon distance, so what was your “real” PB for that distance?\nStrava and other fitness tracking software will find your best time for a given distance within your activities, but here we’ll use R. We’ll look at the data first. Scroll down or\nclick here to see the code\n.\nTracking PBs\nHere we are looking at all running data over several years. Each run is shown as a dot, and the blue line represents my PB. We can look at 5K, 10K, half and full marathon. For all distances, my PB has come down over time (obviously) but satisfyingly, I set PBs in all four distances this year.\nNotice that the density of dots is highest for the 5K plot. It shows all runs of 5K\nor more\n. The same for the other distances. We search all runs to find the fastest segment at the set distance shown on the plot.\nIn the plots above, we cannot see what the total distance of each run is. Did the PB times come from the set distance or a longer run? To show this we can plot the fastest segment versus the total distance of the run.\nThese plots show that my 10K PB currently comes from a half marathon run. Also, I managed a few sub-20 min 5K times during runs of that distance too. Apart from 10K, my PBs came from running the set distance.\nThe script analyses the four main distances, but obviously it could search for any distance at all. Examples that others like to track include 1K, 30K and integer mile distances.\nAs mentioned above, Strava calculates these in what it calls Best Efforts. It allows you to enter your real PBs in a separate section.\nHow does this compare? The code finds these PBs:\n5K = 18:56\n10K = 40:01\nHM = 1:25:44\nMarathon = 3:25:29\nThese are all faster than the Strava best efforts. All GPS data is noisy and different platforms and software make different assumptions, which makes comparisons quite difficult. Note that shortest set distance times are more error prone due to GPS blips. My 400 m PB is definitely\nnot\n45 s. The current world record is 43 s.\nMy actual PBs, measured by chip timing are longer than both.\n5K = 19:01\n10K = 40:04 (from HM)\nHM = 1:26:19\nMarathon = 3:26:39\nYes, I really need to work on the that marathon time…\nAccording to this analysis my calculated PBs are a little bit better than my actual PBs.\nI think it’s best to be consistent and either go off one set of numbers or another, because ultimately, the only point of tracking PBs is to try to improve on them. For this, a single goal to shoot for is necessary.\nThe code\nI’m starting this script with a large GPX file containing all of my runs. Other starting points might be a bunch of GPX files, one for each run, but we need to assemble a data frame of the timepoints and distances form all runs to do this calculation.\nWe use\ntrackeR\nfor loading in the gpx files and a few other libraries to help with wrangling dates/times and for plotting.\nThe code needs to search for the fastest segment of a set distance. My solution is far from optimal but it uses a few steps to reduce computation time. First, only runs of the set distance or grater are considered by first subsetting the large dataframe. Second, for each time point we can calculate the distance to every other point\nas a vector\nand then find the correct set distance, we take its time and compare to the minimum time found so far, and continue the search. This is considerably faster than comparing each point to every other point in nested for-loops. Third, if the max distance of the vector is less than the set distance, we have run out of points and we can stop the search. Further improvements would come from parallelising the code.\nlibrary(trackeR)\nlibrary(ggplot2)\nlibrary(zoo)\nlibrary(hms)\nlibrary(lubridate)\n\n## Functions ----\n\nfind_fastest_segment <- function(data, dist) {\n  data$best_segment <- NA\n  # for each activity id in activityDF, we will subset runDF and calculate the\n  # speed for the fastest segment\n  for (i in 1:nrow(data)) {\n    activity_id <- data$activity_id[i]\n    # check that max_distance is greater than the segment distance, if not, break\n    if (data$max_distance[i] < dist * 0.99) {\n      data$best_segment[i] <- NA\n      next\n    }\n    subsetDF <- runDF[runDF$activity_id == activity_id, ]\n    # add progress bar for every 10th activity\n    if (i %% 10 == 0) {\n      cat(\"Processing activity\", i, \"of\", nrow(data), \"\\n\")\n    }\n    # calculate the best segment\n    best_segment <- 0\n    for (j in 1:(nrow(subsetDF) - 1)) {\n      these_dists <- subsetDF$distance_id - subsetDF$distance_id[j]\n      # check if the maximum distance is less than the segment distance\n      if (max(these_dists, na.rm = TRUE) < dist * 0.99) {\n        break\n      }\n      these_times <- subsetDF$time_id - subsetDF$time_id[j]\n      target_dists <- these_dists[these_dists > (dist * 0.99) &\n                                    these_dists < (dist * 1.01)]\n      # check we have some target distances\n      if (length(target_dists) == 0) {\n        # should not encounter this but we will go again if so (rather than break)\n        next\n      }\n      target_times <- these_times[these_dists > (dist * 0.99) &\n                                    these_dists < (dist * 1.01)]\n      target_speeds <- target_dists / target_times\n      segment_speed <- max(target_speeds, na.rm = TRUE)\n      if (segment_speed > best_segment) {\n        best_segment <- segment_speed\n        data$best_segment[i] <- best_segment\n      }\n    }\n  }\n  # for each of the best_segment column, convert the speed to km/h\n  # and convert to a pace in min:ss per the distance\n  # the column best_segment is in m/s convert to km/h\n  data$best_kmh <- data$best_segment * 3.6\n  # convert the column best_fullkmh to a pace in min:ss per 42.195 km\n  data$pace <- (3600 / data$best_kmh) * (dist / 1000)\n  # convert the pace to a hms object\n  data$pace <- hms::as_hms(data$pace)\n  \n  # remove rows with > 16 kmh because there are gps blips in the data\n  data <- data[data$best_kmh < 16, ]\n  # remove rows with NA in the best_segment column\n  data <- data[!is.na(data$best_segment), ]\n  \n  return(data)\n}\n\ncalculate_pb_pace <- function(data) {\n  # make a new column the best pace at that point in time, i.e. if the pace is\n  # faster than previous that becomes the new best until it is surpassed\n  data$best_pace <- NA\n  for (i in 1:nrow(data)) {\n    if (i == 1) {\n      data$best_pace[i] <- data$pace[i]\n    } else {\n      if (data$pace[i] < data$best_pace[i - 1]) {\n        data$best_pace[i] <- data$pace[i]\n      } else {\n        data$best_pace[i] <- data$best_pace[i - 1]\n      }\n    }\n  }\n  return(data)\n}\n\n## Script ----\n\n# find the gpx file in Data/ if there is more than one, select a gpx file\n# in the Data/ folder\nfiles <- list.files(path = \"Data\", pattern = \"*.gpx\", full.names = TRUE)\nif (length(files) > 1) {\n  cat(\"Please select a GPX file:\\n\")\n  for (i in seq_along(files)) {\n    cat(i, \": \", basename(files[i]), \"\\n\", sep = \"\")\n  }\n  choice <- as.integer(readline(prompt = \"Enter the number of the file: \"))\n  filepath <- files[choice]\n} else {\n  filepath <- files[1]\n}\nrunDF <- readGPX(file = filepath, timezone = \"GMT\")\n# save runDF as an r data object\nsave(runDF, file = \"Output/Data/runDF.RData\")\n# .. or load the runDF object\nload(\"Output/Data/runDF.RData\")\n\n# calculate point-to-point distance from the cumulative distance\nrunDF$dist_point <- c(0, diff(runDF$distance, lag=1))\n# time calculations\nrunDF$time_temp <- strptime(runDF$time, format = \"%Y-%m-%d %H:%M:%S\")\nrunDF$time_temp <- as.numeric(runDF$time_temp)\nrunDF$time_point <- c(0, diff(runDF$time_temp, lag=1))\n\n# if time_point is greater than 380 s it means that it is a different activity\n# so we set it to 0\nrunDF$time_point[runDF$time_point > 380] <- 0\n# if time_point is 0 we set the dist_point to 0\nrunDF$dist_point[runDF$time_point == 0] <- 0\n# recalculate the cumulative distance\nrunDF$distance <- cumsum(runDF$dist_point)\n\n# label the activities with an id number that we can use to refer to them\nrunDF$activity_id <- cumsum(runDF$time_point == 0)\n\n# for each activity calculate the cumulative distance and time\nrunDF$distance_id <- ave(runDF$dist_point, runDF$activity_id, FUN = function(x) cumsum(x))\nrunDF$time_id <- ave(runDF$time_point, runDF$activity_id, FUN = function(x) cumsum(x))\n\n# make a dataframe with the activity id and maximum cumulative distance\nrunDF$max_distance <- ave(runDF$distance_id, runDF$activity_id, FUN = max)\nrunDF$the_time <- ave(runDF$time, runDF$activity_id, FUN = min)\nactivityDF <- data.frame(activity_id = unique(runDF$activity_id),\n                         max_distance = unique(runDF$max_distance),\n                         time = unique(runDF$the_time))\nrunDF$max_distance <- runDF$the_time <- NULL\n\n# make separate dataframes for each distance\nactivityDF_5k <- activityDF[activityDF$max_distance > 5000 * 0.99, ]\nactivityDF_10k <- activityDF[activityDF$max_distance > 10000 * 0.99, ]\nactivityDF_half <- activityDF[activityDF$max_distance > 21097.5 * 0.99, ]\nactivityDF_full <- activityDF[activityDF$max_distance > 42195 * 0.99, ]\n\n# do the calculations for each distance\nactivityDF_5k <- find_fastest_segment(activityDF_5k, 5000)\nactivityDF_10k <- find_fastest_segment(activityDF_10k, 10000)\nactivityDF_half <- find_fastest_segment(activityDF_half, 21097.5)\nactivityDF_full <- find_fastest_segment(activityDF_full, 42195)\n\n# remove activity 410\nactivityDF_5k <- activityDF_5k[activityDF_5k$activity_id != 410, ]\n\n# find pb over time\nactivityDF_5k <- calculate_pb_pace(activityDF_5k)\nactivityDF_10k <- calculate_pb_pace(activityDF_10k)\nactivityDF_half <- calculate_pb_pace(activityDF_half)\nactivityDF_full <- calculate_pb_pace(activityDF_full)\n\n# save each of these dfs as an r data object\nsave(activityDF_5k, file = \"Output/Data/activityDF_5k.RData\")\nsave(activityDF_10k, file = \"Output/Data/activityDF_10k.RData\")\nsave(activityDF_half, file = \"Output/Data/activityDF_half.RData\")\nsave(activityDF_full, file = \"Output/Data/activityDF_full.RData\")\n\n## Plots ----\n\nggplot(activityDF_5k, aes(x = time, y = pace)) +\n  geom_point(aes(color = \"Pace\")) +\n  geom_line(aes(y = best_pace, color = \"Best Pace\")) +\n  labs(x = \"Time\",\n       y = \"5K Time\") +\n  # scale y from 0 to 30 min\n  scale_y_continuous(limits = c(0, 1800), breaks = seq(0, 1800, by = 300), labels = function(x) {\n    paste0(floor(x / 60), \":\", sprintf(\"%02d\", x %% 60))\n  }) +\n  scale_color_manual(values = c(\"blue\", \"#ff00003f\")) +\n  theme_bw() +\n  theme(legend.position = \"none\")\nggsave(\"Output/Plots/activityDF_5k_plot.png\", width = 8, height = 6, bg = \"white\", dpi = 300)\n\nggplot(activityDF_10k, aes(x = time, y = pace)) +\n  geom_point(aes(color = \"Pace\")) +\n  geom_line(aes(y = best_pace, color = \"Best Pace\")) +\n  labs(x = \"Time\",\n       y = \"10K Time\") +\n  # scale y from 0 to 70 min\n  scale_y_continuous(limits = c(0, 4200), breaks = seq(0, 4200, by = 300), labels = function(x) {\n    paste0(floor(x / 60), \":\", sprintf(\"%02d\", x %% 60))\n  }) +\n  scale_color_manual(values = c(\"blue\", \"#ff00003f\")) +\n  theme_bw() +\n  theme(legend.position = \"none\")  \nggsave(\"Output/Plots/activityDF_10k_plot.png\", width = 8, height = 6, bg = \"white\", dpi = 300)\n\nggplot(activityDF_half, aes(x = time, y = pace)) +\n  geom_point(aes(color = \"Pace\")) +\n  geom_line(aes(y = best_pace, color = \"Best Pace\")) +\n  labs(x = \"Time\",\n       y = \"HM Time\") +\n  # scale y from 0 to 150 min\n  scale_y_continuous(limits = c(0, 9000), breaks = seq(0, 9000, by = 600), labels = function(x) {\n    paste0(floor(x / 3600), \":\", sprintf(\"%02d\", floor(x / 60) %% 60), \":\", sprintf(\"%02d\", x %% 60))\n  }) +\n  scale_color_manual(values = c(\"blue\", \"#ff00003f\")) +\n  theme_bw() +\n  theme(legend.position = \"none\")  \nggsave(\"Output/Plots/activityDF_half_plot.png\", width = 8, height = 6, bg = \"white\", dpi = 300)\n\nggplot(activityDF_full, aes(x = time, y = pace)) +\n  geom_point(aes(color = \"Pace\")) +\n  geom_line(aes(y = best_pace, color = \"Best Pace\")) +\n  labs(x = \"Time\",\n       y = \"Marathon Time\") +\n  # scale y from 0 to 300 min\n  scale_y_continuous(limits = c(0, 18000), breaks = seq(0, 18000, by = 1200), labels = function(x) {\n    paste0(floor(x / 3600), \":\", sprintf(\"%02d\", floor(x / 60) %% 60), \":\", sprintf(\"%02d\", x %% 60))\n  }) +\n  scale_color_manual(values = c(\"blue\", \"#ff00003f\")) +\n  theme_bw() +\n  theme(legend.position = \"none\")  \nggsave(\"Output/Plots/activityDF_full_plot.png\", width = 8, height = 6, bg = \"white\", dpi = 300)\n\n# graph of best 5k pace as a function of max_distance\nggplot(activityDF_5k, aes(x = max_distance, y = pace)) +\n  geom_point(color = \"#ff00003f\") +\n  labs(x = \"Max Distance\",\n       y = \"Best 5K Pace\") +\n  # scale y from 0 to 30 min\n  scale_y_continuous(limits = c(0, 1800), breaks = seq(0, 1800, by = 300), labels = function(x) {\n    paste0(floor(x / 60), \":\", sprintf(\"%02d\", x %% 60))\n  }) +\n  lims(x = c(0, 70000)) +\n  scale_color_manual(values = c(\"blue\", \"#ff00003f\")) +\n  theme_bw() +\n  theme(legend.position = \"none\")\nggsave(\"Output/Plots/activityDF_5k_max_distance_plot.png\", width = 8, height = 6, bg = \"white\", dpi = 300)\n\n# graph of best 10k pace as a function of max_distance\nggplot(activityDF_10k, aes(x = max_distance, y = pace)) +\n  geom_point(color = \"#ff00003f\") +\n  labs(x = \"Max Distance\",\n       y = \"Best 10K Pace\") +\n  # scale y from 0 to 70 min\n  scale_y_continuous(limits = c(0, 4200), breaks = seq(0, 4200, by = 300), labels = function(x) {\n    paste0(floor(x / 60), \":\", sprintf(\"%02d\", x %% 60))\n  }) +\n  lims(x = c(0, 70000)) +\n  theme_bw() +\n  theme(legend.position = \"none\")\nggsave(\"Output/Plots/activityDF_10k_max_distance_plot.png\", width = 8, height = 6, bg = \"white\", dpi = 300)\n\n# graph of best half pace as a function of max_distance\nggplot(activityDF_half, aes(x = max_distance, y = pace)) +\n  geom_point(color = \"#ff00003f\") +\n  labs(x = \"Max Distance\",\n       y = \"Best Half Pace\") +\n  # scale y from 0 to 150 min\n  scale_y_continuous(limits = c(0, 9000), breaks = seq(0, 9000, by = 600), labels = function(x) {\n    paste0(floor(x / 3600), \":\", sprintf(\"%02d\", floor(x / 60) %% 60), \":\", sprintf(\"%02d\", x %% 60))\n  }) +\n  lims(x = c(0, 70000)) +\n  theme_bw() +\n  theme(legend.position = \"none\")\nggsave(\"Output/Plots/activityDF_half_max_distance_plot.png\", width = 8, height = 6, bg = \"white\", dpi = 300)\n\n# what is the last value of best pace?\n# it's in seconds - covert to minutes and seconds\nlast_5k_pace <- activityDF_5k$best_pace[nrow(activityDF_5k)]\nlast_10k_pace <- activityDF_10k$best_pace[nrow(activityDF_10k)]\nlast_half_pace <- activityDF_half$best_pace[nrow(activityDF_half)]\nlast_full_pace <- activityDF_full$best_pace[nrow(activityDF_full)]\ncat(\"Last 5K pace:\", floor(last_5k_pace / 60), \"min\", last_5k_pace %% 60, \"sec\\n\")\ncat(\"Last 10K pace:\", floor(last_10k_pace / 60), \"min\", last_10k_pace %% 60, \"sec\\n\")\ncat(\"Last Half pace:\", floor(last_half_pace / 60), \"min\", last_half_pace %% 60, \"sec\\n\")\ncat(\"Last Full pace:\", floor(last_full_pace / 60), \"min\", last_full_pace %% 60, \"sec\\n\")\n—\nThe post title comes from “A Pace Far Different” by Gladie from their Safe Sins album.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nRstats – quantixed\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "If you are into running, chances are that you will be chasing your PB (personal best) times. This post is about using R to search for your PBs, and to monitor them over time. Usually runners target four distances for PBs: 5 km, 10 km, half marathon and full marathon. It’s likely that a PB […]",
    "meta_keywords": null,
    "og_description": "If you are into running, chances are that you will be chasing your PB (personal best) times. This post is about using R to search for your PBs, and to monitor them over time. Usually runners target four distances for PBs: 5 km, 10 km, half marathon and full marathon. It’s likely that a PB […]",
    "og_image": "https://quantixed.org/wp-content/uploads/2025/05/activityDF_5k_plot.png",
    "og_title": "A Pace Far Different: finding best running pace with R | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 12.1,
    "sitemap_lastmod": null,
    "twitter_description": "If you are into running, chances are that you will be chasing your PB (personal best) times. This post is about using R to search for your PBs, and to monitor them over time. Usually runners target four distances for PBs: 5 km, 10 km, half marathon and full marathon. It’s likely that a PB […]",
    "twitter_title": "A Pace Far Different: finding best running pace with R | R-bloggers",
    "url": "https://www.r-bloggers.com/2025/05/a-pace-far-different-finding-best-running-pace-with-r/",
    "word_count": 2420
  }
}