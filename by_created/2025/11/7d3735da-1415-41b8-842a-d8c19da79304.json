{
  "uuid": "7d3735da-1415-41b8-842a-d8c19da79304",
  "created_at": "2025-11-17 20:38:48",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2023/12/renv-with-docker-how-to-dockerize-a-shiny-application-with-an-reproducible-environment/",
    "crawled_at": "2025-11-17T09:31:40.908437",
    "external_links": [
      {
        "href": "https://appsilon.com/renv-with-docker/",
        "text": "Tag: r - Appsilon | Enterprise R Shiny Dashboards"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://appsilon.com/renv-how-to-manage-dependencies-in-r/",
        "text": "Our guide for easy dependency management in R projects has you covered"
      },
      {
        "href": "https://appsilon.com/renv-with-docker/#what-is-renv",
        "text": "What is R renv and How it Works with Docker?"
      },
      {
        "href": "https://appsilon.com/renv-with-docker/#shiny-app",
        "text": "Creating an R Shiny Application with renv"
      },
      {
        "href": "https://appsilon.com/renv-with-docker/#docker",
        "text": "Renv with Docker: How to Launch Your App in a Container"
      },
      {
        "href": "https://appsilon.com/renv-with-docker/#summary",
        "text": "Summing up renv with Docker"
      },
      {
        "href": "https://appsilon.com/r-docker-getting-started",
        "text": "How to run R Scripts in a Docker Container"
      },
      {
        "href": "https://appsilon.com/r-shiny-docker-getting-started",
        "text": "How to run R Shiny Apps in a Docker Container"
      },
      {
        "href": "https://appsilon.com/r-dplyr-gapminder/",
        "text": "Gapminder dataset"
      },
      {
        "href": "https://appsilon.com/ggplot2-bar-charts/",
        "text": "How to Make Stunning Bar Charts in R"
      },
      {
        "href": "https://appsilon.com/ggplot2-line-charts/",
        "text": "How to Make Stunning Line Charts in R"
      },
      {
        "href": "https://appsilon.com/shiny-emptystate-for-shiny-apps/",
        "text": "Make sure to deliver the best user experience with shiny.emptystate"
      },
      {
        "href": "https://appsilon.com/renv-with-docker/",
        "text": "Tag: r - Appsilon | Enterprise R Shiny Dashboards"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Renv with Docker: How to Dockerize a Shiny Application with an Reproducible Environment | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/renv_Docker.webp"
      },
      {
        "alt": "Image 1 - Creating a new project in RStudio",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 1 - Creating a new project in RStudio",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-1-Creating-a-new-project-in-RStudio.webp"
      },
      {
        "alt": "Image 2 - Console output",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 2 - Console output",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-2-Console-output.webp"
      },
      {
        "alt": "Image 3 - Directory structure created by renv",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 3 - Directory structure created by renv",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-3-Directory-structure-created-by-renv.webp"
      },
      {
        "alt": "Image 4 - Installing R packages",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 4 - Installing R packages",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-4-Installing-R-packages.webp"
      },
      {
        "alt": "Image 5 - Confirming the installation in a renv folder",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 5 - Confirming the installation in a renv folder",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-5-Confirming-the-installation-in-a-renv-folder.webp"
      },
      {
        "alt": "Image 6 - Package installation success message",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 6 - Package installation success message",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-6-Package-installation-success-message.webp"
      },
      {
        "alt": "Image 7 - Custom R Shiny application",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 7 - Custom R Shiny application",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-7-Custom-R-Shiny-application.webp"
      },
      {
        "alt": "Image 8 - Custom R Shiny application (2)",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 8 - Custom R Shiny application (2)",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-8-Custom-R-Shiny-application-2.webp"
      },
      {
        "alt": "Image 9 - Creating the environment snapshot",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 9 - Creating the environment snapshot",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-9-Creating-the-environment-snapshot.webp"
      },
      {
        "alt": "Image 10 - Updated directory structure",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 10 - Updated directory structure",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-10-Updated-directory-structure.webp"
      },
      {
        "alt": "Image 11 - Contents of a renv.lock file",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 11 - Contents of a renv.lock file",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-11-Contents-of-a-renv.lock-file.webp"
      },
      {
        "alt": "Image 12 - Building the Docker image",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 12 - Building the Docker image",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-12-Building-the-Docker-image.webp"
      },
      {
        "alt": "Image 13 - Building the Docker image (2)",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 13 - Building the Docker image (2)",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-13-Building-the-Docker-image-2.webp"
      },
      {
        "alt": "Image 14 - Image build success message",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 14 - Image build success message",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-14-Image-build-success-message.webp"
      },
      {
        "alt": "Image 15 - Running the container",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 15 - Running the container",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-15-Running-the-container.webp"
      },
      {
        "alt": "Image 16 - Shiny app running in a Docker container",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 16 - Shiny app running in a Docker container",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-16-Shiny-app-running-in-a-Docker-container.webp"
      },
      {
        "alt": "Image 17 - Shiny app running in a Docker container (2)",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Image 17 - Shiny app running in a Docker container (2)",
        "base64": null,
        "src": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-17-Shiny-app-running-in-a-Docker-container-2.webp"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/dario-radecic/",
        "text": "Dario Radečić"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-380987 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Renv with Docker: How to Dockerize a Shiny Application with an Reproducible Environment</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 19, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/dario-radecic/\">Dario Radečić</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://appsilon.com/renv-with-docker/\"> Tag: r - Appsilon | Enterprise R Shiny Dashboards</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><div><img alt=\"\" class=\"attachment-medium size-medium wp-post-image\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/renv_Docker.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" style=\"margin-bottom: 15px;\" width=\"450\"/><noscript><img alt=\"\" class=\"attachment-medium size-medium wp-post-image\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/renv_Docker.webp\" style=\"margin-bottom: 15px;\" width=\"450\"/></noscript></div><p>You might have seen our previous articles on Dockerizing R scripts and R Shiny applications and were left wondering: <i>Are all of my dependency versions really fixed right now?</i> It’s a good question, and the answer is both yes and no at the same time. Your dependencies are fixed, but their version might change in the future, which might cause unwanted behavior and crashes.</p>\n<p><b>The solution?</b> Combining renv with Docker. The <code>renv</code> package is pretty well-known in the R community, and it creates project-specific packages and a list of dependencies with their versions, making it easy to share your project.</p>\n<p>Today you’ll learn how to combine the best of both worlds or how to use renv with Docker.</p>\n<blockquote><p>Need a refresher in R renv? <a href=\"https://appsilon.com/renv-how-to-manage-dependencies-in-r/\" rel=\"nofollow\" target=\"_blank\">Our guide for easy dependency management in R projects has you covered</a>.</p></blockquote>\n<h3>Table of contents</h3>\n<ul>\n<li><strong><a href=\"https://appsilon.com/renv-with-docker/#what-is-renv\" rel=\"nofollow\" target=\"_blank\">What is R renv and How it Works with Docker?</a></strong></li>\n<li><strong><a href=\"https://appsilon.com/renv-with-docker/#shiny-app\" rel=\"nofollow\" target=\"_blank\">Creating an R Shiny Application with renv</a></strong></li>\n<li><strong><a href=\"https://appsilon.com/renv-with-docker/#docker\" rel=\"nofollow\" target=\"_blank\">Renv with Docker: How to Launch Your App in a Container</a></strong></li>\n<li><strong><a href=\"https://appsilon.com/renv-with-docker/#summary\" rel=\"nofollow\" target=\"_blank\">Summing up renv with Docker</a></strong></li>\n</ul>\n<hr>\n<h2 id=\"what-is-renv\">What is R renv and How it Works with Docker?</h2>\n<p>Renv stands for <i>Reproducible Environment</i> and is here to address the pain points many R developers have – managing environment dependencies.</p>\n<p>By default, R installs packages to a central library and shares them between projects. This means you don’t have to install the dependencies again when working on a new project, but might introduce <b>dependency version conflict</b> when two or more developers are working on the same code.</p>\n<p>This typically results in a lot of crashes and bugs that occur only on one machine. The reason is always the same – environment differences and package mismatch.</p>\n<p>What renv allows you to do is to create a separate, reproducible environment that everyone can use.</p>\n<p><b>But what does Docker have to do with renv?</b> Good question. Docker is a platform for developing, shipping and running applications in isolated environments on an OS level. It’s kind of like a virtual machine but stripped down to bare bones.</p>\n<p>Combining renv with Docker means you’ll be able to control the exact operating system your R code runs on along with system-wide dependencies, and you’ll also be able to control R version and R package dependencies.</p>\n<p>It’s a win-win configuration for ultimate reproducibility and portability control over your R projects.</p>\n<p><b>Do you need more introduction-level resources for R and Docker?</b> Check out these articles:</p>\n<ul>\n<li><a href=\"https://appsilon.com/r-docker-getting-started\" rel=\"nofollow\" target=\"_blank\">How to run R Scripts in a Docker Container</a></li>\n<li><a href=\"https://appsilon.com/r-shiny-docker-getting-started\" rel=\"nofollow\" target=\"_blank\">How to run R Shiny Apps in a Docker Container</a></li>\n</ul>\n<h2 id=\"shiny-app\">Creating an R Shiny Application with renv</h2>\n<p>Creating and configuring a new R Shiny application with renv will take a couple of steps. You’ll have to initialize a new RStudio project, install dependencies, and create an environment snapshot before even writing a single line of R code.</p>\n<h3>Creating a New Project with renv</h3>\n<p>To start, open RStudio and create a new project. The easiest way is to use the project wizard.</p>\n<p>Specify the path to where you want to save this new project, and make sure to <b>tick the “Use renv with this project”</b> checkbox. This will create all the files and folders needed to move forward:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22488\" style=\"width: 1944px\"><img alt=\"Image 1 - Creating a new project in RStudio\" aria-describedby=\"caption-attachment-22488\" class=\"size-full wp-image-22488\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-1-Creating-a-new-project-in-RStudio.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 1 - Creating a new project in RStudio\" aria-describedby=\"caption-attachment-22488\" class=\"size-full wp-image-22488\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-1-Creating-a-new-project-in-RStudio.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22488\">Image 1 – Creating a new project in RStudio</p></div>\n<p>As soon as the new project is initialized, you’ll see the following output in the R console:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22490\" style=\"width: 1604px\"><img alt=\"Image 2 - Console output\" aria-describedby=\"caption-attachment-22490\" class=\"size-full wp-image-22490\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-2-Console-output.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 2 - Console output\" aria-describedby=\"caption-attachment-22490\" class=\"size-full wp-image-22490\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-2-Console-output.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22490\">Image 2 – Console output</p></div>\n<p>And if you were to navigate to the project folder, you’d see a bunch of R environment files:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22492\" style=\"width: 1720px\"><img alt=\"Image 3 - Directory structure created by renv\" aria-describedby=\"caption-attachment-22492\" class=\"size-full wp-image-22492\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-3-Directory-structure-created-by-renv.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 3 - Directory structure created by renv\" aria-describedby=\"caption-attachment-22492\" class=\"size-full wp-image-22492\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-3-Directory-structure-created-by-renv.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22492\">Image 3 – Directory structure created by renv</p></div>\n<p>Basically, you now have an isolated R environment free of any external dependencies. Just what you want. The next step is to install the dependencies needed to run our app.</p>\n<h3>Installing R Dependencies with renv</h3>\n<p>We’ll create a simple R Shiny dashboard a bit later in the article, and it will rely on four external dependencies, so make sure to install them:</p>\n<pre>install.packages(c(\"shiny\", \"dplyr\", \"ggplot2\", \"gapminder\"))</pre>\n<p>You’ll see the output that the packages are downloading:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22494\" style=\"width: 1790px\"><img alt=\"Image 4 - Installing R packages\" aria-describedby=\"caption-attachment-22494\" class=\"size-full wp-image-22494\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-4-Installing-R-packages.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 4 - Installing R packages\" aria-describedby=\"caption-attachment-22494\" class=\"size-full wp-image-22494\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-4-Installing-R-packages.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22494\">Image 4 – Installing R packages</p></div>\n<p>It will take a couple of minutes to download all dependencies and sub-dependencies, and you’ll be asked for an installation confirmation when the download is complete:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22496\" style=\"width: 1836px\"><img alt=\"Image 5 - Confirming the installation in a renv folder\" aria-describedby=\"caption-attachment-22496\" class=\"size-full wp-image-22496\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-5-Confirming-the-installation-in-a-renv-folder.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 5 - Confirming the installation in a renv folder\" aria-describedby=\"caption-attachment-22496\" class=\"size-full wp-image-22496\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-5-Confirming-the-installation-in-a-renv-folder.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22496\">Image 5 – Confirming the installation in a renv folder</p></div>\n<p>Simply type “Y” and the packages will be installed in your isolated environment:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22498\" style=\"width: 1836px\"><img alt=\"Image 6 - Package installation success message\" aria-describedby=\"caption-attachment-22498\" class=\"size-full wp-image-22498\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-6-Package-installation-success-message.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 6 - Package installation success message\" aria-describedby=\"caption-attachment-22498\" class=\"size-full wp-image-22498\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-6-Package-installation-success-message.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22498\">Image 6 – Package installation success message</p></div>\n<p>The packages are now installed, but the R environment isn’t aware of them. We’ll have to write the R Shiny application first, and then create an environment snapshot.</p>\n<h3>Coding the R Shiny application</h3>\n<p>The Shiny app code will feel familiar if you’ve followed our previous articles on R and Docker. Put simply, it’s an app that allows to user to change the continent (dropdown menu), and the two resulting charts change automatically.</p>\n<p>The app uses the <a href=\"https://appsilon.com/r-dplyr-gapminder/\" rel=\"nofollow\" target=\"_blank\">Gapminder dataset</a> to show the shift in average life expectancy and average GDP per capita over time, summarized on all countries belonging to a continent.</p>\n<p><b>Take extra notes</b> on the call to <code>options()</code> function. We use it to hardcode the host and port values on which the Shiny application will run. This will make the deployment process easier later on.</p>\n<p>Anyhow, here’s the full source code for our Shiny app (saved as <code>app.R</code>):</p>\n<pre>library(shiny)\r\nlibrary(dplyr)\r\nlibrary(ggplot2)\r\nlibrary(gapminder)\r\n\r\n# Specify the application port\r\noptions(shiny.host = \"0.0.0.0\")\r\noptions(shiny.port = 8180)\r\n\r\n\r\nui &lt;- fluidPage(\r\n  sidebarLayout(\r\n    sidebarPanel(\r\n      tags$h4(\"Gapminder Dashboard\"),\r\n      tags$hr(),\r\n      selectInput(inputId = \"inContinent\", label = \"Continent\", choices = unique(gapminder$continent), selected = \"Europe\")\r\n    ),\r\n    mainPanel(\r\n      plotOutput(outputId = \"outChartLifeExp\"),\r\n      plotOutput(outputId = \"outChartGDP\")\r\n    )\r\n  )\r\n)\r\n\r\nserver &lt;- function(input, output, session) {\r\n  # Filter data and store as reactive value\r\n  data &lt;- reactive({\r\n    gapminder %&gt;%\r\n      filter(continent == input$inContinent) %&gt;%\r\n      group_by(year) %&gt;%\r\n      summarise(\r\n        AvgLifeExp = round(mean(lifeExp)),\r\n        AvgGdpPercap = round(mean(gdpPercap), digits = 2)\r\n      )\r\n  })\r\n\r\n  # Common properties for charts\r\n  chart_theme &lt;- ggplot2::theme(\r\n    plot.title = element_text(hjust = 0.5, size = 20, face = \"bold\"),\r\n    axis.title.x = element_text(size = 15),\r\n    axis.title.y = element_text(size = 15),\r\n    axis.text.x = element_text(size = 12),\r\n    axis.text.y = element_text(size = 12)\r\n  )\r\n\r\n  # Render Life Exp chart\r\n  output$outChartLifeExp &lt;- renderPlot({\r\n    ggplot(data(), aes(x = year, y = AvgLifeExp)) +\r\n      geom_col(fill = \"#0099f9\") +\r\n      geom_text(aes(label = AvgLifeExp), vjust = 2, size = 6, color = \"#ffffff\") +\r\n      labs(title = paste(\"Average life expectancy in\", input$inContinent)) +\r\n      theme_classic() +\r\n      chart_theme\r\n  })\r\n\r\n  # Render GDP chart\r\n  output$outChartGDP &lt;- renderPlot({\r\n    ggplot(data(), aes(x = year, y = AvgGdpPercap)) +\r\n      geom_line(color = \"#f96000\", size = 2) +\r\n      geom_point(color = \"#f96000\", size = 5) +\r\n      geom_label(\r\n        aes(label = AvgGdpPercap),\r\n        nudge_x = 0.25,\r\n        nudge_y = 0.25\r\n      ) +\r\n      labs(title = paste(\"Average GDP per capita in\", input$inContinent)) +\r\n      theme_classic() +\r\n      chart_theme\r\n  })\r\n}\r\n\r\nshinyApp(ui = ui, server = server)</pre>\n<p>This is what the app looks like when you run it:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22500\" style=\"width: 2440px\"><img alt=\"Image 7 - Custom R Shiny application\" aria-describedby=\"caption-attachment-22500\" class=\"size-full wp-image-22500\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-7-Custom-R-Shiny-application.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 7 - Custom R Shiny application\" aria-describedby=\"caption-attachment-22500\" class=\"size-full wp-image-22500\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-7-Custom-R-Shiny-application.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22500\">Image 7 – Custom R Shiny application</p></div>\n<p>As expected, you can change the continent value and the charts will re-render automatically:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22502\" style=\"width: 2440px\"><img alt=\"Image 8 - Custom R Shiny application (2)\" aria-describedby=\"caption-attachment-22502\" class=\"size-full wp-image-22502\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-8-Custom-R-Shiny-application-2.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 8 - Custom R Shiny application (2)\" aria-describedby=\"caption-attachment-22502\" class=\"size-full wp-image-22502\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-8-Custom-R-Shiny-application-2.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22502\">Image 8 – Custom R Shiny application (2)</p></div>\n<p>The Shiny app created in this section is fairly simple, but we don’t need anything more complex. The purpose is to showcase how the Docker renv combination works together, after all.</p>\n<p>In case you need a refresher on data visualization in R:</p>\n<ul>\n<li><a href=\"https://appsilon.com/ggplot2-bar-charts/\" rel=\"nofollow\" target=\"_blank\">How to Make Stunning Bar Charts in R</a></li>\n<li><a href=\"https://appsilon.com/ggplot2-line-charts/\" rel=\"nofollow\" target=\"_blank\">How to Make Stunning Line Charts in R</a></li>\n</ul>\n<h3>Creating an R renv Environment Snapshot</h3>\n<p>The final step in this section is to create an R environment snapshot. We’re doing this step now because renv will scan for the dependencies that are actually used in R scripts and won’t pick on any that are installed but unused.</p>\n<p>Run the following command from the R console to create a snapshot:</p>\n<pre>renv::snapshot()</pre>\n<p>This is the output you will see:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22504\" style=\"width: 1778px\"><img alt=\"Image 9 - Creating the environment snapshot\" aria-describedby=\"caption-attachment-22504\" class=\"size-full wp-image-22504\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-9-Creating-the-environment-snapshot.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 9 - Creating the environment snapshot\" aria-describedby=\"caption-attachment-22504\" class=\"size-full wp-image-22504\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-9-Creating-the-environment-snapshot.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22504\">Image 9 – Creating the environment snapshot</p></div>\n<p>Scroll down to the bottom and confirm the snapshot creation. As soon as you do, the folder structure in our isolated R environment will change:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22506\" style=\"width: 1720px\"><img alt=\"Image 10 - Updated directory structure\" aria-describedby=\"caption-attachment-22506\" class=\"size-full wp-image-22506\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-10-Updated-directory-structure.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 10 - Updated directory structure\" aria-describedby=\"caption-attachment-22506\" class=\"size-full wp-image-22506\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-10-Updated-directory-structure.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22506\">Image 10 – Updated directory structure</p></div>\n<p>The <code>renv.lock</code> file now also has a list of all dependencies and sub-dependencies used in our project:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22508\" style=\"width: 1790px\"><img alt=\"Image 11 - Contents of a renv.lock file\" aria-describedby=\"caption-attachment-22508\" class=\"size-full wp-image-22508\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-11-Contents-of-a-renv.lock-file.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 11 - Contents of a renv.lock file\" aria-describedby=\"caption-attachment-22508\" class=\"size-full wp-image-22508\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-11-Contents-of-a-renv.lock-file.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22508\">Image 11 – Contents of a renv.lock file</p></div>\n<p>And that’s it – you’ve done everything needed on the renv end. Now it’s time to start working with Docker.</p>\n<h2 id=\"docker\">Renv with Docker: How to Launch Your App in a Container</h2>\n<p>This article section will teach you how to write a <code>Dockerfile</code> suitable for using renv with Docker, and also how to create an image and container using a couple of shell commands.</p>\n<h3>Writing a Dockerfile for R renv</h3>\n<p>A <code>Dockerfile</code> is a simple set of instructions responsible for telling Docker how to build an image. We want to use a base image that already has R installed, and then copy our app and install all of the dependencies.</p>\n<p>The syntax of this file will take you some time to get used to, so let’s go over all of the specific keywords used:</p>\n<ul>\n<li><code>FROM</code>: Tells Docker what is the base image on which your image will be based. For example, the <code>rocker/shiny</code> image already has R and Shiny installed, so it’s a good starting point.</li>\n<li><code>RUN</code>: Runs a shell command, such as the one for installing R packages, and creating directories, and files.</li>\n<li><code>WORKDIR</code>: Sets a working directory so you don’t have to specify a full path every time you want to copy a file.</li>\n<li><code>COPY</code>: Copies contents from a local machine to a Docker container. You have to specify the path to the local file first, followed by a path to the file on the container.</li>\n<li><code>EXPOSE</code>: Exposes a port of a Docker container so we can access it from a local machine.</li>\n<li><code>CMD</code>: Command used every time you launch the Docker container. We’ll use it to run our Shiny app.</li>\n</ul>\n<p>To get started, create a new file and name it <code>Dockerfile</code>, without any extensions. Paste the following contents inside it:</p>\n<pre># Base R Shiny image\r\nFROM rocker/shiny\r\n\r\n# Make a directory in the container\r\nRUN mkdir /home/shiny-app\r\n\r\n# Install Renv\r\nRUN R -e \"install.packages('renv', repos = c(CRAN = 'https://cloud.r-project.org'))\"\r\n\r\n# Copy Renv files and Shiny app\r\nWORKDIR /home/shiny-app/\r\n\r\nRUN mkdir -p renv\r\nCOPY app.R app.R\r\nCOPY renv.lock renv.lock\r\nCOPY .Rprofile  .Rprofile\r\nCOPY renv/activate.R renv/activate.R\r\nCOPY renv/settings.json renv/settings.json\r\n\r\n# Restore the R environment\r\nRUN R -e \"renv::restore()\"\r\n\r\n# Expose the application port\r\nEXPOSE 8180\r\n\r\n# Run the R Shiny app\r\nCMD Rscript /home/shiny-app/app.R</pre>\n<p>What we’re doing here is actually simple. We’re defining the base image, creating a folder to hold our Shiny app, installing <code>renv</code>, copying a bunch of files that contain our R Shiny application and environment info, running the <code>renv::restore()</code> function to restore an environment from the lock file, exposing a port on which the app will run, and finally, running the Shiny app.</p>\n<p>Sounds like a lot, but go over it section by section – you’ll immediately understand what each part is responsible for.</p>\n<h3>Building a Custom Docker Image</h3>\n<p>We now have a <code>Dockerfile</code> saved, which means the only step left to do is to build the image and run the container.</p>\n<p>Unfortunately, the <code>rocker/shiny</code> image isn’t yet supported on ARM platforms (such as M1/M2 Macs), so we’ll have to be a bit creative on this step.</p>\n<p>But first, open up a new Terminal window and navigate to where your R project is saved.</p>\n<p>Run this shell command <b>if you’re using an x86_64 architecture</b>:</p>\n<pre>docker build -t renv-docker-demo .</pre>\n<p>Similarly, run the following line <b>if you’re using an ARM architecture</b>:</p>\n<pre>docker build --platform linux/x86_64 -t renv-docker-demo .</pre>\n<p>We’re running this code on an M2 MacBook Air, so the second shell command does the trick for us:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22510\" style=\"width: 2500px\"><img alt=\"Image 12 - Building the Docker image\" aria-describedby=\"caption-attachment-22510\" class=\"size-full wp-image-22510\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-12-Building-the-Docker-image.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 12 - Building the Docker image\" aria-describedby=\"caption-attachment-22510\" class=\"size-full wp-image-22510\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-12-Building-the-Docker-image.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22510\">Image 12 – Building the Docker image</p></div>\n<p>The process of building the image will take some time, a couple of minutes at least. If you see that the R environment is restoring, it means you’re on the right track:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22512\" style=\"width: 2500px\"><img alt=\"Image 13 - Building the Docker image (2)\" aria-describedby=\"caption-attachment-22512\" class=\"size-full wp-image-22512\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-13-Building-the-Docker-image-2.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 13 - Building the Docker image (2)\" aria-describedby=\"caption-attachment-22512\" class=\"size-full wp-image-22512\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-13-Building-the-Docker-image-2.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22512\">Image 13 – Building the Docker image (2)</p></div>\n<p>Once done, you’ll see the following output:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22514\" style=\"width: 2500px\"><img alt=\"Image 14 - Image build success message\" aria-describedby=\"caption-attachment-22514\" class=\"size-full wp-image-22514\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-14-Image-build-success-message.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 14 - Image build success message\" aria-describedby=\"caption-attachment-22514\" class=\"size-full wp-image-22514\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-14-Image-build-success-message.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22514\">Image 14 – Image build success message</p></div>\n<p>The only thing left to do is to create a container from this image.</p>\n<h3>Running the Docker Container</h3>\n<p>The following shell command will create a container based on the previously created image (<code>renv-docker-demo</code>) and will bind the local port 8180 to the one exposed by the Docker container:</p>\n<pre>docker run -p 8180:8180 renv-docker-demo</pre>\n<p>You’ll see the message that the app is running:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22516\" style=\"width: 2500px\"><img alt=\"Image 15 - Running the container\" aria-describedby=\"caption-attachment-22516\" class=\"size-full wp-image-22516\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-15-Running-the-container.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 15 - Running the container\" aria-describedby=\"caption-attachment-22516\" class=\"size-full wp-image-22516\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-15-Running-the-container.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22516\">Image 15 – Running the container</p></div>\n<p>You can now open up your browser and open localhost on port 8180 – here’s what you’ll see:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22518\" style=\"width: 2226px\"><img alt=\"Image 16 - Shiny app running in a Docker container\" aria-describedby=\"caption-attachment-22518\" class=\"size-full wp-image-22518\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-16-Shiny-app-running-in-a-Docker-container.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 16 - Shiny app running in a Docker container\" aria-describedby=\"caption-attachment-22518\" class=\"size-full wp-image-22518\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-16-Shiny-app-running-in-a-Docker-container.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22518\">Image 16 – Shiny app running in a Docker container</p></div>\n<p>This is the exact same app created in the previous section, but is now running in a Docker container and has all of the R dependencies locked because of renv.</p>\n<p>As before, you can change the dropdown menu value, and the contents will re-render automatically:</p>\n<div class=\"wp-caption alignnone\" id=\"attachment_22520\" style=\"width: 2226px\"><img alt=\"Image 17 - Shiny app running in a Docker container (2)\" aria-describedby=\"caption-attachment-22520\" class=\"size-full wp-image-22520\" data-lazy-src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-17-Shiny-app-running-in-a-Docker-container-2.webp\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"450\"/><noscript><img alt=\"Image 17 - Shiny app running in a Docker container (2)\" aria-describedby=\"caption-attachment-22520\" class=\"size-full wp-image-22520\" decoding=\"async\" loading=\"lazy\" src=\"https://wordpress.appsilon.com/wp-content/uploads/2023/12/Image-17-Shiny-app-running-in-a-Docker-container-2.webp\" width=\"450\"/></noscript><p class=\"wp-caption-text\" id=\"caption-attachment-22520\">Image 17 – Shiny app running in a Docker container (2)</p></div>\n<p>And that’s how you can use renv with Docker! Let’s make a brief recap next.</p>\n<hr/>\n<h2 id=\"summary\">Summing up renv with Docker</h2>\n<p>To summarize, you can use both renv and Docker separately, but combining them is what you really should strive for. Not only does it allow you to have full control of the underlying OS and system dependencies, but it also enables you to set R package versions in stone, so they don’t ever change.</p>\n<p>It is the ultimate approach to making your projects reproducible, sharable, and running in an isolated environment – just what you want!</p>\n<p><i>Are you combining renv with Docker in your R/R Shiny projects?</i> Make sure to let us know in the comment section below.</p>\n<blockquote><p>No data to display in your Shiny app, or is data still loading? <a href=\"https://appsilon.com/shiny-emptystate-for-shiny-apps/\" rel=\"nofollow\" target=\"_blank\">Make sure to deliver the best user experience with shiny.emptystate</a>.</p></blockquote>\n<p>The post appeared first on appsilon.com/blog/.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://appsilon.com/renv-with-docker/\"> Tag: r - Appsilon | Enterprise R Shiny Dashboards</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div> </hr></div>\n</article>",
    "main_text": "Renv with Docker: How to Dockerize a Shiny Application with an Reproducible Environment\nPosted on\nDecember 19, 2023\nby\nDario Radečić\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nTag: r - Appsilon | Enterprise R Shiny Dashboards\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nYou might have seen our previous articles on Dockerizing R scripts and R Shiny applications and were left wondering:\nAre all of my dependency versions really fixed right now?\nIt’s a good question, and the answer is both yes and no at the same time. Your dependencies are fixed, but their version might change in the future, which might cause unwanted behavior and crashes.\nThe solution?\nCombining renv with Docker. The\nrenv\npackage is pretty well-known in the R community, and it creates project-specific packages and a list of dependencies with their versions, making it easy to share your project.\nToday you’ll learn how to combine the best of both worlds or how to use renv with Docker.\nNeed a refresher in R renv?\nOur guide for easy dependency management in R projects has you covered\n.\nTable of contents\nWhat is R renv and How it Works with Docker?\nCreating an R Shiny Application with renv\nRenv with Docker: How to Launch Your App in a Container\nSumming up renv with Docker\nWhat is R renv and How it Works with Docker?\nRenv stands for\nReproducible Environment\nand is here to address the pain points many R developers have – managing environment dependencies.\nBy default, R installs packages to a central library and shares them between projects. This means you don’t have to install the dependencies again when working on a new project, but might introduce\ndependency version conflict\nwhen two or more developers are working on the same code.\nThis typically results in a lot of crashes and bugs that occur only on one machine. The reason is always the same – environment differences and package mismatch.\nWhat renv allows you to do is to create a separate, reproducible environment that everyone can use.\nBut what does Docker have to do with renv?\nGood question. Docker is a platform for developing, shipping and running applications in isolated environments on an OS level. It’s kind of like a virtual machine but stripped down to bare bones.\nCombining renv with Docker means you’ll be able to control the exact operating system your R code runs on along with system-wide dependencies, and you’ll also be able to control R version and R package dependencies.\nIt’s a win-win configuration for ultimate reproducibility and portability control over your R projects.\nDo you need more introduction-level resources for R and Docker?\nCheck out these articles:\nHow to run R Scripts in a Docker Container\nHow to run R Shiny Apps in a Docker Container\nCreating an R Shiny Application with renv\nCreating and configuring a new R Shiny application with renv will take a couple of steps. You’ll have to initialize a new RStudio project, install dependencies, and create an environment snapshot before even writing a single line of R code.\nCreating a New Project with renv\nTo start, open RStudio and create a new project. The easiest way is to use the project wizard.\nSpecify the path to where you want to save this new project, and make sure to\ntick the “Use renv with this project”\ncheckbox. This will create all the files and folders needed to move forward:\nImage 1 – Creating a new project in RStudio\nAs soon as the new project is initialized, you’ll see the following output in the R console:\nImage 2 – Console output\nAnd if you were to navigate to the project folder, you’d see a bunch of R environment files:\nImage 3 – Directory structure created by renv\nBasically, you now have an isolated R environment free of any external dependencies. Just what you want. The next step is to install the dependencies needed to run our app.\nInstalling R Dependencies with renv\nWe’ll create a simple R Shiny dashboard a bit later in the article, and it will rely on four external dependencies, so make sure to install them:\ninstall.packages(c(\"shiny\", \"dplyr\", \"ggplot2\", \"gapminder\"))\nYou’ll see the output that the packages are downloading:\nImage 4 – Installing R packages\nIt will take a couple of minutes to download all dependencies and sub-dependencies, and you’ll be asked for an installation confirmation when the download is complete:\nImage 5 – Confirming the installation in a renv folder\nSimply type “Y” and the packages will be installed in your isolated environment:\nImage 6 – Package installation success message\nThe packages are now installed, but the R environment isn’t aware of them. We’ll have to write the R Shiny application first, and then create an environment snapshot.\nCoding the R Shiny application\nThe Shiny app code will feel familiar if you’ve followed our previous articles on R and Docker. Put simply, it’s an app that allows to user to change the continent (dropdown menu), and the two resulting charts change automatically.\nThe app uses the\nGapminder dataset\nto show the shift in average life expectancy and average GDP per capita over time, summarized on all countries belonging to a continent.\nTake extra notes\non the call to\noptions()\nfunction. We use it to hardcode the host and port values on which the Shiny application will run. This will make the deployment process easier later on.\nAnyhow, here’s the full source code for our Shiny app (saved as\napp.R\n):\nlibrary(shiny)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gapminder)\n\n# Specify the application port\noptions(shiny.host = \"0.0.0.0\")\noptions(shiny.port = 8180)\n\nui <- fluidPage(\n  sidebarLayout(\n    sidebarPanel(\n      tags$h4(\"Gapminder Dashboard\"),\n      tags$hr(),\n      selectInput(inputId = \"inContinent\", label = \"Continent\", choices = unique(gapminder$continent), selected = \"Europe\")\n    ),\n    mainPanel(\n      plotOutput(outputId = \"outChartLifeExp\"),\n      plotOutput(outputId = \"outChartGDP\")\n    )\n  )\n)\n\nserver <- function(input, output, session) {\n  # Filter data and store as reactive value\n  data <- reactive({\n    gapminder %>%\n      filter(continent == input$inContinent) %>%\n      group_by(year) %>%\n      summarise(\n        AvgLifeExp = round(mean(lifeExp)),\n        AvgGdpPercap = round(mean(gdpPercap), digits = 2)\n      )\n  })\n\n  # Common properties for charts\n  chart_theme <- ggplot2::theme(\n    plot.title = element_text(hjust = 0.5, size = 20, face = \"bold\"),\n    axis.title.x = element_text(size = 15),\n    axis.title.y = element_text(size = 15),\n    axis.text.x = element_text(size = 12),\n    axis.text.y = element_text(size = 12)\n  )\n\n  # Render Life Exp chart\n  output$outChartLifeExp <- renderPlot({\n    ggplot(data(), aes(x = year, y = AvgLifeExp)) +\n      geom_col(fill = \"#0099f9\") +\n      geom_text(aes(label = AvgLifeExp), vjust = 2, size = 6, color = \"#ffffff\") +\n      labs(title = paste(\"Average life expectancy in\", input$inContinent)) +\n      theme_classic() +\n      chart_theme\n  })\n\n  # Render GDP chart\n  output$outChartGDP <- renderPlot({\n    ggplot(data(), aes(x = year, y = AvgGdpPercap)) +\n      geom_line(color = \"#f96000\", size = 2) +\n      geom_point(color = \"#f96000\", size = 5) +\n      geom_label(\n        aes(label = AvgGdpPercap),\n        nudge_x = 0.25,\n        nudge_y = 0.25\n      ) +\n      labs(title = paste(\"Average GDP per capita in\", input$inContinent)) +\n      theme_classic() +\n      chart_theme\n  })\n}\n\nshinyApp(ui = ui, server = server)\nThis is what the app looks like when you run it:\nImage 7 – Custom R Shiny application\nAs expected, you can change the continent value and the charts will re-render automatically:\nImage 8 – Custom R Shiny application (2)\nThe Shiny app created in this section is fairly simple, but we don’t need anything more complex. The purpose is to showcase how the Docker renv combination works together, after all.\nIn case you need a refresher on data visualization in R:\nHow to Make Stunning Bar Charts in R\nHow to Make Stunning Line Charts in R\nCreating an R renv Environment Snapshot\nThe final step in this section is to create an R environment snapshot. We’re doing this step now because renv will scan for the dependencies that are actually used in R scripts and won’t pick on any that are installed but unused.\nRun the following command from the R console to create a snapshot:\nrenv::snapshot()\nThis is the output you will see:\nImage 9 – Creating the environment snapshot\nScroll down to the bottom and confirm the snapshot creation. As soon as you do, the folder structure in our isolated R environment will change:\nImage 10 – Updated directory structure\nThe\nrenv.lock\nfile now also has a list of all dependencies and sub-dependencies used in our project:\nImage 11 – Contents of a renv.lock file\nAnd that’s it – you’ve done everything needed on the renv end. Now it’s time to start working with Docker.\nRenv with Docker: How to Launch Your App in a Container\nThis article section will teach you how to write a\nDockerfile\nsuitable for using renv with Docker, and also how to create an image and container using a couple of shell commands.\nWriting a Dockerfile for R renv\nA\nDockerfile\nis a simple set of instructions responsible for telling Docker how to build an image. We want to use a base image that already has R installed, and then copy our app and install all of the dependencies.\nThe syntax of this file will take you some time to get used to, so let’s go over all of the specific keywords used:\nFROM\n: Tells Docker what is the base image on which your image will be based. For example, the\nrocker/shiny\nimage already has R and Shiny installed, so it’s a good starting point.\nRUN\n: Runs a shell command, such as the one for installing R packages, and creating directories, and files.\nWORKDIR\n: Sets a working directory so you don’t have to specify a full path every time you want to copy a file.\nCOPY\n: Copies contents from a local machine to a Docker container. You have to specify the path to the local file first, followed by a path to the file on the container.\nEXPOSE\n: Exposes a port of a Docker container so we can access it from a local machine.\nCMD\n: Command used every time you launch the Docker container. We’ll use it to run our Shiny app.\nTo get started, create a new file and name it\nDockerfile\n, without any extensions. Paste the following contents inside it:\n# Base R Shiny image\nFROM rocker/shiny\n\n# Make a directory in the container\nRUN mkdir /home/shiny-app\n\n# Install Renv\nRUN R -e \"install.packages('renv', repos = c(CRAN = 'https://cloud.r-project.org'))\"\n\n# Copy Renv files and Shiny app\nWORKDIR /home/shiny-app/\n\nRUN mkdir -p renv\nCOPY app.R app.R\nCOPY renv.lock renv.lock\nCOPY .Rprofile  .Rprofile\nCOPY renv/activate.R renv/activate.R\nCOPY renv/settings.json renv/settings.json\n\n# Restore the R environment\nRUN R -e \"renv::restore()\"\n\n# Expose the application port\nEXPOSE 8180\n\n# Run the R Shiny app\nCMD Rscript /home/shiny-app/app.R\nWhat we’re doing here is actually simple. We’re defining the base image, creating a folder to hold our Shiny app, installing\nrenv\n, copying a bunch of files that contain our R Shiny application and environment info, running the\nrenv::restore()\nfunction to restore an environment from the lock file, exposing a port on which the app will run, and finally, running the Shiny app.\nSounds like a lot, but go over it section by section – you’ll immediately understand what each part is responsible for.\nBuilding a Custom Docker Image\nWe now have a\nDockerfile\nsaved, which means the only step left to do is to build the image and run the container.\nUnfortunately, the\nrocker/shiny\nimage isn’t yet supported on ARM platforms (such as M1/M2 Macs), so we’ll have to be a bit creative on this step.\nBut first, open up a new Terminal window and navigate to where your R project is saved.\nRun this shell command\nif you’re using an x86_64 architecture\n:\ndocker build -t renv-docker-demo .\nSimilarly, run the following line\nif you’re using an ARM architecture\n:\ndocker build --platform linux/x86_64 -t renv-docker-demo .\nWe’re running this code on an M2 MacBook Air, so the second shell command does the trick for us:\nImage 12 – Building the Docker image\nThe process of building the image will take some time, a couple of minutes at least. If you see that the R environment is restoring, it means you’re on the right track:\nImage 13 – Building the Docker image (2)\nOnce done, you’ll see the following output:\nImage 14 – Image build success message\nThe only thing left to do is to create a container from this image.\nRunning the Docker Container\nThe following shell command will create a container based on the previously created image (\nrenv-docker-demo\n) and will bind the local port 8180 to the one exposed by the Docker container:\ndocker run -p 8180:8180 renv-docker-demo\nYou’ll see the message that the app is running:\nImage 15 – Running the container\nYou can now open up your browser and open localhost on port 8180 – here’s what you’ll see:\nImage 16 – Shiny app running in a Docker container\nThis is the exact same app created in the previous section, but is now running in a Docker container and has all of the R dependencies locked because of renv.\nAs before, you can change the dropdown menu value, and the contents will re-render automatically:\nImage 17 – Shiny app running in a Docker container (2)\nAnd that’s how you can use renv with Docker! Let’s make a brief recap next.\nSumming up renv with Docker\nTo summarize, you can use both renv and Docker separately, but combining them is what you really should strive for. Not only does it allow you to have full control of the underlying OS and system dependencies, but it also enables you to set R package versions in stone, so they don’t ever change.\nIt is the ultimate approach to making your projects reproducible, sharable, and running in an isolated environment – just what you want!\nAre you combining renv with Docker in your R/R Shiny projects?\nMake sure to let us know in the comment section below.\nNo data to display in your Shiny app, or is data still loading?\nMake sure to deliver the best user experience with shiny.emptystate\n.\nThe post appeared first on appsilon.com/blog/.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nTag: r - Appsilon | Enterprise R Shiny Dashboards\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "You might have seen our previous articles on Dockerizing R scripts and R Shiny applications and were left wondering: Are all of my dependency versions really fixed right now? It’s a good question, and the answer is both yes and no at the same time. Your dependencies are fixed, but their version might change in […] The post appeared first on appsilon.com/blog/.",
    "meta_keywords": null,
    "og_description": "You might have seen our previous articles on Dockerizing R scripts and R Shiny applications and were left wondering: Are all of my dependency versions really fixed right now? It’s a good question, and the answer is both yes and no at the same time. Your dependencies are fixed, but their version might change in […] The post appeared first on appsilon.com/blog/.",
    "og_image": "https://wordpress.appsilon.com/wp-content/uploads/2023/12/renv_Docker.webp",
    "og_title": "Renv with Docker: How to Dockerize a Shiny Application with an Reproducible Environment | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 12.4,
    "sitemap_lastmod": "2023-12-19T19:43:14+00:00",
    "twitter_description": "You might have seen our previous articles on Dockerizing R scripts and R Shiny applications and were left wondering: Are all of my dependency versions really fixed right now? It’s a good question, and the answer is both yes and no at the same time. Your dependencies are fixed, but their version might change in […] The post appeared first on appsilon.com/blog/.",
    "twitter_title": "Renv with Docker: How to Dockerize a Shiny Application with an Reproducible Environment | R-bloggers",
    "url": "https://www.r-bloggers.com/2023/12/renv-with-docker-how-to-dockerize-a-shiny-application-with-an-reproducible-environment/",
    "word_count": 2480
  }
}