{
  "id": "1e29ddb11178e50378db8e1bcdd552d67893cd14",
  "url": "https://www.r-bloggers.com/2009/08/simple-logistic-regression-on-qualitative-dichotomic-variables/",
  "created_at_utc": "2025-11-17T20:40:30Z",
  "data": null,
  "raw_original": {
    "uuid": "d7df8e73-fe11-4e46-9786-05fa2e877eab",
    "created_at": "2025-11-17 20:40:30",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2009/08/simple-logistic-regression-on-qualitative-dichotomic-variables/",
      "crawled_at": "2025-11-17T10:28:14.741565",
      "external_links": [
        {
          "href": "https://statistic-on-air.blogspot.com/2009/08/simple-logistic-regression-on.html",
          "text": "Statistic on aiR"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://statistic-on-air.blogspot.com/2009/08/simple-logistic-regression-on.html",
          "text": "Statistic on aiR"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Simple logistic regression on qualitative dichotomic variables | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/1.bp.blogspot.com/_0yqjfYQXaSw/So0ra9uO28I/AAAAAAAAAF4/syOtm6rOq7Q/s400/refl.JPG?w=578"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/1.bp.blogspot.com/_0yqjfYQXaSw/So0ra9uO28I/AAAAAAAAAF4/syOtm6rOq7Q/s400/refl.JPG?w=578"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/todos-logos/",
          "text": "Todos Logos"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-614 post type-post status-publish format-standard hentry\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Simple logistic regression on qualitative dichotomic variables</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">August 20, 2009</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/todos-logos/\">Todos Logos</a></span>  in Uncategorized | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<p class=\"syndicated-attribution\"><!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://statistic-on-air.blogspot.com/2009/08/simple-logistic-regression-on.html\"> Statistic on aiR</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div></p>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->In this post we will see briefly how to implement a logistic regression model if you have categorical variables, or qualitative, organized in double entry contingency tables. In this model the dependent variable (Y) and independent variable (X) are both dichotomies (or Bernoullian).<br/><br/>In general, the probability that Y = 1 as a function of <b>predictors</b> is:<br/><br/>$$P(Y=1|X=x)=\\pi(x)=\\frac{exp(\\beta_0+\\beta_1x_1+\\cdots +\\beta_kx_k)}{1+exp(\\beta_0+\\beta_1x_1+\\cdots +\\beta_kx_k)}$$<br/><br/>Our goal is to estimate the value of the beta parameters (<b>regressors</b>).<br/><br/><span class=\"fullpost\">We begin to examine a <b>model of simple logistic regression</b> (with <i>only one predictor</i>).<br/><br/>Consider the following example. The table below shows the results of a study on gastroesophageal reflux. You want to evaluate how the presence of a stress factor can influence the onset of this disease.<br/><br/><img border=\"0\" class=\"jetpack-lazy-image\" data-lazy-src=\"https://i0.wp.com/1.bp.blogspot.com/_0yqjfYQXaSw/So0ra9uO28I/AAAAAAAAAF4/syOtm6rOq7Q/s400/refl.JPG?w=578&amp;is-pending-load=1\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/1.bp.blogspot.com/_0yqjfYQXaSw/So0ra9uO28I/AAAAAAAAAF4/syOtm6rOq7Q/s400/refl.JPG?w=578\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" style=\"display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 244px; height: 141px;\"/><noscript><img alt=\"\" border=\"0\" data-recalc-dims=\"1\" id=\"BLOGGER_PHOTO_ID_5371997672767937474\" src=\"https://i0.wp.com/1.bp.blogspot.com/_0yqjfYQXaSw/So0ra9uO28I/AAAAAAAAAF4/syOtm6rOq7Q/s400/refl.JPG?w=578\" style=\"display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 244px; height: 141px;\"/></noscript><br/><br/>First we import the values in R. We must create a table with double entry; proceed as follows:<br/><br/><pre>\nreflux &lt;- matrix(c(251,131,4,33), nrow=2)\ncolnames(reflux) &lt;- c(\"reflNO\", \"reflYES\")\nrownames(reflux) &lt;- c(\"stressNO\", \"stressYES\")\ntable &lt;- as.table(reflux)\n\ntable\n\n          reflNO reflYES\nstressNO     251       4\nstressYES    131      33</pre><br/><br/>Now adjust the data for the logistic regression. We must create a data frame:<br/><br/><pre>\ndft &lt;- as.data.frame(table)\ndft\n\n       Var1    Var2 Freq\n1  stressNO  reflNO  251\n2 stressYES  reflNO  131\n3  stressNO reflYES    4\n4 stressYES reflYES   33</pre><br/><br/><br/>We can now fit the model, and then perform the logistic regression in R:<br/><br/><pre>\nfit &lt;- glm(Var2 ~ Var1, weights = Freq, data = dft, family = binomial(logit))\nsummary(fit)\n\n\nCall:\nglm(formula = Var2 ~ Var1, family = binomial(logit), data = dft, \n    weights = Freq)\n\nDeviance Residuals: \n     1       2       3       4  \n-2.817  -7.672   5.765  10.287  \n\nCoefficients:\n              Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)    -4.1392     0.5040  -8.213  &lt; 2e-16 ***\nVar1stressYES   2.7605     0.5403   5.109 3.23e-07 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 \n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 250.23  on 3  degrees of freedom\nResidual deviance: 205.86  on 2  degrees of freedom\nAIC: 209.86\n\nNumber of Fisher Scoring iterations: 6</pre><br/><br/><br/>First we comment the code to perform the regression. The logistic regression is called imposing the family: <code>family = binomial(logit)</code>. The code <code>Var2 ~ Var1</code> means that we want to create a model that will explain the variable var2 (presence or absence of reflux) as a function of the variable var1 (presence or absence of stressful events). In practice var2 is the independent variable Y, and Var1 is the dependent variable X (the regressors). Provided the formula to be analyzed, you specify the weight of each variable, data in column <code>Freq</code> of the dataframe <code>dft</code> (so we write <code>weights = Freq</code> and <code>data = dft</code> to specify the location where the values are contained).<br/><br/>The values of the parameters $\\beta_0$ and $\\beta_1$ are respectively the values <code>(intercept)</code> and <code>Var1stress1</code>. We can then write our empirical model:<br/><br/>$$\\pi(x)=\\frac{exp(-4.139+2.760x)}{1+exp(-4.139+2.760x)}$$<br/><br/>The independent variable x can be zero or one. If you assume value 0 (ie in the absence of stressful events), then the probability of having reflux is:<br/><br/>$$\\pi(x=0)=\\frac{exp(\\beta_0)}{1+exp(\\beta_0)}=0.016=1.6\\%$$<br/><br/>If there are stressful events (x = 1), the probability of having reflux is:<br/><br/>$$\\pi(x=1)=\\frac{exp(\\beta_0+\\beta_1)}{1+exp(\\beta_0+\\beta_1)}=0.20=20\\%$$<br/><br/>The odds are:<br/><br/>$$odds(x=1)=\\frac{\\pi(1)}{1-\\pi(1)}=exp(\\beta_0+\\beta_1)$$<br/><br/>$$odds(x=0)=\\frac{\\pi(0)}{1-\\pi(0)}=exp(\\beta_0)$$<br/><br/>We can finally calculate the odd ratio OR:<br/><br/>$$OR=\\frac{odds(x=1)}{odds(x=0)}=15.807$$<br/><br/>A person who has experienced a stressful event has a propensity to develop gastroesophageal reflux 15.807 times larger than the person who has not undergone stressful events.<br/><br/>The probabilities and the odds can be readily calculated in R recalling that:<br/><br/><code>fit$coefficient[1]</code> = $\\beta_0$ (intercept)<br/><code>fit$coefficient[2]</code> = $\\beta_1$<br/><br/>Furthermore:<br/><br/><code>summary(fit)$coefficient[1,2]</code> = standard error of $\\beta_0$<br/><code>summary(fit)$coefficient[2,2]</code> = standard error of $\\beta_1$<br/><br/>And so we have:<br/><br/><pre>\npi0 &lt;- exp(fit$coefficient[1]) / (1 + exp(fit$coefficient[1]))\npi1 &lt;- exp(fit$coefficient[1] + fit$coefficient[2]) / (1 + exp(fit$coefficient[1]+fit$coefficient[2]))\n\nodds0 &lt;- pi0 / (1 - pi0)\nodds1 &lt;- pi1 / (1 - pi1)\n\nOR &lt;- odds1 / odds0\n\n#the same result with:\nOR &lt;- exp(fit$coefficient[2])\n\n#the confidence interval for OR is:\nORmin &lt;- exp( fit$coefficient[2] - qnorm(.975) * summary(fit)$coefficient[2,2] )\n\nORmax &lt;- exp( fit$coefficient[2] + qnorm(.975) * summary(fit)$coefficient[2,2] )</pre><br/><br/>We can obtain the same result for the odd-ratio, using the simplify formula:<br/><br/>$$OR=\\frac{ad}{bc}=\\frac{251\\cdot33}{4\\cdot131}=15.807$$<br/><br/>that in R is:<br/><br/><pre>\nOR &lt;- (table[1,1]*table[2,2]) / (table[1,2]*table[2,1])</pre><br/><br/>The acronym AIC stands for <b>Akaike's information criterion</b>. This parameter does not provide any data on the model just created. It<br/>may be useful in comparing this model with other possibly taken into account (the model with lowest AIC is the better).</span>\n\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->\n<p class=\"syndicated-attribution\"><div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://statistic-on-air.blogspot.com/2009/08/simple-logistic-regression-on.html\"> Statistic on aiR</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div></p> </div>\n</article>",
      "main_text": "Simple logistic regression on qualitative dichotomic variables\nPosted on\nAugust 20, 2009\nby\nTodos Logos\nin Uncategorized | 0 Comments\n[This article was first published on\nStatistic on aiR\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nIn this post we will see briefly how to implement a logistic regression model if you have categorical variables, or qualitative, organized in double entry contingency tables. In this model the dependent variable (Y) and independent variable (X) are both dichotomies (or Bernoullian).\nIn general, the probability that Y = 1 as a function of\npredictors\nis:\n$$P(Y=1|X=x)=\\pi(x)=\\frac{exp(\\beta_0+\\beta_1x_1+\\cdots +\\beta_kx_k)}{1+exp(\\beta_0+\\beta_1x_1+\\cdots +\\beta_kx_k)}$$\nOur goal is to estimate the value of the beta parameters (\nregressors\n).\nWe begin to examine a\nmodel of simple logistic regression\n(with\nonly one predictor\n).\nConsider the following example. The table below shows the results of a study on gastroesophageal reflux. You want to evaluate how the presence of a stress factor can influence the onset of this disease.\nFirst we import the values in R. We must create a table with double entry; proceed as follows:\nreflux <- matrix(c(251,131,4,33), nrow=2)\ncolnames(reflux) <- c(\"reflNO\", \"reflYES\")\nrownames(reflux) <- c(\"stressNO\", \"stressYES\")\ntable <- as.table(reflux)\n\ntable\n\n          reflNO reflYES\nstressNO     251       4\nstressYES    131      33\nNow adjust the data for the logistic regression. We must create a data frame:\ndft <- as.data.frame(table)\ndft\n\n       Var1    Var2 Freq\n1  stressNO  reflNO  251\n2 stressYES  reflNO  131\n3  stressNO reflYES    4\n4 stressYES reflYES   33\nWe can now fit the model, and then perform the logistic regression in R:\nfit <- glm(Var2 ~ Var1, weights = Freq, data = dft, family = binomial(logit))\nsummary(fit)\n\nCall:\nglm(formula = Var2 ~ Var1, family = binomial(logit), data = dft, \n    weights = Freq)\n\nDeviance Residuals: \n     1       2       3       4  \n-2.817  -7.672   5.765  10.287  \n\nCoefficients:\n              Estimate Std. Error z value Pr(>|z|)    \n(Intercept)    -4.1392     0.5040  -8.213  < 2e-16 ***\nVar1stressYES   2.7605     0.5403   5.109 3.23e-07 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 \n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 250.23  on 3  degrees of freedom\nResidual deviance: 205.86  on 2  degrees of freedom\nAIC: 209.86\n\nNumber of Fisher Scoring iterations: 6\nFirst we comment the code to perform the regression. The logistic regression is called imposing the family:\nfamily = binomial(logit)\n. The code\nVar2 ~ Var1\nmeans that we want to create a model that will explain the variable var2 (presence or absence of reflux) as a function of the variable var1 (presence or absence of stressful events). In practice var2 is the independent variable Y, and Var1 is the dependent variable X (the regressors). Provided the formula to be analyzed, you specify the weight of each variable, data in column\nFreq\nof the dataframe\ndft\n(so we write\nweights = Freq\nand\ndata = dft\nto specify the location where the values are contained).\nThe values of the parameters $\\beta_0$ and $\\beta_1$ are respectively the values\n(intercept)\nand\nVar1stress1\n. We can then write our empirical model:\n$$\\pi(x)=\\frac{exp(-4.139+2.760x)}{1+exp(-4.139+2.760x)}$$\nThe independent variable x can be zero or one. If you assume value 0 (ie in the absence of stressful events), then the probability of having reflux is:\n$$\\pi(x=0)=\\frac{exp(\\beta_0)}{1+exp(\\beta_0)}=0.016=1.6\\%$$\nIf there are stressful events (x = 1), the probability of having reflux is:\n$$\\pi(x=1)=\\frac{exp(\\beta_0+\\beta_1)}{1+exp(\\beta_0+\\beta_1)}=0.20=20\\%$$\nThe odds are:\n$$odds(x=1)=\\frac{\\pi(1)}{1-\\pi(1)}=exp(\\beta_0+\\beta_1)$$\n$$odds(x=0)=\\frac{\\pi(0)}{1-\\pi(0)}=exp(\\beta_0)$$\nWe can finally calculate the odd ratio OR:\n$$OR=\\frac{odds(x=1)}{odds(x=0)}=15.807$$\nA person who has experienced a stressful event has a propensity to develop gastroesophageal reflux 15.807 times larger than the person who has not undergone stressful events.\nThe probabilities and the odds can be readily calculated in R recalling that:\nfit$coefficient[1]\n= $\\beta_0$ (intercept)\nfit$coefficient[2]\n= $\\beta_1$\nFurthermore:\nsummary(fit)$coefficient[1,2]\n= standard error of $\\beta_0$\nsummary(fit)$coefficient[2,2]\n= standard error of $\\beta_1$\nAnd so we have:\npi0 <- exp(fit$coefficient[1]) / (1 + exp(fit$coefficient[1]))\npi1 <- exp(fit$coefficient[1] + fit$coefficient[2]) / (1 + exp(fit$coefficient[1]+fit$coefficient[2]))\n\nodds0 <- pi0 / (1 - pi0)\nodds1 <- pi1 / (1 - pi1)\n\nOR <- odds1 / odds0\n\n#the same result with:\nOR <- exp(fit$coefficient[2])\n\n#the confidence interval for OR is:\nORmin <- exp( fit$coefficient[2] - qnorm(.975) * summary(fit)$coefficient[2,2] )\n\nORmax <- exp( fit$coefficient[2] + qnorm(.975) * summary(fit)$coefficient[2,2] )\nWe can obtain the same result for the odd-ratio, using the simplify formula:\n$$OR=\\frac{ad}{bc}=\\frac{251\\cdot33}{4\\cdot131}=15.807$$\nthat in R is:\nOR <- (table[1,1]*table[2,2]) / (table[1,2]*table[2,1])\nThe acronym AIC stands for\nAkaike's information criterion\n. This parameter does not provide any data on the model just created. It\nmay be useful in comparing this model with other possibly taken into account (the model with lowest AIC is the better).\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nStatistic on aiR\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "In this post we will see briefly how to implement a logistic regression model if you have categorical variables, or qualitative, organized in double entry contingency tables. In this model the dependent variable (Y) and independent variable (X) are both dichotomies (or Bernoullian).In general, the probability that Y = 1 as a function of predictors is:$$P(Y=1|X=x)=\\pi(x)=\\frac{exp(\\beta_0+\\beta_1x_1+\\cdots +\\beta_kx_k)}{1+exp(\\beta_0+\\beta_1x_1+\\cdots +\\beta_kx_k)}$$Our goal is to estimate the value of the beta parameters (regressors).We begin to examine a model of simple logistic regression (with only one predictor).Consider the following example. The table below shows the results of a study on gastroesophageal reflux. You want to evaluate how the presence of a stress factor can influence the onset of this disease.First we import the values in R. We must create a table with double entry; proceed as follows:reflux colnames(reflux) rownames(reflux) table table reflNO reflYESstressNO 251 4stressYES 131 33 Now adjust the data for the logistic regression. We must create a data frame:dft dft Var1 Var2 Freq1 stressNO reflNO 2512 stressYES reflNO 1313 stressNO reflYES 44 stressYES reflYES 33 We can now fit the model, and then perform the logistic regression in R:fit summary(fit)Call:glm(formula = Var2 ~ Var1, family = binomial(logit), data = dft, weights = Freq)Deviance Residuals: 1 2 3 4 -2.817 -7.672 5.765 10.287 Coefficients: Estimate Std. Error z value Pr(>|z|) (Intercept) -4.1392 0.5040 -8.213 Var1stressYES 2.7605 0.5403 5.109 3.23e-07 ***---Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 250.23 on 3 degrees of freedomResidual deviance: 205.86 on 2 degrees of freedomAIC: 209.86Number of Fisher Scoring iterations: 6 First we comment the code to perform the regression. The logistic regression is called imposing the family: family = binomial(logit). The code Var2 ~ Var1 means that we want to create a model that will explain the variable var2 (presence or absence of reflux) as a function of the variable var1 (presence or absence of stressful events). In practice var2 is the independent variable Y, and Var1 is the dependent variable X (the regressors). Provided the formula to be analyzed, you specify the weight of each variable, data in column Freq of the dataframe dft (so we write weights = Freq and data = dft to specify the location where the values are contained).The values of the parameters $\\beta_0$ and $\\beta_1$ are respectively the values (intercept) and Var1stress1. We can then write our empirical model:$$\\pi(x)=\\frac{exp(-4.139+2.760x)}{1+exp(-4.139+2.760x)}$$The independent variable x can be zero or one. If you assume value 0 (ie in the absence of stressful events), then the probability of having reflux is:$$\\pi(x=0)=\\frac{exp(\\beta_0)}{1+exp(\\beta_0)}=0.016=1.6\\%$$If there are stressful events (x = 1), the probability of having reflux is:$$\\pi(x=1)=\\frac{exp(\\beta_0+\\beta_1)}{1+exp(\\beta_0+\\beta_1)}=0.20=20\\%$$The odds are:$$odds(x=1)=\\frac{\\pi(1)}{1-\\pi(1)}=exp(\\beta_0+\\beta_1)$$$$odds(x=0)=\\frac{\\pi(0)}{1-\\pi(0)}=exp(\\beta_0)$$We can finally calculate the odd ratio OR:$$OR=\\frac{odds(x=1)}{odds(x=0)}=15.807$$A person who has experienced a stressful event has a propensity to develop gastroesophageal reflux 15.807 times larger than the person who has not undergone stressful events.The probabilities and the odds can be readily calculated in R recalling that:fit$coefficient[1] = $\\beta_0$ (intercept)fit$coefficient[2] = $\\beta_1$Furthermore:summary(fit)$coefficient[1,2] = standard error of $\\beta_0$summary(fit)$coefficient[2,2] = standard error of $\\beta_1$And so we have:pi0 pi1 odds0 odds1 OR #the same result with:OR #the confidence interval for OR is:ORmin ORmax We can obtain the same result for the odd-ratio, using the simplify formula:$$OR=\\frac{ad}{bc}=\\frac{251\\cdot33}{4\\cdot131}=15.807$$that in R is:OR The acronym AIC stands for Akaike's information criterion. This parameter does not provide any data on the model just created. Itmay be useful in comparing this model with other possibly taken into account (the model with lowest AIC is the better).",
      "meta_keywords": null,
      "og_description": "In this post we will see briefly how to implement a logistic regression model if you have categorical variables, or qualitative, organized in double entry contingency tables. In this model the dependent variable (Y) and independent variable (X) are both dichotomies (or Bernoullian).In general, the probability that Y = 1 as a function of predictors is:$$P(Y=1|X=x)=\\pi(x)=\\frac{exp(\\beta_0+\\beta_1x_1+\\cdots +\\beta_kx_k)}{1+exp(\\beta_0+\\beta_1x_1+\\cdots +\\beta_kx_k)}$$Our goal is to estimate the value of the beta parameters (regressors).We begin to examine a model of simple logistic regression (with only one predictor).Consider the following example. The table below shows the results of a study on gastroesophageal reflux. You want to evaluate how the presence of a stress factor can influence the onset of this disease.First we import the values in R. We must create a table with double entry; proceed as follows:reflux colnames(reflux) rownames(reflux) table table reflNO reflYESstressNO 251 4stressYES 131 33 Now adjust the data for the logistic regression. We must create a data frame:dft dft Var1 Var2 Freq1 stressNO reflNO 2512 stressYES reflNO 1313 stressNO reflYES 44 stressYES reflYES 33 We can now fit the model, and then perform the logistic regression in R:fit summary(fit)Call:glm(formula = Var2 ~ Var1, family = binomial(logit), data = dft, weights = Freq)Deviance Residuals: 1 2 3 4 -2.817 -7.672 5.765 10.287 Coefficients: Estimate Std. Error z value Pr(>|z|) (Intercept) -4.1392 0.5040 -8.213 Var1stressYES 2.7605 0.5403 5.109 3.23e-07 ***---Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 250.23 on 3 degrees of freedomResidual deviance: 205.86 on 2 degrees of freedomAIC: 209.86Number of Fisher Scoring iterations: 6 First we comment the code to perform the regression. The logistic regression is called imposing the family: family = binomial(logit). The code Var2 ~ Var1 means that we want to create a model that will explain the variable var2 (presence or absence of reflux) as a function of the variable var1 (presence or absence of stressful events). In practice var2 is the independent variable Y, and Var1 is the dependent variable X (the regressors). Provided the formula to be analyzed, you specify the weight of each variable, data in column Freq of the dataframe dft (so we write weights = Freq and data = dft to specify the location where the values are contained).The values of the parameters $\\beta_0$ and $\\beta_1$ are respectively the values (intercept) and Var1stress1. We can then write our empirical model:$$\\pi(x)=\\frac{exp(-4.139+2.760x)}{1+exp(-4.139+2.760x)}$$The independent variable x can be zero or one. If you assume value 0 (ie in the absence of stressful events), then the probability of having reflux is:$$\\pi(x=0)=\\frac{exp(\\beta_0)}{1+exp(\\beta_0)}=0.016=1.6\\%$$If there are stressful events (x = 1), the probability of having reflux is:$$\\pi(x=1)=\\frac{exp(\\beta_0+\\beta_1)}{1+exp(\\beta_0+\\beta_1)}=0.20=20\\%$$The odds are:$$odds(x=1)=\\frac{\\pi(1)}{1-\\pi(1)}=exp(\\beta_0+\\beta_1)$$$$odds(x=0)=\\frac{\\pi(0)}{1-\\pi(0)}=exp(\\beta_0)$$We can finally calculate the odd ratio OR:$$OR=\\frac{odds(x=1)}{odds(x=0)}=15.807$$A person who has experienced a stressful event has a propensity to develop gastroesophageal reflux 15.807 times larger than the person who has not undergone stressful events.The probabilities and the odds can be readily calculated in R recalling that:fit$coefficient[1] = $\\beta_0$ (intercept)fit$coefficient[2] = $\\beta_1$Furthermore:summary(fit)$coefficient[1,2] = standard error of $\\beta_0$summary(fit)$coefficient[2,2] = standard error of $\\beta_1$And so we have:pi0 pi1 odds0 odds1 OR #the same result with:OR #the confidence interval for OR is:ORmin ORmax We can obtain the same result for the odd-ratio, using the simplify formula:$$OR=\\frac{ad}{bc}=\\frac{251\\cdot33}{4\\cdot131}=15.807$$that in R is:OR The acronym AIC stands for Akaike's information criterion. This parameter does not provide any data on the model just created. Itmay be useful in comparing this model with other possibly taken into account (the model with lowest AIC is the better).",
      "og_image": "https://1.bp.blogspot.com/_0yqjfYQXaSw/So0ra9uO28I/AAAAAAAAAF4/syOtm6rOq7Q/s400/refl.JPG",
      "og_title": "Simple logistic regression on qualitative dichotomic variables | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 4.9,
      "sitemap_lastmod": "2009-08-20T11:05:32+00:00",
      "twitter_description": "In this post we will see briefly how to implement a logistic regression model if you have categorical variables, or qualitative, organized in double entry contingency tables. In this model the dependent variable (Y) and independent variable (X) are both dichotomies (or Bernoullian).In general, the probability that Y = 1 as a function of predictors is:$$P(Y=1|X=x)=\\pi(x)=\\frac{exp(\\beta_0+\\beta_1x_1+\\cdots +\\beta_kx_k)}{1+exp(\\beta_0+\\beta_1x_1+\\cdots +\\beta_kx_k)}$$Our goal is to estimate the value of the beta parameters (regressors).We begin to examine a model of simple logistic regression (with only one predictor).Consider the following example. The table below shows the results of a study on gastroesophageal reflux. You want to evaluate how the presence of a stress factor can influence the onset of this disease.First we import the values in R. We must create a table with double entry; proceed as follows:reflux colnames(reflux) rownames(reflux) table table reflNO reflYESstressNO 251 4stressYES 131 33 Now adjust the data for the logistic regression. We must create a data frame:dft dft Var1 Var2 Freq1 stressNO reflNO 2512 stressYES reflNO 1313 stressNO reflYES 44 stressYES reflYES 33 We can now fit the model, and then perform the logistic regression in R:fit summary(fit)Call:glm(formula = Var2 ~ Var1, family = binomial(logit), data = dft, weights = Freq)Deviance Residuals: 1 2 3 4 -2.817 -7.672 5.765 10.287 Coefficients: Estimate Std. Error z value Pr(>|z|) (Intercept) -4.1392 0.5040 -8.213 Var1stressYES 2.7605 0.5403 5.109 3.23e-07 ***---Signif. codes: 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 250.23 on 3 degrees of freedomResidual deviance: 205.86 on 2 degrees of freedomAIC: 209.86Number of Fisher Scoring iterations: 6 First we comment the code to perform the regression. The logistic regression is called imposing the family: family = binomial(logit). The code Var2 ~ Var1 means that we want to create a model that will explain the variable var2 (presence or absence of reflux) as a function of the variable var1 (presence or absence of stressful events). In practice var2 is the independent variable Y, and Var1 is the dependent variable X (the regressors). Provided the formula to be analyzed, you specify the weight of each variable, data in column Freq of the dataframe dft (so we write weights = Freq and data = dft to specify the location where the values are contained).The values of the parameters $\\beta_0$ and $\\beta_1$ are respectively the values (intercept) and Var1stress1. We can then write our empirical model:$$\\pi(x)=\\frac{exp(-4.139+2.760x)}{1+exp(-4.139+2.760x)}$$The independent variable x can be zero or one. If you assume value 0 (ie in the absence of stressful events), then the probability of having reflux is:$$\\pi(x=0)=\\frac{exp(\\beta_0)}{1+exp(\\beta_0)}=0.016=1.6\\%$$If there are stressful events (x = 1), the probability of having reflux is:$$\\pi(x=1)=\\frac{exp(\\beta_0+\\beta_1)}{1+exp(\\beta_0+\\beta_1)}=0.20=20\\%$$The odds are:$$odds(x=1)=\\frac{\\pi(1)}{1-\\pi(1)}=exp(\\beta_0+\\beta_1)$$$$odds(x=0)=\\frac{\\pi(0)}{1-\\pi(0)}=exp(\\beta_0)$$We can finally calculate the odd ratio OR:$$OR=\\frac{odds(x=1)}{odds(x=0)}=15.807$$A person who has experienced a stressful event has a propensity to develop gastroesophageal reflux 15.807 times larger than the person who has not undergone stressful events.The probabilities and the odds can be readily calculated in R recalling that:fit$coefficient[1] = $\\beta_0$ (intercept)fit$coefficient[2] = $\\beta_1$Furthermore:summary(fit)$coefficient[1,2] = standard error of $\\beta_0$summary(fit)$coefficient[2,2] = standard error of $\\beta_1$And so we have:pi0 pi1 odds0 odds1 OR #the same result with:OR #the confidence interval for OR is:ORmin ORmax We can obtain the same result for the odd-ratio, using the simplify formula:$$OR=\\frac{ad}{bc}=\\frac{251\\cdot33}{4\\cdot131}=15.807$$that in R is:OR The acronym AIC stands for Akaike's information criterion. This parameter does not provide any data on the model just created. Itmay be useful in comparing this model with other possibly taken into account (the model with lowest AIC is the better).",
      "twitter_title": "Simple logistic regression on qualitative dichotomic variables | R-bloggers",
      "url": "https://www.r-bloggers.com/2009/08/simple-logistic-regression-on-qualitative-dichotomic-variables/",
      "word_count": 987
    }
  }
}