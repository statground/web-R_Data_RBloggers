{
  "id": "d6ef20a9b13d06596e75633c49e2a6776e2ad828",
  "url": "https://www.r-bloggers.com/2023/12/analyzing-trends-in-heating-and-cooling-degree-days-using-r/",
  "created_at_utc": "2025-11-17T20:38:55Z",
  "data": null,
  "raw_original": {
    "uuid": "0da9abed-ac2f-4486-b940-c21b8fe9457a",
    "created_at": "2025-11-17 20:38:55",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2023/12/analyzing-trends-in-heating-and-cooling-degree-days-using-r/",
      "crawled_at": "2025-11-17T09:37:23.219247",
      "external_links": [
        {
          "href": "https://andypicke.quarto.pub/portfolio/posts/EIA_degree_days/degreedays.html",
          "text": "Andy Pickering"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://www.eia.gov/energyexplained/units-and-calculators/degree-days.php",
          "text": "Degree days"
        },
        {
          "href": "https://andypicke.quarto.pub/portfolio/posts/EIA_degree_days/Short-Term%20Energy%20Outlook%20(STEO)%20Data%20Browser",
          "text": "data"
        },
        {
          "href": "https://www.eia.gov/",
          "text": "U.S. Energy Information Administration"
        },
        {
          "href": "https://www.eia.gov/tools/glossary/index.php?id=Population-weighted%20Degree%20Days",
          "text": "weighted by population"
        },
        {
          "href": "https://www.eia.gov/outlooks/steo/special/pdf/2012_sp_04.pdf",
          "text": "here"
        },
        {
          "href": "https://broom.tidymodels.org/articles/broom_and_dplyr.html",
          "text": "nested workflow"
        },
        {
          "href": "https://andypicke.quarto.pub/portfolio/posts/EIA_degree_days/degreedays.html",
          "text": "Andy Pickering"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Analyzing Trends in Heating and Cooling Degree days using R | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/andypicke.quarto.pub/portfolio/posts/EIA_degree_days/degreedays_files/figure-html/fig-hdd-monthly-boxplot-1.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/andypicke.quarto.pub/portfolio/posts/EIA_degree_days/degreedays_files/figure-html/fig-hdd-yearly-1.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/andypicke.quarto.pub/portfolio/posts/EIA_degree_days/degreedays_files/figure-html/fig-hdd-time-winter-1.png?w=450&ssl=1"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/andy-pickering/",
          "text": "Andy Pickering"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-380816 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Analyzing Trends in Heating and Cooling Degree days using R</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 12, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/andy-pickering/\">Andy Pickering</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://andypicke.quarto.pub/portfolio/posts/EIA_degree_days/degreedays.html\"> Andy Pickering</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--> <section class=\"level1\" id=\"introduction\"><h1>Introduction</h1>\n<p><a href=\"https://www.eia.gov/energyexplained/units-and-calculators/degree-days.php\" rel=\"nofollow\" target=\"_blank\">Degree days</a> are useful as a measure of building heating and cooling demands. A degree day is calculated as the difference between the average temperature (the average of the high and low temperature for the day) and a reference temperature (in the US 65°F is used). For example, if the average temperature today is 40°F, that would be 25 heating degree days (HDD). A summer day with an average temperature of 85°F would have 20 cooling degree days (CDD). Degree days are usually well correlated with the amount of energy used to heat or cool a home.</p>\n<p>I was interested in obtaining and analyzing degree day data; in particular I wanted to see if there were any noticeable trends over time. Given an overall increase in earth’s average temperature due to climate change, I would hypothesize that there might be an overall increase in CDD and a decrease in HDD.</p>\n<p>Changes in heating or cooling degree days would have implications for the amount of energy needed in the future to heat and cool residential or commercial buildings, resulting changes in demand on the electric grid, and implications for related carbon emissions (either for the power grid or from burning fossil fuels to heat buildings).</p>\n</section><section class=\"level1\" id=\"data\"><h1>Data</h1>\n<p>I obtained heating and cooling degree day <a href=\"https://andypicke.quarto.pub/portfolio/posts/EIA_degree_days/Short-Term%20Energy%20Outlook%20(STEO)%20Data%20Browser\" rel=\"nofollow\" target=\"_blank\">data</a> from the <a href=\"https://www.eia.gov/\" rel=\"nofollow\" target=\"_blank\">U.S. Energy Information Administration</a> for the US. Note these data are <a href=\"https://www.eia.gov/tools/glossary/index.php?id=Population-weighted%20Degree%20Days\" rel=\"nofollow\" target=\"_blank\"><em>weighted by population</em></a>, see details of how the EIA data are calculated <a href=\"https://www.eia.gov/outlooks/steo/special/pdf/2012_sp_04.pdf\" rel=\"nofollow\" target=\"_blank\">here</a>.</p>\n<div class=\"cell\">\n<details open=\"\"><summary>Code</summary><pre>suppressPackageStartupMessages(library(tidyverse))\nggplot2::theme_set(theme_grey(base_size = 15))\nsuppressPackageStartupMessages(library(janitor))\nlibrary(broom)\nlibrary(DT)\nsuppressPackageStartupMessages(library(plotly))</pre>\n</details>\n</div>\n<p>I’ll only use years we have complete data for (1997-2022).</p>\n<div class=\"cell\">\n<details open=\"\"><summary>Code</summary><pre>region &lt;- \"u_s\"\n\ndd &lt;- read_csv(paste0('data/EIA_DegreeDays_Monthly_',region,'.csv'), \n               skip = 4,\n               show_col_types = FALSE) |&gt;\n  janitor::clean_names() |&gt;\n  rename(CDD = paste0('cooling_degree_days_',region,\n                      '_cooling_degree_days_cooling_degree_days')) |&gt;\n  rename(HDD = paste0('heating_degree_days_',region,\n                      '_heating_degree_days_heating_degree_days')) |&gt;\n  mutate(date = lubridate::my(month)) |&gt;\n  select(-month) |&gt;\n  mutate(month = lubridate::month(date)) |&gt;\n  mutate(year = lubridate::year(date)) |&gt;\n  filter(year &gt; 1996, year &lt; 2023) # keep only complete years\n\n\ndd |&gt;\n  DT::datatable(options = list(pageLength = 5), rownames = FALSE)</pre>\n</details><div class=\"cell-output-display\">\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-2e47d05599ad5d381a4e\" style=\"width:100%;height:auto;\"></div>\n\n</div>\n</div>\n<p>I’ll also make a dataframe of the yearly totals:</p>\n<div class=\"cell\">\n<details open=\"\"><summary>Code</summary><pre>dd_yearly &lt;- dd |&gt;\n  filter(year &gt; 1996) |&gt;\n  group_by(year) |&gt;\n  summarise(HDD = sum(HDD, na.rm = TRUE),\n            CDD = sum(CDD, na.rm = TRUE)\n            )\n\ndd |&gt;\n  DT::datatable(options = list(pageLength = 5), rownames = FALSE)</pre>\n</details><div class=\"cell-output-display\">\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-fa4dc35f4c53b9925658\" style=\"width:100%;height:auto;\"></div>\n\n</div>\n</div>\n</section><section class=\"level1\" id=\"analysis\"><h1>Analysis</h1>\n</section><section class=\"level2\" id=\"heating-degree-days\"><h2 class=\"anchored\" data-anchor-id=\"heating-degree-days\">Heating Degree Days</h2>\n<p>Figure 1 shows the distribution of US heating degree days for each month. Not surprisingly HDD tends to be higher in winter months, although there is a decent amount of variability between years.</p>\n</section><section class=\"level3\" id=\"hdd-per-month\"><h3 class=\"anchored\" data-anchor-id=\"hdd-per-month\">HDD Per Month</h3>\n<div class=\"cell\">\n<details open=\"\"><summary>Code</summary><pre>dd |&gt;\n  mutate(month_name = lubridate::month(date, label = TRUE)) |&gt;\n  ggplot(aes(month_name, HDD, group = month_name)) +\n  geom_boxplot() +\n  labs(title = 'Monthly Heating Degree Days for US (1997-2022)',\n       x = 'Month',\n       y = \"Heating Degree Days\")</pre>\n</details><div class=\"cell-output-display\">\n<div class=\"quarto-figure quarto-figure-center anchored\" id=\"fig-hdd-monthly-boxplot\">\n<figure class=\"figure\"><p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/andypicke.quarto.pub/portfolio/posts/EIA_degree_days/degreedays_files/figure-html/fig-hdd-monthly-boxplot-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/andypicke.quarto.pub/portfolio/posts/EIA_degree_days/degreedays_files/figure-html/fig-hdd-monthly-boxplot-1.png?w=450&amp;ssl=1\"/></noscript></p>\n<figcaption class=\"figure-caption\">Figure 1: Boxplot of US heating degree days for each month</figcaption></figure>\n</div>\n</div>\n</div>\n</section><section class=\"level3\" id=\"trends-in-hdd\"><h3 class=\"anchored\" data-anchor-id=\"trends-in-hdd\">Trends in HDD</h3>\n<p>Is there a trend in HDD over time? I would expect that HDD might decrease over time due to climate change and the increase in earth’s average temperature.</p>\n</section><section class=\"level4\" id=\"annual\"><h4 class=\"anchored\" data-anchor-id=\"annual\">Annual</h4>\n<p>Figure 2 shows a timeseries of the annual total heating degree days in the US, along with a linear regression line that shows a negative trend.</p>\n<div class=\"cell\">\n<details open=\"\"><summary>Code</summary><pre>g &lt;- dd_yearly |&gt;\n  ggplot(aes(year, HDD)) +\n  geom_point(size = 4, alpha = 0.5) +\n  geom_smooth(method = 'lm', formula = 'y~x') +\n  labs(title = \"US Annual Heating Degree Days\")\n\ng\n#plotly::ggplotly(g)</pre>\n</details><div class=\"cell-output-display\">\n<div class=\"quarto-figure quarto-figure-center anchored\" id=\"fig-hdd-yearly\">\n<figure class=\"figure\"><p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/andypicke.quarto.pub/portfolio/posts/EIA_degree_days/degreedays_files/figure-html/fig-hdd-yearly-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/andypicke.quarto.pub/portfolio/posts/EIA_degree_days/degreedays_files/figure-html/fig-hdd-yearly-1.png?w=450&amp;ssl=1\"/></noscript></p>\n<figcaption class=\"figure-caption\">Figure 2: Timeseries of annual US HDD</figcaption></figure>\n</div>\n</div>\n</div>\n<p>There is a fair bit of variability, but looking at the fit metrics shows that the negative trend in HDD is statistically significant (p-value &lt; 0.05):</p>\n<div class=\"cell\">\n<details open=\"\"><summary>Code</summary><pre>hdd_yearly_fit &lt;- lm(data = dd_yearly, formula = 'HDD ~ year')\nbroom::tidy(hdd_yearly_fit) |&gt; mutate_if(is.numeric,~round(.x,digits = 3))</pre>\n</details><div class=\"cell-output cell-output-stdout\">\n<pre># A tibble: 2 × 5\n  term        estimate std.error statistic p.value\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n1 (Intercept)  30788.   11849.        2.60   0.016\n2 year           -13.2      5.90     -2.24   0.035</pre>\n</div>\n<details open=\"\"><summary>Code</summary><pre>broom::glance(hdd_yearly_fit) |&gt; mutate_if(is.numeric,~round(.x,digits = 3))</pre>\n</details><div class=\"cell-output cell-output-stdout\">\n<pre># A tibble: 1 × 12\n  r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC\n      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1     0.173         0.138  225.      5.01   0.035     1  -177.  359.  363.\n# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;dbl&gt;, nobs &lt;dbl&gt;</pre>\n</div>\n</div>\n</section><section class=\"level4\" id=\"monthly\"><h4 class=\"anchored\" data-anchor-id=\"monthly\">Monthly</h4>\n<p>We have seen that there is a negative trend in annual HDD; what are the trends for individual months? Figure 3 shows timeseries of monthly HDD vs year for winter months, with linear regression lines plotted over them. Visually there appears to be a negative trend for some of the months.</p>\n<div class=\"cell\">\n<details open=\"\"><summary>Code</summary><pre>dd |&gt;\n  filter(month %in% c(11,12,1,2,3,4)) |&gt;\n  mutate(month_name = lubridate::month(date, label = TRUE)) |&gt;\n  ggplot(aes(year, HDD, group = month_name)) +\n  geom_point(size = 3, alpha = 0.5) +\n  geom_smooth(method = 'lm', formula = 'y ~ x') +\n  facet_wrap('month_name', scales = 'free') +\n  guides(x =  guide_axis(angle = 45))</pre>\n</details><div class=\"cell-output-display\">\n<div class=\"quarto-figure quarto-figure-center anchored\" id=\"fig-hdd-time-winter\">\n<figure class=\"figure\"><p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/andypicke.quarto.pub/portfolio/posts/EIA_degree_days/degreedays_files/figure-html/fig-hdd-time-winter-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/andypicke.quarto.pub/portfolio/posts/EIA_degree_days/degreedays_files/figure-html/fig-hdd-time-winter-1.png?w=450&amp;ssl=1\"/></noscript></p>\n<figcaption class=\"figure-caption\">Figure 3: HDD vs year for winter months</figcaption></figure>\n</div>\n</div>\n</div>\n<p>To better quantify these trends I want to fit a linear regression to the data for each month and examine the results. This could be done with a <em>for loop</em>, but I will take advantage of a nice <a href=\"https://broom.tidymodels.org/articles/broom_and_dplyr.html\" rel=\"nofollow\" target=\"_blank\">nested workflow</a> using the <em>tidyr</em> <span class=\"citation\" data-cites=\"tidyr\">(Wickham, Vaughan, and Girlich 2023)</span>, *broom*<span class=\"citation\" data-cites=\"broom\">(Robinson, Hayes, and Couch 2023)</span>, and <em>purrr</em> <span class=\"citation\" data-cites=\"purrr\">(Wickham and Henry 2023)</span> packages.</p>\n<div class=\"cell\">\n<details open=\"\"><summary>Code</summary><pre>dd_fit_hdd &lt;- dd |&gt;\n  group_by(month) |&gt;\n  nest() |&gt;\n  mutate(fit = map(data, ~ lm(HDD ~ year, data = .x) ),\n         tidied = map(fit, broom::tidy),\n         glanced = map(fit, broom::glance)\n  ) %&gt;%\n  unnest(tidied) |&gt;\n  ungroup()\n\ndd_fit_hdd |&gt;\n  mutate_if(is.numeric,~round(.x,digits = 3)) |&gt;\n  DT::datatable(rownames = FALSE, options = list(pageLength = 5))</pre>\n</details><div class=\"cell-output-display\">\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-5ce26680e0a1802746a2\" style=\"width:100%;height:auto;\"></div>\n</div></div></section>\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://andypicke.quarto.pub/portfolio/posts/EIA_degree_days/degreedays.html\"> Andy Pickering</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
      "main_text": "Analyzing Trends in Heating and Cooling Degree days using R\nPosted on\nDecember 12, 2023\nby\nAndy Pickering\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nAndy Pickering\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nIntroduction\nDegree days\nare useful as a measure of building heating and cooling demands. A degree day is calculated as the difference between the average temperature (the average of the high and low temperature for the day) and a reference temperature (in the US 65°F is used). For example, if the average temperature today is 40°F, that would be 25 heating degree days (HDD). A summer day with an average temperature of 85°F would have 20 cooling degree days (CDD). Degree days are usually well correlated with the amount of energy used to heat or cool a home.\nI was interested in obtaining and analyzing degree day data; in particular I wanted to see if there were any noticeable trends over time. Given an overall increase in earth’s average temperature due to climate change, I would hypothesize that there might be an overall increase in CDD and a decrease in HDD.\nChanges in heating or cooling degree days would have implications for the amount of energy needed in the future to heat and cool residential or commercial buildings, resulting changes in demand on the electric grid, and implications for related carbon emissions (either for the power grid or from burning fossil fuels to heat buildings).\nData\nI obtained heating and cooling degree day\ndata\nfrom the\nU.S. Energy Information Administration\nfor the US. Note these data are\nweighted by population\n, see details of how the EIA data are calculated\nhere\n.\nCode\nsuppressPackageStartupMessages(library(tidyverse))\nggplot2::theme_set(theme_grey(base_size = 15))\nsuppressPackageStartupMessages(library(janitor))\nlibrary(broom)\nlibrary(DT)\nsuppressPackageStartupMessages(library(plotly))\nI’ll only use years we have complete data for (1997-2022).\nCode\nregion <- \"u_s\"\n\ndd <- read_csv(paste0('data/EIA_DegreeDays_Monthly_',region,'.csv'), \n               skip = 4,\n               show_col_types = FALSE) |>\n  janitor::clean_names() |>\n  rename(CDD = paste0('cooling_degree_days_',region,\n                      '_cooling_degree_days_cooling_degree_days')) |>\n  rename(HDD = paste0('heating_degree_days_',region,\n                      '_heating_degree_days_heating_degree_days')) |>\n  mutate(date = lubridate::my(month)) |>\n  select(-month) |>\n  mutate(month = lubridate::month(date)) |>\n  mutate(year = lubridate::year(date)) |>\n  filter(year > 1996, year < 2023) # keep only complete years\n\ndd |>\n  DT::datatable(options = list(pageLength = 5), rownames = FALSE)\nI’ll also make a dataframe of the yearly totals:\nCode\ndd_yearly <- dd |>\n  filter(year > 1996) |>\n  group_by(year) |>\n  summarise(HDD = sum(HDD, na.rm = TRUE),\n            CDD = sum(CDD, na.rm = TRUE)\n            )\n\ndd |>\n  DT::datatable(options = list(pageLength = 5), rownames = FALSE)\nAnalysis\nHeating Degree Days\nFigure 1 shows the distribution of US heating degree days for each month. Not surprisingly HDD tends to be higher in winter months, although there is a decent amount of variability between years.\nHDD Per Month\nCode\ndd |>\n  mutate(month_name = lubridate::month(date, label = TRUE)) |>\n  ggplot(aes(month_name, HDD, group = month_name)) +\n  geom_boxplot() +\n  labs(title = 'Monthly Heating Degree Days for US (1997-2022)',\n       x = 'Month',\n       y = \"Heating Degree Days\")\nFigure 1: Boxplot of US heating degree days for each month\nTrends in HDD\nIs there a trend in HDD over time? I would expect that HDD might decrease over time due to climate change and the increase in earth’s average temperature.\nAnnual\nFigure 2 shows a timeseries of the annual total heating degree days in the US, along with a linear regression line that shows a negative trend.\nCode\ng <- dd_yearly |>\n  ggplot(aes(year, HDD)) +\n  geom_point(size = 4, alpha = 0.5) +\n  geom_smooth(method = 'lm', formula = 'y~x') +\n  labs(title = \"US Annual Heating Degree Days\")\n\ng\n#plotly::ggplotly(g)\nFigure 2: Timeseries of annual US HDD\nThere is a fair bit of variability, but looking at the fit metrics shows that the negative trend in HDD is statistically significant (p-value < 0.05):\nCode\nhdd_yearly_fit <- lm(data = dd_yearly, formula = 'HDD ~ year')\nbroom::tidy(hdd_yearly_fit) |> mutate_if(is.numeric,~round(.x,digits = 3))\n# A tibble: 2 × 5\n  term        estimate std.error statistic p.value\n  <chr>          <dbl>     <dbl>     <dbl>   <dbl>\n1 (Intercept)  30788.   11849.        2.60   0.016\n2 year           -13.2      5.90     -2.24   0.035\nCode\nbroom::glance(hdd_yearly_fit) |> mutate_if(is.numeric,~round(.x,digits = 3))\n# A tibble: 1 × 12\n  r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC\n      <dbl>         <dbl> <dbl>     <dbl>   <dbl> <dbl>  <dbl> <dbl> <dbl>\n1     0.173         0.138  225.      5.01   0.035     1  -177.  359.  363.\n# ℹ 3 more variables: deviance <dbl>, df.residual <dbl>, nobs <dbl>\nMonthly\nWe have seen that there is a negative trend in annual HDD; what are the trends for individual months? Figure 3 shows timeseries of monthly HDD vs year for winter months, with linear regression lines plotted over them. Visually there appears to be a negative trend for some of the months.\nCode\ndd |>\n  filter(month %in% c(11,12,1,2,3,4)) |>\n  mutate(month_name = lubridate::month(date, label = TRUE)) |>\n  ggplot(aes(year, HDD, group = month_name)) +\n  geom_point(size = 3, alpha = 0.5) +\n  geom_smooth(method = 'lm', formula = 'y ~ x') +\n  facet_wrap('month_name', scales = 'free') +\n  guides(x =  guide_axis(angle = 45))\nFigure 3: HDD vs year for winter months\nTo better quantify these trends I want to fit a linear regression to the data for each month and examine the results. This could be done with a\nfor loop\n, but I will take advantage of a nice\nnested workflow\nusing the\ntidyr\n(Wickham, Vaughan, and Girlich 2023)\n, *broom*\n(Robinson, Hayes, and Couch 2023)\n, and\npurrr\n(Wickham and Henry 2023)\npackages.\nCode\ndd_fit_hdd <- dd |>\n  group_by(month) |>\n  nest() |>\n  mutate(fit = map(data, ~ lm(HDD ~ year, data = .x) ),\n         tidied = map(fit, broom::tidy),\n         glanced = map(fit, broom::glance)\n  ) %>%\n  unnest(tidied) |>\n  ungroup()\n\ndd_fit_hdd |>\n  mutate_if(is.numeric,~round(.x,digits = 3)) |>\n  DT::datatable(rownames = FALSE, options = list(pageLength = 5))\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nAndy Pickering\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Introduction Degree days are useful as a measure of building heating and cooling demands. A degree day is calculated as the difference between the average temperature (the average of the high and low temperature for the day) and a reference temperature (in the US 65°F is used). For example, if the average temperature today is 40°F, that would be 25 heating degree days (HDD). A summer day with an average temperature of 85°F would have 20 cooling degree days (CDD). Degree days are usually well correlated with the amount of energy used to heat or cool a home. I was interested in obtaining and analyzing degree day data; in particular I wanted to see if there were any noticeable trends over time. Given an overall increase in earth’s average temperature due to climate change, I would hypothesize that there might be an overall increase in CDD and a decrease in HDD. Changes in heating or cooling degree days would have implications for the amount of energy needed in the future to heat and cool residential or commercial buildings, resulting changes in demand on the electric grid, and implications for related carbon emissions (either for the power grid or from burning fossil fuels to heat buildings). Data I obtained heating and cooling degree day data from the U.S. Energy Information Administration for the US. Note these data are weighted by population, see details of how the EIA data are calculated here. CodesuppressPackageStartupMessages(library(tidyverse)) ggplot2::theme_set(theme_grey(base_size = 15)) suppressPackageStartupMessages(library(janitor)) library(broom) library(DT) suppressPackageStartupMessages(library(plotly)) I’ll only use years we have complete data for (1997-2022). Coderegion rename(CDD = paste0('cooling_degree_days_',region, '_cooling_degree_days_cooling_degree_days')) |> rename(HDD = paste0('heating_degree_days_',region, '_heating_degree_days_heating_degree_days')) |> mutate(date = lubridate::my(month)) |> select(-month) |> mutate(month = lubridate::month(date)) |> mutate(year = lubridate::year(date)) |> filter(year > 1996, year DT::datatable(options = list(pageLength = 5), rownames = FALSE) I’ll also make a dataframe of the yearly totals: Codedd_yearly filter(year > 1996) |> group_by(year) |> summarise(HDD = sum(HDD, na.rm = TRUE), CDD = sum(CDD, na.rm = TRUE) ) dd |> DT::datatable(options = list(pageLength = 5), rownames = FALSE) Analysis Heating Degree Days Figure 1 shows the distribution of US heating degree days for each month. Not surprisingly HDD tends to be higher in winter months, although there is a decent amount of variability between years. HDD Per Month Codedd |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(month_name, HDD, group = month_name)) + geom_boxplot() + labs(title = 'Monthly Heating Degree Days for US (1997-2022)', x = 'Month', y = \"Heating Degree Days\") Figure 1: Boxplot of US heating degree days for each month Trends in HDD Is there a trend in HDD over time? I would expect that HDD might decrease over time due to climate change and the increase in earth’s average temperature. Annual Figure 2 shows a timeseries of the annual total heating degree days in the US, along with a linear regression line that shows a negative trend. Codeg ggplot(aes(year, HDD)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y~x') + labs(title = \"US Annual Heating Degree Days\") g #plotly::ggplotly(g) Figure 2: Timeseries of annual US HDD There is a fair bit of variability, but looking at the fit metrics shows that the negative trend in HDD is statistically significant (p-value < 0.05): Codehdd_yearly_fit mutate_if(is.numeric,~round(.x,digits = 3)) # A tibble: 2 × 5 term estimate std.error statistic p.value 1 (Intercept) 30788. 11849. 2.60 0.016 2 year -13.2 5.90 -2.24 0.035 Codebroom::glance(hdd_yearly_fit) |> mutate_if(is.numeric,~round(.x,digits = 3)) # A tibble: 1 × 12 r.squared adj.r.squared sigma statistic p.value df logLik AIC BIC 1 0.173 0.138 225. 5.01 0.035 1 -177. 359. 363. # ℹ 3 more variables: deviance , df.residual , nobs Monthly We have seen that there is a negative trend in annual HDD; what are the trends for individual months? Figure 3 shows timeseries of monthly HDD vs year for winter months, with linear regression lines plotted over them. Visually there appears to be a negative trend for some of the months. Codedd |> filter(month %in% c(11,12,1,2,3,4)) |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(year, HDD, group = month_name)) + geom_point(size = 3, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y ~ x') + facet_wrap('month_name', scales = 'free') + guides(x = guide_axis(angle = 45)) Figure 3: HDD vs year for winter months To better quantify these trends I want to fit a linear regression to the data for each month and examine the results. This could be done with a for loop, but I will take advantage of a nice nested workflow using the tidyr (Wickham, Vaughan, and Girlich 2023), *broom*(Robinson, Hayes, and Couch 2023), and purrr (Wickham and Henry 2023) packages. Codedd_fit_hdd group_by(month) |> nest() |> mutate(fit = map(data, ~ lm(HDD ~ year, data = .x) ), tidied = map(fit, broom::tidy), glanced = map(fit, broom::glance) ) %>% unnest(tidied) |> ungroup() dd_fit_hdd |> mutate_if(is.numeric,~round(.x,digits = 3)) |> DT::datatable(rownames = FALSE, options = list(pageLength = 5)) Now that the data and model fit results are in a tidy data, they can be easily filtered to identify significant fits using p-values. The months with significant trends are June, August, September, and October. These months and the linear regression lines are shown in Figure 4 Codedd_fit_hdd |> filter(term == 'year') |> filter(p.value mutate_if(is.numeric,~round(.x,digits = 3)) |> DT::datatable(rownames = FALSE) Codedd |> filter(month %in% c(6,8,9,10)) |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(year, HDD, group = month_name)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y ~ x') + facet_wrap('month_name', scales = 'free') Figure 4: HDD vs year for months with signficant trends Cooling Degree Days CDD Per Month Figure 5 shows the distribution of US heating degree days for each month. Not surprisingly CDD tends to be higher in summer months, although there is a decent amount of variability between years. Codedd |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(month_name, CDD, group = month_name)) + geom_boxplot() + labs(title = 'Monthly Cooling Degree Days for US', x = 'Month', y = \"Cooling Degree Days\") Figure 5: Boxplot of US cooling degree days for each month Trends in CDD Annual Is there a trend in CDD over time? I would expect that CDD might increase over time due to climate change and the increase in earth’s average temperature. Figure 6 shows a timeseries of the annual total heating degree days in the US, along with a linear regression line showing a positive trend. Codeg ggplot(aes(year, CDD)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y~x') + labs(title = \"US Annual Cooling Degree Days\") g #plotly::ggplotly(g) Figure 6: Timeseries of annual US CDD Looking at the fit metrics shows that the positive trend in CDD is indeed statistically significant: Codecdd_yearly_fit mutate_if(is.numeric,~round(.x,digits = 3)) # A tibble: 2 × 5 term estimate std.error statistic p.value 1 (Intercept) -23285. 4207. -5.54 0 2 year 12.3 2.09 5.86 0 Codebroom::glance(cdd_yearly_fit) |> mutate_if(is.numeric,~round(.x,digits = 3)) # A tibble: 1 × 12 r.squared adj.r.squared sigma statistic p.value df logLik AIC BIC 1 0.589 0.572 80.1 34.4 0 1 -150. 306. 309. # ℹ 3 more variables: deviance , df.residual , nobs Monthly Figure 7 shows timeseries of monthly CDD vs year for the 4 summer months with the highest CDD, with linear regression lines plotted over them. Visually there appears to be a positive trend for each month. Codedd |> filter(month %in% c(6,7,8,9)) |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(year, CDD, group = month_name)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y ~ x') + facet_wrap('month_name') Figure 7: CDD vs year for summer month Next i’ll apply a linear regression to each month using the same workflow used for HDD. Codedd_fit_cdd group_by(month) |> nest() |> mutate(fit = map(data, ~ lm(CDD ~ year, data = .x) ), tidied = map(fit, broom::tidy) ) %>% unnest(tidied) |> ungroup() dd_fit_cdd |> mutate_if(is.numeric,~round(.x,digits = 3)) |> DT::datatable(options = list(pageLength = 5), rownames = FALSE) I find that there are significant positive trends in CDD for July, August, September, October, and December. Figure 8 shows the data and fits for these months in detail. Codedd_fit_cdd |> filter(term == 'year') |> filter(p.value mutate_if(is.numeric,~round(.x,digits = 3)) |> DT::datatable(rownames = FALSE,options = list(pageLength = 5)) ?(caption) Codedd |> filter(month %in% c(7,8,9,10,12)) |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(year, CDD, group = month_name)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y ~ x') + facet_wrap('month_name', scales = 'free') + guides(x = guide_axis(angle = 45)) Figure 8: CDD vs year for Months with significant trends Summary Annual and monthly heating and cooling degree days for the US 1997-2022 were analyzed. A linear regression was applied to the annual data, and to each month, to determine if there was a trend. Model fits with a p-value less than 0.05 were considered significant. There are significant negative (positive) trends in annual HDD (CDD). There are significant negative trends in HDD for the months of June, August, September, and October. There are significant positive trends in CDD for the months of July, August, September, October, and December. SessionInfo CodesessionInfo() R version 4.3.1 (2023-06-16) Platform: x86_64-apple-darwin20 (64-bit) Running under: macOS Sonoma 14.1.2 Matrix products: default BLAS: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib; LAPACK version 3.11.0 locale: [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 time zone: America/Denver tzcode source: internal attached base packages: [1] stats graphics grDevices datasets utils methods base other attached packages: [1] plotly_4.10.3 DT_0.30 broom_1.0.5 janitor_2.2.0 [5] lubridate_1.9.3 forcats_1.0.0 stringr_1.5.0 dplyr_1.1.3 [9] purrr_1.0.2 readr_2.1.4 tidyr_1.3.0 tibble_3.2.1 [13] ggplot2_3.4.4 tidyverse_2.0.0 loaded via a namespace (and not attached): [1] gtable_0.3.4 xfun_0.40 bslib_0.5.1 htmlwidgets_1.6.2 [5] lattice_0.22-5 tzdb_0.4.0 vctrs_0.6.4 tools_4.3.1 [9] crosstalk_1.2.0 generics_0.1.3 parallel_4.3.1 fansi_1.0.5 [13] pkgconfig_2.0.3 Matrix_1.6-1.1 data.table_1.14.8 lifecycle_1.0.3 [17] farver_2.1.1 compiler_4.3.1 munsell_0.5.0 snakecase_0.11.1 [21] htmltools_0.5.6.1 sass_0.4.7 yaml_2.3.7 lazyeval_0.2.2 [25] pillar_1.9.0 crayon_1.5.2 jquerylib_0.1.4 ellipsis_0.3.2 [29] cachem_1.0.8 nlme_3.1-163 tidyselect_1.2.0 digest_0.6.33 [33] stringi_1.7.12 splines_4.3.1 labeling_0.4.3 fastmap_1.1.1 [37] grid_4.3.1 colorspace_2.1-0 cli_3.6.1 magrittr_2.0.3 [41] utf8_1.2.4 withr_2.5.1 scales_1.2.1 backports_1.4.1 [45] bit64_4.0.5 timechange_0.2.0 rmarkdown_2.25 httr_1.4.7 [49] bit_4.0.5 hms_1.1.3 evaluate_0.22 knitr_1.44 [53] viridisLite_0.4.2 mgcv_1.9-0 rlang_1.1.1 glue_1.6.2 [57] renv_1.0.3 rstudioapi_0.15.0 vroom_1.6.4 jsonlite_1.8.7 [61] R6_2.5.1 References Robinson, David, Alex Hayes, and Simon Couch. 2023. “Broom: Convert Statistical Objects into Tidy Tibbles.” https://CRAN.R-project.org/package=broom. Wickham, Hadley, and Lionel Henry. 2023. “Purrr: Functional Programming Tools.” https://CRAN.R-project.org/package=purrr. Wickham, Hadley, Davis Vaughan, and Maximilian Girlich. 2023. “Tidyr: Tidy Messy Data.” https://CRAN.R-project.org/package=tidyr.",
      "meta_keywords": null,
      "og_description": "Introduction Degree days are useful as a measure of building heating and cooling demands. A degree day is calculated as the difference between the average temperature (the average of the high and low temperature for the day) and a reference temperature (in the US 65°F is used). For example, if the average temperature today is 40°F, that would be 25 heating degree days (HDD). A summer day with an average temperature of 85°F would have 20 cooling degree days (CDD). Degree days are usually well correlated with the amount of energy used to heat or cool a home. I was interested in obtaining and analyzing degree day data; in particular I wanted to see if there were any noticeable trends over time. Given an overall increase in earth’s average temperature due to climate change, I would hypothesize that there might be an overall increase in CDD and a decrease in HDD. Changes in heating or cooling degree days would have implications for the amount of energy needed in the future to heat and cool residential or commercial buildings, resulting changes in demand on the electric grid, and implications for related carbon emissions (either for the power grid or from burning fossil fuels to heat buildings). Data I obtained heating and cooling degree day data from the U.S. Energy Information Administration for the US. Note these data are weighted by population, see details of how the EIA data are calculated here. CodesuppressPackageStartupMessages(library(tidyverse)) ggplot2::theme_set(theme_grey(base_size = 15)) suppressPackageStartupMessages(library(janitor)) library(broom) library(DT) suppressPackageStartupMessages(library(plotly)) I’ll only use years we have complete data for (1997-2022). Coderegion rename(CDD = paste0('cooling_degree_days_',region, '_cooling_degree_days_cooling_degree_days')) |> rename(HDD = paste0('heating_degree_days_',region, '_heating_degree_days_heating_degree_days')) |> mutate(date = lubridate::my(month)) |> select(-month) |> mutate(month = lubridate::month(date)) |> mutate(year = lubridate::year(date)) |> filter(year > 1996, year DT::datatable(options = list(pageLength = 5), rownames = FALSE) I’ll also make a dataframe of the yearly totals: Codedd_yearly filter(year > 1996) |> group_by(year) |> summarise(HDD = sum(HDD, na.rm = TRUE), CDD = sum(CDD, na.rm = TRUE) ) dd |> DT::datatable(options = list(pageLength = 5), rownames = FALSE) Analysis Heating Degree Days Figure 1 shows the distribution of US heating degree days for each month. Not surprisingly HDD tends to be higher in winter months, although there is a decent amount of variability between years. HDD Per Month Codedd |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(month_name, HDD, group = month_name)) + geom_boxplot() + labs(title = 'Monthly Heating Degree Days for US (1997-2022)', x = 'Month', y = \"Heating Degree Days\") Figure 1: Boxplot of US heating degree days for each month Trends in HDD Is there a trend in HDD over time? I would expect that HDD might decrease over time due to climate change and the increase in earth’s average temperature. Annual Figure 2 shows a timeseries of the annual total heating degree days in the US, along with a linear regression line that shows a negative trend. Codeg ggplot(aes(year, HDD)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y~x') + labs(title = \"US Annual Heating Degree Days\") g #plotly::ggplotly(g) Figure 2: Timeseries of annual US HDD There is a fair bit of variability, but looking at the fit metrics shows that the negative trend in HDD is statistically significant (p-value < 0.05): Codehdd_yearly_fit mutate_if(is.numeric,~round(.x,digits = 3)) # A tibble: 2 × 5 term estimate std.error statistic p.value 1 (Intercept) 30788. 11849. 2.60 0.016 2 year -13.2 5.90 -2.24 0.035 Codebroom::glance(hdd_yearly_fit) |> mutate_if(is.numeric,~round(.x,digits = 3)) # A tibble: 1 × 12 r.squared adj.r.squared sigma statistic p.value df logLik AIC BIC 1 0.173 0.138 225. 5.01 0.035 1 -177. 359. 363. # ℹ 3 more variables: deviance , df.residual , nobs Monthly We have seen that there is a negative trend in annual HDD; what are the trends for individual months? Figure 3 shows timeseries of monthly HDD vs year for winter months, with linear regression lines plotted over them. Visually there appears to be a negative trend for some of the months. Codedd |> filter(month %in% c(11,12,1,2,3,4)) |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(year, HDD, group = month_name)) + geom_point(size = 3, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y ~ x') + facet_wrap('month_name', scales = 'free') + guides(x = guide_axis(angle = 45)) Figure 3: HDD vs year for winter months To better quantify these trends I want to fit a linear regression to the data for each month and examine the results. This could be done with a for loop, but I will take advantage of a nice nested workflow using the tidyr (Wickham, Vaughan, and Girlich 2023), *broom*(Robinson, Hayes, and Couch 2023), and purrr (Wickham and Henry 2023) packages. Codedd_fit_hdd group_by(month) |> nest() |> mutate(fit = map(data, ~ lm(HDD ~ year, data = .x) ), tidied = map(fit, broom::tidy), glanced = map(fit, broom::glance) ) %>% unnest(tidied) |> ungroup() dd_fit_hdd |> mutate_if(is.numeric,~round(.x,digits = 3)) |> DT::datatable(rownames = FALSE, options = list(pageLength = 5)) Now that the data and model fit results are in a tidy data, they can be easily filtered to identify significant fits using p-values. The months with significant trends are June, August, September, and October. These months and the linear regression lines are shown in Figure 4 Codedd_fit_hdd |> filter(term == 'year') |> filter(p.value mutate_if(is.numeric,~round(.x,digits = 3)) |> DT::datatable(rownames = FALSE) Codedd |> filter(month %in% c(6,8,9,10)) |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(year, HDD, group = month_name)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y ~ x') + facet_wrap('month_name', scales = 'free') Figure 4: HDD vs year for months with signficant trends Cooling Degree Days CDD Per Month Figure 5 shows the distribution of US heating degree days for each month. Not surprisingly CDD tends to be higher in summer months, although there is a decent amount of variability between years. Codedd |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(month_name, CDD, group = month_name)) + geom_boxplot() + labs(title = 'Monthly Cooling Degree Days for US', x = 'Month', y = \"Cooling Degree Days\") Figure 5: Boxplot of US cooling degree days for each month Trends in CDD Annual Is there a trend in CDD over time? I would expect that CDD might increase over time due to climate change and the increase in earth’s average temperature. Figure 6 shows a timeseries of the annual total heating degree days in the US, along with a linear regression line showing a positive trend. Codeg ggplot(aes(year, CDD)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y~x') + labs(title = \"US Annual Cooling Degree Days\") g #plotly::ggplotly(g) Figure 6: Timeseries of annual US CDD Looking at the fit metrics shows that the positive trend in CDD is indeed statistically significant: Codecdd_yearly_fit mutate_if(is.numeric,~round(.x,digits = 3)) # A tibble: 2 × 5 term estimate std.error statistic p.value 1 (Intercept) -23285. 4207. -5.54 0 2 year 12.3 2.09 5.86 0 Codebroom::glance(cdd_yearly_fit) |> mutate_if(is.numeric,~round(.x,digits = 3)) # A tibble: 1 × 12 r.squared adj.r.squared sigma statistic p.value df logLik AIC BIC 1 0.589 0.572 80.1 34.4 0 1 -150. 306. 309. # ℹ 3 more variables: deviance , df.residual , nobs Monthly Figure 7 shows timeseries of monthly CDD vs year for the 4 summer months with the highest CDD, with linear regression lines plotted over them. Visually there appears to be a positive trend for each month. Codedd |> filter(month %in% c(6,7,8,9)) |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(year, CDD, group = month_name)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y ~ x') + facet_wrap('month_name') Figure 7: CDD vs year for summer month Next i’ll apply a linear regression to each month using the same workflow used for HDD. Codedd_fit_cdd group_by(month) |> nest() |> mutate(fit = map(data, ~ lm(CDD ~ year, data = .x) ), tidied = map(fit, broom::tidy) ) %>% unnest(tidied) |> ungroup() dd_fit_cdd |> mutate_if(is.numeric,~round(.x,digits = 3)) |> DT::datatable(options = list(pageLength = 5), rownames = FALSE) I find that there are significant positive trends in CDD for July, August, September, October, and December. Figure 8 shows the data and fits for these months in detail. Codedd_fit_cdd |> filter(term == 'year') |> filter(p.value mutate_if(is.numeric,~round(.x,digits = 3)) |> DT::datatable(rownames = FALSE,options = list(pageLength = 5)) ?(caption) Codedd |> filter(month %in% c(7,8,9,10,12)) |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(year, CDD, group = month_name)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y ~ x') + facet_wrap('month_name', scales = 'free') + guides(x = guide_axis(angle = 45)) Figure 8: CDD vs year for Months with significant trends Summary Annual and monthly heating and cooling degree days for the US 1997-2022 were analyzed. A linear regression was applied to the annual data, and to each month, to determine if there was a trend. Model fits with a p-value less than 0.05 were considered significant. There are significant negative (positive) trends in annual HDD (CDD). There are significant negative trends in HDD for the months of June, August, September, and October. There are significant positive trends in CDD for the months of July, August, September, October, and December. SessionInfo CodesessionInfo() R version 4.3.1 (2023-06-16) Platform: x86_64-apple-darwin20 (64-bit) Running under: macOS Sonoma 14.1.2 Matrix products: default BLAS: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib; LAPACK version 3.11.0 locale: [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 time zone: America/Denver tzcode source: internal attached base packages: [1] stats graphics grDevices datasets utils methods base other attached packages: [1] plotly_4.10.3 DT_0.30 broom_1.0.5 janitor_2.2.0 [5] lubridate_1.9.3 forcats_1.0.0 stringr_1.5.0 dplyr_1.1.3 [9] purrr_1.0.2 readr_2.1.4 tidyr_1.3.0 tibble_3.2.1 [13] ggplot2_3.4.4 tidyverse_2.0.0 loaded via a namespace (and not attached): [1] gtable_0.3.4 xfun_0.40 bslib_0.5.1 htmlwidgets_1.6.2 [5] lattice_0.22-5 tzdb_0.4.0 vctrs_0.6.4 tools_4.3.1 [9] crosstalk_1.2.0 generics_0.1.3 parallel_4.3.1 fansi_1.0.5 [13] pkgconfig_2.0.3 Matrix_1.6-1.1 data.table_1.14.8 lifecycle_1.0.3 [17] farver_2.1.1 compiler_4.3.1 munsell_0.5.0 snakecase_0.11.1 [21] htmltools_0.5.6.1 sass_0.4.7 yaml_2.3.7 lazyeval_0.2.2 [25] pillar_1.9.0 crayon_1.5.2 jquerylib_0.1.4 ellipsis_0.3.2 [29] cachem_1.0.8 nlme_3.1-163 tidyselect_1.2.0 digest_0.6.33 [33] stringi_1.7.12 splines_4.3.1 labeling_0.4.3 fastmap_1.1.1 [37] grid_4.3.1 colorspace_2.1-0 cli_3.6.1 magrittr_2.0.3 [41] utf8_1.2.4 withr_2.5.1 scales_1.2.1 backports_1.4.1 [45] bit64_4.0.5 timechange_0.2.0 rmarkdown_2.25 httr_1.4.7 [49] bit_4.0.5 hms_1.1.3 evaluate_0.22 knitr_1.44 [53] viridisLite_0.4.2 mgcv_1.9-0 rlang_1.1.1 glue_1.6.2 [57] renv_1.0.3 rstudioapi_0.15.0 vroom_1.6.4 jsonlite_1.8.7 [61] R6_2.5.1 References Robinson, David, Alex Hayes, and Simon Couch. 2023. “Broom: Convert Statistical Objects into Tidy Tibbles.” https://CRAN.R-project.org/package=broom. Wickham, Hadley, and Lionel Henry. 2023. “Purrr: Functional Programming Tools.” https://CRAN.R-project.org/package=purrr. Wickham, Hadley, Davis Vaughan, and Maximilian Girlich. 2023. “Tidyr: Tidy Messy Data.” https://CRAN.R-project.org/package=tidyr.",
      "og_image": "https://andypicke.quarto.pub/portfolio/posts/EIA_degree_days/degreedays_files/figure-html/fig-hdd-monthly-boxplot-1.png",
      "og_title": "Analyzing Trends in Heating and Cooling Degree days using R | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 5.3,
      "sitemap_lastmod": "2023-12-12T07:00:00+00:00",
      "twitter_description": "Introduction Degree days are useful as a measure of building heating and cooling demands. A degree day is calculated as the difference between the average temperature (the average of the high and low temperature for the day) and a reference temperature (in the US 65°F is used). For example, if the average temperature today is 40°F, that would be 25 heating degree days (HDD). A summer day with an average temperature of 85°F would have 20 cooling degree days (CDD). Degree days are usually well correlated with the amount of energy used to heat or cool a home. I was interested in obtaining and analyzing degree day data; in particular I wanted to see if there were any noticeable trends over time. Given an overall increase in earth’s average temperature due to climate change, I would hypothesize that there might be an overall increase in CDD and a decrease in HDD. Changes in heating or cooling degree days would have implications for the amount of energy needed in the future to heat and cool residential or commercial buildings, resulting changes in demand on the electric grid, and implications for related carbon emissions (either for the power grid or from burning fossil fuels to heat buildings). Data I obtained heating and cooling degree day data from the U.S. Energy Information Administration for the US. Note these data are weighted by population, see details of how the EIA data are calculated here. CodesuppressPackageStartupMessages(library(tidyverse)) ggplot2::theme_set(theme_grey(base_size = 15)) suppressPackageStartupMessages(library(janitor)) library(broom) library(DT) suppressPackageStartupMessages(library(plotly)) I’ll only use years we have complete data for (1997-2022). Coderegion rename(CDD = paste0('cooling_degree_days_',region, '_cooling_degree_days_cooling_degree_days')) |> rename(HDD = paste0('heating_degree_days_',region, '_heating_degree_days_heating_degree_days')) |> mutate(date = lubridate::my(month)) |> select(-month) |> mutate(month = lubridate::month(date)) |> mutate(year = lubridate::year(date)) |> filter(year > 1996, year DT::datatable(options = list(pageLength = 5), rownames = FALSE) I’ll also make a dataframe of the yearly totals: Codedd_yearly filter(year > 1996) |> group_by(year) |> summarise(HDD = sum(HDD, na.rm = TRUE), CDD = sum(CDD, na.rm = TRUE) ) dd |> DT::datatable(options = list(pageLength = 5), rownames = FALSE) Analysis Heating Degree Days Figure 1 shows the distribution of US heating degree days for each month. Not surprisingly HDD tends to be higher in winter months, although there is a decent amount of variability between years. HDD Per Month Codedd |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(month_name, HDD, group = month_name)) + geom_boxplot() + labs(title = 'Monthly Heating Degree Days for US (1997-2022)', x = 'Month', y = \"Heating Degree Days\") Figure 1: Boxplot of US heating degree days for each month Trends in HDD Is there a trend in HDD over time? I would expect that HDD might decrease over time due to climate change and the increase in earth’s average temperature. Annual Figure 2 shows a timeseries of the annual total heating degree days in the US, along with a linear regression line that shows a negative trend. Codeg ggplot(aes(year, HDD)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y~x') + labs(title = \"US Annual Heating Degree Days\") g #plotly::ggplotly(g) Figure 2: Timeseries of annual US HDD There is a fair bit of variability, but looking at the fit metrics shows that the negative trend in HDD is statistically significant (p-value < 0.05): Codehdd_yearly_fit mutate_if(is.numeric,~round(.x,digits = 3)) # A tibble: 2 × 5 term estimate std.error statistic p.value 1 (Intercept) 30788. 11849. 2.60 0.016 2 year -13.2 5.90 -2.24 0.035 Codebroom::glance(hdd_yearly_fit) |> mutate_if(is.numeric,~round(.x,digits = 3)) # A tibble: 1 × 12 r.squared adj.r.squared sigma statistic p.value df logLik AIC BIC 1 0.173 0.138 225. 5.01 0.035 1 -177. 359. 363. # ℹ 3 more variables: deviance , df.residual , nobs Monthly We have seen that there is a negative trend in annual HDD; what are the trends for individual months? Figure 3 shows timeseries of monthly HDD vs year for winter months, with linear regression lines plotted over them. Visually there appears to be a negative trend for some of the months. Codedd |> filter(month %in% c(11,12,1,2,3,4)) |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(year, HDD, group = month_name)) + geom_point(size = 3, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y ~ x') + facet_wrap('month_name', scales = 'free') + guides(x = guide_axis(angle = 45)) Figure 3: HDD vs year for winter months To better quantify these trends I want to fit a linear regression to the data for each month and examine the results. This could be done with a for loop, but I will take advantage of a nice nested workflow using the tidyr (Wickham, Vaughan, and Girlich 2023), *broom*(Robinson, Hayes, and Couch 2023), and purrr (Wickham and Henry 2023) packages. Codedd_fit_hdd group_by(month) |> nest() |> mutate(fit = map(data, ~ lm(HDD ~ year, data = .x) ), tidied = map(fit, broom::tidy), glanced = map(fit, broom::glance) ) %>% unnest(tidied) |> ungroup() dd_fit_hdd |> mutate_if(is.numeric,~round(.x,digits = 3)) |> DT::datatable(rownames = FALSE, options = list(pageLength = 5)) Now that the data and model fit results are in a tidy data, they can be easily filtered to identify significant fits using p-values. The months with significant trends are June, August, September, and October. These months and the linear regression lines are shown in Figure 4 Codedd_fit_hdd |> filter(term == 'year') |> filter(p.value mutate_if(is.numeric,~round(.x,digits = 3)) |> DT::datatable(rownames = FALSE) Codedd |> filter(month %in% c(6,8,9,10)) |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(year, HDD, group = month_name)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y ~ x') + facet_wrap('month_name', scales = 'free') Figure 4: HDD vs year for months with signficant trends Cooling Degree Days CDD Per Month Figure 5 shows the distribution of US heating degree days for each month. Not surprisingly CDD tends to be higher in summer months, although there is a decent amount of variability between years. Codedd |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(month_name, CDD, group = month_name)) + geom_boxplot() + labs(title = 'Monthly Cooling Degree Days for US', x = 'Month', y = \"Cooling Degree Days\") Figure 5: Boxplot of US cooling degree days for each month Trends in CDD Annual Is there a trend in CDD over time? I would expect that CDD might increase over time due to climate change and the increase in earth’s average temperature. Figure 6 shows a timeseries of the annual total heating degree days in the US, along with a linear regression line showing a positive trend. Codeg ggplot(aes(year, CDD)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y~x') + labs(title = \"US Annual Cooling Degree Days\") g #plotly::ggplotly(g) Figure 6: Timeseries of annual US CDD Looking at the fit metrics shows that the positive trend in CDD is indeed statistically significant: Codecdd_yearly_fit mutate_if(is.numeric,~round(.x,digits = 3)) # A tibble: 2 × 5 term estimate std.error statistic p.value 1 (Intercept) -23285. 4207. -5.54 0 2 year 12.3 2.09 5.86 0 Codebroom::glance(cdd_yearly_fit) |> mutate_if(is.numeric,~round(.x,digits = 3)) # A tibble: 1 × 12 r.squared adj.r.squared sigma statistic p.value df logLik AIC BIC 1 0.589 0.572 80.1 34.4 0 1 -150. 306. 309. # ℹ 3 more variables: deviance , df.residual , nobs Monthly Figure 7 shows timeseries of monthly CDD vs year for the 4 summer months with the highest CDD, with linear regression lines plotted over them. Visually there appears to be a positive trend for each month. Codedd |> filter(month %in% c(6,7,8,9)) |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(year, CDD, group = month_name)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y ~ x') + facet_wrap('month_name') Figure 7: CDD vs year for summer month Next i’ll apply a linear regression to each month using the same workflow used for HDD. Codedd_fit_cdd group_by(month) |> nest() |> mutate(fit = map(data, ~ lm(CDD ~ year, data = .x) ), tidied = map(fit, broom::tidy) ) %>% unnest(tidied) |> ungroup() dd_fit_cdd |> mutate_if(is.numeric,~round(.x,digits = 3)) |> DT::datatable(options = list(pageLength = 5), rownames = FALSE) I find that there are significant positive trends in CDD for July, August, September, October, and December. Figure 8 shows the data and fits for these months in detail. Codedd_fit_cdd |> filter(term == 'year') |> filter(p.value mutate_if(is.numeric,~round(.x,digits = 3)) |> DT::datatable(rownames = FALSE,options = list(pageLength = 5)) ?(caption) Codedd |> filter(month %in% c(7,8,9,10,12)) |> mutate(month_name = lubridate::month(date, label = TRUE)) |> ggplot(aes(year, CDD, group = month_name)) + geom_point(size = 4, alpha = 0.5) + geom_smooth(method = 'lm', formula = 'y ~ x') + facet_wrap('month_name', scales = 'free') + guides(x = guide_axis(angle = 45)) Figure 8: CDD vs year for Months with significant trends Summary Annual and monthly heating and cooling degree days for the US 1997-2022 were analyzed. A linear regression was applied to the annual data, and to each month, to determine if there was a trend. Model fits with a p-value less than 0.05 were considered significant. There are significant negative (positive) trends in annual HDD (CDD). There are significant negative trends in HDD for the months of June, August, September, and October. There are significant positive trends in CDD for the months of July, August, September, October, and December. SessionInfo CodesessionInfo() R version 4.3.1 (2023-06-16) Platform: x86_64-apple-darwin20 (64-bit) Running under: macOS Sonoma 14.1.2 Matrix products: default BLAS: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib; LAPACK version 3.11.0 locale: [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 time zone: America/Denver tzcode source: internal attached base packages: [1] stats graphics grDevices datasets utils methods base other attached packages: [1] plotly_4.10.3 DT_0.30 broom_1.0.5 janitor_2.2.0 [5] lubridate_1.9.3 forcats_1.0.0 stringr_1.5.0 dplyr_1.1.3 [9] purrr_1.0.2 readr_2.1.4 tidyr_1.3.0 tibble_3.2.1 [13] ggplot2_3.4.4 tidyverse_2.0.0 loaded via a namespace (and not attached): [1] gtable_0.3.4 xfun_0.40 bslib_0.5.1 htmlwidgets_1.6.2 [5] lattice_0.22-5 tzdb_0.4.0 vctrs_0.6.4 tools_4.3.1 [9] crosstalk_1.2.0 generics_0.1.3 parallel_4.3.1 fansi_1.0.5 [13] pkgconfig_2.0.3 Matrix_1.6-1.1 data.table_1.14.8 lifecycle_1.0.3 [17] farver_2.1.1 compiler_4.3.1 munsell_0.5.0 snakecase_0.11.1 [21] htmltools_0.5.6.1 sass_0.4.7 yaml_2.3.7 lazyeval_0.2.2 [25] pillar_1.9.0 crayon_1.5.2 jquerylib_0.1.4 ellipsis_0.3.2 [29] cachem_1.0.8 nlme_3.1-163 tidyselect_1.2.0 digest_0.6.33 [33] stringi_1.7.12 splines_4.3.1 labeling_0.4.3 fastmap_1.1.1 [37] grid_4.3.1 colorspace_2.1-0 cli_3.6.1 magrittr_2.0.3 [41] utf8_1.2.4 withr_2.5.1 scales_1.2.1 backports_1.4.1 [45] bit64_4.0.5 timechange_0.2.0 rmarkdown_2.25 httr_1.4.7 [49] bit_4.0.5 hms_1.1.3 evaluate_0.22 knitr_1.44 [53] viridisLite_0.4.2 mgcv_1.9-0 rlang_1.1.1 glue_1.6.2 [57] renv_1.0.3 rstudioapi_0.15.0 vroom_1.6.4 jsonlite_1.8.7 [61] R6_2.5.1 References Robinson, David, Alex Hayes, and Simon Couch. 2023. “Broom: Convert Statistical Objects into Tidy Tibbles.” https://CRAN.R-project.org/package=broom. Wickham, Hadley, and Lionel Henry. 2023. “Purrr: Functional Programming Tools.” https://CRAN.R-project.org/package=purrr. Wickham, Hadley, Davis Vaughan, and Maximilian Girlich. 2023. “Tidyr: Tidy Messy Data.” https://CRAN.R-project.org/package=tidyr.",
      "twitter_title": "Analyzing Trends in Heating and Cooling Degree days using R | R-bloggers",
      "url": "https://www.r-bloggers.com/2023/12/analyzing-trends-in-heating-and-cooling-degree-days-using-r/",
      "word_count": 1053
    }
  }
}