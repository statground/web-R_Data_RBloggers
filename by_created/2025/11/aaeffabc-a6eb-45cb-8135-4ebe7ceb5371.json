{
  "uuid": "aaeffabc-a6eb-45cb-8135-4ebe7ceb5371",
  "created_at": "2025-11-22 19:57:58",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2025/07/how-to-test-r-code-that-uses-llms-apis-or-databases/",
    "crawled_at": "2025-11-22T10:44:50.421008",
    "external_links": [
      {
        "href": "https://jakubsobolewski.com/blog/testing-code-with-dependencies",
        "text": "jakub::sobolewski"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://jakubsobolewski.com/r-tests-gallery/external-service-interaction/",
        "text": "Check out this pattern how to test code with external dependencies."
      },
      {
        "href": "https://refactoring.guru/design-patterns/factory-method",
        "text": "factory function"
      },
      {
        "href": "https://jakubsobolewski.com/r-tests-gallery/external-service-interaction/",
        "text": "See the example on how to test a function that uses {ellmer}."
      },
      {
        "href": "https://jakubsobolewski.com/blog/testing-code-with-dependencies",
        "text": "jakub::sobolewski"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "How to Test R Code That Uses LLMs, APIs, or Databases | R-bloggers",
    "images": [],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/jakubsobolewski/",
        "text": "jakub::sobolewski"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-394489 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">How to Test R Code That Uses LLMs, APIs, or Databases</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">July 31, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/jakubsobolewski/\">jakub::sobolewski</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://jakubsobolewski.com/blog/testing-code-with-dependencies\"> jakub::sobolewski</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47--><p>Your code often relies on external systemsâ€”LLMs, APIs, databases, or third-party libraries. While these are essential for functionality, they donâ€™t need to be part of your tests.</p>\n<p>Hereâ€™s a practical pattern to test your code without relying on external dependencies, so your tests remain fast, reliable, and cheap.</p>\n<blockquote>\n<p>ðŸ§ª <strong><a href=\"https://jakubsobolewski.com/r-tests-gallery/external-service-interaction/\" rel=\"nofollow\" target=\"_blank\">Check out this pattern how to test code with external dependencies.</a></strong></p>\n</blockquote>\n<h2 id=\"-why-testing-external-dependencies-directly-is-a-bad-idea\">ðŸš« Why Testing External Dependencies Directly Is a Bad Idea</h2>\n<p>If you test your code that calls an API as-is:</p>\n<ol>\n<li><strong>Tests will be slow</strong>, as they will need to wait for the external resources to respond.</li>\n<li><strong>Tests will be flaky</strong>, as the external resources may not always be available or may return different results.</li>\n<li><strong>Tests will be expensive</strong>, as you may need to pay for the external resources.</li>\n</ol>\n<p>Or <strong>tests wonâ€™t get written at all</strong>, as there seem to be too many obstacles, it might not be worth it.</p>\n<p>The alternative is to write <strong>tests only for the code you own</strong>.</p>\n<h2 id=\"-test-only-the-code-you-own\">âœ… Test Only The Code You Own</h2>\n<p>The key is to test how your code behaves when interacting with external resources, without using the real ones. Hereâ€™s how:</p>\n<ol>\n<li>Create interfaces for interacting with the external resources.</li>\n<li>Use fake objects or mocks to simulate the external resources in your tests.</li>\n<li>Write tests that verify your codeâ€™s behavior when interacting with the fake objects or mocks.</li>\n<li>Use real objects in production code, but use fake objects or mocks in tests.</li>\n</ol>\n<p>This way, you can test your code without relying on the external resources, making your tests fast, reliable, and inexpensive.</p>\n<h3 id=\"1-create-interfaces\">1. Create Interfaces</h3>\n<p>Donâ€™t hardcode calls to external resources. Instead:</p>\n<ul>\n<li>Create interfaces that define how your code talks to them.</li>\n<li>Use dependency injection to pass these interfaces into your functions or classes.</li>\n</ul>\n<p>This makes it easy to substitute real implementations with fakes or mocks during testing.</p>\n<h3 id=\"2-use-fake-objects-or-mocks\">2. Use Fake Objects or Mocks</h3>\n<p>Simulate external systems in tests using fake objects or mocks:</p>\n<ul>\n<li>Mimic the shape and behavior of expected API/database responses.</li>\n<li>Control edge cases (e.g., timeouts, errors) in a predictable way.</li>\n</ul>\n<p>This helps you test how your code handles various scenarios without relying on the real service.</p>\n<h3 id=\"3-write-tests\">3. Write Tests</h3>\n<p>Test your codeâ€™s behavior by asserting:</p>\n<ul>\n<li>Correct calls to the fake/mocked interface.</li>\n<li>Correct handling of success, failure, and edge cases.</li>\n</ul>\n<p>Follow the Arrange â€“ Act â€“ Assert pattern for each test, and keep each test focused on one expected outcome.</p>\n<p>Create your objects the same way as you would in production code, but use the fake objects or mocks instead of the real objects.</p>\n<h3 id=\"4-use-real-objects-in-production-code\">4. Use Real Objects in Production Code</h3>\n<p>In production:</p>\n<ul>\n<li>Instantiate the real versions of the dependencies.</li>\n<li>Use a <a href=\"https://refactoring.guru/design-patterns/factory-method\" rel=\"nofollow\" target=\"_blank\">factory function</a> to create them. This keeps your production code clean and your tests flexible.</li>\n</ul>\n<p>You can still override dependencies in tests while using defaults in production.</p>\n<hr/>\n<blockquote>\n<p>ðŸ§ª <strong><a href=\"https://jakubsobolewski.com/r-tests-gallery/external-service-interaction/\" rel=\"nofollow\" target=\"_blank\">See the example on how to test a function that uses {ellmer}.</a></strong></p>\n</blockquote>\n<p>External resources are essential to your system, but they donâ€™t belong in your unit tests. By isolating them through interfaces and mocks, you get faster, more reliable, and more maintainable testsâ€”while keeping production code just as clean.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://jakubsobolewski.com/blog/testing-code-with-dependencies\"> jakub::sobolewski</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
    "main_text": "How to Test R Code That Uses LLMs, APIs, or Databases\nPosted on\nJuly 31, 2025\nby\njakub::sobolewski\nin\nR bloggers\n| 0 Comments\n[This article was first published on\njakub::sobolewski\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nYour code often relies on external systemsâ€”LLMs, APIs, databases, or third-party libraries. While these are essential for functionality, they donâ€™t need to be part of your tests.\nHereâ€™s a practical pattern to test your code without relying on external dependencies, so your tests remain fast, reliable, and cheap.\nðŸ§ª\nCheck out this pattern how to test code with external dependencies.\nðŸš« Why Testing External Dependencies Directly Is a Bad Idea\nIf you test your code that calls an API as-is:\nTests will be slow\n, as they will need to wait for the external resources to respond.\nTests will be flaky\n, as the external resources may not always be available or may return different results.\nTests will be expensive\n, as you may need to pay for the external resources.\nOr\ntests wonâ€™t get written at all\n, as there seem to be too many obstacles, it might not be worth it.\nThe alternative is to write\ntests only for the code you own\n.\nâœ… Test Only The Code You Own\nThe key is to test how your code behaves when interacting with external resources, without using the real ones. Hereâ€™s how:\nCreate interfaces for interacting with the external resources.\nUse fake objects or mocks to simulate the external resources in your tests.\nWrite tests that verify your codeâ€™s behavior when interacting with the fake objects or mocks.\nUse real objects in production code, but use fake objects or mocks in tests.\nThis way, you can test your code without relying on the external resources, making your tests fast, reliable, and inexpensive.\n1. Create Interfaces\nDonâ€™t hardcode calls to external resources. Instead:\nCreate interfaces that define how your code talks to them.\nUse dependency injection to pass these interfaces into your functions or classes.\nThis makes it easy to substitute real implementations with fakes or mocks during testing.\n2. Use Fake Objects or Mocks\nSimulate external systems in tests using fake objects or mocks:\nMimic the shape and behavior of expected API/database responses.\nControl edge cases (e.g., timeouts, errors) in a predictable way.\nThis helps you test how your code handles various scenarios without relying on the real service.\n3. Write Tests\nTest your codeâ€™s behavior by asserting:\nCorrect calls to the fake/mocked interface.\nCorrect handling of success, failure, and edge cases.\nFollow the Arrange â€“ Act â€“ Assert pattern for each test, and keep each test focused on one expected outcome.\nCreate your objects the same way as you would in production code, but use the fake objects or mocks instead of the real objects.\n4. Use Real Objects in Production Code\nIn production:\nInstantiate the real versions of the dependencies.\nUse a\nfactory function\nto create them. This keeps your production code clean and your tests flexible.\nYou can still override dependencies in tests while using defaults in production.\nðŸ§ª\nSee the example on how to test a function that uses {ellmer}.\nExternal resources are essential to your system, but they donâ€™t belong in your unit tests. By isolating them through interfaces and mocks, you get faster, more reliable, and more maintainable testsâ€”while keeping production code just as clean.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\njakub::sobolewski\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "A Practical Guide to Faking External Dependencies in R for Fast, Reliable Tests.",
    "meta_keywords": null,
    "og_description": "A Practical Guide to Faking External Dependencies in R for Fast, Reliable Tests.",
    "og_image": "https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png",
    "og_title": "How to Test R Code That Uses LLMs, APIs, or Databases | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 3.4,
    "sitemap_lastmod": null,
    "twitter_description": "A Practical Guide to Faking External Dependencies in R for Fast, Reliable Tests.",
    "twitter_title": "How to Test R Code That Uses LLMs, APIs, or Databases | R-bloggers",
    "url": "https://www.r-bloggers.com/2025/07/how-to-test-r-code-that-uses-llms-apis-or-databases/",
    "word_count": 672
  }
}