{
  "uuid": "8570e61e-26b6-4b75-a7bb-c305ce74895f",
  "created_at": "2025-11-22 19:58:48",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2025/04/choroplethr-v4-0-0-is-now-on-cran/",
    "crawled_at": "2025-11-22T10:50:16.733381",
    "external_links": [
      {
        "href": "https://arilamstein.com/blog/2025/04/14/choroplethr-v4-0-0-is-now-on-cran/",
        "text": "R – Ari Lamstein"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://cnu.edu/people/zhaochenhe/",
        "text": "Zhaochen He"
      },
      {
        "href": "https://arilamstein.com/blog/2025/02/12/is-cran-holding-r-back/",
        "text": "archived"
      },
      {
        "href": "https://www.federalregister.gov/documents/2022/06/06/2022-12063/change-to-county-equivalents-in-the-state-of-connecticut",
        "text": "link"
      },
      {
        "href": "https://www.census.gov/data/academy/courses/choroplethr.html",
        "text": "link"
      },
      {
        "href": "https://i2.wp.com/arilamstein.com/wp-content/uploads/2025/04/state.png?ssl=1",
        "text": null
      },
      {
        "href": "https://en.wikipedia.org/wiki/Federal_Information_Processing_Standard_state_code",
        "text": "FIPS codes"
      },
      {
        "href": "https://i1.wp.com/arilamstein.com/wp-content/uploads/2025/04/county.png?ssl=1",
        "text": null
      },
      {
        "href": "https://i0.wp.com/arilamstein.com/wp-content/uploads/2025/04/tract.png?ssl=1",
        "text": null
      },
      {
        "href": "https://arilamstein.com/blog/2025/02/02/choroplethr-is-scheduled-to-be-archived-from-cran/",
        "text": "here"
      },
      {
        "href": "https://arilamstein.com/open-source/",
        "text": "this"
      },
      {
        "href": "https://arilamstein.com/contact/",
        "text": "this"
      },
      {
        "href": "https://arilamstein.com/blog/2025/04/14/choroplethr-v4-0-0-is-now-on-cran/",
        "text": "R – Ari Lamstein"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Choroplethr v4.0.0 is now on CRAN | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/arilamstein.com/wp-content/uploads/2025/04/state.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/arilamstein.com/wp-content/uploads/2025/04/county.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/arilamstein.com/wp-content/uploads/2025/04/tract.png?w=450&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/ari-lamstein/",
        "text": "Ari Lamstein"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-391897 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Choroplethr v4.0.0 is now on CRAN</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">April 14, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/ari-lamstein/\">Ari Lamstein</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://arilamstein.com/blog/2025/04/14/choroplethr-v4-0-0-is-now-on-cran/\"> R – Ari Lamstein</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47--><p><code>choroplethr</code> version 4.0.0 is now on CRAN. You can install it like this:</p>\n<pre>\n\ninstall.packages(\"choroplethr\")\n\npackageVersion(\"choroplethr\") # [1] ‘4.0.0’\n\n</pre>\n<p>With this version, I have transferred the maintenance of choroplethr to <a href=\"https://cnu.edu/people/zhaochenhe/\" rel=\"nofollow\" target=\"_blank\">Zhaochen He</a>, an economics professor at Christopher Newport University. Zhao addressed the issues that led to choroplethr being <a href=\"https://arilamstein.com/blog/2025/02/12/is-cran-holding-r-back/\" rel=\"nofollow\" target=\"_blank\">archived</a> from CRAN in February. Please join me in thanking Zhao for his contribution!</p>\n<h3>Changes in v4.0.0</h3>\n<p>The primary changes in this version are:</p>\n<ul>\n<li>choroplethr now only uses the <code>tidycensus</code> package to get data from the Census Bureau API. By removing the dependency on the <code>acs</code> package (which was recently archived), choroplethr can be hosted on CRAN again.</li>\n<li>Data returned by the functions <code>get_state_demographics</code><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\">, </span><code>get_county_demographics</code><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\"> and </span><code>get_tract_demographics</code><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\"> has been simplified. These functions previously returned eight columns of data for each region. Now they return only two: </span><code>population</code><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\"> and </span><code>median_hh_income</code><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\">.</span></li>\n<li>The function <code>choroplethr_animate</code> has been removed from the package.</li>\n</ul>\n<h3>Future Work</h3>\n<p>Future development of choroplethr will be decided by Zhao. That’s the best part of being a maintainer, and I don’t want to take it away from him. But I also want to note three issues I see facing the project: outdated maps, simple features and backwards compatibility.</p>\n<h5>Outdated Maps</h5>\n<p>When Choroplethr was released in 2014, one of its contributions was packaging contemporary maps and making them accessible to the entire R ecosystem. (For reference, at that time, the world map that shipped with the <code>maps</code> package still included the USSR!)</p>\n<p>Unfortunately these maps are now outdated, and it is causing problems in some cases. For example, in 2022 Census changed the names and boundaries of Connecticut’s county-equivalents (<a href=\"https://www.federalregister.gov/documents/2022/06/06/2022-12063/change-to-county-equivalents-in-the-state-of-connecticut\" rel=\"nofollow\" target=\"_blank\">link</a>). Because choroplethr’s county map is from 2010, attempting to map data from 2022 or later generates an error. Here is a code snippet that demonstrates the issue:</p>\n<pre>\nlibrary(choroplethr)\n\n#Works\ndf = get_county_demographics(2021)\ndf$value = df$population\ncounty_choropleth(df, state_zoom='connecticut')\n\n#Error\ndf = get_county_demographics(2022)\ndf$value = df$population\ncounty_choropleth(df, state_zoom='connecticut')\n\n</pre>\n<p>In addition to the county map, I believe that the following maps should also be updated:</p>\n<ul>\n<li>choroplethrZip packages the Census Bureau’s 2010 ZIP Code Tabulation Area (ZCTA) map. A newer version of that map was published in 2020. There appear to be significant differences between the two versions, and I think that choroplethr should use the newer one.</li>\n<li>Choroplethr’s country (Admin 0) map is version 2.0.0 from Natural Earth Data. The latest version is 5.1.1. Being on the latest major version of the map seems like a good idea.</li>\n<li>Choroplethr’s province (Admin 1) map is version 3.0.0 from Natural Earth Data. The latest version is 5.1.0. Being on the latest major version of this map also seems like a good idea.</li>\n<li>Calling <code>county_choropleth</code> actually renders two maps: a state map superimposed over a county map. This helps users understand which counties are part of which state. Currently, both maps are from 2010. If we update the county map, then I think we should also update the state map to be from the same year.</li>\n</ul>\n<h5>Simple Features</h5>\n<p>Choroplethr was published when the best way to make a map with ggplot2 was by “fortifying” a shapefile. Towards the end of my active development on choroplethr the “Simple Features” package was created. My impression is that there might be advantages to migrating choroplethr to use simple features. Unfortunately, I never got around to researching this.</p>\n<p>I think it would be useful if someone researches Simple Features and generates an informed opinion on whether (and how) to incorporate it into choroplethr.</p>\n<h5>Backwards Compatibility</h5>\n<p>One of the highlights of developing choroplethr was when the US Census Bureau commissioned a video course on it. That course is still on their website (<a href=\"https://www.census.gov/data/academy/courses/choroplethr.html\" rel=\"nofollow\" target=\"_blank\">link</a>), and it would be awkward if the instructions in it somehow stopped working.</p>\n<p>That said, the course was published in 2016 and should not prevent genuine innovation. I am not sure the best way to balance this, and it’s possible that I became too conservative about breaking backwards compatibility after the course was released.</p>\n<p>I hope that Zhao can find a balance between innovation and respecting backwards compatibility.</p>\n<h3 id=\"example\">Example</h3>\n<p>Back in choroplethr’s heyday I would include an example in each post. This might be my last post about choroplethr, and I thought it would be nice to include an example here as well.</p>\n<p>Since the output of the functions that get state, county and tract demographics have changed, let’s use them. We can use those functions to explore how the median household income in the US changed between 2009 (the first 5-year ACS) and 2023 (the last 5-year ACS).</p>\n<h5>Change in State Median Household Income</h5>\n<p>Here’s how to map the percent change in median income in each state between 2009 and 2023:</p>\n<pre>\nlibrary(choroplethr)\nstopifnot(packageVersion(\"choroplethr\") &gt;= '4.0.0')\n\n#Get data from 2009 and 2023\ndf_2009 = get_state_demographics(2009, 5)\ndf_2009$value = df_2009$median_hh_income\ndf_2023 = get_state_demographics(2023, 5)\ndf_2023$value = df_2023$median_hh_income\n\n#Calculate and map percent change\ndf_final = calculate_percent_change(df_2009, df_2023)\nstate_choropleth(df_final,\n    title = 'Change in Median Household Income: 2009 to 2023',\n    legend = 'Percent Change',\n    num_colors = 4)\n</pre>\n<p><a href=\"https://i2.wp.com/arilamstein.com/wp-content/uploads/2025/04/state.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img alt=\"\" class=\"aligncenter size-full wp-image-21512\" data-attachment-id=\"21512\" data-comments-opened=\"0\" data-image-caption=\"\" data-image-description=\"\" data-image-title=\"state\" data-large-file=\"https://i2.wp.com/arilamstein.com/wp-content/uploads/2025/04/state.png?w=450&amp;ssl=1\" data-lazy-sizes=\"(max-width: 1007px) 100vw, 1007px\" data-lazy-src=\"https://i2.wp.com/arilamstein.com/wp-content/uploads/2025/04/state.png?w=450&amp;ssl=1\" data-medium-file=\"https://arilamstein.com/wp-content/uploads/2025/04/state-300x202.png\" data-orig-file=\"https://i2.wp.com/arilamstein.com/wp-content/uploads/2025/04/state.png?w=450&amp;ssl=1\" data-orig-size=\"1007,677\" data-permalink=\"https://arilamstein.com/blog/2025/04/14/choroplethr-v4-0-0-is-now-on-cran/state/\" data-recalc-dims=\"1\" decoding=\"async\" fetchpriority=\"high\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i2.wp.com/arilamstein.com/wp-content/uploads/2025/04/state.png?w=450&amp;ssl=1 1007w, https://arilamstein.com/wp-content/uploads/2025/04/state-300x202.png 300w, https://arilamstein.com/wp-content/uploads/2025/04/state-768x516.png 768w\"/><noscript><img alt=\"\" aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_len=\"\" class=\"aligncenter size-full wp-image-21512\" data-attachment-id=\"21512\" data-comments-opened=\"0\" data-image-caption=\"\" data-image-description=\"\" data-image-meta=\"{\" data-image-title=\"state\" data-large-file=\"https://i2.wp.com/arilamstein.com/wp-content/uploads/2025/04/state.png?w=450&amp;ssl=1\" data-medium-file=\"https://arilamstein.com/wp-content/uploads/2025/04/state-300x202.png\" data-orig-file=\"https://i2.wp.com/arilamstein.com/wp-content/uploads/2025/04/state.png?w=450&amp;ssl=1\" data-orig-size=\"1007,677\" data-permalink=\"https://arilamstein.com/blog/2025/04/14/choroplethr-v4-0-0-is-now-on-cran/state/\" data-recalc-dims=\"1\" decoding=\"async\" fetchpriority=\"high\" loading=\"lazy\" sizes=\"(max-width: 1007px) 100vw, 1007px\" src=\"https://i2.wp.com/arilamstein.com/wp-content/uploads/2025/04/state.png?w=450&amp;ssl=1\" srcset_temp=\"https://i2.wp.com/arilamstein.com/wp-content/uploads/2025/04/state.png?w=450&amp;ssl=1 1007w, https://arilamstein.com/wp-content/uploads/2025/04/state-300x202.png 300w, https://arilamstein.com/wp-content/uploads/2025/04/state-768x516.png 768w\"/></noscript></a></p>\n<p>This map really surprised me. Virtually all the states in the top quartile are in the western half of the country. And many of the exceptions to that rule (Nevada, Wyoming and New Mexico) are in the lowest quartile.</p>\n<h5>Change in County Median Household Income</h5>\n<p>For the county map, let’s zoom in on the five counties that make up New York City. Using a continuous scale will help us see the magnitude of the difference between each county. (Recall that when working with counties you need to use <a href=\"https://en.wikipedia.org/wiki/Federal_Information_Processing_Standard_state_code\" rel=\"nofollow\" target=\"_blank\">FIPS codes</a>).</p>\n<pre>\ndf_2009 = get_county_demographics(2009)\ndf_2009$value = df_2009$median_hh_income\ndf_2023 = get_county_demographics(2023)\ndf_2023$value = df_2023$median_hh_income\n\ndf_final = calculate_percent_change(df_2009, df_2023)\n\nnyc_counties = c(36005, 36047, 36061, 36081, 36085)\ncounty_choropleth(df_final,\n    title = 'Change in Median Household Income: 2009 to 2023\\nCounties in New York City',\n    legend = 'Percent Change',\n    num_colors = 1,\n    county_zoom = nyc_counties)\n</pre>\n<p><a href=\"https://i1.wp.com/arilamstein.com/wp-content/uploads/2025/04/county.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img alt=\"\" class=\"aligncenter size-full wp-image-21513\" data-attachment-id=\"21513\" data-comments-opened=\"0\" data-image-caption=\"\" data-image-description=\"\" data-image-title=\"county\" data-large-file=\"https://i1.wp.com/arilamstein.com/wp-content/uploads/2025/04/county.png?w=450&amp;ssl=1\" data-lazy-sizes=\"(max-width: 1007px) 100vw, 1007px\" data-lazy-src=\"https://i1.wp.com/arilamstein.com/wp-content/uploads/2025/04/county.png?w=450&amp;ssl=1\" data-medium-file=\"https://arilamstein.com/wp-content/uploads/2025/04/county-300x202.png\" data-orig-file=\"https://i1.wp.com/arilamstein.com/wp-content/uploads/2025/04/county.png?w=450&amp;ssl=1\" data-orig-size=\"1007,677\" data-permalink=\"https://arilamstein.com/blog/2025/04/14/choroplethr-v4-0-0-is-now-on-cran/county/\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i1.wp.com/arilamstein.com/wp-content/uploads/2025/04/county.png?w=450&amp;ssl=1 1007w, https://arilamstein.com/wp-content/uploads/2025/04/county-300x202.png 300w, https://arilamstein.com/wp-content/uploads/2025/04/county-768x516.png 768w\"/><noscript><img alt=\"\" aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_len=\"\" class=\"aligncenter size-full wp-image-21513\" data-attachment-id=\"21513\" data-comments-opened=\"0\" data-image-caption=\"\" data-image-description=\"\" data-image-meta=\"{\" data-image-title=\"county\" data-large-file=\"https://i1.wp.com/arilamstein.com/wp-content/uploads/2025/04/county.png?w=450&amp;ssl=1\" data-medium-file=\"https://arilamstein.com/wp-content/uploads/2025/04/county-300x202.png\" data-orig-file=\"https://i1.wp.com/arilamstein.com/wp-content/uploads/2025/04/county.png?w=450&amp;ssl=1\" data-orig-size=\"1007,677\" data-permalink=\"https://arilamstein.com/blog/2025/04/14/choroplethr-v4-0-0-is-now-on-cran/county/\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"(max-width: 1007px) 100vw, 1007px\" src=\"https://i1.wp.com/arilamstein.com/wp-content/uploads/2025/04/county.png?w=450&amp;ssl=1\" srcset_temp=\"https://i1.wp.com/arilamstein.com/wp-content/uploads/2025/04/county.png?w=450&amp;ssl=1 1007w, https://arilamstein.com/wp-content/uploads/2025/04/county-300x202.png 300w, https://arilamstein.com/wp-content/uploads/2025/04/county-768x516.png 768w\"/></noscript></a></p>\n<p>Unfortunately <code>county_choropleth</code> doesn’t print the names of the counties, so you need to have some familiarity with New York City to understand this map. The darkest county is Brooklyn (Kings County), which had an increase in median household income of 83% in just 14 years!</p>\n<h5>Change in Tract Median Household Income</h5>\n<p>I wondered if all of Brooklyn had a large increase in income, or just parts of it. We can answer that question by analyzing the census tracts in Brooklyn:</p>\n<pre>\ndf_2009 = get_tract_demographics(\"new york\", 36047, 2009)\ndf_2009$value = df_2009$median_hh_income\ndf_2023 = get_tract_demographics(\"new york\", 36047, 2023)\ndf_2023$value = df_2023$median_hh_income\n\ndf_final = calculate_percent_change(df_2009, df_2023)\n\ntract_choropleth(df_final,\n    \"new york\", \n    county_zoom=36047,\n    legend=\"Percent Change\",\n    title=\"Change in Median Household Income: 2009-2023\\nCensus Tracts in Brooklyn, NY\")\n</pre>\n<p><a href=\"https://i0.wp.com/arilamstein.com/wp-content/uploads/2025/04/tract.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img alt=\"\" class=\"aligncenter size-full wp-image-21514\" data-attachment-id=\"21514\" data-comments-opened=\"0\" data-image-caption=\"\" data-image-description=\"\" data-image-title=\"tract\" data-large-file=\"https://i0.wp.com/arilamstein.com/wp-content/uploads/2025/04/tract.png?w=450&amp;ssl=1\" data-lazy-sizes=\"(max-width: 1007px) 100vw, 1007px\" data-lazy-src=\"https://i0.wp.com/arilamstein.com/wp-content/uploads/2025/04/tract.png?w=450&amp;ssl=1\" data-medium-file=\"https://arilamstein.com/wp-content/uploads/2025/04/tract-300x202.png\" data-orig-file=\"https://i0.wp.com/arilamstein.com/wp-content/uploads/2025/04/tract.png?w=450&amp;ssl=1\" data-orig-size=\"1007,677\" data-permalink=\"https://arilamstein.com/blog/2025/04/14/choroplethr-v4-0-0-is-now-on-cran/tract/\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" srcset_temp=\"https://i0.wp.com/arilamstein.com/wp-content/uploads/2025/04/tract.png?w=450&amp;ssl=1 1007w, https://arilamstein.com/wp-content/uploads/2025/04/tract-300x202.png 300w, https://arilamstein.com/wp-content/uploads/2025/04/tract-768x516.png 768w\"/><noscript><img alt=\"\" aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_len=\"\" class=\"aligncenter size-full wp-image-21514\" data-attachment-id=\"21514\" data-comments-opened=\"0\" data-image-caption=\"\" data-image-description=\"\" data-image-meta=\"{\" data-image-title=\"tract\" data-large-file=\"https://i0.wp.com/arilamstein.com/wp-content/uploads/2025/04/tract.png?w=450&amp;ssl=1\" data-medium-file=\"https://arilamstein.com/wp-content/uploads/2025/04/tract-300x202.png\" data-orig-file=\"https://i0.wp.com/arilamstein.com/wp-content/uploads/2025/04/tract.png?w=450&amp;ssl=1\" data-orig-size=\"1007,677\" data-permalink=\"https://arilamstein.com/blog/2025/04/14/choroplethr-v4-0-0-is-now-on-cran/tract/\" data-recalc-dims=\"1\" decoding=\"async\" loading=\"lazy\" sizes=\"(max-width: 1007px) 100vw, 1007px\" src=\"https://i0.wp.com/arilamstein.com/wp-content/uploads/2025/04/tract.png?w=450&amp;ssl=1\" srcset_temp=\"https://i0.wp.com/arilamstein.com/wp-content/uploads/2025/04/tract.png?w=450&amp;ssl=1 1007w, https://arilamstein.com/wp-content/uploads/2025/04/tract-300x202.png 300w, https://arilamstein.com/wp-content/uploads/2025/04/tract-768x516.png 768w\"/></noscript></a>It appears that the northern half of Brooklyn experienced a much larger increase in median household income than the southern half. This might be due to its close proximity to Manhattan (northern Brooklyn is connected to Manhattan by three bridges and a tunnel). Also note the range of the scale: it goes from -40.5% to 362.9%!</p>\n<h3>Conclusion</h3>\n<div class=\"elementor-element elementor-element-30caa1b elementor-widget elementor-widget-theme-post-content\" data-element_type=\"widget\" data-id=\"30caa1b\" data-widget_type=\"theme-post-content.default\">\n<div class=\"elementor-widget-container\">\n<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\">Thank you again to Zhaochen He for becoming the new maintainer of choroplethr. As I mentioned <a href=\"https://arilamstein.com/blog/2025/02/02/choroplethr-is-scheduled-to-be-archived-from-cran/\" rel=\"nofollow\" target=\"_blank\">here</a>, choroplethr was downloaded over 1,500 times in the month before it was archived. Archiving it impacted a significant number of users</span><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\">. Thanks to Zhaochen’s efforts, the package is now back on CRAN.</span></p>\n</div>\n</div>\n<div class=\"elementor-element elementor-element-30caa1b elementor-widget elementor-widget-theme-post-content\" data-element_type=\"widget\" data-id=\"30caa1b\" data-widget_type=\"theme-post-content.default\">\n<div class=\"elementor-widget-container\">\n<p>If you would like to learn more about choroplethr, then please visit <a href=\"https://arilamstein.com/open-source/\" rel=\"nofollow\" target=\"_blank\">this</a> page. There you will find a recording of a webinar I gave about choroplethr at the CDC, as well as links to three (now free) courses I created on how to use choroplethr.</p>\n<p><em>While I have disabled comments on my blog, I welcome hearing from readers. Use <a href=\"https://arilamstein.com/contact/\" rel=\"nofollow\" target=\"_blank\">this</a> form to contact me.</em></p>\n</div>\n</div>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://arilamstein.com/blog/2025/04/14/choroplethr-v4-0-0-is-now-on-cran/\"> R – Ari Lamstein</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
    "main_text": "Choroplethr v4.0.0 is now on CRAN\nPosted on\nApril 14, 2025\nby\nAri Lamstein\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nR – Ari Lamstein\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nchoroplethr\nversion 4.0.0 is now on CRAN. You can install it like this:\ninstall.packages(\"choroplethr\")\n\npackageVersion(\"choroplethr\") # [1] ‘4.0.0’\nWith this version, I have transferred the maintenance of choroplethr to\nZhaochen He\n, an economics professor at Christopher Newport University. Zhao addressed the issues that led to choroplethr being\narchived\nfrom CRAN in February. Please join me in thanking Zhao for his contribution!\nChanges in v4.0.0\nThe primary changes in this version are:\nchoroplethr now only uses the\ntidycensus\npackage to get data from the Census Bureau API. By removing the dependency on the\nacs\npackage (which was recently archived), choroplethr can be hosted on CRAN again.\nData returned by the functions\nget_state_demographics\n,\nget_county_demographics\nand\nget_tract_demographics\nhas been simplified. These functions previously returned eight columns of data for each region. Now they return only two:\npopulation\nand\nmedian_hh_income\n.\nThe function\nchoroplethr_animate\nhas been removed from the package.\nFuture Work\nFuture development of choroplethr will be decided by Zhao. That’s the best part of being a maintainer, and I don’t want to take it away from him. But I also want to note three issues I see facing the project: outdated maps, simple features and backwards compatibility.\nOutdated Maps\nWhen Choroplethr was released in 2014, one of its contributions was packaging contemporary maps and making them accessible to the entire R ecosystem. (For reference, at that time, the world map that shipped with the\nmaps\npackage still included the USSR!)\nUnfortunately these maps are now outdated, and it is causing problems in some cases. For example, in 2022 Census changed the names and boundaries of Connecticut’s county-equivalents (\nlink\n). Because choroplethr’s county map is from 2010, attempting to map data from 2022 or later generates an error. Here is a code snippet that demonstrates the issue:\nlibrary(choroplethr)\n\n#Works\ndf = get_county_demographics(2021)\ndf$value = df$population\ncounty_choropleth(df, state_zoom='connecticut')\n\n#Error\ndf = get_county_demographics(2022)\ndf$value = df$population\ncounty_choropleth(df, state_zoom='connecticut')\nIn addition to the county map, I believe that the following maps should also be updated:\nchoroplethrZip packages the Census Bureau’s 2010 ZIP Code Tabulation Area (ZCTA) map. A newer version of that map was published in 2020. There appear to be significant differences between the two versions, and I think that choroplethr should use the newer one.\nChoroplethr’s country (Admin 0) map is version 2.0.0 from Natural Earth Data. The latest version is 5.1.1. Being on the latest major version of the map seems like a good idea.\nChoroplethr’s province (Admin 1) map is version 3.0.0 from Natural Earth Data. The latest version is 5.1.0. Being on the latest major version of this map also seems like a good idea.\nCalling\ncounty_choropleth\nactually renders two maps: a state map superimposed over a county map. This helps users understand which counties are part of which state. Currently, both maps are from 2010. If we update the county map, then I think we should also update the state map to be from the same year.\nSimple Features\nChoroplethr was published when the best way to make a map with ggplot2 was by “fortifying” a shapefile. Towards the end of my active development on choroplethr the “Simple Features” package was created. My impression is that there might be advantages to migrating choroplethr to use simple features. Unfortunately, I never got around to researching this.\nI think it would be useful if someone researches Simple Features and generates an informed opinion on whether (and how) to incorporate it into choroplethr.\nBackwards Compatibility\nOne of the highlights of developing choroplethr was when the US Census Bureau commissioned a video course on it. That course is still on their website (\nlink\n), and it would be awkward if the instructions in it somehow stopped working.\nThat said, the course was published in 2016 and should not prevent genuine innovation. I am not sure the best way to balance this, and it’s possible that I became too conservative about breaking backwards compatibility after the course was released.\nI hope that Zhao can find a balance between innovation and respecting backwards compatibility.\nExample\nBack in choroplethr’s heyday I would include an example in each post. This might be my last post about choroplethr, and I thought it would be nice to include an example here as well.\nSince the output of the functions that get state, county and tract demographics have changed, let’s use them. We can use those functions to explore how the median household income in the US changed between 2009 (the first 5-year ACS) and 2023 (the last 5-year ACS).\nChange in State Median Household Income\nHere’s how to map the percent change in median income in each state between 2009 and 2023:\nlibrary(choroplethr)\nstopifnot(packageVersion(\"choroplethr\") >= '4.0.0')\n\n#Get data from 2009 and 2023\ndf_2009 = get_state_demographics(2009, 5)\ndf_2009$value = df_2009$median_hh_income\ndf_2023 = get_state_demographics(2023, 5)\ndf_2023$value = df_2023$median_hh_income\n\n#Calculate and map percent change\ndf_final = calculate_percent_change(df_2009, df_2023)\nstate_choropleth(df_final,\n    title = 'Change in Median Household Income: 2009 to 2023',\n    legend = 'Percent Change',\n    num_colors = 4)\nThis map really surprised me. Virtually all the states in the top quartile are in the western half of the country. And many of the exceptions to that rule (Nevada, Wyoming and New Mexico) are in the lowest quartile.\nChange in County Median Household Income\nFor the county map, let’s zoom in on the five counties that make up New York City. Using a continuous scale will help us see the magnitude of the difference between each county. (Recall that when working with counties you need to use\nFIPS codes\n).\ndf_2009 = get_county_demographics(2009)\ndf_2009$value = df_2009$median_hh_income\ndf_2023 = get_county_demographics(2023)\ndf_2023$value = df_2023$median_hh_income\n\ndf_final = calculate_percent_change(df_2009, df_2023)\n\nnyc_counties = c(36005, 36047, 36061, 36081, 36085)\ncounty_choropleth(df_final,\n    title = 'Change in Median Household Income: 2009 to 2023\\nCounties in New York City',\n    legend = 'Percent Change',\n    num_colors = 1,\n    county_zoom = nyc_counties)\nUnfortunately\ncounty_choropleth\ndoesn’t print the names of the counties, so you need to have some familiarity with New York City to understand this map. The darkest county is Brooklyn (Kings County), which had an increase in median household income of 83% in just 14 years!\nChange in Tract Median Household Income\nI wondered if all of Brooklyn had a large increase in income, or just parts of it. We can answer that question by analyzing the census tracts in Brooklyn:\ndf_2009 = get_tract_demographics(\"new york\", 36047, 2009)\ndf_2009$value = df_2009$median_hh_income\ndf_2023 = get_tract_demographics(\"new york\", 36047, 2023)\ndf_2023$value = df_2023$median_hh_income\n\ndf_final = calculate_percent_change(df_2009, df_2023)\n\ntract_choropleth(df_final,\n    \"new york\", \n    county_zoom=36047,\n    legend=\"Percent Change\",\n    title=\"Change in Median Household Income: 2009-2023\\nCensus Tracts in Brooklyn, NY\")\nIt appears that the northern half of Brooklyn experienced a much larger increase in median household income than the southern half. This might be due to its close proximity to Manhattan (northern Brooklyn is connected to Manhattan by three bridges and a tunnel). Also note the range of the scale: it goes from -40.5% to 362.9%!\nConclusion\nThank you again to Zhaochen He for becoming the new maintainer of choroplethr. As I mentioned\nhere\n, choroplethr was downloaded over 1,500 times in the month before it was archived. Archiving it impacted a significant number of users\n. Thanks to Zhaochen’s efforts, the package is now back on CRAN.\nIf you would like to learn more about choroplethr, then please visit\nthis\npage. There you will find a recording of a webinar I gave about choroplethr at the CDC, as well as links to three (now free) courses I created on how to use choroplethr.\nWhile I have disabled comments on my blog, I welcome hearing from readers. Use\nthis\nform to contact me.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nR – Ari Lamstein\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "choroplethr version 4.0.0 is now on CRAN. You can install it like this: With this version, I have transferred the maintenance of choroplethr to Zhaochen He, an economics professor at Christopher Newport University. Zhao addressed the issues that led to choroplethr being archived from CRAN in February. Please join me in thanking Zhao for his […]",
    "meta_keywords": null,
    "og_description": "choroplethr version 4.0.0 is now on CRAN. You can install it like this: With this version, I have transferred the maintenance of choroplethr to Zhaochen He, an economics professor at Christopher Newport University. Zhao addressed the issues that led to choroplethr being archived from CRAN in February. Please join me in thanking Zhao for his […]",
    "og_image": "https://arilamstein.com/wp-content/uploads/2025/04/state.png",
    "og_title": "Choroplethr v4.0.0 is now on CRAN | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 7.2,
    "sitemap_lastmod": null,
    "twitter_description": "choroplethr version 4.0.0 is now on CRAN. You can install it like this: With this version, I have transferred the maintenance of choroplethr to Zhaochen He, an economics professor at Christopher Newport University. Zhao addressed the issues that led to choroplethr being archived from CRAN in February. Please join me in thanking Zhao for his […]",
    "twitter_title": "Choroplethr v4.0.0 is now on CRAN | R-bloggers",
    "url": "https://www.r-bloggers.com/2025/04/choroplethr-v4-0-0-is-now-on-cran/",
    "word_count": 1446
  }
}