{
  "id": "d917b73c1485c80129a0e4e842b3061627ea26f0",
  "url": "https://www.r-bloggers.com/2023/12/powerquery-puzzle-solved-with-r-3/",
  "created_at_utc": "2025-11-17T20:38:59Z",
  "data": null,
  "raw_original": {
    "uuid": "c3bdfc05-2176-4c55-8f54-b12af53e70e7",
    "created_at": "2025-11-17 20:38:59",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2023/12/powerquery-puzzle-solved-with-r-3/",
      "crawled_at": "2025-11-17T09:39:39.359606",
      "external_links": [
        {
          "href": "https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-f8607c1093ad",
          "text": "Numbers around us - Medium"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_powerquerychallenge-daxchallenge-m-activity-7136564640230035456-hBYa",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/dqr6zbzh",
          "text": "file"
        },
        {
          "href": "https://www.linkedin.com/posts/excelbi_powerquerychallenge-daxchallenge-m-activity-7136927031631429632-_PE5",
          "text": "content"
        },
        {
          "href": "https://lnkd.in/dt62n3WB",
          "text": "file"
        },
        {
          "href": "https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-f8607c1093ad",
          "text": "PowerQuery Puzzle solved with R"
        },
        {
          "href": "https://medium.com/number-around-us",
          "text": "Numbers around us"
        },
        {
          "href": "https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-f8607c1093ad",
          "text": "Numbers around us - Medium"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "PowerQuery Puzzle solved with R | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*tVUTgYfQFsgKzKEnQp7ONQ.jpeg?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*O9c5XCvOg9i9qNL9-vfy0g.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*Fgux5Ps4qCa_v45N1bhvDg.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": "data:application/octet-stream;base64,R0lGODlhAQABAO+/vQAA77+977+977+9AAAAIe+/vQQBAAAAACwAAAAAAQABAAACAkQBADs=",
          "src": "https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=f8607c1093ad"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/numbers-around-us/",
          "text": "Numbers around us"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-380529 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">PowerQuery Puzzle solved with R</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 5, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/numbers-around-us/\">Numbers around us</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-f8607c1093ad\"> Numbers around us - Medium</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><p># 135–136</p><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*tVUTgYfQFsgKzKEnQp7ONQ.jpeg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*tVUTgYfQFsgKzKEnQp7ONQ.jpeg?w=578&amp;ssl=1\"/></noscript></figure><h3>Puzzles:</h3><p>PQ_135: <a href=\"https://www.linkedin.com/posts/excelbi_powerquerychallenge-daxchallenge-m-activity-7136564640230035456-hBYa\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dqr6zbzh\" rel=\"nofollow\" target=\"_blank\">file</a><br/>PQ_136: <a href=\"https://www.linkedin.com/posts/excelbi_powerquerychallenge-daxchallenge-m-activity-7136927031631429632-_PE5\" rel=\"nofollow\" target=\"_blank\">content</a> <a href=\"https://lnkd.in/dt62n3WB\" rel=\"nofollow\" target=\"_blank\">file</a></p><h3>PQ_135</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*O9c5XCvOg9i9qNL9-vfy0g.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*O9c5XCvOg9i9qNL9-vfy0g.png?w=578&amp;ssl=1\"/></noscript></figure><p>Lets imagine that we have binning machines in our sport centre. We can set how many balls need to be grouped in one bin/bucket/chest/whatever. We have 10 balls and machine is placing it in maximally 4 containers.<br/>Now basing on bin size set on machine we have to find what range of balls is in each container.</p><h4>Load libraries and data:</h4><pre>library(tidyverse)\nlibrary(readxl)\n\nsequence = data.frame(elements = str_c(\"B\", 1:10))\n\ninput = read_excel(\"PQ_Challenge_135.xlsx\", range = \"A1:B6\")\ntest = read_excel(\"PQ_Challenge_135.xlsx\", range = \"L1:Q6\")</pre><h4>Transform data and validation:</h4><pre>slice_df_to_range = function(df, x) {\n  df_sliced = df %&gt;%\n    mutate(section = str_c(\"Group \",((row_number()-1) %/% x)+1)) %&gt;%\n    group_by(section) %&gt;%\n    mutate(range = str_c(first(elements),\"-\", last(elements))) %&gt;%\n    select(-elements) %&gt;%\n    distinct()\n  \n  return(df_sliced)\n}\n\nresult = input %&gt;%\n  mutate(sections = map(`Bin size`, slice_df_to_range, df = sequence)) %&gt;%\n  unnest(cols = sections) %&gt;%\n  pivot_wider(names_from = section, values_from = range)\n\nidentical(result, test)\n#&gt; [1] TRUE</pre><h3>PQ_136</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*Fgux5Ps4qCa_v45N1bhvDg.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*Fgux5Ps4qCa_v45N1bhvDg.png?w=578&amp;ssl=1\"/></noscript></figure><p>In this puzzle we have groups that (as I imagine take parts in different projects — IDs). And we need to find which group has common project with another groups. But we can point relationship only on first occurence. For example if we have A and B in project of group A, even if we have them in project of group B, it can not be count. Little bit tricky, but let try.</p><h4>Load libraries and data:</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput &lt;- read_excel(\"PQ_Challenge_136.xlsx\", range = \"A1:B15\")\ntest &lt;- read_excel(\"PQ_Challenge_136.xlsx\", range = \"D1:E5\")</pre><h4>Transform data and validation:</h4><pre>groups &lt;- input %&gt;%\n  group_by(Group) %&gt;%\n  summarise(all = list(ID), .groups = 'drop')\n\nrow_indices &lt;- seq_len(nrow(groups)) - 1\n\nacum &lt;- map(row_indices, ~{\n  current_ids &lt;- groups$all[[.x + 1]]\n  subsequent_rows &lt;- row_indices[.x + 2:length(row_indices)]\n  map(subsequent_rows, ~{\n    if (any(groups$all[[.x + 1]] %in% current_ids)) {\n      groups$Group[.x + 1]\n    } else {\n      NA_character_\n    }\n  }) %&gt;% unlist() %&gt;% na.omit()\n}) %&gt;% map_chr(., ~str_c(.x, collapse = \", \")) \n\nresult &lt;- tibble(Group = groups$Group, Common = acum) %&gt;%\n  mutate(Common = if_else(Common == \"\", NA_character_, Common))\n\nidentical(result, test)\n#&gt; [1] TRUE</pre><p>We’ve seen some nice puzzles considering time changes and it shows little bit out of the box thinking. Feel free to ask, like and share.<br/>Lets be in touch for next article about the functions.</p><img alt=\"\" data-lazy-src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=f8607c1093ad\" height=\"1\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"1\"/><noscript><img alt=\"\" height=\"1\" loading=\"lazy\" src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=f8607c1093ad\" width=\"1\"/></noscript><hr/><p><a href=\"https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-f8607c1093ad\" rel=\"nofollow\" target=\"_blank\">PowerQuery Puzzle solved with R</a> was originally published in <a href=\"https://medium.com/number-around-us\" rel=\"nofollow\" target=\"_blank\">Numbers around us</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-f8607c1093ad\"> Numbers around us - Medium</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
      "main_text": "PowerQuery Puzzle solved with R\nPosted on\nDecember 5, 2023\nby\nNumbers around us\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nNumbers around us - Medium\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\n# 135–136\nPuzzles:\nPQ_135:\ncontent\nfile\nPQ_136:\ncontent\nfile\nPQ_135\nLets imagine that we have binning machines in our sport centre. We can set how many balls need to be grouped in one bin/bucket/chest/whatever. We have 10 balls and machine is placing it in maximally 4 containers.\nNow basing on bin size set on machine we have to find what range of balls is in each container.\nLoad libraries and data:\nlibrary(tidyverse)\nlibrary(readxl)\n\nsequence = data.frame(elements = str_c(\"B\", 1:10))\n\ninput = read_excel(\"PQ_Challenge_135.xlsx\", range = \"A1:B6\")\ntest = read_excel(\"PQ_Challenge_135.xlsx\", range = \"L1:Q6\")\nTransform data and validation:\nslice_df_to_range = function(df, x) {\n  df_sliced = df %>%\n    mutate(section = str_c(\"Group \",((row_number()-1) %/% x)+1)) %>%\n    group_by(section) %>%\n    mutate(range = str_c(first(elements),\"-\", last(elements))) %>%\n    select(-elements) %>%\n    distinct()\n  \n  return(df_sliced)\n}\n\nresult = input %>%\n  mutate(sections = map(`Bin size`, slice_df_to_range, df = sequence)) %>%\n  unnest(cols = sections) %>%\n  pivot_wider(names_from = section, values_from = range)\n\nidentical(result, test)\n#> [1] TRUE\nPQ_136\nIn this puzzle we have groups that (as I imagine take parts in different projects — IDs). And we need to find which group has common project with another groups. But we can point relationship only on first occurence. For example if we have A and B in project of group A, even if we have them in project of group B, it can not be count. Little bit tricky, but let try.\nLoad libraries and data:\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput <- read_excel(\"PQ_Challenge_136.xlsx\", range = \"A1:B15\")\ntest <- read_excel(\"PQ_Challenge_136.xlsx\", range = \"D1:E5\")\nTransform data and validation:\ngroups <- input %>%\n  group_by(Group) %>%\n  summarise(all = list(ID), .groups = 'drop')\n\nrow_indices <- seq_len(nrow(groups)) - 1\n\nacum <- map(row_indices, ~{\n  current_ids <- groups$all[[.x + 1]]\n  subsequent_rows <- row_indices[.x + 2:length(row_indices)]\n  map(subsequent_rows, ~{\n    if (any(groups$all[[.x + 1]] %in% current_ids)) {\n      groups$Group[.x + 1]\n    } else {\n      NA_character_\n    }\n  }) %>% unlist() %>% na.omit()\n}) %>% map_chr(., ~str_c(.x, collapse = \", \")) \n\nresult <- tibble(Group = groups$Group, Common = acum) %>%\n  mutate(Common = if_else(Common == \"\", NA_character_, Common))\n\nidentical(result, test)\n#> [1] TRUE\nWe’ve seen some nice puzzles considering time changes and it shows little bit out of the box thinking. Feel free to ask, like and share.\nLets be in touch for next article about the functions.\nPowerQuery Puzzle solved with R\nwas originally published in\nNumbers around us\non Medium, where people are continuing the conversation by highlighting and responding to this story.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nNumbers around us - Medium\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "# 135–136Puzzles:PQ_135: content filePQ_136: content filePQ_135Lets imagine that we have binning machines in our sport centre. We can set how many balls need to be grouped in one bin/bucket/chest/whatever. We have 10 balls and machine is placing it in ...",
      "meta_keywords": null,
      "og_description": "# 135–136Puzzles:PQ_135: content filePQ_136: content filePQ_135Lets imagine that we have binning machines in our sport centre. We can set how many balls need to be grouped in one bin/bucket/chest/whatever. We have 10 balls and machine is placing it in ...",
      "og_image": "https://cdn-images-1.medium.com/max/1024/1*tVUTgYfQFsgKzKEnQp7ONQ.jpeg",
      "og_title": "PowerQuery Puzzle solved with R | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 2.7,
      "sitemap_lastmod": "2023-12-05T13:01:56+00:00",
      "twitter_description": "# 135–136Puzzles:PQ_135: content filePQ_136: content filePQ_135Lets imagine that we have binning machines in our sport centre. We can set how many balls need to be grouped in one bin/bucket/chest/whatever. We have 10 balls and machine is placing it in ...",
      "twitter_title": "PowerQuery Puzzle solved with R | R-bloggers",
      "url": "https://www.r-bloggers.com/2023/12/powerquery-puzzle-solved-with-r-3/",
      "word_count": 531
    }
  }
}