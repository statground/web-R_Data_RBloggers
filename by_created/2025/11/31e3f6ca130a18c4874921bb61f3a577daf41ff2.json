{
  "id": "31e3f6ca130a18c4874921bb61f3a577daf41ff2",
  "url": "https://www.r-bloggers.com/2025/07/tidyverse-with-github-copilot-for-healthcare-analytics-part-2/",
  "created_at_utc": "2025-11-22T19:58:01Z",
  "data": null,
  "raw_original": {
    "uuid": "3ae8daf8-68c0-428e-b917-eccdc38eea54",
    "created_at": "2025-11-22 19:58:01",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2025/07/tidyverse-with-github-copilot-for-healthcare-analytics-part-2/",
      "crawled_at": "2025-11-22T10:45:12.285816",
      "external_links": [
        {
          "href": "https://rworks.dev/posts/healthcare-part2/",
          "text": "R Works"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://rworks.dev/posts/healthcare-part1/",
          "text": "part"
        },
        {
          "href": "https://docs.posit.co/ide/user/ide/guide/tools/copilot.html",
          "text": "more"
        },
        {
          "href": "https://github.com/VidishaVac/healthcare-analytics/blob/main/cleanDiabetic_data.R",
          "text": "snippet"
        },
        {
          "href": "https://github.com/VidishaVac/healthcare-analytics/tree/main/dataset_diabetes",
          "text": "here"
        },
        {
          "href": "https://i1.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk11-1.png?ssl=1",
          "text": null
        },
        {
          "href": "https://i2.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk31-1.png?ssl=1",
          "text": null
        },
        {
          "href": "https://i0.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk41-1.png?ssl=1",
          "text": null
        },
        {
          "href": "https://i0.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk51-1.png?ssl=1",
          "text": null
        },
        {
          "href": "https://i1.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk61-1.png?ssl=1",
          "text": null
        },
        {
          "href": "https://pmc.ncbi.nlm.nih.gov/articles/PMC4657617/",
          "text": "research"
        },
        {
          "href": "https://rworks.dev/posts/healthcare-part2/",
          "text": "R Works"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Tidyverse with GitHub Copilot for Healthcare Analytics – Part 2 | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk11-1.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAANCAMAAADYOB3GAAAANlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABHL6OuAAAAEXRSTlMAid2ZuzKrEO9UZiJ2zURebAvdMo4AAAAJcEhZcwAADsQAAA7EAZUrDhsAAADiSURBVCgVjVJbkgQhCENtH6D2rve/7CTozLdUWSqdhIAtgghxpRDSk3m5iqcQVpteoQFa5khtl4S8uiP7ujRlR7muS0/l2Vb6JuiwgFJZE9JJ0VtHqpqVr4E2NkHdWsKtN6kqEYCGNf/e3NCm/oQPs9CaTbJXfqUvMLFk/ItF7j5MQJhk+LAoJZXtB3w3iiKTAvZynHxbCNTubss14nswIDSc5QxTItlosnG42ctNaq0qQlLP25lOIQ0X33Tux2Cn5mYh4I+PAt4YbNFumP4jFZ4ZPajt85vMcrGBQoOZHLTKB4MGBwsqDi20AAAAAElFTkSuQmCC",
          "src": "https://latex.codecogs.com/png.latex?Down"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAARBAMAAAArn0GwAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAIonvMrurEJlEZnbN3VR9UU46AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAmElEQVQIHWMQMlZhcP3mwAAGRgwM7A0QJuNPBgZOBwib6wMDAzeEycB2gIGBCcpmVmBgqGJgeL1xVQOD/AQGhikM7M9/MXQxrAfKb2Dg5DRgUGPIAbKByrgTGDIYIhgYWIDKWB8w2DF0QIzhL+C8wCDLwK4OVOZfwOPAwJKkBWQy7Fi3EUSBQRSMAaQ/ItgsQFfBwJxPQBYAWxIbp62f+TIAAAAASUVORK5CYII=",
          "src": "https://latex.codecogs.com/png.latex?Up"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAARBAMAAACP9fljAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMARIl2ZiJU75ndu6vNMhBVgMKNAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABJ0lEQVQYGXWPv0vDUBSFv5ekiW2aGl0URKhau7gEhA4VIbTg4CAZ3O0gxcFCCv4BHYpznQUpVFytujo5O2QRxaWZOgnN0s1fr5ghQnuWx7nf5dzzALFROOSfrFsv9kVEk1yYpEuxES3okHGSbCc2cy7kmQ+S7Do2mT54vCYR49jpn7uw+FxA33NQSy+wXfetE/SWXHj/uQKZ8sCCfB7JuGZ/aAR/DcQlMkXrsKl1uWcf07EHGLKBB6cIn/RN1TZcmpxNxlsMwLJhBaXPSC4deVaUGk/GF5RBrcEdWXc4kqcHqN3ViLLIfdMD+QXNIR046YCGwUfe9XNPGlHqCxRlfQ30kpcqHofivNEOl+tvB1QqkcyZIbU1A5C1DVltukza04GcatUa/AIFH0KJsul1vwAAAABJRU5ErkJggg==",
          "src": "https://latex.codecogs.com/png.latex?Steady"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAANBAMAAACugNjdAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAid0iEJm7RHbvq2YyVM2JF0xrAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAjklEQVQIHT3MoQrCUBjF8T868c7LFGyCvsOqaQ9g0KhJm1UwWm5fE+yLxtsN7gEE9whGuwZBg2eg92u/cw4f0H8QLdf8zhyg8wd2AJOgS1axDfLdFS7IJc9aST6sI8cLD3PGQnPDop1ib/RKsHDdQeyZSgYaR8hSzlpK5q0e7pJW0Ud9aQto7SuY6dnoBF+OdRw2pMlOrwAAAABJRU5ErkJggg==",
          "src": "https://latex.codecogs.com/png.latex?No"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk31-1.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk41-1.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk51-1.png?w=450&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk61-1.png?w=450&ssl=1"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/vidisha-vachharajani/",
          "text": "Vidisha Vachharajani"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-394307 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Tidyverse with GitHub Copilot for Healthcare Analytics – Part 2</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">July 22, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/vidisha-vachharajani/\">Vidisha Vachharajani</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://rworks.dev/posts/healthcare-part2/\"> R Works</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<section class=\"level2\" id=\"introduction-and-recap\">\n<h2 class=\"anchored\" data-anchor-id=\"introduction-and-recap\">1. Introduction and recap</h2>\n<p>Healthcare analytics offers significant benefits to a wide range of stakeholders, including health administrators, organizations, and most importantly, doctors, nurses, and healthcare workers.</p>\n<p>In the first <a href=\"https://rworks.dev/posts/healthcare-part1/\" rel=\"nofollow\" target=\"_blank\">part</a> of this series, we introduced a complex dataset of diabetes patient encounters, comprising 100,000+ rows and over 50 columns. This dataset includes a rich array of variables, such as admission type and primary diagnosis. We demonstrated the process of cleaning, redefining, and preparing this data for analysis, highlighting the use of GitHub Copilot to navigate a particularly challenging variable.</p>\n<p>In this second installment, we will dive deeper to evaluate the effectiveness of healthcare delivery and the impact of patient-level variables on downstream outcomes. We start by exploring medication prescriptions more closely and setting up the analytics around patient outcomes like hospital readmissions.</p>\n<p>Finally, in a supplemental post that we will publish shortly after this one, we will examine the use of Copilot a little more, especially around avoiding tricky situations arising from insufficient context or guidance provided to Copilot (see here for <a href=\"https://docs.posit.co/ide/user/ide/guide/tools/copilot.html\" rel=\"nofollow\" target=\"_blank\">more</a>).</p>\n</section>\n<section class=\"level2\" id=\"some-useful-data-summaries\">\n<h2 class=\"anchored\" data-anchor-id=\"some-useful-data-summaries\">2. Some useful data summaries</h2>\n<p>Before we explore how downstream outcomes, such as early hospital readmissions, may be influenced by specific care delivery actions, such as whether a patient’s HbA1c was measured during their stay, let’s ground ourselves in the dataset. We’ll start by summarizing key variables, which include:</p>\n<ul>\n<li><p><strong>Covariates</strong> — such as initial diagnoses and early interventions upon admission.</p></li>\n<li><p><strong>Outcomes</strong> — both intermediate care delivery results and downstream events, like early readmissions.</p></li>\n</ul>\n<p>Understanding the structure and distribution of these variables is a critical first step before modeling or drawing any conclusions.</p>\n<p>Let’s read in the data again and clean it. The code <a href=\"https://github.com/VidishaVac/healthcare-analytics/blob/main/cleanDiabetic_data.R\" rel=\"nofollow\" target=\"_blank\">snippet</a> and the data can be downloaded from <a href=\"https://github.com/VidishaVac/healthcare-analytics/tree/main/dataset_diabetes\" rel=\"nofollow\" target=\"_blank\">here</a>. We will summarize the following fields, and instead of tables, we will use some compelling visuals to rapidly get us to our insights.</p>\n<table class=\"caption-top table\">\n<caption>Table 1: Important fields to be summarized, **this will be summarized in the next section</caption>\n<colgroup>\n<col style=\"width: 33%\"/>\n<col style=\"width: 33%\"/>\n<col style=\"width: 33%\"/>\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th>Field name</th>\n<th>Field type</th>\n<th>Field description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><code>primary_diag</code></td>\n<td>initial admission covariate</td>\n<td>primary diagnosis upon admission</td>\n</tr>\n<tr class=\"even\">\n<td><code>a1c</code></td>\n<td>initial admission covariate</td>\n<td>whether a patient was given the A1c test or not</td>\n</tr>\n<tr class=\"odd\">\n<td><code>diabetesMed</code></td>\n<td>intermediate response</td>\n<td>whether a patient was given any diabetes medication</td>\n</tr>\n<tr class=\"even\">\n<td><code>acarbose:troglitazone</code></td>\n<td>intermediate response**</td>\n<td>individual 23 diabetes medications that were prescribed or not, and if prescribed, were held steady, increased or decreased</td>\n</tr>\n<tr class=\"odd\">\n<td><code>readmitted</code></td>\n<td>final response</td>\n<td>whether the patient was readmitted early (&lt;30 days)</td>\n</tr>\n</tbody>\n</table>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre># --------------------------------------------- #\n# Load necessary libraries\n# --------------------------------------------- #\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(kableExtra)\nlibrary(gridExtra)\nlibrary(grid)\nlibrary(lattice)\n\n# --------------------------------------------- #\n# Read in the data\n# --------------------------------------------- #\n\nD &lt;- read.csv(\"https://raw.githubusercontent.com/VidishaVac/healthcare-analytics/refs/heads/main/dataset_diabetes/diabetic_data.csv\", sep = \",\")\n\n# -------------------------------------------------------- #\n# Clean and re-define HbA1c and primary diag\n# -------------------------------------------------------- #\n\nD &lt;- D %&gt;%\n  mutate(\n    a1c = ifelse(A1Cresult == \"None\", \"not measured\", \"measured\"),\n    primary_diag = case_when(\n      diag_1 %in% c(390:459, 785) ~ \"Circulatory\",\n      diag_1 %in% c(460:519, 786) ~ \"Respiratory\",\n      diag_1 %in% c(520:579, 787) ~ \"Digestive\",\n      diag_1 %in% c(580:629, 788) ~ \"Genitourinary\",\n      diag_1 %in% c(630:679) ~ \"Pregnancy\",\n      diag_1 %in% c(680:709, 782) ~ \"Skin\",\n      diag_1 %in% c(710:739) ~ \"Musculoskeletal\",\n      diag_1 %in% c(740:759) ~ \"Congenital\",\n      diag_1 %in% c(800:999) ~ \"Injury\",\n      grepl(\"^250\", diag_1) ~ \"Diabetes\",\n      is.na(diag_1) ~ \"Missing\",\n      TRUE ~ \"Other\"\n    )\n  )\n\n# Remove columns not used, patients with a discharge disposition of \"expired\" or \"hospice\"\nD &lt;- D %&gt;% select(1,2,7:9,25:52) %&gt;% \n  filter(!discharge_disposition_id %in% c('11','13','14','19','20','21'))\n\n# Summarize\nsummary_a1c &lt;- D %&gt;%\n  group_by(a1c) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))\nsummary_primary_diag &lt;- D %&gt;% \n  group_by(primary_diag) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))\nsummary_readmitted &lt;- D %&gt;% \n  group_by(readmitted) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))\nsummary_change &lt;- D %&gt;% \n  group_by(change) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))\nsummary_diabetesMed &lt;- D %&gt;% \n  group_by(diabetesMed) %&gt;%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %&gt;%\n  arrange(desc(percent))\n\n# summary_primary_diag %&gt;% kable(digits = 1, format.args = list(big.mark = \",\"), caption = \"Summary of primary diagnosis\")\n# summary_a1c %&gt;% kable(digits = 1, format.args = list(big.mark = \",\"), caption = \"Summary of A1c test\")\n# summary_diabetesMed %&gt;% kable(digits = 1, format.args = list(big.mark = \",\"), caption = \"Summary of diabetes medication\")\n# summary_readmitted %&gt;% kable(digits = 1, format.args = list(big.mark = \",\"), caption = \"Summary of early readmission\")</pre>\n</details>\n</div>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre>df &lt;- summary_primary_diag\ndf &lt;- df %&gt;% mutate(\n  label = c(paste(round(df$percent[1:5]), \"%\", sep = \"\"), rep(NA, nrow(df) - 5))\n)\n\np0 &lt;- ggplot(data = df, aes(x = reorder(primary_diag, count), y = count, fill = percent)) +\n  geom_bar(stat = \"identity\", color = \"black\") +\n  coord_polar() +\n  scale_fill_gradientn(\n    \"Percent\",\n    colours = c(\"#6C5B7B\", \"#C06C84\", \"#F67280\", \"#F8B195\")\n  ) +\n  geom_text(aes(x = primary_diag, y = count / 2, label = label),\n    size = 3.5,\n    color = \"black\",\n    fontface = \"bold\"\n  ) +\n  scale_y_continuous(\n    breaks = seq(0, 40000, by = 10000),\n    limits = c(-10000, 40000),\n    expand = c(0, 0)\n  ) +\n  annotate(\"text\", x = 11.95, y = 12000, label = \"10,000\", size = 2.5, color = \"black\") +\n  annotate(\"text\", x = 11.95, y = 22000, label = \"20,000\", size = 2.5, color = \"black\") +\n  annotate(\"text\", x = 11.95, y = 32000, label = \"30,000\", size = 2.5, color = \"black\") +\n  theme(\n    # Remove axis ticks and text\n    axis.title = element_blank(),\n    axis.ticks = element_blank(),\n    axis.text.y = element_blank(),\n    # Use gray text for the region names\n    axis.text.x = element_text(color = \"gray12\", size = 10),\n    legend.position = \"none\",\n    plot.title = element_text(face = \"bold\", size = 15),\n    plot.subtitle = element_text(size = 9)\n  ) +\n  # Add labels\n  labs(\n    title = \"\\nPatient primary diagnoses\",\n    subtitle = paste(\n      \"\\nPrimary diagnoses of admitted patients vary considerably.\",\n      \"Even for diabetic encounters, the most common admitting diagnosis is\",\n      \"circulatory or heart disease. We will call this out in our analysis,\",\n      \"comparing patient outcomes for these high-risk but non-diabetic\",\n      \"admissions with diabetic admissions (which are only 9% of the\",\n      \"admitting or primary diagnoses).\",\n      sep = \"\\n\"\n    )\n  )\n\n# Modifying those with fewer categories\ndf &lt;- summary_a1c\ndf &lt;- df %&gt;% mutate(\n  label = c(paste(round(df$percent), \"%\", sep = \"\"))\n)\n\n\np1 &lt;- ggplot(data = df, aes(x = reorder(a1c, count), y = count, fill = percent)) +\n  geom_bar(stat = \"identity\", color = \"black\", width = 1) +\n  coord_polar(theta = \"x\", start = pi / 4) +\n  scale_fill_gradientn(\n    \"Percent\",\n    colours = c(\"#F67280\", \"#F8B195\")\n  ) +\n  #    scale_y_continuous(breaks = seq(0, 90000, by = 30000)) +\n  annotate(\"text\", x = 1.25, y = 22000, label = \"20,000\", size = 3.5, color = \"black\") +\n  annotate(\"text\", x = 1.25, y = 42000, label = \"40,000\", size = 3.5, color = \"black\") +\n  annotate(\"text\", x = 1.25, y = 62000, label = \"60,000\", size = 3.5, color = \"black\") +\n  annotate(\"text\", x = 1.25, y = 82000, label = \"80,000\", size = 3.5, color = \"black\") +\n  geom_text(aes(x = a1c, y = count / 2, label = label),\n    size = 3.5,\n    color = \"black\",\n    fontface = \"bold\"\n  ) +\n  theme(\n    # Remove axis ticks and text\n    axis.title = element_blank(),\n    axis.ticks = element_blank(),\n    axis.text.y = element_blank(),\n    # Use gray text for the region names\n    axis.text.x = element_text(color = \"gray12\", size = 10),\n    legend.position = \"none\",\n    plot.title = element_text(face = \"bold\", size = 15),\n    plot.subtitle = element_text(size = 9)\n  ) +\n  # Add labels\n  labs(\n    title = \"\\nHbA1c test measurement\",\n    subtitle = paste(\n      \"\\nEven though these are all diabetic encounters, for 83% of patients\",\n      \"an HbA1c value is not measured. This is a vital insight, since HbA1c\",\n      \"is a critical tool to assess patient outcomes and to calculate insulin\",\n      \"dosage (see text for source**).\",\n      sep = \"\\n\"\n    )\n  )\n\n\ndf &lt;- summary_readmitted\ndf &lt;- df %&gt;% mutate(\n  label = c(paste(round(df$percent), \"%\", sep = \"\"))\n)\n\n\np2 &lt;- ggplot(data = df, aes(x = reorder(readmitted, count), y = count, fill = percent)) +\n  geom_bar(stat = \"identity\", color = \"black\", width = 1) +\n  coord_polar(theta = \"x\") +\n  scale_fill_gradientn(\n    \"Percent\",\n    colours = c(\"#F67280\", \"#F8B195\")\n  ) +\n  geom_text(aes(x = readmitted, y = count / 2, label = label),\n    size = 3.5,\n    color = \"black\",\n    fontface = \"bold\"\n  ) +\n  scale_y_continuous(breaks = seq(0, 50000, by = 10000)) +\n  annotate(\"text\",\n    x = 1, y = 18000, label = \"20,000\", size = 3.5, color = \"black\",\n    angle = -60\n  ) +\n  annotate(\"text\",\n    x = 1, y = 28000, label = \"30,000\", size = 3.5, color = \"black\",\n    angle = -60\n  ) +\n  annotate(\"text\",\n    x = 1, y = 38000, label = \"40,000\", size = 3.5, color = \"black\",\n    angle = -60\n  ) +\n  annotate(\"text\",\n    x = 1, y = 48000, label = \"50,000\", size = 3.5, color = \"black\",\n    angle = -60\n  ) +\n  theme(\n    # Remove axis ticks and text\n    axis.title = element_blank(),\n    axis.ticks = element_blank(),\n    axis.text.y = element_blank(),\n    # Use gray text for the region names\n    axis.text.x = element_text(color = \"gray12\", size = 13),\n    legend.position = \"none\",\n    plot.title = element_text(face = \"bold\", size = 15),\n    plot.subtitle = element_text(size = 9)\n  ) +\n  # Add labels\n  labs(\n    title = \"\\nReadmissions\",\n    subtitle = paste(\n      \"\\nReadmission after discharge is an important downstream patient\",\n      \"outcome, due to the cost burden it levies on the healthcare system.\",\n      \"Almost 50% of patients are readmitted, and 11% are readmitted early-\",\n      \"&lt;30 days after being discharged. We will use this (early readmit)\",\n      \"as our primary outcome in the final analysis.\",\n      sep = \"\\n\"\n    )\n  )\n\n\ndf &lt;- summary_diabetesMed\ndf &lt;- df %&gt;% mutate(\n  label = c(paste(round(df$percent), \"%\", sep = \"\"))\n)\n\n\np3 &lt;- ggplot(data = df, aes(x = reorder(diabetesMed, count), y = count, fill = percent)) +\n  geom_bar(stat = \"identity\", color = \"black\", width = 1) +\n  coord_polar(theta = \"x\", start = pi / 4) +\n  scale_fill_gradientn(\n    \"Percent\",\n    colours = c(\"#F67280\", \"#F8B195\")\n  ) +\n  annotate(\"text\", x = 1.25, y = 26000, label = \"25,000\", size = 3.5, color = \"black\") +\n  annotate(\"text\", x = 1.25, y = 41000, label = \"40,000\", size = 3.5, color = \"black\") +\n  annotate(\"text\", x = 1.25, y = 61000, label = \"60,000\", size = 3.5, color = \"black\") +\n  annotate(\"text\", x = 1.25, y = 81000, label = \"80,000\", size = 3.5, color = \"black\") +\n  geom_text(aes(x = diabetesMed, y = count / 2, label = label),\n    size = 3.5,\n    color = \"black\",\n    fontface = \"bold\"\n  ) +\n  theme(\n    # Remove axis ticks and text\n    axis.title = element_blank(),\n    axis.ticks = element_blank(),\n    axis.text.y = element_blank(),\n    # Use gray text for the region names\n    axis.text.x = element_text(color = \"gray12\", size = 10),\n    legend.position = \"none\",\n    plot.title = element_text(face = \"bold\", size = 15),\n    plot.subtitle = element_text(size = 9)\n  ) +\n  # Add labels\n  labs(\n    title = \"\\nDiabetes medications\",\n    subtitle = paste(\n      \"\\nThough these are all diabetic encounters, we see that 23% of patients\",\n      \"are never given diabetes medications. In our analysis, we will also\",\n      \"dive deeper into what this means, and how downstream outcomes of these\",\n      \"patients are impacted by this intermediate care delivery variable.\",\n      sep = \"\\n\"\n    )\n  )\n\n\ngrid.arrange(p0, p1, p3, p2, nrow = 2, ncol = 2)</pre>\n</details>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-1\" href=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk11-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk11-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk11-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n<div class=\"callout callout-style-default callout-note callout-titled\" title=\"Plot notes\">\n<div class=\"callout-header d-flex align-content-center\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nPlot notes\n</div>\n</div>\n<div class=\"callout-body-container callout-body\">\n<p><strong><em>The cognitive dilemma of the pie chart</em></strong></p>\n<p><em>For as long as we have had data and charts, there has been a debate about whether pie charts are helpful. While the visuals above could easily have been rendered as <strong>pie charts</strong>, I opted instead for a <strong>circular bar plot</strong>. Even though we’re still showing proportions, I find circular bars more intuitive when trying to understand actual contribution, both absolute and relative. For instance, only 17% of the 100,000 patients in our sample received an HbA1c measurement — fewer than 20,000 individuals. In the circular bar chart, this is immediately clear: not only is the arc labeled just under 20,000, but the smaller sweep of the 17% segment stands in stark visual contrast to the much larger group that did not receive the test. A standard pie chart, by comparison, flattens this distinction — visually and cognitively — making it harder to grasp the disparity at a glance.</em></p>\n<p><em>See our supplemental post to understand the plotting mechanics in detail.</em></p>\n<p><strong><em>[Copilot was not used for these charts]</em></strong></p>\n</div>\n</div>\n</section>\n<section class=\"level2\" id=\"a-closer-look-at-all-diabetes-medications\">\n<h2 class=\"anchored\" data-anchor-id=\"a-closer-look-at-all-diabetes-medications\">3. A closer look at all diabetes medications</h2>\n<p>Let’s now take a closer look at the 23 medication prescriptions, each defined by whether a particular medication was prescribed to the patient, including well-known drugs like insulin and metformin.</p>\n<p>Each of these 23 fields is originally categorized into four groups or levels – <img data-lazy-src=\"https://latex.codecogs.com/png.latex?Down\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?Down\"/></noscript>, <img data-lazy-src=\"https://latex.codecogs.com/png.latex?Up\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?Up\"/></noscript>, <img data-lazy-src=\"https://latex.codecogs.com/png.latex?Steady\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?Steady\"/></noscript>, <img data-lazy-src=\"https://latex.codecogs.com/png.latex?No\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?No\"/></noscript>. We will visualize this data to assess variations across medications, first to explore how they’re being prescribed, evaluating the use of Copilot in the plots we use, and then in relation to our two key covariates.</p>\n<p>To facilitate this, we will first reshape the data using <code>gather()</code>, allowing us to analyze all 23 medications simultaneously. We will then create a series of visualizations using <code>dplyr</code> and <code>ggplot2</code>, with assistance from Copilot for fine-tuning our visuals.</p>\n<section class=\"level3\" id=\"how-are-these-medications-being-prescribed\">\n<h3 class=\"anchored\" data-anchor-id=\"how-are-these-medications-being-prescribed\">3.1. How are these medications being prescribed?</h3>\n<p>To visualize and understand how these are prescribed, after reshaping the data, we use <code>geom_tile()</code> to plot all 23 medications and their four levels each, leveraging the structure of the reshaped data. See our supplemental AI tools post to learn more about how this plot was designed.</p>\n<div class=\"columns\">\n<div class=\"column\" style=\"width:65%;\">\n<div class=\"cell\">\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-2\" href=\"https://i2.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk31-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk31-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk31-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n</div><div class=\"column\" style=\"width:35%;\">\n<div class=\"callout callout-style-default callout-note callout-titled\" title=\"Quick Insight\">\n<div class=\"callout-header d-flex align-content-center\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nQuick Insight\n</div>\n</div>\n<div class=\"callout-body-container callout-body\">\n<p><em>We see that most medications are rarely prescribed; in fact, the medications commonly known for diabetes are the ones most given – insulin and metformin. For the purpose of the next section, we will focus on the medications that are prescribed to at least 5% of patients.</em></p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre># Reshaping wide to get a better view of medications\nmeds &lt;- D %&gt;%\n  select(metformin:metformin.pioglitazone) %&gt;%\n  gather(key = \"medication\", value = \"value\") %&gt;%\n  group_by(medication, value) %&gt;% summarise(n=n()) %&gt;% mutate(pct = (n / sum(n))*100)\n\np1 &lt;- ggplot(data=meds, aes(x=value, y=medication, fill=pct)) + geom_tile() + \n  labs(title = \"Diabetes medication heatmap\",\n       x = \"Medication value\",\n       y = \"Medication name\", fill=\"Percent prescribed\") + theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5)) + \n  scale_fill_gradientn(colors = palette.colors(9), \n                       limits = c(0, 100)) +\n  geom_text(aes(label = paste(round(pct, 1), \"%\", sep=\"\")), color = \"white\", size = 3) \n\np1</pre>\n</details>\n</div>\n<div class=\"columns\">\n<div class=\"column\" style=\"width:65%;\">\n<div class=\"cell\">\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-3\" href=\"https://i0.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk41-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk41-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk41-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n</div><div class=\"column\" style=\"width:35%;\">\n<div class=\"callout callout-style-default callout-note callout-titled\" title=\"Quick insight\">\n<div class=\"callout-header d-flex align-content-center\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nQuick insight\n</div>\n</div>\n<div class=\"callout-body-container callout-body\">\n<p><span style=\"font-size: 0.95em;\"><em>Insulin is prescribed for almost 1.5x as many encounters as any of the other medications. Being a key part of diabetes therapy, this is not surprising; however, the use and dosage of insulin itself are impacted by factors that we will look at in the next section.</em></span></p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre># Medications prescribed to at least 5% of patients\nmeds_5pct &lt;- meds %&gt;%\n  subset(value == \"No\" &amp; 100 - pct &gt;= 5) %&gt;%\n  mutate(pct_prsc = 100 - pct) %&gt;%\n  select(medication, pct_prsc)\n\nggplot(data = meds_5pct, aes(x = reorder(medication, pct_prsc), y = pct_prsc)) +\n  geom_bar(stat = \"identity\", color = \"black\", fill = \"#56B4E9\") +\n  labs(\n    title = \"Medications prescribed to at least 5% of patients\",\n    x = \"Medication name\",\n    y = \"Percent prescribed\"\n  ) +\n  geom_text(aes(label = paste0(round(pct_prsc, 2), \"%\")),\n    position = position_dodge(width = 1), vjust = -0.5, hjust = 1, size = 3.5\n  ) +\n  coord_flip()</pre>\n</details>\n</div>\n<p>It is worth noting here that it was upon switching to a heatmap style plot using <code>geom_tile()</code>, the more nuanced variations in medications become more evident. This is exactly the value of this tile plot - since in the next section, we will see its ability to handle a complex data structure (23 medications and their 4-fold values), triangulated over A1c test decisions and primary diagnoses, take in our inputs (both the aesthetic specifications as well as the suitable color palettes we provided), and excavate rapid insights into these kind of care delivery patterns.</p>\n</section>\n<section class=\"level3\" id=\"medication-usage-by-2-key-covariates\">\n<h3 class=\"anchored\" data-anchor-id=\"medication-usage-by-2-key-covariates\">3.2. Medication usage by 2 key covariates</h3>\n<p>Now, let’s use the above plot style to triangulate and add more nuance to our investigation – that is, examine the impact made by the admitting primary diagnosis of the patient and whether their HbA1c was measured, on the diabetes medications given to the patient.</p>\n<section class=\"level4\" id=\"primary-diagnoses\">\n<h4 class=\"anchored\" data-anchor-id=\"primary-diagnoses\">3.2.1. Primary diagnoses</h4>\n<div class=\"columns\">\n<div class=\"column\" style=\"width:65%;\">\n<div class=\"cell\">\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-4\" href=\"https://i0.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk51-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk51-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk51-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n</div><div class=\"column\" style=\"width:35%;\">\n<div class=\"callout callout-style-default callout-note callout-titled\" title=\"Quick Insight\">\n<div class=\"callout-header d-flex align-content-center\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nQuick Insight\n</div>\n</div>\n<div class=\"callout-body-container callout-body\">\n<p><em>While 75% of patients admitted with a diabetes diagnosis are given insulin, this crucial medication is only given to 51% of high-risk circulatory disease patients and 55% of respiratory illness patients. Of those non-diabetic patients who receive insulin, only ~20% receive a change in their dosage, while 40% of diabetic patients get their insulin dosage changed.</em></p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre># i) primary diagnosis\n\n# Re-define diagnoses to focus on a few key ones\nD &lt;- D %&gt;% mutate(primary_diag = ifelse(primary_diag %in% c(\"Digestive\", \"Genitourinary\", \"Pregnancy\", \"Skin\", \"Musculoskeletal\", \"Congenital\", \"Injury\", \"Other\"), \"Other\", primary_diag))\n\n# Reshape data again\nmeds_diag &lt;- D %&gt;%\n  select(meds_5pct$medication, primary_diag) %&gt;%\n  gather(key = \"medication\", value = \"value\", -primary_diag) %&gt;%\n  group_by(primary_diag, medication, value) %&gt;%\n  summarise(n = n()) %&gt;%\n  mutate(pct = (n / sum(n)) * 100)\n\n# Plot using color parameters that are robust under color vision deficiencies\nggplot(meds_diag, aes(x = value, y = medication, fill = pct)) +\n  geom_tile() +\n  facet_wrap(~primary_diag, nrow = 2, ncol = 2) +\n  scale_fill_gradientn(\n    colors = palette.colors(9),\n    limits = c(0, 100)\n  ) +\n  labs(\n    title = \"Medication by primary diagnosis &amp; tuned colors\",\n    x = \"Medication value\",\n    y = \"Medication name\", fill = \"Percent prescribed\"\n  ) +\n  theme_minimal() +\n  geom_text(aes(label = paste(round(pct, 1), \"%\", sep = \"\")), color = \"white\", size = 3) +\n  theme(plot.title = element_text(hjust = 0.5), legend.position = \"none\")</pre>\n</details>\n</div>\n</section>\n<section class=\"level4\" id=\"a1c-test\">\n<h4 class=\"anchored\" data-anchor-id=\"a1c-test\">3.2.2. A1c test</h4>\n<div class=\"columns\">\n<div class=\"column\" style=\"width:65%;\">\n<div class=\"cell\">\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><a class=\"lightbox\" data-gallery=\"quarto-lightbox-gallery-5\" href=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk61-1.png?ssl=1\" rel=\"nofollow\" target=\"_blank\"><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk61-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk61-1.png?w=450&amp;ssl=1\"/></noscript></a></p>\n</figure>\n</div>\n</div>\n</div>\n</div><div class=\"column\" style=\"width:35%;\">\n<div class=\"callout callout-style-default callout-note callout-titled\" title=\"Quick Insight\">\n<div class=\"callout-header d-flex align-content-center\">\n<div class=\"callout-icon-container\">\n<i class=\"callout-icon\"></i>\n</div>\n<div class=\"callout-title-container flex-fill\">\nQuick Insight\n</div>\n</div>\n<div class=\"callout-body-container callout-body\">\n<p><em>While 64% of patients whose HbA1c is measured are given insulin, only 52% of those who did not get an HbA1c measurement get this crucial medication. Though this disparity is much less for other medications, the tendency to adjust dosage is higher for patients with an HbA1c measurement. Note that <a href=\"https://pmc.ncbi.nlm.nih.gov/articles/PMC4657617/\" rel=\"nofollow\" target=\"_blank\">research</a>** has shown that the HbA1c is important in “tailoring appropriate diabetes therapy regimens”, so this finding of a differential dosage adjustment based on HbA1c measurement is extremely important.</em></p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"cell\">\n<details class=\"code-fold\">\n<summary>Show the code</summary>\n<pre># ii) A1c\n\n# Re-shape data\nmeds_a1c &lt;- D %&gt;%\n  select(meds_5pct$medication, a1c) %&gt;%\n  gather(key = \"medication\", value = \"value\", -a1c) %&gt;%\n  group_by(a1c, medication, value) %&gt;% summarise(n=n()) %&gt;% mutate(pct = (n / sum(n))*100)\n\n# Visualize with fine-tuned color parameters \nggplot(meds_a1c, aes(x = value, y = medication, fill = pct)) +\n  geom_tile() +\n  facet_grid(~ a1c) +\n  scale_fill_gradientn(colors = palette.colors(9), \n                       limits = c(0, 100)) +\n  labs(title = \"Medication by the A1c test &amp; tuned colors\",\n       x = \"Medication value\",\n       y = \"Medication name\", fill=\"Percent prescribed\") +\n  theme_minimal() +\n  geom_text(aes(label = paste(round(pct, 1), \"%\", sep=\"\")), color = \"white\", size = 4) +\n  theme(plot.title = element_text(hjust = 0.5))</pre>\n</details>\n</div>\n</section>\n</section>\n</section>\n<section class=\"level2\" id=\"conclusion-and-whats-next\">\n<h2 class=\"anchored\" data-anchor-id=\"conclusion-and-whats-next\">4. Conclusion and what’s next</h2>\n<p>These findings highlight meaningful variation in both insulin administration and dosage adjustment across patient groups. While insulin is routinely given to diabetic patients, it is prescribed far less frequently for those with high-risk circulatory or respiratory conditions — and even less likely to be adjusted when given. Notably, patients who receive an HbA1c measurement are not only more likely to be prescribed insulin, but also more likely to have their dosage adjusted — a pattern aligned with clinical guidance emphasizing the role of HbA1c in tailoring diabetes treatment.</p>\n<p>Taken together, these patterns suggest that diagnostic practices and comorbid conditions meaningfully shape treatment decisions. With these foundational relationships established, we are now ready to explore how factors like HbA1c measurement and primary diagnosis influence downstream outcomes such as early readmission — a metric of both clinical quality and financial strain. Reducing preventable readmissions not only helps relieve the cost burden on the healthcare system but also improves the patient experience — making this a priority for administrators, caregivers, and, most importantly, the patients themselves. Leveraging AI-assisted pattern discovery, we can now surface deeper insights into how inpatient care decisions translate into longer-term outcomes, guiding more equitable and effective interventions across the board.</p>\n<blockquote class=\"blockquote\">\n<p><em>In the meantime, be sure to check out the supplemental post we will publish shortly after this one on how we used Copilot in this post, including guidance on effective prompt writing for Copilot, and additional visualizations of the complex data we’re exploring!</em></p>\n</blockquote>\n</section>\n<section class=\"level2\" id=\"about-the-author\">\n<h2 class=\"anchored\" data-anchor-id=\"about-the-author\">About the Author</h2>\n<p><em>Vidisha writes: “I am a statistician and data science professional. For practitioners like me, ‘tidyverse’ is a household word. I’ve used it for complex data wrangling, visualization, and advanced analytics work, especially where I needed clarity on how to leverage my data so that it allows for story-telling that informs business decisions, recasting my work into actionable insights. I recently began exploring GPT-4o mini and GitHub Copilot to help me speed up my workflows, especially within Healthcare Analytics. I am excited to share this post series to help readers understand the role of RStudio and AI in Healthcare Analytics!”</em></p>\n</section>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://rworks.dev/posts/healthcare-part2/\"> R Works</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
      "main_text": "Tidyverse with GitHub Copilot for Healthcare Analytics – Part 2\nPosted on\nJuly 22, 2025\nby\nVidisha Vachharajani\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nR Works\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\n1. Introduction and recap\nHealthcare analytics offers significant benefits to a wide range of stakeholders, including health administrators, organizations, and most importantly, doctors, nurses, and healthcare workers.\nIn the first\npart\nof this series, we introduced a complex dataset of diabetes patient encounters, comprising 100,000+ rows and over 50 columns. This dataset includes a rich array of variables, such as admission type and primary diagnosis. We demonstrated the process of cleaning, redefining, and preparing this data for analysis, highlighting the use of GitHub Copilot to navigate a particularly challenging variable.\nIn this second installment, we will dive deeper to evaluate the effectiveness of healthcare delivery and the impact of patient-level variables on downstream outcomes. We start by exploring medication prescriptions more closely and setting up the analytics around patient outcomes like hospital readmissions.\nFinally, in a supplemental post that we will publish shortly after this one, we will examine the use of Copilot a little more, especially around avoiding tricky situations arising from insufficient context or guidance provided to Copilot (see here for\nmore\n).\n2. Some useful data summaries\nBefore we explore how downstream outcomes, such as early hospital readmissions, may be influenced by specific care delivery actions, such as whether a patient’s HbA1c was measured during their stay, let’s ground ourselves in the dataset. We’ll start by summarizing key variables, which include:\nCovariates\n— such as initial diagnoses and early interventions upon admission.\nOutcomes\n— both intermediate care delivery results and downstream events, like early readmissions.\nUnderstanding the structure and distribution of these variables is a critical first step before modeling or drawing any conclusions.\nLet’s read in the data again and clean it. The code\nsnippet\nand the data can be downloaded from\nhere\n. We will summarize the following fields, and instead of tables, we will use some compelling visuals to rapidly get us to our insights.\nTable 1: Important fields to be summarized, **this will be summarized in the next section\nField name\nField type\nField description\nprimary_diag\ninitial admission covariate\nprimary diagnosis upon admission\na1c\ninitial admission covariate\nwhether a patient was given the A1c test or not\ndiabetesMed\nintermediate response\nwhether a patient was given any diabetes medication\nacarbose:troglitazone\nintermediate response**\nindividual 23 diabetes medications that were prescribed or not, and if prescribed, were held steady, increased or decreased\nreadmitted\nfinal response\nwhether the patient was readmitted early (<30 days)\nShow the code\n# --------------------------------------------- #\n# Load necessary libraries\n# --------------------------------------------- #\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(kableExtra)\nlibrary(gridExtra)\nlibrary(grid)\nlibrary(lattice)\n\n# --------------------------------------------- #\n# Read in the data\n# --------------------------------------------- #\n\nD <- read.csv(\"https://raw.githubusercontent.com/VidishaVac/healthcare-analytics/refs/heads/main/dataset_diabetes/diabetic_data.csv\", sep = \",\")\n\n# -------------------------------------------------------- #\n# Clean and re-define HbA1c and primary diag\n# -------------------------------------------------------- #\n\nD <- D %>%\n  mutate(\n    a1c = ifelse(A1Cresult == \"None\", \"not measured\", \"measured\"),\n    primary_diag = case_when(\n      diag_1 %in% c(390:459, 785) ~ \"Circulatory\",\n      diag_1 %in% c(460:519, 786) ~ \"Respiratory\",\n      diag_1 %in% c(520:579, 787) ~ \"Digestive\",\n      diag_1 %in% c(580:629, 788) ~ \"Genitourinary\",\n      diag_1 %in% c(630:679) ~ \"Pregnancy\",\n      diag_1 %in% c(680:709, 782) ~ \"Skin\",\n      diag_1 %in% c(710:739) ~ \"Musculoskeletal\",\n      diag_1 %in% c(740:759) ~ \"Congenital\",\n      diag_1 %in% c(800:999) ~ \"Injury\",\n      grepl(\"^250\", diag_1) ~ \"Diabetes\",\n      is.na(diag_1) ~ \"Missing\",\n      TRUE ~ \"Other\"\n    )\n  )\n\n# Remove columns not used, patients with a discharge disposition of \"expired\" or \"hospice\"\nD <- D %>% select(1,2,7:9,25:52) %>% \n  filter(!discharge_disposition_id %in% c('11','13','14','19','20','21'))\n\n# Summarize\nsummary_a1c <- D %>%\n  group_by(a1c) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\nsummary_primary_diag <- D %>% \n  group_by(primary_diag) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\nsummary_readmitted <- D %>% \n  group_by(readmitted) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\nsummary_change <- D %>% \n  group_by(change) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\nsummary_diabetesMed <- D %>% \n  group_by(diabetesMed) %>%\n  summarise(count = n(), percent = n() / nrow(D) * 100) %>%\n  arrange(desc(percent))\n\n# summary_primary_diag %>% kable(digits = 1, format.args = list(big.mark = \",\"), caption = \"Summary of primary diagnosis\")\n# summary_a1c %>% kable(digits = 1, format.args = list(big.mark = \",\"), caption = \"Summary of A1c test\")\n# summary_diabetesMed %>% kable(digits = 1, format.args = list(big.mark = \",\"), caption = \"Summary of diabetes medication\")\n# summary_readmitted %>% kable(digits = 1, format.args = list(big.mark = \",\"), caption = \"Summary of early readmission\")\nShow the code\ndf <- summary_primary_diag\ndf <- df %>% mutate(\n  label = c(paste(round(df$percent[1:5]), \"%\", sep = \"\"), rep(NA, nrow(df) - 5))\n)\n\np0 <- ggplot(data = df, aes(x = reorder(primary_diag, count), y = count, fill = percent)) +\n  geom_bar(stat = \"identity\", color = \"black\") +\n  coord_polar() +\n  scale_fill_gradientn(\n    \"Percent\",\n    colours = c(\"#6C5B7B\", \"#C06C84\", \"#F67280\", \"#F8B195\")\n  ) +\n  geom_text(aes(x = primary_diag, y = count / 2, label = label),\n    size = 3.5,\n    color = \"black\",\n    fontface = \"bold\"\n  ) +\n  scale_y_continuous(\n    breaks = seq(0, 40000, by = 10000),\n    limits = c(-10000, 40000),\n    expand = c(0, 0)\n  ) +\n  annotate(\"text\", x = 11.95, y = 12000, label = \"10,000\", size = 2.5, color = \"black\") +\n  annotate(\"text\", x = 11.95, y = 22000, label = \"20,000\", size = 2.5, color = \"black\") +\n  annotate(\"text\", x = 11.95, y = 32000, label = \"30,000\", size = 2.5, color = \"black\") +\n  theme(\n    # Remove axis ticks and text\n    axis.title = element_blank(),\n    axis.ticks = element_blank(),\n    axis.text.y = element_blank(),\n    # Use gray text for the region names\n    axis.text.x = element_text(color = \"gray12\", size = 10),\n    legend.position = \"none\",\n    plot.title = element_text(face = \"bold\", size = 15),\n    plot.subtitle = element_text(size = 9)\n  ) +\n  # Add labels\n  labs(\n    title = \"\\nPatient primary diagnoses\",\n    subtitle = paste(\n      \"\\nPrimary diagnoses of admitted patients vary considerably.\",\n      \"Even for diabetic encounters, the most common admitting diagnosis is\",\n      \"circulatory or heart disease. We will call this out in our analysis,\",\n      \"comparing patient outcomes for these high-risk but non-diabetic\",\n      \"admissions with diabetic admissions (which are only 9% of the\",\n      \"admitting or primary diagnoses).\",\n      sep = \"\\n\"\n    )\n  )\n\n# Modifying those with fewer categories\ndf <- summary_a1c\ndf <- df %>% mutate(\n  label = c(paste(round(df$percent), \"%\", sep = \"\"))\n)\n\np1 <- ggplot(data = df, aes(x = reorder(a1c, count), y = count, fill = percent)) +\n  geom_bar(stat = \"identity\", color = \"black\", width = 1) +\n  coord_polar(theta = \"x\", start = pi / 4) +\n  scale_fill_gradientn(\n    \"Percent\",\n    colours = c(\"#F67280\", \"#F8B195\")\n  ) +\n  #    scale_y_continuous(breaks = seq(0, 90000, by = 30000)) +\n  annotate(\"text\", x = 1.25, y = 22000, label = \"20,000\", size = 3.5, color = \"black\") +\n  annotate(\"text\", x = 1.25, y = 42000, label = \"40,000\", size = 3.5, color = \"black\") +\n  annotate(\"text\", x = 1.25, y = 62000, label = \"60,000\", size = 3.5, color = \"black\") +\n  annotate(\"text\", x = 1.25, y = 82000, label = \"80,000\", size = 3.5, color = \"black\") +\n  geom_text(aes(x = a1c, y = count / 2, label = label),\n    size = 3.5,\n    color = \"black\",\n    fontface = \"bold\"\n  ) +\n  theme(\n    # Remove axis ticks and text\n    axis.title = element_blank(),\n    axis.ticks = element_blank(),\n    axis.text.y = element_blank(),\n    # Use gray text for the region names\n    axis.text.x = element_text(color = \"gray12\", size = 10),\n    legend.position = \"none\",\n    plot.title = element_text(face = \"bold\", size = 15),\n    plot.subtitle = element_text(size = 9)\n  ) +\n  # Add labels\n  labs(\n    title = \"\\nHbA1c test measurement\",\n    subtitle = paste(\n      \"\\nEven though these are all diabetic encounters, for 83% of patients\",\n      \"an HbA1c value is not measured. This is a vital insight, since HbA1c\",\n      \"is a critical tool to assess patient outcomes and to calculate insulin\",\n      \"dosage (see text for source**).\",\n      sep = \"\\n\"\n    )\n  )\n\ndf <- summary_readmitted\ndf <- df %>% mutate(\n  label = c(paste(round(df$percent), \"%\", sep = \"\"))\n)\n\np2 <- ggplot(data = df, aes(x = reorder(readmitted, count), y = count, fill = percent)) +\n  geom_bar(stat = \"identity\", color = \"black\", width = 1) +\n  coord_polar(theta = \"x\") +\n  scale_fill_gradientn(\n    \"Percent\",\n    colours = c(\"#F67280\", \"#F8B195\")\n  ) +\n  geom_text(aes(x = readmitted, y = count / 2, label = label),\n    size = 3.5,\n    color = \"black\",\n    fontface = \"bold\"\n  ) +\n  scale_y_continuous(breaks = seq(0, 50000, by = 10000)) +\n  annotate(\"text\",\n    x = 1, y = 18000, label = \"20,000\", size = 3.5, color = \"black\",\n    angle = -60\n  ) +\n  annotate(\"text\",\n    x = 1, y = 28000, label = \"30,000\", size = 3.5, color = \"black\",\n    angle = -60\n  ) +\n  annotate(\"text\",\n    x = 1, y = 38000, label = \"40,000\", size = 3.5, color = \"black\",\n    angle = -60\n  ) +\n  annotate(\"text\",\n    x = 1, y = 48000, label = \"50,000\", size = 3.5, color = \"black\",\n    angle = -60\n  ) +\n  theme(\n    # Remove axis ticks and text\n    axis.title = element_blank(),\n    axis.ticks = element_blank(),\n    axis.text.y = element_blank(),\n    # Use gray text for the region names\n    axis.text.x = element_text(color = \"gray12\", size = 13),\n    legend.position = \"none\",\n    plot.title = element_text(face = \"bold\", size = 15),\n    plot.subtitle = element_text(size = 9)\n  ) +\n  # Add labels\n  labs(\n    title = \"\\nReadmissions\",\n    subtitle = paste(\n      \"\\nReadmission after discharge is an important downstream patient\",\n      \"outcome, due to the cost burden it levies on the healthcare system.\",\n      \"Almost 50% of patients are readmitted, and 11% are readmitted early-\",\n      \"<30 days after being discharged. We will use this (early readmit)\",\n      \"as our primary outcome in the final analysis.\",\n      sep = \"\\n\"\n    )\n  )\n\ndf <- summary_diabetesMed\ndf <- df %>% mutate(\n  label = c(paste(round(df$percent), \"%\", sep = \"\"))\n)\n\np3 <- ggplot(data = df, aes(x = reorder(diabetesMed, count), y = count, fill = percent)) +\n  geom_bar(stat = \"identity\", color = \"black\", width = 1) +\n  coord_polar(theta = \"x\", start = pi / 4) +\n  scale_fill_gradientn(\n    \"Percent\",\n    colours = c(\"#F67280\", \"#F8B195\")\n  ) +\n  annotate(\"text\", x = 1.25, y = 26000, label = \"25,000\", size = 3.5, color = \"black\") +\n  annotate(\"text\", x = 1.25, y = 41000, label = \"40,000\", size = 3.5, color = \"black\") +\n  annotate(\"text\", x = 1.25, y = 61000, label = \"60,000\", size = 3.5, color = \"black\") +\n  annotate(\"text\", x = 1.25, y = 81000, label = \"80,000\", size = 3.5, color = \"black\") +\n  geom_text(aes(x = diabetesMed, y = count / 2, label = label),\n    size = 3.5,\n    color = \"black\",\n    fontface = \"bold\"\n  ) +\n  theme(\n    # Remove axis ticks and text\n    axis.title = element_blank(),\n    axis.ticks = element_blank(),\n    axis.text.y = element_blank(),\n    # Use gray text for the region names\n    axis.text.x = element_text(color = \"gray12\", size = 10),\n    legend.position = \"none\",\n    plot.title = element_text(face = \"bold\", size = 15),\n    plot.subtitle = element_text(size = 9)\n  ) +\n  # Add labels\n  labs(\n    title = \"\\nDiabetes medications\",\n    subtitle = paste(\n      \"\\nThough these are all diabetic encounters, we see that 23% of patients\",\n      \"are never given diabetes medications. In our analysis, we will also\",\n      \"dive deeper into what this means, and how downstream outcomes of these\",\n      \"patients are impacted by this intermediate care delivery variable.\",\n      sep = \"\\n\"\n    )\n  )\n\ngrid.arrange(p0, p1, p3, p2, nrow = 2, ncol = 2)\nPlot notes\nThe cognitive dilemma of the pie chart\nFor as long as we have had data and charts, there has been a debate about whether pie charts are helpful. While the visuals above could easily have been rendered as\npie charts\n, I opted instead for a\ncircular bar plot\n. Even though we’re still showing proportions, I find circular bars more intuitive when trying to understand actual contribution, both absolute and relative. For instance, only 17% of the 100,000 patients in our sample received an HbA1c measurement — fewer than 20,000 individuals. In the circular bar chart, this is immediately clear: not only is the arc labeled just under 20,000, but the smaller sweep of the 17% segment stands in stark visual contrast to the much larger group that did not receive the test. A standard pie chart, by comparison, flattens this distinction — visually and cognitively — making it harder to grasp the disparity at a glance.\nSee our supplemental post to understand the plotting mechanics in detail.\n[Copilot was not used for these charts]\n3. A closer look at all diabetes medications\nLet’s now take a closer look at the 23 medication prescriptions, each defined by whether a particular medication was prescribed to the patient, including well-known drugs like insulin and metformin.\nEach of these 23 fields is originally categorized into four groups or levels –\n,\n,\n,\n. We will visualize this data to assess variations across medications, first to explore how they’re being prescribed, evaluating the use of Copilot in the plots we use, and then in relation to our two key covariates.\nTo facilitate this, we will first reshape the data using\ngather()\n, allowing us to analyze all 23 medications simultaneously. We will then create a series of visualizations using\ndplyr\nand\nggplot2\n, with assistance from Copilot for fine-tuning our visuals.\n3.1. How are these medications being prescribed?\nTo visualize and understand how these are prescribed, after reshaping the data, we use\ngeom_tile()\nto plot all 23 medications and their four levels each, leveraging the structure of the reshaped data. See our supplemental AI tools post to learn more about how this plot was designed.\nQuick Insight\nWe see that most medications are rarely prescribed; in fact, the medications commonly known for diabetes are the ones most given – insulin and metformin. For the purpose of the next section, we will focus on the medications that are prescribed to at least 5% of patients.\nShow the code\n# Reshaping wide to get a better view of medications\nmeds <- D %>%\n  select(metformin:metformin.pioglitazone) %>%\n  gather(key = \"medication\", value = \"value\") %>%\n  group_by(medication, value) %>% summarise(n=n()) %>% mutate(pct = (n / sum(n))*100)\n\np1 <- ggplot(data=meds, aes(x=value, y=medication, fill=pct)) + geom_tile() + \n  labs(title = \"Diabetes medication heatmap\",\n       x = \"Medication value\",\n       y = \"Medication name\", fill=\"Percent prescribed\") + theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5)) + \n  scale_fill_gradientn(colors = palette.colors(9), \n                       limits = c(0, 100)) +\n  geom_text(aes(label = paste(round(pct, 1), \"%\", sep=\"\")), color = \"white\", size = 3) \n\np1\nQuick insight\nInsulin is prescribed for almost 1.5x as many encounters as any of the other medications. Being a key part of diabetes therapy, this is not surprising; however, the use and dosage of insulin itself are impacted by factors that we will look at in the next section.\nShow the code\n# Medications prescribed to at least 5% of patients\nmeds_5pct <- meds %>%\n  subset(value == \"No\" & 100 - pct >= 5) %>%\n  mutate(pct_prsc = 100 - pct) %>%\n  select(medication, pct_prsc)\n\nggplot(data = meds_5pct, aes(x = reorder(medication, pct_prsc), y = pct_prsc)) +\n  geom_bar(stat = \"identity\", color = \"black\", fill = \"#56B4E9\") +\n  labs(\n    title = \"Medications prescribed to at least 5% of patients\",\n    x = \"Medication name\",\n    y = \"Percent prescribed\"\n  ) +\n  geom_text(aes(label = paste0(round(pct_prsc, 2), \"%\")),\n    position = position_dodge(width = 1), vjust = -0.5, hjust = 1, size = 3.5\n  ) +\n  coord_flip()\nIt is worth noting here that it was upon switching to a heatmap style plot using\ngeom_tile()\n, the more nuanced variations in medications become more evident. This is exactly the value of this tile plot - since in the next section, we will see its ability to handle a complex data structure (23 medications and their 4-fold values), triangulated over A1c test decisions and primary diagnoses, take in our inputs (both the aesthetic specifications as well as the suitable color palettes we provided), and excavate rapid insights into these kind of care delivery patterns.\n3.2. Medication usage by 2 key covariates\nNow, let’s use the above plot style to triangulate and add more nuance to our investigation – that is, examine the impact made by the admitting primary diagnosis of the patient and whether their HbA1c was measured, on the diabetes medications given to the patient.\n3.2.1. Primary diagnoses\nQuick Insight\nWhile 75% of patients admitted with a diabetes diagnosis are given insulin, this crucial medication is only given to 51% of high-risk circulatory disease patients and 55% of respiratory illness patients. Of those non-diabetic patients who receive insulin, only ~20% receive a change in their dosage, while 40% of diabetic patients get their insulin dosage changed.\nShow the code\n# i) primary diagnosis\n\n# Re-define diagnoses to focus on a few key ones\nD <- D %>% mutate(primary_diag = ifelse(primary_diag %in% c(\"Digestive\", \"Genitourinary\", \"Pregnancy\", \"Skin\", \"Musculoskeletal\", \"Congenital\", \"Injury\", \"Other\"), \"Other\", primary_diag))\n\n# Reshape data again\nmeds_diag <- D %>%\n  select(meds_5pct$medication, primary_diag) %>%\n  gather(key = \"medication\", value = \"value\", -primary_diag) %>%\n  group_by(primary_diag, medication, value) %>%\n  summarise(n = n()) %>%\n  mutate(pct = (n / sum(n)) * 100)\n\n# Plot using color parameters that are robust under color vision deficiencies\nggplot(meds_diag, aes(x = value, y = medication, fill = pct)) +\n  geom_tile() +\n  facet_wrap(~primary_diag, nrow = 2, ncol = 2) +\n  scale_fill_gradientn(\n    colors = palette.colors(9),\n    limits = c(0, 100)\n  ) +\n  labs(\n    title = \"Medication by primary diagnosis & tuned colors\",\n    x = \"Medication value\",\n    y = \"Medication name\", fill = \"Percent prescribed\"\n  ) +\n  theme_minimal() +\n  geom_text(aes(label = paste(round(pct, 1), \"%\", sep = \"\")), color = \"white\", size = 3) +\n  theme(plot.title = element_text(hjust = 0.5), legend.position = \"none\")\n3.2.2. A1c test\nQuick Insight\nWhile 64% of patients whose HbA1c is measured are given insulin, only 52% of those who did not get an HbA1c measurement get this crucial medication. Though this disparity is much less for other medications, the tendency to adjust dosage is higher for patients with an HbA1c measurement. Note that\nresearch\n** has shown that the HbA1c is important in “tailoring appropriate diabetes therapy regimens”, so this finding of a differential dosage adjustment based on HbA1c measurement is extremely important.\nShow the code\n# ii) A1c\n\n# Re-shape data\nmeds_a1c <- D %>%\n  select(meds_5pct$medication, a1c) %>%\n  gather(key = \"medication\", value = \"value\", -a1c) %>%\n  group_by(a1c, medication, value) %>% summarise(n=n()) %>% mutate(pct = (n / sum(n))*100)\n\n# Visualize with fine-tuned color parameters \nggplot(meds_a1c, aes(x = value, y = medication, fill = pct)) +\n  geom_tile() +\n  facet_grid(~ a1c) +\n  scale_fill_gradientn(colors = palette.colors(9), \n                       limits = c(0, 100)) +\n  labs(title = \"Medication by the A1c test & tuned colors\",\n       x = \"Medication value\",\n       y = \"Medication name\", fill=\"Percent prescribed\") +\n  theme_minimal() +\n  geom_text(aes(label = paste(round(pct, 1), \"%\", sep=\"\")), color = \"white\", size = 4) +\n  theme(plot.title = element_text(hjust = 0.5))\n4. Conclusion and what’s next\nThese findings highlight meaningful variation in both insulin administration and dosage adjustment across patient groups. While insulin is routinely given to diabetic patients, it is prescribed far less frequently for those with high-risk circulatory or respiratory conditions — and even less likely to be adjusted when given. Notably, patients who receive an HbA1c measurement are not only more likely to be prescribed insulin, but also more likely to have their dosage adjusted — a pattern aligned with clinical guidance emphasizing the role of HbA1c in tailoring diabetes treatment.\nTaken together, these patterns suggest that diagnostic practices and comorbid conditions meaningfully shape treatment decisions. With these foundational relationships established, we are now ready to explore how factors like HbA1c measurement and primary diagnosis influence downstream outcomes such as early readmission — a metric of both clinical quality and financial strain. Reducing preventable readmissions not only helps relieve the cost burden on the healthcare system but also improves the patient experience — making this a priority for administrators, caregivers, and, most importantly, the patients themselves. Leveraging AI-assisted pattern discovery, we can now surface deeper insights into how inpatient care decisions translate into longer-term outcomes, guiding more equitable and effective interventions across the board.\nIn the meantime, be sure to check out the supplemental post we will publish shortly after this one on how we used Copilot in this post, including guidance on effective prompt writing for Copilot, and additional visualizations of the complex data we’re exploring!\nAbout the Author\nVidisha writes: “I am a statistician and data science professional. For practitioners like me, ‘tidyverse’ is a household word. I’ve used it for complex data wrangling, visualization, and advanced analytics work, especially where I needed clarity on how to leverage my data so that it allows for story-telling that informs business decisions, recasting my work into actionable insights. I recently began exploring GPT-4o mini and GitHub Copilot to help me speed up my workflows, especially within Healthcare Analytics. I am excited to share this post series to help readers understand the role of RStudio and AI in Healthcare Analytics!”\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nR Works\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "1. Introduction and recap Healthcare analytics offers significant benefits to a wide range of stakeholders, including health administrators, organizations, and most importantly, doctors, nurses, and healthcare workers. In the first part of this...",
      "meta_keywords": null,
      "og_description": "1. Introduction and recap Healthcare analytics offers significant benefits to a wide range of stakeholders, including health administrators, organizations, and most importantly, doctors, nurses, and healthcare workers. In the first part of this...",
      "og_image": "https://rworks.dev/posts/healthcare-part2/index_files/figure-html/Chunk11-1.png",
      "og_title": "Tidyverse with GitHub Copilot for Healthcare Analytics – Part 2 | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 16.4,
      "sitemap_lastmod": null,
      "twitter_description": "1. Introduction and recap Healthcare analytics offers significant benefits to a wide range of stakeholders, including health administrators, organizations, and most importantly, doctors, nurses, and healthcare workers. In the first part of this...",
      "twitter_title": "Tidyverse with GitHub Copilot for Healthcare Analytics – Part 2 | R-bloggers",
      "url": "https://www.r-bloggers.com/2025/07/tidyverse-with-github-copilot-for-healthcare-analytics-part-2/",
      "word_count": 3284
    }
  }
}