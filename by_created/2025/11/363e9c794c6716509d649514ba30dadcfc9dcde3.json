{
  "id": "363e9c794c6716509d649514ba30dadcfc9dcde3",
  "url": "https://www.r-bloggers.com/2009/05/rsi2-with-position-sizing/",
  "created_at_utc": "2025-11-17T20:40:59Z",
  "data": null,
  "raw_original": {
    "uuid": "07601a8f-413c-4c95-90ab-dfdd2490fb4d",
    "created_at": "2025-11-17 20:40:59",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2009/05/rsi2-with-position-sizing/",
      "crawled_at": "2025-11-17T10:38:50.165932",
      "external_links": [
        {
          "href": "https://feedproxy.google.com/~r/FossTrading/~3/omYutD_yek8/rsi2-with-position-sizing.html",
          "text": "FOSS Trading"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "http://blog.fosstrading.com/2009/04/testing-rsi2-with-r.html",
          "text": "here"
        },
        {
          "href": "http://marketsci.wordpress.com/2008/12/09/trading-with-rsi2/",
          "text": "simple RSI(2) strategy"
        },
        {
          "href": "http://marketsci.wordpress.com/",
          "text": "MarketSci Blog"
        },
        {
          "href": "http://marketsci.wordpress.com/2008/12/14/trading-strategy-scaling-inout-of-rsi2/",
          "text": "this strategy"
        },
        {
          "href": "https://i1.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_replication2.png?ssl=1",
          "text": null
        },
        {
          "href": "https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_updated2.png?ssl=1",
          "text": null
        },
        {
          "href": "http://cran.r-project.org/web/packages/PerformanceAnalytics/index.html",
          "text": "PerformanceAnalytics"
        },
        {
          "href": "https://feedads.g.doubleclick.net/~a/VkVCcRXoIPfgK8jnMo7hayjyzsc/0/da",
          "text": null
        },
        {
          "href": "https://feedads.g.doubleclick.net/~a/VkVCcRXoIPfgK8jnMo7hayjyzsc/1/da",
          "text": null
        },
        {
          "href": "https://feeds.feedburner.com/~ff/FossTrading?a=omYutD_yek8:Grp2PXD45D8:yIl2AUoC8zA",
          "text": null
        },
        {
          "href": "https://feeds.feedburner.com/~ff/FossTrading?a=omYutD_yek8:Grp2PXD45D8:F7zBnMyn0Lo",
          "text": null
        },
        {
          "href": "https://feeds.feedburner.com/~ff/FossTrading?a=omYutD_yek8:Grp2PXD45D8:V_sGLiPBpWU",
          "text": null
        },
        {
          "href": "https://feeds.feedburner.com/~ff/FossTrading?a=omYutD_yek8:Grp2PXD45D8:qj6IDK7rITs",
          "text": null
        },
        {
          "href": "https://feeds.feedburner.com/~ff/FossTrading?a=omYutD_yek8:Grp2PXD45D8:I9og5sOYxJI",
          "text": null
        },
        {
          "href": "https://feedproxy.google.com/~r/FossTrading/~3/omYutD_yek8/rsi2-with-position-sizing.html",
          "text": "FOSS Trading"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "RSI(2) with Position Sizing | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_replication3.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_replication3.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_updated3.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_updated3.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://blogger.googleusercontent.com/tracker/5815834906618132494-7875282317638300993?l=blog.fosstrading.com"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://blogger.googleusercontent.com/tracker/5815834906618132494-7875282317638300993?l=blog.fosstrading.com"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://feedads.g.doubleclick.net/~a/VkVCcRXoIPfgK8jnMo7hayjyzsc/0/di"
        },
        {
          "alt": null,
          "base64": null,
          "src": "http://feedads.g.doubleclick.net/~a/VkVCcRXoIPfgK8jnMo7hayjyzsc/0/di"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://feedads.g.doubleclick.net/~a/VkVCcRXoIPfgK8jnMo7hayjyzsc/1/di"
        },
        {
          "alt": null,
          "base64": null,
          "src": "http://feedads.g.doubleclick.net/~a/VkVCcRXoIPfgK8jnMo7hayjyzsc/1/di"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://feeds.feedburner.com/~ff/FossTrading?d=yIl2AUoC8zA"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://feeds.feedburner.com/~ff/FossTrading?d=yIl2AUoC8zA"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://feeds.feedburner.com/~ff/FossTrading?i=omYutD_yek8:Grp2PXD45D8:F7zBnMyn0Lo"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://feeds.feedburner.com/~ff/FossTrading?i=omYutD_yek8:Grp2PXD45D8:F7zBnMyn0Lo"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://feeds.feedburner.com/~ff/FossTrading?i=omYutD_yek8:Grp2PXD45D8:V_sGLiPBpWU"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://feeds.feedburner.com/~ff/FossTrading?i=omYutD_yek8:Grp2PXD45D8:V_sGLiPBpWU"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://feeds.feedburner.com/~ff/FossTrading?d=qj6IDK7rITs"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://feeds.feedburner.com/~ff/FossTrading?d=qj6IDK7rITs"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://feeds.feedburner.com/~ff/FossTrading?d=I9og5sOYxJI"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://feeds.feedburner.com/~ff/FossTrading?d=I9og5sOYxJI"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://feeds.feedburner.com/~r/FossTrading/~4/omYutD_yek8"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://feeds.feedburner.com/~r/FossTrading/~4/omYutD_yek8"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/joshua-ulrich/",
          "text": "Joshua Ulrich"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/tag/code/",
          "text": "code"
        },
        {
          "href": "https://www.r-bloggers.com/tag/examples/",
          "text": "Examples"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-562 post type-post status-publish format-standard hentry category-r-bloggers tag-code tag-examples\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">RSI(2) with Position Sizing</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">May 1, 2009</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/joshua-ulrich/\">Joshua Ulrich</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<p class=\"syndicated-attribution\"><!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://feedproxy.google.com/~r/FossTrading/~3/omYutD_yek8/rsi2-with-position-sizing.html\"> FOSS Trading</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div></p>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->Though it’s more than two weeks later, here’s the second post in the series that will demonstrate how to build, test, and implement a trading strategy with <a href=\"https://www.r-project.org/\" rel=\"nofollow\" target=\"_blank\">R</a>.  You can find the first post <a href=\"http://blog.fosstrading.com/2009/04/testing-rsi2-with-r.html\" rel=\"nofollow\" target=\"_blank\">here</a>.<br/><br/>The first post replicated this <a href=\"http://marketsci.wordpress.com/2008/12/09/trading-with-rsi2/\" rel=\"nofollow\" target=\"_blank\">simple RSI(2) strategy</a> from the <a href=\"http://marketsci.wordpress.com/\" rel=\"nofollow\" target=\"_blank\">MarketSci Blog</a>.  This second post will demonstrate how to replicate <a href=\"http://marketsci.wordpress.com/2008/12/14/trading-strategy-scaling-inout-of-rsi2/\" rel=\"nofollow\" target=\"_blank\">this strategy</a> that scales in/out of RSI(2).<br/><br/>A couple notes before moving to the code:<br/><ol><li>The rsi2pos() function isn’t <i>necessary</i>, but it provides an example of how to define a function.  Plus, it enables us to test several ideas with much greater speed and flexibility.<br/></li><br/><li>The ifelse() function works on entire vectors at once, avoiding costly loops (loops are costly in R because it’s an interpreted language).  Since we can potentially modify the entire ‘size’ vector, we must be mindful of the order of the tests.</li></ol><br/>On to the code!<br/><blockquote style=\"font-family:courier new;\"><span style=\"font-size:85%;\"># Attach the quantmod and TTR packages.<br/># You can install packages via:<br/># install.packages(c(“quantmod”,”TTR”))<br/>library(quantmod)<br/>library(TTR)<br/><br/># Pull S&amp;P500 index data from Yahoo! Finance<br/>getSymbols(“^GSPC”, from=”2000-01-01″, to=”2008-12-07″)<br/><br/># Calculate the RSI indicator<br/>rsi &lt;- RSI(Cl(GSPC),2)<br/><br/># Calculate Close-to-Close returns<br/># (this assumes we open/close our positions<br/># at each day’s close)<br/>ret &lt;- ROC(Cl(GSPC))<br/>ret[1] &lt;- 0<br/><br/># Define our position-sizing function<br/>rsi2pos &lt;- function(ind, indIncr=5, posIncr=0.25) {<br/>  # Inputs:<br/>  # ind     : indicator vector<br/>  # indIncr : indicator value increments/breakpoints<br/>  # posIncr : position value increments/breakpoints<br/><br/>  # Initialize result vector<br/>  size &lt;- rep(0,NROW(ind))<br/> <br/>  # Long<br/>  size &lt;- ifelse(ind &lt; 4*indIncr, (1-posIncr*3), size)<br/>  size &lt;- ifelse(ind &lt; 3*indIncr, (1-posIncr*2), size)<br/>  size &lt;- ifelse(ind &lt; 2*indIncr, (1-posIncr*1), size)<br/>  size &lt;- ifelse(ind &lt; 1*indIncr, (1-posIncr*0), size)<br/><br/>  # Short<br/>  size &lt;- ifelse(ind &gt; 100-4*indIncr, 3*posIncr-1, size)<br/>  size &lt;- ifelse(ind &gt; 100-3*indIncr, 2*posIncr-1, size)<br/>  size &lt;- ifelse(ind &gt; 100-2*indIncr, 1*posIncr-1, size)<br/>  size &lt;- ifelse(ind &gt; 100-1*indIncr, 0*posIncr-1, size)<br/><br/>  # Today’s position (‘size’) is based on today’s<br/>  # indicator, but we need to apply today’s position<br/>  # to the Close-to-Close return at tomorrow’s close.<br/>  size &lt;- lag(size)<br/> <br/>  # Replace missing signals with no position<br/>  # (generally just at beginning of series)<br/>  size[is.na(size)] &lt;- 0<br/><br/>  # Return results<br/>  return(size)<br/>}<br/><br/># Calculate signals using the ‘rsi2pos()’ function<br/>sig &lt;- rsi2pos(rsi, 5, 0.25)<br/><br/># Break out the long (up) and short (dn) signals<br/>sigup &lt;- ifelse(sig &gt; 0, sig, 0)<br/>sigdn &lt;- ifelse(sig &lt; 0, sig, 0)<br/><br/># Calculate equity curves<br/>eq_up  &lt;- cumprod(1+ret*sigup)<br/>eq_dn  &lt;- cumprod(1+ret*sigdn)<br/>eq_all &lt;- cumprod(1+ret*sig)<br/><br/># Replicate Michael’s nice chart (again)<br/>png(filename=”20090430_rsi2_replication.png”)<br/>plot.zoo( cbind(eq_up, eq_dn), plot.type=”single”,<br/>  ylab=c(“Long”,”Short”), col=c(“green”,”red”),<br/>  main=”RSI(2) Strategy, with Position Scaling:n 2000-01-03 through 2008-12-07″ )<br/>dev.off()</span></blockquote><br/><a data-cf-modified-03ce33fe6aeb114ccf81612b-=\"\" href=\"https://i1.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_replication2.png?ssl=1\" onblur=\"if (!window.__cfRLUnblockHandlers) return false; try {parent.deselectBloggerImageGracefully();} catch(e) {}\" rel=\"nofollow\" target=\"_blank\"><img border=\"0\" class=\"jetpack-lazy-image\" data-lazy-src=\"https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_replication3.png?w=578&amp;is-pending-load=1#038;ssl=1\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_replication3.png?w=578&amp;ssl=1\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" style=\"display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 400px;\"/><noscript><img alt=\"\" border=\"0\" data-recalc-dims=\"1\" id=\"BLOGGER_PHOTO_ID_5331062725859634882\" src=\"https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_replication3.png?w=578&amp;ssl=1\" style=\"display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 400px;\"/></noscript></a><br/><blockquote style=\"font-family:courier new;\"><span style=\"font-size:85%;\"># Calculate signals using the ‘rsi2pos()’ function<br/># with new values<br/>sig &lt;- rsi2pos(rsi, 10, 0.3)<br/><br/># Break out the long (up) and short (dn) signals<br/>sigup &lt;- ifelse(sig &gt; 0, sig, 0)<br/>sigdn &lt;- ifelse(sig &lt; 0, sig, 0)<br/><br/># Calculate equity curves<br/>eq_up  &lt;- cumprod(1+ret*sigup)<br/>eq_dn  &lt;- cumprod(1+ret*sigdn)<br/>eq_all &lt;- cumprod(1+ret*sig)<br/><br/># Re-plot equity curves using updated values<br/>png(filename=”20090501_rsi2_updated.png”)<br/>plot.zoo( cbind(eq_up, eq_dn), plot.type=”single”,<br/>  ylab=c(“Long”,”Short”), col=c(“green”,”red”),<br/>  main=”Updated RSI(2) Strategy, with Position Scaling:n 2000-01-03 through 2008-12-07″ )<br/>dev.off()</span></blockquote><br/><a data-cf-modified-03ce33fe6aeb114ccf81612b-=\"\" href=\"https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_updated2.png?ssl=1\" onblur=\"if (!window.__cfRLUnblockHandlers) return false; try {parent.deselectBloggerImageGracefully();} catch(e) {}\" rel=\"nofollow\" target=\"_blank\"><img border=\"0\" class=\"jetpack-lazy-image\" data-lazy-src=\"https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_updated3.png?w=578&amp;is-pending-load=1#038;ssl=1\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_updated3.png?w=578&amp;ssl=1\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" style=\"display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 400px;\"/><noscript><img alt=\"\" border=\"0\" data-recalc-dims=\"1\" id=\"BLOGGER_PHOTO_ID_5331063643465306402\" src=\"https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_updated3.png?w=578&amp;ssl=1\" style=\"display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 400px;\"/></noscript></a><br/>Visual inspection of the charts seems to indicate the updated RSI(2) strategy has slightly higher returns,  but more volatility and larger drawdowns.  The next post will use the <a href=\"http://cran.r-project.org/web/packages/PerformanceAnalytics/index.html\" rel=\"nofollow\" target=\"_blank\">PerformanceAnalytics</a> package to evaluate the volatility, drawdowns, and related metrics associated with these strategies.  I will do my best to post it less than two weeks from now!<div class=\"blogger-post-footer\"><img alt=\"\" class=\"jetpack-lazy-image\" data-lazy-src=\"https://blogger.googleusercontent.com/tracker/5815834906618132494-7875282317638300993?l=blog.fosstrading.com&amp;is-pending-load=1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/5815834906618132494-7875282317638300993?l=blog.fosstrading.com\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" width=\"1\"/><noscript><img alt=\"\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/5815834906618132494-7875282317638300993?l=blog.fosstrading.com\" width=\"1\"/></noscript></div>\n<p><a href=\"https://feedads.g.doubleclick.net/~a/VkVCcRXoIPfgK8jnMo7hayjyzsc/0/da\" rel=\"nofollow\" target=\"_blank\"><img border=\"0\" class=\"jetpack-lazy-image\" data-lazy-src=\"http://feedads.g.doubleclick.net/~a/VkVCcRXoIPfgK8jnMo7hayjyzsc/0/di?is-pending-load=1\" ismap=\"true\" src=\"https://feedads.g.doubleclick.net/~a/VkVCcRXoIPfgK8jnMo7hayjyzsc/0/di\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/><noscript><img border=\"0\" ismap=\"true\" src=\"http://feedads.g.doubleclick.net/~a/VkVCcRXoIPfgK8jnMo7hayjyzsc/0/di\"/></noscript></a><br/>\n<a href=\"https://feedads.g.doubleclick.net/~a/VkVCcRXoIPfgK8jnMo7hayjyzsc/1/da\" rel=\"nofollow\" target=\"_blank\"><img border=\"0\" class=\"jetpack-lazy-image\" data-lazy-src=\"http://feedads.g.doubleclick.net/~a/VkVCcRXoIPfgK8jnMo7hayjyzsc/1/di?is-pending-load=1\" ismap=\"true\" src=\"https://feedads.g.doubleclick.net/~a/VkVCcRXoIPfgK8jnMo7hayjyzsc/1/di\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/><noscript><img border=\"0\" ismap=\"true\" src=\"http://feedads.g.doubleclick.net/~a/VkVCcRXoIPfgK8jnMo7hayjyzsc/1/di\"/></noscript></a></p><div class=\"feedflare\">\n<a href=\"https://feeds.feedburner.com/~ff/FossTrading?a=omYutD_yek8:Grp2PXD45D8:yIl2AUoC8zA\" rel=\"nofollow\" target=\"_blank\"><img border=\"0\" class=\"jetpack-lazy-image\" data-lazy-src=\"https://feeds.feedburner.com/~ff/FossTrading?d=yIl2AUoC8zA&amp;is-pending-load=1\" src=\"https://feeds.feedburner.com/~ff/FossTrading?d=yIl2AUoC8zA\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/><noscript><img border=\"0\" src=\"https://feeds.feedburner.com/~ff/FossTrading?d=yIl2AUoC8zA\"/></noscript></a> <a href=\"https://feeds.feedburner.com/~ff/FossTrading?a=omYutD_yek8:Grp2PXD45D8:F7zBnMyn0Lo\" rel=\"nofollow\" target=\"_blank\"><img border=\"0\" class=\"jetpack-lazy-image\" data-lazy-src=\"https://feeds.feedburner.com/~ff/FossTrading?i=omYutD_yek8%3AGrp2PXD45D8%3AF7zBnMyn0Lo&amp;is-pending-load=1\" src=\"https://feeds.feedburner.com/~ff/FossTrading?i=omYutD_yek8:Grp2PXD45D8:F7zBnMyn0Lo\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/><noscript><img border=\"0\" src=\"https://feeds.feedburner.com/~ff/FossTrading?i=omYutD_yek8:Grp2PXD45D8:F7zBnMyn0Lo\"/></noscript></a> <a href=\"https://feeds.feedburner.com/~ff/FossTrading?a=omYutD_yek8:Grp2PXD45D8:V_sGLiPBpWU\" rel=\"nofollow\" target=\"_blank\"><img border=\"0\" class=\"jetpack-lazy-image\" data-lazy-src=\"https://feeds.feedburner.com/~ff/FossTrading?i=omYutD_yek8%3AGrp2PXD45D8%3AV_sGLiPBpWU&amp;is-pending-load=1\" src=\"https://feeds.feedburner.com/~ff/FossTrading?i=omYutD_yek8:Grp2PXD45D8:V_sGLiPBpWU\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/><noscript><img border=\"0\" src=\"https://feeds.feedburner.com/~ff/FossTrading?i=omYutD_yek8:Grp2PXD45D8:V_sGLiPBpWU\"/></noscript></a> <a href=\"https://feeds.feedburner.com/~ff/FossTrading?a=omYutD_yek8:Grp2PXD45D8:qj6IDK7rITs\" rel=\"nofollow\" target=\"_blank\"><img border=\"0\" class=\"jetpack-lazy-image\" data-lazy-src=\"https://feeds.feedburner.com/~ff/FossTrading?d=qj6IDK7rITs&amp;is-pending-load=1\" src=\"https://feeds.feedburner.com/~ff/FossTrading?d=qj6IDK7rITs\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/><noscript><img border=\"0\" src=\"https://feeds.feedburner.com/~ff/FossTrading?d=qj6IDK7rITs\"/></noscript></a> <a href=\"https://feeds.feedburner.com/~ff/FossTrading?a=omYutD_yek8:Grp2PXD45D8:I9og5sOYxJI\" rel=\"nofollow\" target=\"_blank\"><img border=\"0\" class=\"jetpack-lazy-image\" data-lazy-src=\"https://feeds.feedburner.com/~ff/FossTrading?d=I9og5sOYxJI&amp;is-pending-load=1\" src=\"https://feeds.feedburner.com/~ff/FossTrading?d=I9og5sOYxJI\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"/><noscript><img border=\"0\" src=\"https://feeds.feedburner.com/~ff/FossTrading?d=I9og5sOYxJI\"/></noscript></a>\n</div><img class=\"jetpack-lazy-image\" data-lazy-src=\"https://feeds.feedburner.com/~r/FossTrading/~4/omYutD_yek8?is-pending-load=1\" height=\"1\" loading=\"lazy\" src=\"https://feeds.feedburner.com/~r/FossTrading/~4/omYutD_yek8\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" width=\"1\"/><noscript><img height=\"1\" loading=\"lazy\" src=\"https://feeds.feedburner.com/~r/FossTrading/~4/omYutD_yek8\" width=\"1\"/></noscript>\n\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.0-->\n<p class=\"syndicated-attribution\"><div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://feedproxy.google.com/~r/FossTrading/~3/omYutD_yek8/rsi2-with-position-sizing.html\"> FOSS Trading</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div></p> </div>\n<div class=\"post-tags clearfix\"><ul><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/code/\" rel=\"tag\">code</a></li><li class=\"round-corners\"><a href=\"https://www.r-bloggers.com/tag/examples/\" rel=\"tag\">Examples</a></li></ul></div></article>",
      "main_text": "RSI(2) with Position Sizing\nPosted on\nMay 1, 2009\nby\nJoshua Ulrich\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nFOSS Trading\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nThough it’s more than two weeks later, here’s the second post in the series that will demonstrate how to build, test, and implement a trading strategy with\nR\n.  You can find the first post\nhere\n.\nThe first post replicated this\nsimple RSI(2) strategy\nfrom the\nMarketSci Blog\n.  This second post will demonstrate how to replicate\nthis strategy\nthat scales in/out of RSI(2).\nA couple notes before moving to the code:\nThe rsi2pos() function isn’t\nnecessary\n, but it provides an example of how to define a function.  Plus, it enables us to test several ideas with much greater speed and flexibility.\nThe ifelse() function works on entire vectors at once, avoiding costly loops (loops are costly in R because it’s an interpreted language).  Since we can potentially modify the entire ‘size’ vector, we must be mindful of the order of the tests.\nOn to the code!\n# Attach the quantmod and TTR packages.\n# You can install packages via:\n# install.packages(c(“quantmod”,”TTR”))\nlibrary(quantmod)\nlibrary(TTR)\n# Pull S&P500 index data from Yahoo! Finance\ngetSymbols(“^GSPC”, from=”2000-01-01″, to=”2008-12-07″)\n# Calculate the RSI indicator\nrsi <- RSI(Cl(GSPC),2)\n# Calculate Close-to-Close returns\n# (this assumes we open/close our positions\n# at each day’s close)\nret <- ROC(Cl(GSPC))\nret[1] <- 0\n# Define our position-sizing function\nrsi2pos <- function(ind, indIncr=5, posIncr=0.25) {\n# Inputs:\n# ind     : indicator vector\n# indIncr : indicator value increments/breakpoints\n# posIncr : position value increments/breakpoints\n# Initialize result vector\nsize <- rep(0,NROW(ind))\n# Long\nsize <- ifelse(ind < 4*indIncr, (1-posIncr*3), size)\nsize <- ifelse(ind < 3*indIncr, (1-posIncr*2), size)\nsize <- ifelse(ind < 2*indIncr, (1-posIncr*1), size)\nsize <- ifelse(ind < 1*indIncr, (1-posIncr*0), size)\n# Short\nsize <- ifelse(ind > 100-4*indIncr, 3*posIncr-1, size)\nsize <- ifelse(ind > 100-3*indIncr, 2*posIncr-1, size)\nsize <- ifelse(ind > 100-2*indIncr, 1*posIncr-1, size)\nsize <- ifelse(ind > 100-1*indIncr, 0*posIncr-1, size)\n# Today’s position (‘size’) is based on today’s\n# indicator, but we need to apply today’s position\n# to the Close-to-Close return at tomorrow’s close.\nsize <- lag(size)\n# Replace missing signals with no position\n# (generally just at beginning of series)\nsize[is.na(size)] <- 0\n# Return results\nreturn(size)\n}\n# Calculate signals using the ‘rsi2pos()’ function\nsig <- rsi2pos(rsi, 5, 0.25)\n# Break out the long (up) and short (dn) signals\nsigup <- ifelse(sig > 0, sig, 0)\nsigdn <- ifelse(sig < 0, sig, 0)\n# Calculate equity curves\neq_up  <- cumprod(1+ret*sigup)\neq_dn  <- cumprod(1+ret*sigdn)\neq_all <- cumprod(1+ret*sig)\n# Replicate Michael’s nice chart (again)\npng(filename=”20090430_rsi2_replication.png”)\nplot.zoo( cbind(eq_up, eq_dn), plot.type=”single”,\nylab=c(“Long”,”Short”), col=c(“green”,”red”),\nmain=”RSI(2) Strategy, with Position Scaling:n 2000-01-03 through 2008-12-07″ )\ndev.off()\n# Calculate signals using the ‘rsi2pos()’ function\n# with new values\nsig <- rsi2pos(rsi, 10, 0.3)\n# Break out the long (up) and short (dn) signals\nsigup <- ifelse(sig > 0, sig, 0)\nsigdn <- ifelse(sig < 0, sig, 0)\n# Calculate equity curves\neq_up  <- cumprod(1+ret*sigup)\neq_dn  <- cumprod(1+ret*sigdn)\neq_all <- cumprod(1+ret*sig)\n# Re-plot equity curves using updated values\npng(filename=”20090501_rsi2_updated.png”)\nplot.zoo( cbind(eq_up, eq_dn), plot.type=”single”,\nylab=c(“Long”,”Short”), col=c(“green”,”red”),\nmain=”Updated RSI(2) Strategy, with Position Scaling:n 2000-01-03 through 2008-12-07″ )\ndev.off()\nVisual inspection of the charts seems to indicate the updated RSI(2) strategy has slightly higher returns,  but more volatility and larger drawdowns.  The next post will use the\nPerformanceAnalytics\npackage to evaluate the volatility, drawdowns, and related metrics associated with these strategies.  I will do my best to post it less than two weeks from now!\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nFOSS Trading\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\ncode\nExamples",
      "meta_description": "Though it's more than two weeks later, here's the second post in the series that will demonstrate how to build, test, and implement a trading strategy with R. You can find the first post here.The first post replicated this simple RSI(2) strategy from ...",
      "meta_keywords": "code,examples",
      "og_description": "Though it's more than two weeks later, here's the second post in the series that will demonstrate how to build, test, and implement a trading strategy with R. You can find the first post here.The first post replicated this simple RSI(2) strategy from ...",
      "og_image": "https://www.r-bloggers.com/wp-content/uploads/2009/05/20090501_rsi2_replication3.png",
      "og_title": "RSI(2) with Position Sizing | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 3.9,
      "sitemap_lastmod": "2011-05-11T21:14:47+00:00",
      "twitter_description": "Though it's more than two weeks later, here's the second post in the series that will demonstrate how to build, test, and implement a trading strategy with R. You can find the first post here.The first post replicated this simple RSI(2) strategy from ...",
      "twitter_title": "RSI(2) with Position Sizing | R-bloggers",
      "url": "https://www.r-bloggers.com/2009/05/rsi2-with-position-sizing/",
      "word_count": 779
    }
  }
}