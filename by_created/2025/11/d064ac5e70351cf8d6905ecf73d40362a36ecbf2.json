{
  "id": "d064ac5e70351cf8d6905ecf73d40362a36ecbf2",
  "url": "https://www.r-bloggers.com/2023/11/non-stationary-wrapped-gaussian-spatial-response-model/",
  "created_at_utc": "2025-11-17T20:39:10Z",
  "data": null,
  "raw_original": {
    "uuid": "b096eca3-9db5-4907-9960-3e49541b8c1f",
    "created_at": "2025-11-17 20:39:10",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2023/11/non-stationary-wrapped-gaussian-spatial-response-model/",
      "crawled_at": "2025-11-17T09:53:43.840582",
      "external_links": [
        {
          "href": "https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/",
          "text": "YoungStatS"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-jona2012spatial",
          "text": "2012"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-wang2014modeling",
          "text": "2014"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-marques2022non",
          "text": "2022"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-jona2012spatial",
          "text": "2012"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-simpson2017penalising",
          "text": "Simpson et al. 2017"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-klein2016scale",
          "text": "Klein and Kneib 2016"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-klein2016scale",
          "text": "2016"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-lindgren2011explicit",
          "text": "Lindgren, Rue, and Lindström 2011"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-klein2016scale",
          "text": "Klein and Kneib 2016"
        },
        {
          "href": "https://www.gla.ac.uk/schools/mathematicsstatistics/staff/isamanuelarosagoncalvesmarques/",
          "text": "Isa Marques"
        },
        {
          "href": "https://www.uni-goettingen.de/en/264255.html",
          "text": "Thomas Kneib"
        },
        {
          "href": "https://www.tu-dortmund.de/en/university/newly-appointed-professors/prof-nadja-klein/",
          "text": "Nadja Klein"
        },
        {
          "href": "https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/",
          "text": "YoungStatS"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Non-stationary wrapped Gaussian spatial response model | R-bloggers",
      "images": [
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/youngstats.github.io/post/2023-11-22-non-stationary-wrapped-gaussian-spatial-response-model_files/plot_calm-horz.png?w=578&ssl=1"
        },
        {
          "alt": null,
          "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
        },
        {
          "alt": null,
          "base64": null,
          "src": "https://i1.wp.com/youngstats.github.io/post/2023-11-22-non-stationary-wrapped-gaussian-spatial-response-model_files/results_calm.png?w=578&ssl=1"
        }
      ],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/youngstats/",
          "text": "YoungStatS"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-380253 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Non-stationary wrapped Gaussian spatial response model</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">November 21, 2023</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/youngstats/\">YoungStatS</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/\"> YoungStatS</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div class=\"section level2\" id=\"background\">\n<h2>Background</h2>\n<p>Circular data, i.e., data defined on the unit circle, can be found in many areas of science.\nThe unique nature of these data means that conventional methods for non-circular data are not valid for these.\nAt the same time, advances in geographical information and global positioning systems have generated large amounts of spatial data and, consequently, have increased the need for spatial models that accurately describe it.\nAn example of circular, spatial data are the average wind directions in Germany from April 1 to 10, 2019, plotted in space (left) and on a circular histogram (right):</p>\n<p><img data-lazy-src=\"https://i1.wp.com/youngstats.github.io/post/2023-11-22-non-stationary-wrapped-gaussian-spatial-response-model_files/plot_calm-horz.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img data-recalc-dims=\"1\" src=\"https://i1.wp.com/youngstats.github.io/post/2023-11-22-non-stationary-wrapped-gaussian-spatial-response-model_files/plot_calm-horz.png?w=578&amp;ssl=1\"/></noscript></p>\n<p>It was <span class=\"citation\">Jona-Lasinio, Gelfand, and Jona-Lasinio (<a href=\"https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-jona2012spatial\" rel=\"nofollow\" target=\"_blank\">2012</a>)</span> and <span class=\"citation\">Wang and Gelfand (<a href=\"https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-wang2014modeling\" rel=\"nofollow\" target=\"_blank\">2014</a>)</span> that first brought the wrapped and projected Gaussian distributions to space and space-time settings.\nNonetheless, today,<strong>circular data models still need to catch up on the latest advances in spatial statistics</strong>.\nIn particular, models developed so far <strong>assume stationarity in the mean and the covariance of the response</strong> modeled; i.e., these are constant in space.\nOur work in <span class=\"citation\">Marques, Kneib, and Klein (<a href=\"https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-marques2022non\" rel=\"nofollow\" target=\"_blank\">2022</a>)</span> aims to bridge this gap and allow for non-stationarity in the mean and covariance of distributions for circular responses defined on spatial domains.</p>\n</div>\n<div class=\"section level2\" id=\"the-response-distribution\">\n<h2>The response distribution</h2>\n<p>To construct distributions for circular data, we can rely on the construction principle of wrapping the distribution of a random variable <span class=\"math inline\">\\(Y \\in \\mathbb{R}\\)</span> defined on the real line around the unit circle to make its domain adhere to the interval <span class=\"math inline\">\\([0,2\\pi]\\)</span>.\nThe result is a circular – or <em>wrapped</em> – random variable <span class=\"math inline\">\\(X \\in \\lbrack 0,2\\pi)\\)</span>.\nThen, the <em>unwrapped</em> variable <span class=\"math inline\">\\(Y\\)</span> can be expressed as <span class=\"math display\">\\[\nY = X + 2 \\pi K\n\\]</span> where <span class=\"math inline\">\\(K \\in \\mathbb{Z}\\)</span> measures the number of “turns” <span class=\"math inline\">\\(Y\\)</span> has be wrapped around the unit circle.</p>\n<p>Let <span class=\"math inline\">\\(\\mathbf{s}\\)</span> denote a spatial index variable within a spatial domain <span class=\"math inline\">\\(S \\subset \\mathbb{R}^2\\)</span>.\n<span class=\"citation\">Jona-Lasinio, Gelfand, and Jona-Lasinio (<a href=\"https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-jona2012spatial\" rel=\"nofollow\" target=\"_blank\">2012</a>)</span> first showed that this wrapping approach can be extended to the context of spatial data.\nWe extend their framework and consider\n<span class=\"math display\">\\[ X(\\mathbf{s}_i) = \\beta_0 + \\mathbf{z}(\\mathbf{s}_i)' \\boldsymbol{\\beta}  +\\gamma(\\mathbf{s}_i, \\mathbf{z}^\\kappa(\\mathbf{s}_i)) + 2 \\pi K(\\mathbf{s}_i) + \\varepsilon_i ,\\]</span>\nwhere <span class=\"math inline\">\\(i=1, \\ldots,n\\)</span>, <span class=\"math inline\">\\(\\gamma(\\mathbf{s}_i)\\)</span> is a zero-mean Gaussian random field (GRF) and <span class=\"math inline\">\\(\\varepsilon_i \\sim N(0, \\sigma^2_\\varepsilon)\\)</span> are the i.i.d. error terms, with the following novelties:</p>\n<ol style=\"list-style-type: decimal\">\n<li><p>The mean depends on <span class=\"math inline\">\\(\\mathbf{z}(\\mathbf{s}_i)' \\boldsymbol{\\beta}\\)</span>, i.e. it is non-stationary,</p></li>\n<li><p>The covariance depends on <span class=\"math inline\">\\(\\mathbf{z}^\\kappa(\\mathbf{s}_i)\\)</span>, i.e. it is non-stationary,</p></li>\n<li><p>We include small-scale noise <span class=\"math inline\">\\(\\varepsilon_i\\)</span>s.</p></li>\n</ol>\n<p>We focus on 1. and 2.</p>\n<div class=\"section level3\" id=\"non-stationarity-in-the-mean\">\n<h3>1. Non-stationarity in the mean</h3>\n<p>Linear covariates included in the mean of a circular response might induce a circular likelihood for the regression coefficients that has infinitely many maxima.\nThe typical solution is to use a link function for fixed effects with co-domain defined in <span class=\"math inline\">\\(\\mathbb{R}\\)</span> and of length equal to the circular variable’s period of <span class=\"math inline\">\\(2\\pi\\)</span>, e.g. the inverse tangent link function.</p>\n<p>We argue that:</p>\n<ol style=\"list-style-type: decimal\">\n<li><p>The winding number <span class=\"math inline\">\\(K(\\mathbf{s})\\)</span> can govern the behavior of the combination of GRF and fixed effects such that no link function is needed,</p></li>\n<li><p>We use prior information that shrinks towards a stationary mean and enforces the length of the fixed effects to be approximately <span class=\"math inline\">\\(2\\pi\\)</span>.</p></li>\n</ol>\n<p>Concretely, <span class=\"math inline\">\\(\\beta_0 \\sim N(0, 10)\\)</span> represents a diffuse prior for the intercept and we let\n<span class=\"math inline\">\\(\\boldsymbol{\\beta} \\vert \\xi^2 \\sim N(\\mathbf{0}, \\xi^2 \\mathbf{I})\\)</span>. One can show that\nif the base model is such that <span class=\"math inline\">\\(\\xi^2 \\to 0\\)</span> and the prior is constructed\naccording to the PC-prior principles <span class=\"citation\">(<a href=\"https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-simpson2017penalising\" rel=\"nofollow\" target=\"_blank\">Simpson et al. 2017</a>)</span>, then <span class=\"math inline\">\\(\\xi^2\\)</span>\nhas a Weibull prior with shape <span class=\"math inline\">\\(\\frac{1}{2}\\)</span> and scale <span class=\"math inline\">\\(\\lambda\\)</span>, i.e., <span class=\"math inline\">\\(\\xi^2 \\sim \\text{Weibull}(\\frac{1}{2}, \\lambda)\\)</span> <span class=\"citation\">(<a href=\"https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-klein2016scale\" rel=\"nofollow\" target=\"_blank\">Klein and Kneib 2016</a>)</span>.</p>\n<p>For <span class=\"math inline\">\\(\\alpha \\in (0, 1)\\)</span>, <span class=\"math inline\">\\(\\lambda\\)</span> is chosen such that\n<span class=\"math display\">\\[\n     P\\left( \\text{max}_{\\mathbf{s} \\in S} \\mid\n    \\mathbf{z}(\\mathbf{s})'\\boldsymbol{\\beta} \\mid \\leq\\,  \\pi \\right)\n    \\geq 1 – \\alpha,\n\\]</span>\ni.e., the probability that the maximum norm of the non-stationary effect in the mean of the response is smaller than <span class=\"math inline\">\\(\\pi\\)</span> is larger than <span class=\"math inline\">\\(1 – \\alpha\\)</span>. The value <span class=\"math inline\">\\(\\pi\\)</span> in the expression is close to the recommendation of <span class=\"math inline\">\\(3\\)</span> in <span class=\"citation\">Klein and Kneib (<a href=\"https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-klein2016scale\" rel=\"nofollow\" target=\"_blank\">2016</a>)</span>.</p>\n</div>\n<div class=\"section level3\" id=\"non-stationarity-in-the-covariance\">\n<h3>2. Non-stationarity in the covariance</h3>\n<p>The stochastic partial differential equation (SPDE) approach <span class=\"citation\">(see <a href=\"https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-lindgren2011explicit\" rel=\"nofollow\" target=\"_blank\">Lindgren, Rue, and Lindström 2011</a>)</span> allows us to model non-stationarity in the covariance of the GRF in a computationally efficient way.\nConsider the parameters of the Matérn covariance with smoothness <span class=\"math inline\">\\(1\\)</span> and <span class=\"math inline\">\\(\\kappa\\)</span> and <span class=\"math inline\">\\(\\tau\\)</span> controlling the range and the marginal variance of the GRF, respectively.</p>\n<p>We let\n<span class=\"math display\">\\[\n\\log(\\tau) =  \\theta^\\tau_0 \\mbox{ and } \\log(\\kappa(\\mathbf{s})) =\n\\theta^\\kappa_0 + \\mathbf{z}^\\kappa(\\mathbf{s})'\\boldsymbol{\\theta}^\\kappa_z,\n\\]</span>\nwhere uniform priors for <span class=\"math inline\">\\(\\theta^\\tau_0\\)</span> and <span class=\"math inline\">\\(\\theta_0^\\kappa\\)</span> guarantee that the marginal variance is in <span class=\"math inline\">\\([0.01, (2\\pi)^2]\\)</span> and the spatial range is in <span class=\"math inline\">\\([0.01, 1]\\)</span> for <span class=\"math inline\">\\(S \\subseteq [0, 1] \\times [0,1]\\)</span>.\nOnce again, we use a simulation-based method to guarantee</p>\n<p><span class=\"math display\">\\[\nP\\left( \\text{max}_{\\mathbf{s} \\in S} \\mid\n\\mathbf{z}^\\kappa(\\mathbf{s})'\\boldsymbol{\\theta}^\\kappa_z \\mid \\leq\\,  c \\right)\n\\geq 1 – \\alpha_\\kappa,\n\\]</span>\nsuch that <span class=\"math inline\">\\(c\\)</span> guarantees that the spatial range satisfies <span class=\"math inline\">\\(\\rho(\\mathbf{s}) \\in [0.01, 1]\\)</span>, with typically <span class=\"math inline\">\\(c = 3\\)</span> <span class=\"citation\">(see <a href=\"https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/#ref-klein2016scale\" rel=\"nofollow\" target=\"_blank\">Klein and Kneib 2016</a>)</span>. The resulting prior structure shrinks towards a model with stationary covariance.</p>\n<p>More concretely, we have <span class=\"math inline\">\\(\\theta^\\tau_0 \\sim U(-10, 3)\\)</span>, <span class=\"math inline\">\\(\\theta^\\kappa_0 \\sim U(1, 6)\\)</span> and <span class=\"math inline\">\\(\\boldsymbol{\\theta}_z^\\kappa \\vert \\zeta^2 \\sim N(\\mathbf{0}, \\zeta^2 \\mathbf{I})\\)</span>, with <span class=\"math inline\">\\(\\zeta^2 \\sim \\text{Weibull}(\\frac{1}{2}, \\lambda_\\kappa)\\)</span>.</p>\n</div>\n</div>\n<div class=\"section level2\" id=\"the-full-hierarchical-model\">\n<h2>The full-hierarchical model</h2>\n<p>The SPDE is typically used in combination with integrated nested Laplace approximations (INLA). However, INLA does not perform well when combined with shrinkage priors for non-stationarity in the covariance as defined here. Thus, we use Markov Chain Monte Carlo with full-hierarchical model:</p>\n<p><span class=\"math display\">\\[\\begin{align*}\nX(\\mathbf{s}) &amp;= \\eta(\\mathbf{s}) + 2 \\pi K(\\mathbf{s}) +\n\\varepsilon, \\\\\n&amp;= \\beta_0 + \\mathbf{z}(\\mathbf{s})' \\boldsymbol{\\beta} + \\gamma(\\mathbf{s}, \\mathbf{z}^\\kappa(\\mathbf{s})) + 2 \\pi K(\\mathbf{s}) +\n\\varepsilon,\\\\\n\\beta_0 &amp;\\sim N(0, 10) ,\\mbox{ }  \\boldsymbol{\\beta} \\vert \\xi^2 \\sim N(0, \\xi^2 \\mathbf{I}), \\mbox{ }\\boldsymbol{\\gamma} \\vert  \\boldsymbol{\\theta} \\sim N(\\mathbf{0}, \\mathbf{Q}^{-1}(\\boldsymbol{\\theta})) \\\\\n\\theta_0^\\tau &amp;\\sim U(-10, 3) ,\\mbox{ }\n\\theta_0^\\kappa \\sim U(1, 6) ,\\mbox{ }\n\\boldsymbol{\\theta}^\\kappa_z  \\vert  \\zeta^2 \\sim N(\\mathbf{0}, \\zeta^2 \\mathbf{I}) \\\\\n\\xi^2 &amp;\\sim PC\\left(\\pi, \\alpha \\right) ,\\mbox{ }\n\\zeta^2 \\sim PC\\left(3, \\alpha_\\kappa \\right) \\\\\n\\mathbf{\\varepsilon}  \\vert \\sigma^2_\\varepsilon &amp;\\sim N(\\mathbf{0}, \\sigma^2_\\varepsilon \\mathbf{I}) ,\\mbox{ }\n\\sigma^2_\\varepsilon \\sim IG (0.001, 0.001)\\\\\n    p(K(\\mathbf{s})) &amp;=\n\\begin{cases}\n    \\frac{1}{3},&amp; \\text{if } K(\\mathbf{s}) \\in \\lbrace -1, 0, 1 \\rbrace\\\\\n    0,              &amp; \\text{otherwise}\n\\end{cases}\n\\end{align*}\\]</span></p>\n</div>\n<div class=\"section level2\" id=\"outcome\">\n<h2>Outcome</h2>\n<p>One can use our model to estimate wind directions in the dataset above and test the model’s performance.\nWe randomly select a holdout set consisting of <span class=\"math inline\">\\(20\\%\\)</span> of the locations and use the remaining <span class=\"math inline\">\\(80\\%\\)</span> as training data.\nThe covariates considered for <span class=\"math inline\">\\(\\mathbf{z}(\\mathbf{s})\\)</span> are maximum wind speed, average air humidity, and temperature at 10 meters height. For <span class=\"math inline\">\\(\\mathbf{z^\\kappa}(\\mathbf{s})\\)</span> we consider altitude and latitude.</p>\n<p>The figure below shows the posterior predictive mean (left) and standard deviation (right) for each test location for a fully stationary, i.e., stationary mean and covariance and fully non-stationary models.\nThe black arrows represent the true wind directions (left) and the corresponding standard deviation of zero (right).\nThe figure shows that the fully non-stationary model reaches smaller bias than the fully stationary model throughout the whole domain. In the north where this bias is close to zero, our model also reaches lower uncertainty.</p>\n<p><img data-lazy-src=\"https://i1.wp.com/youngstats.github.io/post/2023-11-22-non-stationary-wrapped-gaussian-spatial-response-model_files/results_calm.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img data-recalc-dims=\"1\" src=\"https://i1.wp.com/youngstats.github.io/post/2023-11-22-non-stationary-wrapped-gaussian-spatial-response-model_files/results_calm.png?w=578&amp;ssl=1\"/></noscript></p>\n</div>\n<div class=\"section level2\" id=\"about-the-authors\">\n<h2>About the authors</h2>\n<ul>\n<li><a href=\"https://www.gla.ac.uk/schools/mathematicsstatistics/staff/isamanuelarosagoncalvesmarques/\" rel=\"nofollow\" target=\"_blank\">Isa Marques</a></li>\n<li><a href=\"https://www.uni-goettingen.de/en/264255.html\" rel=\"nofollow\" target=\"_blank\">Thomas Kneib</a></li>\n<li><a href=\"https://www.tu-dortmund.de/en/university/newly-appointed-professors/prof-nadja-klein/\" rel=\"nofollow\" target=\"_blank\">Nadja Klein</a></li>\n</ul>\n</div>\n<div class=\"section level2 unnumbered\" id=\"references\">\n<h2>References</h2>\n<div class=\"references csl-bib-body hanging-indent\" id=\"refs\">\n<div class=\"csl-entry\" id=\"ref-jona2012spatial\">\nJona-Lasinio, Giovanna, Alan Gelfand, and Mattia Jona-Lasinio. 2012. <span>“<span class=\"nocase\">Spatial analysis of wave direction data using wrapped Gaussian processes</span>.”</span> <em>The Annals of Applied Statistics</em> 6 (4): 1478–98.\n</div>\n<div class=\"csl-entry\" id=\"ref-klein2016scale\">\nKlein, Nadja, and Thomas Kneib. 2016. <span>“Scale-Dependent Priors for Variance Parameters in Structured Additive Distributional Regression.”</span> <em>Bayesian Analysis</em> 11 (4): 1071–1106.\n</div>\n<div class=\"csl-entry\" id=\"ref-lindgren2011explicit\">\nLindgren, Finn, Håvard Rue, and Johan Lindström. 2011. <span>“<span class=\"nocase\">An explicit link between Gaussian fields and Gaussian Markov random fields: the stochastic partial differential equation approach</span>.”</span> <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 73 (4): 423–98.\n</div>\n<div class=\"csl-entry\" id=\"ref-marques2022non\">\nMarques, Isa, Thomas Kneib, and Nadja Klein. 2022. <span>“A Non-Stationary Model for Spatially Dependent Circular Response Data Based on Wrapped Gaussian Processes.”</span> <em>Statistics and Computing</em> 32 (5): 73.\n</div>\n<div class=\"csl-entry\" id=\"ref-simpson2017penalising\">\nSimpson, Daniel, Håvard Rue, Andrea Riebler, Thiago G Martins, Sigrunn H Sørbye, et al. 2017. <span>“Penalising Model Component Complexity: A Principled, Practical Approach to Constructing Priors.”</span> <em>Statistical Science</em> 32 (1): 1–28.\n</div>\n<div class=\"csl-entry\" id=\"ref-wang2014modeling\">\nWang, Fangpo, and Alan E Gelfand. 2014. <span>“<span class=\"nocase\">Modeling space and space-time directional data using projected Gaussian processes</span>.”</span> <em>Journal of the American Statistical Association</em> 109 (508): 1565–80.\n</div>\n</div>\n</div>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://youngstats.github.io/post/2023/11/22/non-stationary-wrapped-gaussian-spatial-response-model/\"> YoungStatS</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
      "main_text": "Non-stationary wrapped Gaussian spatial response model\nPosted on\nNovember 21, 2023\nby\nYoungStatS\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nYoungStatS\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nBackground\nCircular data, i.e., data defined on the unit circle, can be found in many areas of science.\nThe unique nature of these data means that conventional methods for non-circular data are not valid for these.\nAt the same time, advances in geographical information and global positioning systems have generated large amounts of spatial data and, consequently, have increased the need for spatial models that accurately describe it.\nAn example of circular, spatial data are the average wind directions in Germany from April 1 to 10, 2019, plotted in space (left) and on a circular histogram (right):\nIt was\nJona-Lasinio, Gelfand, and Jona-Lasinio (\n2012\n)\nand\nWang and Gelfand (\n2014\n)\nthat first brought the wrapped and projected Gaussian distributions to space and space-time settings.\nNonetheless, today,\ncircular data models still need to catch up on the latest advances in spatial statistics\n.\nIn particular, models developed so far\nassume stationarity in the mean and the covariance of the response\nmodeled; i.e., these are constant in space.\nOur work in\nMarques, Kneib, and Klein (\n2022\n)\naims to bridge this gap and allow for non-stationarity in the mean and covariance of distributions for circular responses defined on spatial domains.\nThe response distribution\nTo construct distributions for circular data, we can rely on the construction principle of wrapping the distribution of a random variable\n\\(Y \\in \\mathbb{R}\\)\ndefined on the real line around the unit circle to make its domain adhere to the interval\n\\([0,2\\pi]\\)\n.\nThe result is a circular – or\nwrapped\n– random variable\n\\(X \\in \\lbrack 0,2\\pi)\\)\n.\nThen, the\nunwrapped\nvariable\n\\(Y\\)\ncan be expressed as\n\\[\nY = X + 2 \\pi K\n\\]\nwhere\n\\(K \\in \\mathbb{Z}\\)\nmeasures the number of “turns”\n\\(Y\\)\nhas be wrapped around the unit circle.\nLet\n\\(\\mathbf{s}\\)\ndenote a spatial index variable within a spatial domain\n\\(S \\subset \\mathbb{R}^2\\)\n.\nJona-Lasinio, Gelfand, and Jona-Lasinio (\n2012\n)\nfirst showed that this wrapping approach can be extended to the context of spatial data.\nWe extend their framework and consider\n\\[ X(\\mathbf{s}_i) = \\beta_0 + \\mathbf{z}(\\mathbf{s}_i)' \\boldsymbol{\\beta}  +\\gamma(\\mathbf{s}_i, \\mathbf{z}^\\kappa(\\mathbf{s}_i)) + 2 \\pi K(\\mathbf{s}_i) + \\varepsilon_i ,\\]\nwhere\n\\(i=1, \\ldots,n\\)\n,\n\\(\\gamma(\\mathbf{s}_i)\\)\nis a zero-mean Gaussian random field (GRF) and\n\\(\\varepsilon_i \\sim N(0, \\sigma^2_\\varepsilon)\\)\nare the i.i.d. error terms, with the following novelties:\nThe mean depends on\n\\(\\mathbf{z}(\\mathbf{s}_i)' \\boldsymbol{\\beta}\\)\n, i.e. it is non-stationary,\nThe covariance depends on\n\\(\\mathbf{z}^\\kappa(\\mathbf{s}_i)\\)\n, i.e. it is non-stationary,\nWe include small-scale noise\n\\(\\varepsilon_i\\)\ns.\nWe focus on 1. and 2.\n1. Non-stationarity in the mean\nLinear covariates included in the mean of a circular response might induce a circular likelihood for the regression coefficients that has infinitely many maxima.\nThe typical solution is to use a link function for fixed effects with co-domain defined in\n\\(\\mathbb{R}\\)\nand of length equal to the circular variable’s period of\n\\(2\\pi\\)\n, e.g. the inverse tangent link function.\nWe argue that:\nThe winding number\n\\(K(\\mathbf{s})\\)\ncan govern the behavior of the combination of GRF and fixed effects such that no link function is needed,\nWe use prior information that shrinks towards a stationary mean and enforces the length of the fixed effects to be approximately\n\\(2\\pi\\)\n.\nConcretely,\n\\(\\beta_0 \\sim N(0, 10)\\)\nrepresents a diffuse prior for the intercept and we let\n\\(\\boldsymbol{\\beta} \\vert \\xi^2 \\sim N(\\mathbf{0}, \\xi^2 \\mathbf{I})\\)\n. One can show that\nif the base model is such that\n\\(\\xi^2 \\to 0\\)\nand the prior is constructed\naccording to the PC-prior principles\n(\nSimpson et al. 2017\n)\n, then\n\\(\\xi^2\\)\nhas a Weibull prior with shape\n\\(\\frac{1}{2}\\)\nand scale\n\\(\\lambda\\)\n, i.e.,\n\\(\\xi^2 \\sim \\text{Weibull}(\\frac{1}{2}, \\lambda)\\)\n(\nKlein and Kneib 2016\n)\n.\nFor\n\\(\\alpha \\in (0, 1)\\)\n,\n\\(\\lambda\\)\nis chosen such that\n\\[\n     P\\left( \\text{max}_{\\mathbf{s} \\in S} \\mid\n    \\mathbf{z}(\\mathbf{s})'\\boldsymbol{\\beta} \\mid \\leq\\,  \\pi \\right)\n    \\geq 1 – \\alpha,\n\\]\ni.e., the probability that the maximum norm of the non-stationary effect in the mean of the response is smaller than\n\\(\\pi\\)\nis larger than\n\\(1 – \\alpha\\)\n. The value\n\\(\\pi\\)\nin the expression is close to the recommendation of\n\\(3\\)\nin\nKlein and Kneib (\n2016\n)\n.\n2. Non-stationarity in the covariance\nThe stochastic partial differential equation (SPDE) approach\n(see\nLindgren, Rue, and Lindström 2011\n)\nallows us to model non-stationarity in the covariance of the GRF in a computationally efficient way.\nConsider the parameters of the Matérn covariance with smoothness\n\\(1\\)\nand\n\\(\\kappa\\)\nand\n\\(\\tau\\)\ncontrolling the range and the marginal variance of the GRF, respectively.\nWe let\n\\[\n\\log(\\tau) =  \\theta^\\tau_0 \\mbox{ and } \\log(\\kappa(\\mathbf{s})) =\n\\theta^\\kappa_0 + \\mathbf{z}^\\kappa(\\mathbf{s})'\\boldsymbol{\\theta}^\\kappa_z,\n\\]\nwhere uniform priors for\n\\(\\theta^\\tau_0\\)\nand\n\\(\\theta_0^\\kappa\\)\nguarantee that the marginal variance is in\n\\([0.01, (2\\pi)^2]\\)\nand the spatial range is in\n\\([0.01, 1]\\)\nfor\n\\(S \\subseteq [0, 1] \\times [0,1]\\)\n.\nOnce again, we use a simulation-based method to guarantee\n\\[\nP\\left( \\text{max}_{\\mathbf{s} \\in S} \\mid\n\\mathbf{z}^\\kappa(\\mathbf{s})'\\boldsymbol{\\theta}^\\kappa_z \\mid \\leq\\,  c \\right)\n\\geq 1 – \\alpha_\\kappa,\n\\]\nsuch that\n\\(c\\)\nguarantees that the spatial range satisfies\n\\(\\rho(\\mathbf{s}) \\in [0.01, 1]\\)\n, with typically\n\\(c = 3\\)\n(see\nKlein and Kneib 2016\n)\n. The resulting prior structure shrinks towards a model with stationary covariance.\nMore concretely, we have\n\\(\\theta^\\tau_0 \\sim U(-10, 3)\\)\n,\n\\(\\theta^\\kappa_0 \\sim U(1, 6)\\)\nand\n\\(\\boldsymbol{\\theta}_z^\\kappa \\vert \\zeta^2 \\sim N(\\mathbf{0}, \\zeta^2 \\mathbf{I})\\)\n, with\n\\(\\zeta^2 \\sim \\text{Weibull}(\\frac{1}{2}, \\lambda_\\kappa)\\)\n.\nThe full-hierarchical model\nThe SPDE is typically used in combination with integrated nested Laplace approximations (INLA). However, INLA does not perform well when combined with shrinkage priors for non-stationarity in the covariance as defined here. Thus, we use Markov Chain Monte Carlo with full-hierarchical model:\n\\[\\begin{align*}\nX(\\mathbf{s}) &= \\eta(\\mathbf{s}) + 2 \\pi K(\\mathbf{s}) +\n\\varepsilon, \\\\\n&= \\beta_0 + \\mathbf{z}(\\mathbf{s})' \\boldsymbol{\\beta} + \\gamma(\\mathbf{s}, \\mathbf{z}^\\kappa(\\mathbf{s})) + 2 \\pi K(\\mathbf{s}) +\n\\varepsilon,\\\\\n\\beta_0 &\\sim N(0, 10) ,\\mbox{ }  \\boldsymbol{\\beta} \\vert \\xi^2 \\sim N(0, \\xi^2 \\mathbf{I}), \\mbox{ }\\boldsymbol{\\gamma} \\vert  \\boldsymbol{\\theta} \\sim N(\\mathbf{0}, \\mathbf{Q}^{-1}(\\boldsymbol{\\theta})) \\\\\n\\theta_0^\\tau &\\sim U(-10, 3) ,\\mbox{ }\n\\theta_0^\\kappa \\sim U(1, 6) ,\\mbox{ }\n\\boldsymbol{\\theta}^\\kappa_z  \\vert  \\zeta^2 \\sim N(\\mathbf{0}, \\zeta^2 \\mathbf{I}) \\\\\n\\xi^2 &\\sim PC\\left(\\pi, \\alpha \\right) ,\\mbox{ }\n\\zeta^2 \\sim PC\\left(3, \\alpha_\\kappa \\right) \\\\\n\\mathbf{\\varepsilon}  \\vert \\sigma^2_\\varepsilon &\\sim N(\\mathbf{0}, \\sigma^2_\\varepsilon \\mathbf{I}) ,\\mbox{ }\n\\sigma^2_\\varepsilon \\sim IG (0.001, 0.001)\\\\\n    p(K(\\mathbf{s})) &=\n\\begin{cases}\n    \\frac{1}{3},& \\text{if } K(\\mathbf{s}) \\in \\lbrace -1, 0, 1 \\rbrace\\\\\n    0,              & \\text{otherwise}\n\\end{cases}\n\\end{align*}\\]\nOutcome\nOne can use our model to estimate wind directions in the dataset above and test the model’s performance.\nWe randomly select a holdout set consisting of\n\\(20\\%\\)\nof the locations and use the remaining\n\\(80\\%\\)\nas training data.\nThe covariates considered for\n\\(\\mathbf{z}(\\mathbf{s})\\)\nare maximum wind speed, average air humidity, and temperature at 10 meters height. For\n\\(\\mathbf{z^\\kappa}(\\mathbf{s})\\)\nwe consider altitude and latitude.\nThe figure below shows the posterior predictive mean (left) and standard deviation (right) for each test location for a fully stationary, i.e., stationary mean and covariance and fully non-stationary models.\nThe black arrows represent the true wind directions (left) and the corresponding standard deviation of zero (right).\nThe figure shows that the fully non-stationary model reaches smaller bias than the fully stationary model throughout the whole domain. In the north where this bias is close to zero, our model also reaches lower uncertainty.\nAbout the authors\nIsa Marques\nThomas Kneib\nNadja Klein\nReferences\nJona-Lasinio, Giovanna, Alan Gelfand, and Mattia Jona-Lasinio. 2012.\n“\nSpatial analysis of wave direction data using wrapped Gaussian processes\n.”\nThe Annals of Applied Statistics\n6 (4): 1478–98.\nKlein, Nadja, and Thomas Kneib. 2016.\n“Scale-Dependent Priors for Variance Parameters in Structured Additive Distributional Regression.”\nBayesian Analysis\n11 (4): 1071–1106.\nLindgren, Finn, Håvard Rue, and Johan Lindström. 2011.\n“\nAn explicit link between Gaussian fields and Gaussian Markov random fields: the stochastic partial differential equation approach\n.”\nJournal of the Royal Statistical Society: Series B (Statistical Methodology)\n73 (4): 423–98.\nMarques, Isa, Thomas Kneib, and Nadja Klein. 2022.\n“A Non-Stationary Model for Spatially Dependent Circular Response Data Based on Wrapped Gaussian Processes.”\nStatistics and Computing\n32 (5): 73.\nSimpson, Daniel, Håvard Rue, Andrea Riebler, Thiago G Martins, Sigrunn H Sørbye, et al. 2017.\n“Penalising Model Component Complexity: A Principled, Practical Approach to Constructing Priors.”\nStatistical Science\n32 (1): 1–28.\nWang, Fangpo, and Alan E Gelfand. 2014.\n“\nModeling space and space-time directional data using projected Gaussian processes\n.”\nJournal of the American Statistical Association\n109 (508): 1565–80.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nYoungStatS\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "Background Circular data, i.e., data defined on the unit circle, can be found in many areas of science. The unique nature of these data means that conventional methods for non-circular data are not valid for these. At the same time, advances in geographical information and global positioning systems have generated large amounts of spatial data and, consequently, have increased the need for spatial models that accurately describe it. An example of circular, spatial data are the average wind directions in Germany from April 1 to 10, 2019, plotted in space (left) and on a circular histogram (right): It was Jona-Lasinio, Gelfand, and Jona-Lasinio (2012) and Wang and Gelfand (2014) that first brought the wrapped and projected Gaussian distributions to space and space-time settings. Nonetheless, today,circular data models still need to catch up on the latest advances in spatial statistics. In particular, models developed so far assume stationarity in the mean and the covariance of the response modeled; i.e., these are constant in space. Our work in Marques, Kneib, and Klein (2022) aims to bridge this gap and allow for non-stationarity in the mean and covariance of distributions for circular responses defined on spatial domains. The response distribution To construct distributions for circular data, we can rely on the construction principle of wrapping the distribution of a random variable \\(Y \\in \\mathbb{R}\\) defined on the real line around the unit circle to make its domain adhere to the interval \\([0,2\\pi]\\). The result is a circular – or wrapped – random variable \\(X \\in \\lbrack 0,2\\pi)\\). Then, the unwrapped variable \\(Y\\) can be expressed as \\[ Y = X + 2 \\pi K \\] where \\(K \\in \\mathbb{Z}\\) measures the number of “turns” \\(Y\\) has be wrapped around the unit circle. Let \\(\\mathbf{s}\\) denote a spatial index variable within a spatial domain \\(S \\subset \\mathbb{R}^2\\). Jona-Lasinio, Gelfand, and Jona-Lasinio (2012) first showed that this wrapping approach can be extended to the context of spatial data. We extend their framework and consider \\[ X(\\mathbf{s}_i) = \\beta_0 + \\mathbf{z}(\\mathbf{s}_i)' \\boldsymbol{\\beta} +\\gamma(\\mathbf{s}_i, \\mathbf{z}^\\kappa(\\mathbf{s}_i)) + 2 \\pi K(\\mathbf{s}_i) + \\varepsilon_i ,\\] where \\(i=1, \\ldots,n\\), \\(\\gamma(\\mathbf{s}_i)\\) is a zero-mean Gaussian random field (GRF) and \\(\\varepsilon_i \\sim N(0, \\sigma^2_\\varepsilon)\\) are the i.i.d. error terms, with the following novelties: The mean depends on \\(\\mathbf{z}(\\mathbf{s}_i)' \\boldsymbol{\\beta}\\), i.e. it is non-stationary, The covariance depends on \\(\\mathbf{z}^\\kappa(\\mathbf{s}_i)\\), i.e. it is non-stationary, We include small-scale noise \\(\\varepsilon_i\\)s. We focus on 1. and 2. 1. Non-stationarity in the mean Linear covariates included in the mean of a circular response might induce a circular likelihood for the regression coefficients that has infinitely many maxima. The typical solution is to use a link function for fixed effects with co-domain defined in \\(\\mathbb{R}\\) and of length equal to the circular variable’s period of \\(2\\pi\\), e.g. the inverse tangent link function. We argue that: The winding number \\(K(\\mathbf{s})\\) can govern the behavior of the combination of GRF and fixed effects such that no link function is needed, We use prior information that shrinks towards a stationary mean and enforces the length of the fixed effects to be approximately \\(2\\pi\\). Concretely, \\(\\beta_0 \\sim N(0, 10)\\) represents a diffuse prior for the intercept and we let \\(\\boldsymbol{\\beta} \\vert \\xi^2 \\sim N(\\mathbf{0}, \\xi^2 \\mathbf{I})\\). One can show that if the base model is such that \\(\\xi^2 \\to 0\\) and the prior is constructed according to the PC-prior principles (Simpson et al. 2017), then \\(\\xi^2\\) has a Weibull prior with shape \\(\\frac{1}{2}\\) and scale \\(\\lambda\\), i.e., \\(\\xi^2 \\sim \\text{Weibull}(\\frac{1}{2}, \\lambda)\\) (Klein and Kneib 2016). For \\(\\alpha \\in (0, 1)\\), \\(\\lambda\\) is chosen such that \\[ P\\left( \\text{max}_{\\mathbf{s} \\in S} \\mid \\mathbf{z}(\\mathbf{s})'\\boldsymbol{\\beta} \\mid \\leq\\, \\pi \\right) \\geq 1 - \\alpha, \\] i.e., the probability that the maximum norm of the non-stationary effect in the mean of the response is smaller than \\(\\pi\\) is larger than \\(1 - \\alpha\\). The value \\(\\pi\\) in the expression is close to the recommendation of \\(3\\) in Klein and Kneib (2016). 2. Non-stationarity in the covariance The stochastic partial differential equation (SPDE) approach (see Lindgren, Rue, and Lindström 2011) allows us to model non-stationarity in the covariance of the GRF in a computationally efficient way. Consider the parameters of the Matérn covariance with smoothness \\(1\\) and \\(\\kappa\\) and \\(\\tau\\) controlling the range and the marginal variance of the GRF, respectively. We let \\[ \\log(\\tau) = \\theta^\\tau_0 \\mbox{ and } \\log(\\kappa(\\mathbf{s})) = \\theta^\\kappa_0 + \\mathbf{z}^\\kappa(\\mathbf{s})'\\boldsymbol{\\theta}^\\kappa_z, \\] where uniform priors for \\(\\theta^\\tau_0\\) and \\(\\theta_0^\\kappa\\) guarantee that the marginal variance is in \\([0.01, (2\\pi)^2]\\) and the spatial range is in \\([0.01, 1]\\) for \\(S \\subseteq [0, 1] \\times [0,1]\\). Once again, we use a simulation-based method to guarantee \\[ P\\left( \\text{max}_{\\mathbf{s} \\in S} \\mid \\mathbf{z}^\\kappa(\\mathbf{s})'\\boldsymbol{\\theta}^\\kappa_z \\mid \\leq\\, c \\right) \\geq 1 - \\alpha_\\kappa, \\] such that \\(c\\) guarantees that the spatial range satisfies \\(\\rho(\\mathbf{s}) \\in [0.01, 1]\\), with typically \\(c = 3\\) (see Klein and Kneib 2016). The resulting prior structure shrinks towards a model with stationary covariance. More concretely, we have \\(\\theta^\\tau_0 \\sim U(-10, 3)\\), \\(\\theta^\\kappa_0 \\sim U(1, 6)\\) and \\(\\boldsymbol{\\theta}_z^\\kappa \\vert \\zeta^2 \\sim N(\\mathbf{0}, \\zeta^2 \\mathbf{I})\\), with \\(\\zeta^2 \\sim \\text{Weibull}(\\frac{1}{2}, \\lambda_\\kappa)\\). The full-hierarchical model The SPDE is typically used in combination with integrated nested Laplace approximations (INLA). However, INLA does not perform well when combined with shrinkage priors for non-stationarity in the covariance as defined here. Thus, we use Markov Chain Monte Carlo with full-hierarchical model: \\[\\begin{align*} X(\\mathbf{s}) &= \\eta(\\mathbf{s}) + 2 \\pi K(\\mathbf{s}) + \\varepsilon, \\ &= \\beta_0 + \\mathbf{z}(\\mathbf{s})' \\boldsymbol{\\beta} + \\gamma(\\mathbf{s}, \\mathbf{z}^\\kappa(\\mathbf{s})) + 2 \\pi K(\\mathbf{s}) + \\varepsilon,\\ \\beta_0 &\\sim N(0, 10) ,\\mbox{ } \\boldsymbol{\\beta} \\vert \\xi^2 \\sim N(0, \\xi^2 \\mathbf{I}), \\mbox{ }\\boldsymbol{\\gamma} \\vert \\boldsymbol{\\theta} \\sim N(\\mathbf{0}, \\mathbf{Q}^{-1}(\\boldsymbol{\\theta})) \\ \\theta_0^\\tau &\\sim U(-10, 3) ,\\mbox{ } \\theta_0^\\kappa \\sim U(1, 6) ,\\mbox{ } \\boldsymbol{\\theta}^\\kappa_z \\vert \\zeta^2 \\sim N(\\mathbf{0}, \\zeta^2 \\mathbf{I}) \\ \\xi^2 &\\sim PC\\left(\\pi, \\alpha \\right) ,\\mbox{ } \\zeta^2 \\sim PC\\left(3, \\alpha_\\kappa \\right) \\ \\mathbf{\\varepsilon} \\vert \\sigma^2_\\varepsilon &\\sim N(\\mathbf{0}, \\sigma^2_\\varepsilon \\mathbf{I}) ,\\mbox{ } \\sigma^2_\\varepsilon \\sim IG (0.001, 0.001)\\ p(K(\\mathbf{s})) &= \\begin{cases} \\frac{1}{3},& \\text{if } K(\\mathbf{s}) \\in \\lbrace -1, 0, 1 \\rbrace\\ 0, & \\text{otherwise} \\end{cases} \\end{align*}\\] Outcome One can use our model to estimate wind directions in the dataset above and test the model’s performance. We randomly select a holdout set consisting of \\(20\\%\\) of the locations and use the remaining \\(80\\%\\) as training data. The covariates considered for \\(\\mathbf{z}(\\mathbf{s})\\) are maximum wind speed, average air humidity, and temperature at 10 meters height. For \\(\\mathbf{z^\\kappa}(\\mathbf{s})\\) we consider altitude and latitude. The figure below shows the posterior predictive mean (left) and standard deviation (right) for each test location for a fully stationary, i.e., stationary mean and covariance and fully non-stationary models. The black arrows represent the true wind directions (left) and the corresponding standard deviation of zero (right). The figure shows that the fully non-stationary model reaches smaller bias than the fully stationary model throughout the whole domain. In the north where this bias is close to zero, our model also reaches lower uncertainty. About the authors Isa Marques Thomas Kneib Nadja Klein References Jona-Lasinio, Giovanna, Alan Gelfand, and Mattia Jona-Lasinio. 2012. “Spatial analysis of wave direction data using wrapped Gaussian processes.” The Annals of Applied Statistics 6 (4): 1478–98. Klein, Nadja, and Thomas Kneib. 2016. “Scale-Dependent Priors for Variance Parameters in Structured Additive Distributional Regression.” Bayesian Analysis 11 (4): 1071–1106. Lindgren, Finn, Håvard Rue, and Johan Lindström. 2011. “An explicit link between Gaussian fields and Gaussian Markov random fields: the stochastic partial differential equation approach.” Journal of the Royal Statistical Society: Series B (Statistical Methodology) 73 (4): 423–98. Marques, Isa, Thomas Kneib, and Nadja Klein. 2022. “A Non-Stationary Model for Spatially Dependent Circular Response Data Based on Wrapped Gaussian Processes.” Statistics and Computing 32 (5): 73. Simpson, Daniel, Håvard Rue, Andrea Riebler, Thiago G Martins, Sigrunn H Sørbye, et al. 2017. “Penalising Model Component Complexity: A Principled, Practical Approach to Constructing Priors.” Statistical Science 32 (1): 1–28. Wang, Fangpo, and Alan E Gelfand. 2014. “Modeling space and space-time directional data using projected Gaussian processes.” Journal of the American Statistical Association 109 (508): 1565–80.",
      "meta_keywords": null,
      "og_description": "Background Circular data, i.e., data defined on the unit circle, can be found in many areas of science. The unique nature of these data means that conventional methods for non-circular data are not valid for these. At the same time, advances in geographical information and global positioning systems have generated large amounts of spatial data and, consequently, have increased the need for spatial models that accurately describe it. An example of circular, spatial data are the average wind directions in Germany from April 1 to 10, 2019, plotted in space (left) and on a circular histogram (right): It was Jona-Lasinio, Gelfand, and Jona-Lasinio (2012) and Wang and Gelfand (2014) that first brought the wrapped and projected Gaussian distributions to space and space-time settings. Nonetheless, today,circular data models still need to catch up on the latest advances in spatial statistics. In particular, models developed so far assume stationarity in the mean and the covariance of the response modeled; i.e., these are constant in space. Our work in Marques, Kneib, and Klein (2022) aims to bridge this gap and allow for non-stationarity in the mean and covariance of distributions for circular responses defined on spatial domains. The response distribution To construct distributions for circular data, we can rely on the construction principle of wrapping the distribution of a random variable \\(Y \\in \\mathbb{R}\\) defined on the real line around the unit circle to make its domain adhere to the interval \\([0,2\\pi]\\). The result is a circular – or wrapped – random variable \\(X \\in \\lbrack 0,2\\pi)\\). Then, the unwrapped variable \\(Y\\) can be expressed as \\[ Y = X + 2 \\pi K \\] where \\(K \\in \\mathbb{Z}\\) measures the number of “turns” \\(Y\\) has be wrapped around the unit circle. Let \\(\\mathbf{s}\\) denote a spatial index variable within a spatial domain \\(S \\subset \\mathbb{R}^2\\). Jona-Lasinio, Gelfand, and Jona-Lasinio (2012) first showed that this wrapping approach can be extended to the context of spatial data. We extend their framework and consider \\[ X(\\mathbf{s}_i) = \\beta_0 + \\mathbf{z}(\\mathbf{s}_i)' \\boldsymbol{\\beta} +\\gamma(\\mathbf{s}_i, \\mathbf{z}^\\kappa(\\mathbf{s}_i)) + 2 \\pi K(\\mathbf{s}_i) + \\varepsilon_i ,\\] where \\(i=1, \\ldots,n\\), \\(\\gamma(\\mathbf{s}_i)\\) is a zero-mean Gaussian random field (GRF) and \\(\\varepsilon_i \\sim N(0, \\sigma^2_\\varepsilon)\\) are the i.i.d. error terms, with the following novelties: The mean depends on \\(\\mathbf{z}(\\mathbf{s}_i)' \\boldsymbol{\\beta}\\), i.e. it is non-stationary, The covariance depends on \\(\\mathbf{z}^\\kappa(\\mathbf{s}_i)\\), i.e. it is non-stationary, We include small-scale noise \\(\\varepsilon_i\\)s. We focus on 1. and 2. 1. Non-stationarity in the mean Linear covariates included in the mean of a circular response might induce a circular likelihood for the regression coefficients that has infinitely many maxima. The typical solution is to use a link function for fixed effects with co-domain defined in \\(\\mathbb{R}\\) and of length equal to the circular variable’s period of \\(2\\pi\\), e.g. the inverse tangent link function. We argue that: The winding number \\(K(\\mathbf{s})\\) can govern the behavior of the combination of GRF and fixed effects such that no link function is needed, We use prior information that shrinks towards a stationary mean and enforces the length of the fixed effects to be approximately \\(2\\pi\\). Concretely, \\(\\beta_0 \\sim N(0, 10)\\) represents a diffuse prior for the intercept and we let \\(\\boldsymbol{\\beta} \\vert \\xi^2 \\sim N(\\mathbf{0}, \\xi^2 \\mathbf{I})\\). One can show that if the base model is such that \\(\\xi^2 \\to 0\\) and the prior is constructed according to the PC-prior principles (Simpson et al. 2017), then \\(\\xi^2\\) has a Weibull prior with shape \\(\\frac{1}{2}\\) and scale \\(\\lambda\\), i.e., \\(\\xi^2 \\sim \\text{Weibull}(\\frac{1}{2}, \\lambda)\\) (Klein and Kneib 2016). For \\(\\alpha \\in (0, 1)\\), \\(\\lambda\\) is chosen such that \\[ P\\left( \\text{max}_{\\mathbf{s} \\in S} \\mid \\mathbf{z}(\\mathbf{s})'\\boldsymbol{\\beta} \\mid \\leq\\, \\pi \\right) \\geq 1 - \\alpha, \\] i.e., the probability that the maximum norm of the non-stationary effect in the mean of the response is smaller than \\(\\pi\\) is larger than \\(1 - \\alpha\\). The value \\(\\pi\\) in the expression is close to the recommendation of \\(3\\) in Klein and Kneib (2016). 2. Non-stationarity in the covariance The stochastic partial differential equation (SPDE) approach (see Lindgren, Rue, and Lindström 2011) allows us to model non-stationarity in the covariance of the GRF in a computationally efficient way. Consider the parameters of the Matérn covariance with smoothness \\(1\\) and \\(\\kappa\\) and \\(\\tau\\) controlling the range and the marginal variance of the GRF, respectively. We let \\[ \\log(\\tau) = \\theta^\\tau_0 \\mbox{ and } \\log(\\kappa(\\mathbf{s})) = \\theta^\\kappa_0 + \\mathbf{z}^\\kappa(\\mathbf{s})'\\boldsymbol{\\theta}^\\kappa_z, \\] where uniform priors for \\(\\theta^\\tau_0\\) and \\(\\theta_0^\\kappa\\) guarantee that the marginal variance is in \\([0.01, (2\\pi)^2]\\) and the spatial range is in \\([0.01, 1]\\) for \\(S \\subseteq [0, 1] \\times [0,1]\\). Once again, we use a simulation-based method to guarantee \\[ P\\left( \\text{max}_{\\mathbf{s} \\in S} \\mid \\mathbf{z}^\\kappa(\\mathbf{s})'\\boldsymbol{\\theta}^\\kappa_z \\mid \\leq\\, c \\right) \\geq 1 - \\alpha_\\kappa, \\] such that \\(c\\) guarantees that the spatial range satisfies \\(\\rho(\\mathbf{s}) \\in [0.01, 1]\\), with typically \\(c = 3\\) (see Klein and Kneib 2016). The resulting prior structure shrinks towards a model with stationary covariance. More concretely, we have \\(\\theta^\\tau_0 \\sim U(-10, 3)\\), \\(\\theta^\\kappa_0 \\sim U(1, 6)\\) and \\(\\boldsymbol{\\theta}_z^\\kappa \\vert \\zeta^2 \\sim N(\\mathbf{0}, \\zeta^2 \\mathbf{I})\\), with \\(\\zeta^2 \\sim \\text{Weibull}(\\frac{1}{2}, \\lambda_\\kappa)\\). The full-hierarchical model The SPDE is typically used in combination with integrated nested Laplace approximations (INLA). However, INLA does not perform well when combined with shrinkage priors for non-stationarity in the covariance as defined here. Thus, we use Markov Chain Monte Carlo with full-hierarchical model: \\[\\begin{align*} X(\\mathbf{s}) &= \\eta(\\mathbf{s}) + 2 \\pi K(\\mathbf{s}) + \\varepsilon, \\ &= \\beta_0 + \\mathbf{z}(\\mathbf{s})' \\boldsymbol{\\beta} + \\gamma(\\mathbf{s}, \\mathbf{z}^\\kappa(\\mathbf{s})) + 2 \\pi K(\\mathbf{s}) + \\varepsilon,\\ \\beta_0 &\\sim N(0, 10) ,\\mbox{ } \\boldsymbol{\\beta} \\vert \\xi^2 \\sim N(0, \\xi^2 \\mathbf{I}), \\mbox{ }\\boldsymbol{\\gamma} \\vert \\boldsymbol{\\theta} \\sim N(\\mathbf{0}, \\mathbf{Q}^{-1}(\\boldsymbol{\\theta})) \\ \\theta_0^\\tau &\\sim U(-10, 3) ,\\mbox{ } \\theta_0^\\kappa \\sim U(1, 6) ,\\mbox{ } \\boldsymbol{\\theta}^\\kappa_z \\vert \\zeta^2 \\sim N(\\mathbf{0}, \\zeta^2 \\mathbf{I}) \\ \\xi^2 &\\sim PC\\left(\\pi, \\alpha \\right) ,\\mbox{ } \\zeta^2 \\sim PC\\left(3, \\alpha_\\kappa \\right) \\ \\mathbf{\\varepsilon} \\vert \\sigma^2_\\varepsilon &\\sim N(\\mathbf{0}, \\sigma^2_\\varepsilon \\mathbf{I}) ,\\mbox{ } \\sigma^2_\\varepsilon \\sim IG (0.001, 0.001)\\ p(K(\\mathbf{s})) &= \\begin{cases} \\frac{1}{3},& \\text{if } K(\\mathbf{s}) \\in \\lbrace -1, 0, 1 \\rbrace\\ 0, & \\text{otherwise} \\end{cases} \\end{align*}\\] Outcome One can use our model to estimate wind directions in the dataset above and test the model’s performance. We randomly select a holdout set consisting of \\(20\\%\\) of the locations and use the remaining \\(80\\%\\) as training data. The covariates considered for \\(\\mathbf{z}(\\mathbf{s})\\) are maximum wind speed, average air humidity, and temperature at 10 meters height. For \\(\\mathbf{z^\\kappa}(\\mathbf{s})\\) we consider altitude and latitude. The figure below shows the posterior predictive mean (left) and standard deviation (right) for each test location for a fully stationary, i.e., stationary mean and covariance and fully non-stationary models. The black arrows represent the true wind directions (left) and the corresponding standard deviation of zero (right). The figure shows that the fully non-stationary model reaches smaller bias than the fully stationary model throughout the whole domain. In the north where this bias is close to zero, our model also reaches lower uncertainty. About the authors Isa Marques Thomas Kneib Nadja Klein References Jona-Lasinio, Giovanna, Alan Gelfand, and Mattia Jona-Lasinio. 2012. “Spatial analysis of wave direction data using wrapped Gaussian processes.” The Annals of Applied Statistics 6 (4): 1478–98. Klein, Nadja, and Thomas Kneib. 2016. “Scale-Dependent Priors for Variance Parameters in Structured Additive Distributional Regression.” Bayesian Analysis 11 (4): 1071–1106. Lindgren, Finn, Håvard Rue, and Johan Lindström. 2011. “An explicit link between Gaussian fields and Gaussian Markov random fields: the stochastic partial differential equation approach.” Journal of the Royal Statistical Society: Series B (Statistical Methodology) 73 (4): 423–98. Marques, Isa, Thomas Kneib, and Nadja Klein. 2022. “A Non-Stationary Model for Spatially Dependent Circular Response Data Based on Wrapped Gaussian Processes.” Statistics and Computing 32 (5): 73. Simpson, Daniel, Håvard Rue, Andrea Riebler, Thiago G Martins, Sigrunn H Sørbye, et al. 2017. “Penalising Model Component Complexity: A Principled, Practical Approach to Constructing Priors.” Statistical Science 32 (1): 1–28. Wang, Fangpo, and Alan E Gelfand. 2014. “Modeling space and space-time directional data using projected Gaussian processes.” Journal of the American Statistical Association 109 (508): 1565–80.",
      "og_image": "https://youngstats.github.io/post/2023-11-22-non-stationary-wrapped-gaussian-spatial-response-model_files/plot_calm-horz.png",
      "og_title": "Non-stationary wrapped Gaussian spatial response model | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 8.4,
      "sitemap_lastmod": "2023-11-22T00:00:00+00:00",
      "twitter_description": "Background Circular data, i.e., data defined on the unit circle, can be found in many areas of science. The unique nature of these data means that conventional methods for non-circular data are not valid for these. At the same time, advances in geographical information and global positioning systems have generated large amounts of spatial data and, consequently, have increased the need for spatial models that accurately describe it. An example of circular, spatial data are the average wind directions in Germany from April 1 to 10, 2019, plotted in space (left) and on a circular histogram (right): It was Jona-Lasinio, Gelfand, and Jona-Lasinio (2012) and Wang and Gelfand (2014) that first brought the wrapped and projected Gaussian distributions to space and space-time settings. Nonetheless, today,circular data models still need to catch up on the latest advances in spatial statistics. In particular, models developed so far assume stationarity in the mean and the covariance of the response modeled; i.e., these are constant in space. Our work in Marques, Kneib, and Klein (2022) aims to bridge this gap and allow for non-stationarity in the mean and covariance of distributions for circular responses defined on spatial domains. The response distribution To construct distributions for circular data, we can rely on the construction principle of wrapping the distribution of a random variable \\(Y \\in \\mathbb{R}\\) defined on the real line around the unit circle to make its domain adhere to the interval \\([0,2\\pi]\\). The result is a circular – or wrapped – random variable \\(X \\in \\lbrack 0,2\\pi)\\). Then, the unwrapped variable \\(Y\\) can be expressed as \\[ Y = X + 2 \\pi K \\] where \\(K \\in \\mathbb{Z}\\) measures the number of “turns” \\(Y\\) has be wrapped around the unit circle. Let \\(\\mathbf{s}\\) denote a spatial index variable within a spatial domain \\(S \\subset \\mathbb{R}^2\\). Jona-Lasinio, Gelfand, and Jona-Lasinio (2012) first showed that this wrapping approach can be extended to the context of spatial data. We extend their framework and consider \\[ X(\\mathbf{s}_i) = \\beta_0 + \\mathbf{z}(\\mathbf{s}_i)' \\boldsymbol{\\beta} +\\gamma(\\mathbf{s}_i, \\mathbf{z}^\\kappa(\\mathbf{s}_i)) + 2 \\pi K(\\mathbf{s}_i) + \\varepsilon_i ,\\] where \\(i=1, \\ldots,n\\), \\(\\gamma(\\mathbf{s}_i)\\) is a zero-mean Gaussian random field (GRF) and \\(\\varepsilon_i \\sim N(0, \\sigma^2_\\varepsilon)\\) are the i.i.d. error terms, with the following novelties: The mean depends on \\(\\mathbf{z}(\\mathbf{s}_i)' \\boldsymbol{\\beta}\\), i.e. it is non-stationary, The covariance depends on \\(\\mathbf{z}^\\kappa(\\mathbf{s}_i)\\), i.e. it is non-stationary, We include small-scale noise \\(\\varepsilon_i\\)s. We focus on 1. and 2. 1. Non-stationarity in the mean Linear covariates included in the mean of a circular response might induce a circular likelihood for the regression coefficients that has infinitely many maxima. The typical solution is to use a link function for fixed effects with co-domain defined in \\(\\mathbb{R}\\) and of length equal to the circular variable’s period of \\(2\\pi\\), e.g. the inverse tangent link function. We argue that: The winding number \\(K(\\mathbf{s})\\) can govern the behavior of the combination of GRF and fixed effects such that no link function is needed, We use prior information that shrinks towards a stationary mean and enforces the length of the fixed effects to be approximately \\(2\\pi\\). Concretely, \\(\\beta_0 \\sim N(0, 10)\\) represents a diffuse prior for the intercept and we let \\(\\boldsymbol{\\beta} \\vert \\xi^2 \\sim N(\\mathbf{0}, \\xi^2 \\mathbf{I})\\). One can show that if the base model is such that \\(\\xi^2 \\to 0\\) and the prior is constructed according to the PC-prior principles (Simpson et al. 2017), then \\(\\xi^2\\) has a Weibull prior with shape \\(\\frac{1}{2}\\) and scale \\(\\lambda\\), i.e., \\(\\xi^2 \\sim \\text{Weibull}(\\frac{1}{2}, \\lambda)\\) (Klein and Kneib 2016). For \\(\\alpha \\in (0, 1)\\), \\(\\lambda\\) is chosen such that \\[ P\\left( \\text{max}_{\\mathbf{s} \\in S} \\mid \\mathbf{z}(\\mathbf{s})'\\boldsymbol{\\beta} \\mid \\leq\\, \\pi \\right) \\geq 1 - \\alpha, \\] i.e., the probability that the maximum norm of the non-stationary effect in the mean of the response is smaller than \\(\\pi\\) is larger than \\(1 - \\alpha\\). The value \\(\\pi\\) in the expression is close to the recommendation of \\(3\\) in Klein and Kneib (2016). 2. Non-stationarity in the covariance The stochastic partial differential equation (SPDE) approach (see Lindgren, Rue, and Lindström 2011) allows us to model non-stationarity in the covariance of the GRF in a computationally efficient way. Consider the parameters of the Matérn covariance with smoothness \\(1\\) and \\(\\kappa\\) and \\(\\tau\\) controlling the range and the marginal variance of the GRF, respectively. We let \\[ \\log(\\tau) = \\theta^\\tau_0 \\mbox{ and } \\log(\\kappa(\\mathbf{s})) = \\theta^\\kappa_0 + \\mathbf{z}^\\kappa(\\mathbf{s})'\\boldsymbol{\\theta}^\\kappa_z, \\] where uniform priors for \\(\\theta^\\tau_0\\) and \\(\\theta_0^\\kappa\\) guarantee that the marginal variance is in \\([0.01, (2\\pi)^2]\\) and the spatial range is in \\([0.01, 1]\\) for \\(S \\subseteq [0, 1] \\times [0,1]\\). Once again, we use a simulation-based method to guarantee \\[ P\\left( \\text{max}_{\\mathbf{s} \\in S} \\mid \\mathbf{z}^\\kappa(\\mathbf{s})'\\boldsymbol{\\theta}^\\kappa_z \\mid \\leq\\, c \\right) \\geq 1 - \\alpha_\\kappa, \\] such that \\(c\\) guarantees that the spatial range satisfies \\(\\rho(\\mathbf{s}) \\in [0.01, 1]\\), with typically \\(c = 3\\) (see Klein and Kneib 2016). The resulting prior structure shrinks towards a model with stationary covariance. More concretely, we have \\(\\theta^\\tau_0 \\sim U(-10, 3)\\), \\(\\theta^\\kappa_0 \\sim U(1, 6)\\) and \\(\\boldsymbol{\\theta}_z^\\kappa \\vert \\zeta^2 \\sim N(\\mathbf{0}, \\zeta^2 \\mathbf{I})\\), with \\(\\zeta^2 \\sim \\text{Weibull}(\\frac{1}{2}, \\lambda_\\kappa)\\). The full-hierarchical model The SPDE is typically used in combination with integrated nested Laplace approximations (INLA). However, INLA does not perform well when combined with shrinkage priors for non-stationarity in the covariance as defined here. Thus, we use Markov Chain Monte Carlo with full-hierarchical model: \\[\\begin{align*} X(\\mathbf{s}) &= \\eta(\\mathbf{s}) + 2 \\pi K(\\mathbf{s}) + \\varepsilon, \\ &= \\beta_0 + \\mathbf{z}(\\mathbf{s})' \\boldsymbol{\\beta} + \\gamma(\\mathbf{s}, \\mathbf{z}^\\kappa(\\mathbf{s})) + 2 \\pi K(\\mathbf{s}) + \\varepsilon,\\ \\beta_0 &\\sim N(0, 10) ,\\mbox{ } \\boldsymbol{\\beta} \\vert \\xi^2 \\sim N(0, \\xi^2 \\mathbf{I}), \\mbox{ }\\boldsymbol{\\gamma} \\vert \\boldsymbol{\\theta} \\sim N(\\mathbf{0}, \\mathbf{Q}^{-1}(\\boldsymbol{\\theta})) \\ \\theta_0^\\tau &\\sim U(-10, 3) ,\\mbox{ } \\theta_0^\\kappa \\sim U(1, 6) ,\\mbox{ } \\boldsymbol{\\theta}^\\kappa_z \\vert \\zeta^2 \\sim N(\\mathbf{0}, \\zeta^2 \\mathbf{I}) \\ \\xi^2 &\\sim PC\\left(\\pi, \\alpha \\right) ,\\mbox{ } \\zeta^2 \\sim PC\\left(3, \\alpha_\\kappa \\right) \\ \\mathbf{\\varepsilon} \\vert \\sigma^2_\\varepsilon &\\sim N(\\mathbf{0}, \\sigma^2_\\varepsilon \\mathbf{I}) ,\\mbox{ } \\sigma^2_\\varepsilon \\sim IG (0.001, 0.001)\\ p(K(\\mathbf{s})) &= \\begin{cases} \\frac{1}{3},& \\text{if } K(\\mathbf{s}) \\in \\lbrace -1, 0, 1 \\rbrace\\ 0, & \\text{otherwise} \\end{cases} \\end{align*}\\] Outcome One can use our model to estimate wind directions in the dataset above and test the model’s performance. We randomly select a holdout set consisting of \\(20\\%\\) of the locations and use the remaining \\(80\\%\\) as training data. The covariates considered for \\(\\mathbf{z}(\\mathbf{s})\\) are maximum wind speed, average air humidity, and temperature at 10 meters height. For \\(\\mathbf{z^\\kappa}(\\mathbf{s})\\) we consider altitude and latitude. The figure below shows the posterior predictive mean (left) and standard deviation (right) for each test location for a fully stationary, i.e., stationary mean and covariance and fully non-stationary models. The black arrows represent the true wind directions (left) and the corresponding standard deviation of zero (right). The figure shows that the fully non-stationary model reaches smaller bias than the fully stationary model throughout the whole domain. In the north where this bias is close to zero, our model also reaches lower uncertainty. About the authors Isa Marques Thomas Kneib Nadja Klein References Jona-Lasinio, Giovanna, Alan Gelfand, and Mattia Jona-Lasinio. 2012. “Spatial analysis of wave direction data using wrapped Gaussian processes.” The Annals of Applied Statistics 6 (4): 1478–98. Klein, Nadja, and Thomas Kneib. 2016. “Scale-Dependent Priors for Variance Parameters in Structured Additive Distributional Regression.” Bayesian Analysis 11 (4): 1071–1106. Lindgren, Finn, Håvard Rue, and Johan Lindström. 2011. “An explicit link between Gaussian fields and Gaussian Markov random fields: the stochastic partial differential equation approach.” Journal of the Royal Statistical Society: Series B (Statistical Methodology) 73 (4): 423–98. Marques, Isa, Thomas Kneib, and Nadja Klein. 2022. “A Non-Stationary Model for Spatially Dependent Circular Response Data Based on Wrapped Gaussian Processes.” Statistics and Computing 32 (5): 73. Simpson, Daniel, Håvard Rue, Andrea Riebler, Thiago G Martins, Sigrunn H Sørbye, et al. 2017. “Penalising Model Component Complexity: A Principled, Practical Approach to Constructing Priors.” Statistical Science 32 (1): 1–28. Wang, Fangpo, and Alan E Gelfand. 2014. “Modeling space and space-time directional data using projected Gaussian processes.” Journal of the American Statistical Association 109 (508): 1565–80.",
      "twitter_title": "Non-stationary wrapped Gaussian spatial response model | R-bloggers",
      "url": "https://www.r-bloggers.com/2023/11/non-stationary-wrapped-gaussian-spatial-response-model/",
      "word_count": 1677
    }
  }
}