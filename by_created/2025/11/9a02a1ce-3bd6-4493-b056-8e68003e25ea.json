{
  "uuid": "9a02a1ce-3bd6-4493-b056-8e68003e25ea",
  "created_at": "2025-11-17 20:38:40",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2024/01/probability-intervals-with-gams/",
    "crawled_at": "2025-11-17T09:22:40.169191",
    "external_links": [
      {
        "href": "http://www.seascapemodels.org/rstats/2024/01/05/credible-intervals-with-GAMs.html",
        "text": "Bluecology blog"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://www.sciencedirect.com/science/article/pii/S004896972304490X",
        "text": "animal abundance was greater in an experimental treatment vs the\ncontrol"
      },
      {
        "href": "https://www.taylorfrancis.com/books/mono/10.1201/9781315370279/generalized-additive-models-simon-wood",
        "text": "book"
      },
      {
        "href": "https://gist.github.com/cbrown5/484564c24383fd20fbe0ef76bd4fd97c",
        "text": "which we\nwill use in this\npost"
      },
      {
        "href": "http://www.seascapemodels.org/rstats/2024/01/05/credible-intervals-with-GAMs.html",
        "text": "Bluecology blog"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Probability intervals with GAMs | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/www.seascapemodels.org/images/gam-CIs_files/figure-markdown_strict/unnamed-chunk-2-1.png?w=578"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/www.seascapemodels.org/images/gam-CIs_files/figure-markdown_strict/unnamed-chunk-3-1.png?w=578"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/www.seascapemodels.org/images/gam-CIs_files/figure-markdown_strict/unnamed-chunk-5-1.png?w=578"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/www.seascapemodels.org/images/gam-CIs_files/figure-markdown_strict/unnamed-chunk-6-1.png?w=578"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/bluecology-blog/",
        "text": "Bluecology blog"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-381339 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Probability intervals with GAMs</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">January 4, 2024</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/bluecology-blog/\">Bluecology blog</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"http://www.seascapemodels.org/rstats/2024/01/05/credible-intervals-with-GAMs.html\"> Bluecology blog</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><h1 id=\"probability-intervals-with-gams\">Probability intervals with GAMs</h1>\n<p>A neat trick with GAMs (generalized additive models) fit using the\n<code>mgcv</code> package is that you can use simulation to get Bayesian credible\nintervals. This is handy because it means you can easily calculate\nprobabilities for any arbitrary transformation of your parameters.</p>\n<p>For instance, we used this trick to calculate the probability that\n<a href=\"https://www.sciencedirect.com/science/article/pii/S004896972304490X\" rel=\"nofollow\" target=\"_blank\">animal abundance was greater in an experimental treatment vs the\ncontrol</a>.\nUsing a GAM meant we could also account for non-linear temporal effects.</p>\n<p>The example I give below is for probability of exceeding a threshold.</p>\n<p>Simon Wood explains in his\n<a href=\"https://www.taylorfrancis.com/books/mono/10.1201/9781315370279/generalized-additive-models-simon-wood\" rel=\"nofollow\" target=\"_blank\">book</a>\nthat there is a theoretical equivalence between GAMs from his package\nand an empirical Bayesian analysis. In short, the GAM penalty parameters\n(the ones that control the wiggliness of the non-linear fits) are\nanalogous to Bayesian priors.</p>\n<p>The reason we say ‘empirical’ Bayesian analysis is that the smoothing\nparameters are estimated from data, rather than having a prior.</p>\n<h3 id=\"getting-credible-intervals-from-a-gam\">Getting credible intervals from a GAM</h3>\n<h4 id=\"set-up-data\">Set-up data</h4>\n<p>This is well documented in Wood’s book as well as in the <code>mgcv</code> help\nfiles, see examples in <code>?predict.gam</code>.</p>\n<p>I made myself a handy little function to implement the CIs, <a href=\"https://gist.github.com/cbrown5/484564c24383fd20fbe0ef76bd4fd97c\" rel=\"nofollow\" target=\"_blank\">which we\nwill use in this\npost</a>.</p>\n<p>Here’s the set-up, including sourcing in my function</p>\n<pre>library(mgcv)\n\n## Loading required package: nlme\n\n## This is mgcv 1.8-42. For overview type 'help(\"mgcv-package\")'.\n\nlibrary(ggplot2)\nsource(\"gam-CIs.R\")\n</pre>\n<p>Now let’s make up some data we can fit too. Let’s assume we are\nmeasuring biological responses (`y’) to a toxin:</p>\n<pre>set.seed(2024)\nn &lt;- 50\ntoxin &lt;- sort(runif(n, 0, 1))\ndat &lt;- data.frame(toxin = toxin)\ndat &lt;- within(dat, {\n  ytrue = 6*toxin  - 7*toxin^2\n  yobs = ytrue + rnorm(n, sd = 0.2)\n})\n\nggplot(dat) + \n  aes(x = toxin, y= yobs) + \n  geom_point() + \n  geom_line(aes(y = ytrue))\n</pre>\n<p><img alt=\"\" data-lazy-src=\"https://i0.wp.com/www.seascapemodels.org/images/gam-CIs_files/figure-markdown_strict/unnamed-chunk-2-1.png?w=578\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/www.seascapemodels.org/images/gam-CIs_files/figure-markdown_strict/unnamed-chunk-2-1.png?w=578\"/></noscript></p>\n<p><code>ytrue</code>\nis the true values of the function, and <code>yobs</code> are our data on this\nvariable.</p>\n<h4 id=\"fit-a-gam\">Fit a GAM</h4>\n<p>Now fit a GAM and add its predictions to our dataframe:</p>\n<pre>m1 &lt;- gam(yobs ~ s(toxin), \n          data = dat)\ndat$ypred &lt;- predict(m1)\n\nggplot(dat) + \n  aes(x = toxin, y= yobs) + \n  geom_point() + \n  geom_line(aes(y = ytrue)) + \n  geom_line(aes(y = ypred), col = 'red')\n</pre>\n<p><img alt=\"\" data-lazy-src=\"https://i2.wp.com/www.seascapemodels.org/images/gam-CIs_files/figure-markdown_strict/unnamed-chunk-3-1.png?w=578\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/www.seascapemodels.org/images/gam-CIs_files/figure-markdown_strict/unnamed-chunk-3-1.png?w=578\"/></noscript></p>\n<p>The red line just shows the predictions from the fitted GAM, relative to\nthe true curve (black line).</p>\n<h4 id=\"plotting-predictions-with-cis\">Plotting predictions with CIs</h4>\n<p>The first application of the empirical Bayes trick is to create a plot\nof predictions with credible intervals.</p>\n<p>I won’t go into the detail of the implementation, please see Wood’s book\nand <code>?predict.gam</code> for more info. But in short, you can sample\npredictions from the joint distribution of parameters and their\ncovariances. We are assuming that parameters and their uncertainties are\ndescribed by a multivariate normal distribution (methods like HMC and\nMCMC allow you to relax this assumption, such as when parameter values\nare skewed or multi-modal).</p>\n<p>We need to account for parameter covariances because a higher estimate\nof one parameter might imply a lower or higher estimate for another\nparameter. e.g. slope and intercept values for a linear fit are\nnegatively correlated (a low slope high intercept fit will have similar\nsums of squares to a high slope low intercept fit).</p>\n<p>My function (<code>simulate_gam_CIs</code>) just implements the instructions given\nin <code>?predict.gam</code>. If you are using more complex models I recommend\ndiving into the code yourself, as I can’t guarantee it works in all\ncases (e.g. doesn’t work for models with coefficients on the variance\nparameter like the <code>gaulss</code> family).</p>\n<pre>gamCIs &lt;- simulate_gam_CIs(m1,\n                 newdata = dat,\n                 forms = list(~x), \n                 random_var = NULL,\n                 offset = 0,\n                 probs = c(0.025, 0.5, 0.975),\n                 nsims = 1000)\n</pre>\n<p>The function is drawing 1000 values from the posterior of the model. It\nthen transforms the values according to the function given at <code>forms</code>.\nIn this case we are not doing any transformation.</p>\n<p>Finally, it calculates the 2.5, 50 and 97.5% quantiles across those 1000\nvalues, at each x value in the dataframe. It outputs a list of\ntransformations, where each item corresponds to one of the formulas.</p>\n<p>So basically here we now have 95% credible intervals, and the median.</p>\n<p>Let’s plot that:</p>\n<pre>ggplot(dat) + \n  aes(x = toxin, y= yobs) + \n  geom_point() + \n  geom_line(aes(y = ytrue)) + \n  geom_line(data = gamCIs[[1]], aes(y = X50.), col = 'purple') + \n  geom_ribbon(data = gamCIs[[1]], aes(ymin = X2.5., ymax = X97.5.),\n              color = NA, fill = \"purple\", alpha = 0.5)\n</pre>\n<p><img alt=\"\" data-lazy-src=\"https://i2.wp.com/www.seascapemodels.org/images/gam-CIs_files/figure-markdown_strict/unnamed-chunk-5-1.png?w=578\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/www.seascapemodels.org/images/gam-CIs_files/figure-markdown_strict/unnamed-chunk-5-1.png?w=578\"/></noscript></p>\n<h4 id=\"probability-of-exceeding-a-threshold\">Probability of exceeding a threshold</h4>\n<p>A non-linear transform we might like to do is to find the probability of\nthe mean exceeding a threshold, any arbitrary value of x. Let’s find\nthat probability for exceeding a value of <code>1</code> all the observed values of\nx.</p>\n<p>In this case we don’t want quantiles over the posterior samples, we want\nto know what’s the probability of <code>x&gt;1</code>. Since the function <code>x&gt;1</code>\nreturns a logical, we can simply <code>sum()</code> over the posterior samples and\ndivide by the number of samples to get the probability. So below we\nspecify <code>func_to_apply = \"sum\"</code>.</p>\n<pre>gam_prob_exceed1 &lt;- simulate_gam_CIs(m1,\n                 newdata = dat,\n                 forms = list(~x&gt;1), \n                 random_var = NULL,\n                 offset = 0,\n                 probs = c(0.025, 0.5, 0.975),\n                 nsims = 1000, \n                 func_to_apply = \"sum\")\n\nggplot(gam_prob_exceed1[[1]]) + \n  aes(x = toxin, y =prob) + \n  geom_line() +\n  ylab(\"Probability of the mean of y exceeding a value of 1\")\n</pre>\n<p><img alt=\"\" data-lazy-src=\"https://i1.wp.com/www.seascapemodels.org/images/gam-CIs_files/figure-markdown_strict/unnamed-chunk-6-1.png?w=578\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/www.seascapemodels.org/images/gam-CIs_files/figure-markdown_strict/unnamed-chunk-6-1.png?w=578\"/></noscript></p>\n<p>Couple of important points. When providing a formula <code>x</code> is the name I used in\nthe function to refer to the linear predictor (ie predictions for mean\nof our response), its not the ‘x-variable’.</p>\n<p>We are predicting the probability the mean exceeds a threshold above,\nnot the probability of data observations exceeding a threshold. That\nwould be called a predictive interval and we would need to additionally\nsample from the observation distribution (in this case a normal).</p>\n<h3 id=\"applications\">Applications</h3>\n<p>I find this empirical Bayesian interpretation of GAMs very handy. I use\nit when:</p>\n<ul>\n<li>\n<p>Its impractical to fit a full Bayesian model, such as for large\ndatasets or simulation applications where I need to repeat fitting\n1000s of times. GAMs are generally much faster than numerical\nBayesian methods like HMC or MCMC.</p>\n</li>\n<li>\n<p>I’m working with a collaborator that knows GAMs but not Bayesian\nmodels</p>\n</li>\n<li>\n<p>I want to get predictions on the natural scale for a GAM that is\nfitted with a link function (e.g. poisson with log-link).</p>\n</li>\n</ul>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"http://www.seascapemodels.org/rstats/2024/01/05/credible-intervals-with-GAMs.html\"> Bluecology blog</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
    "main_text": "Probability intervals with GAMs\nPosted on\nJanuary 4, 2024\nby\nBluecology blog\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nBluecology blog\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nProbability intervals with GAMs\nA neat trick with GAMs (generalized additive models) fit using the\nmgcv\npackage is that you can use simulation to get Bayesian credible\nintervals. This is handy because it means you can easily calculate\nprobabilities for any arbitrary transformation of your parameters.\nFor instance, we used this trick to calculate the probability that\nanimal abundance was greater in an experimental treatment vs the\ncontrol\n.\nUsing a GAM meant we could also account for non-linear temporal effects.\nThe example I give below is for probability of exceeding a threshold.\nSimon Wood explains in his\nbook\nthat there is a theoretical equivalence between GAMs from his package\nand an empirical Bayesian analysis. In short, the GAM penalty parameters\n(the ones that control the wiggliness of the non-linear fits) are\nanalogous to Bayesian priors.\nThe reason we say ‘empirical’ Bayesian analysis is that the smoothing\nparameters are estimated from data, rather than having a prior.\nGetting credible intervals from a GAM\nSet-up data\nThis is well documented in Wood’s book as well as in the\nmgcv\nhelp\nfiles, see examples in\n?predict.gam\n.\nI made myself a handy little function to implement the CIs,\nwhich we\nwill use in this\npost\n.\nHere’s the set-up, including sourcing in my function\nlibrary(mgcv)\n\n## Loading required package: nlme\n\n## This is mgcv 1.8-42. For overview type 'help(\"mgcv-package\")'.\n\nlibrary(ggplot2)\nsource(\"gam-CIs.R\")\nNow let’s make up some data we can fit too. Let’s assume we are\nmeasuring biological responses (`y’) to a toxin:\nset.seed(2024)\nn <- 50\ntoxin <- sort(runif(n, 0, 1))\ndat <- data.frame(toxin = toxin)\ndat <- within(dat, {\n  ytrue = 6*toxin  - 7*toxin^2\n  yobs = ytrue + rnorm(n, sd = 0.2)\n})\n\nggplot(dat) + \n  aes(x = toxin, y= yobs) + \n  geom_point() + \n  geom_line(aes(y = ytrue))\nytrue\nis the true values of the function, and\nyobs\nare our data on this\nvariable.\nFit a GAM\nNow fit a GAM and add its predictions to our dataframe:\nm1 <- gam(yobs ~ s(toxin), \n          data = dat)\ndat$ypred <- predict(m1)\n\nggplot(dat) + \n  aes(x = toxin, y= yobs) + \n  geom_point() + \n  geom_line(aes(y = ytrue)) + \n  geom_line(aes(y = ypred), col = 'red')\nThe red line just shows the predictions from the fitted GAM, relative to\nthe true curve (black line).\nPlotting predictions with CIs\nThe first application of the empirical Bayes trick is to create a plot\nof predictions with credible intervals.\nI won’t go into the detail of the implementation, please see Wood’s book\nand\n?predict.gam\nfor more info. But in short, you can sample\npredictions from the joint distribution of parameters and their\ncovariances. We are assuming that parameters and their uncertainties are\ndescribed by a multivariate normal distribution (methods like HMC and\nMCMC allow you to relax this assumption, such as when parameter values\nare skewed or multi-modal).\nWe need to account for parameter covariances because a higher estimate\nof one parameter might imply a lower or higher estimate for another\nparameter. e.g. slope and intercept values for a linear fit are\nnegatively correlated (a low slope high intercept fit will have similar\nsums of squares to a high slope low intercept fit).\nMy function (\nsimulate_gam_CIs\n) just implements the instructions given\nin\n?predict.gam\n. If you are using more complex models I recommend\ndiving into the code yourself, as I can’t guarantee it works in all\ncases (e.g. doesn’t work for models with coefficients on the variance\nparameter like the\ngaulss\nfamily).\ngamCIs <- simulate_gam_CIs(m1,\n                 newdata = dat,\n                 forms = list(~x), \n                 random_var = NULL,\n                 offset = 0,\n                 probs = c(0.025, 0.5, 0.975),\n                 nsims = 1000)\nThe function is drawing 1000 values from the posterior of the model. It\nthen transforms the values according to the function given at\nforms\n.\nIn this case we are not doing any transformation.\nFinally, it calculates the 2.5, 50 and 97.5% quantiles across those 1000\nvalues, at each x value in the dataframe. It outputs a list of\ntransformations, where each item corresponds to one of the formulas.\nSo basically here we now have 95% credible intervals, and the median.\nLet’s plot that:\nggplot(dat) + \n  aes(x = toxin, y= yobs) + \n  geom_point() + \n  geom_line(aes(y = ytrue)) + \n  geom_line(data = gamCIs[[1]], aes(y = X50.), col = 'purple') + \n  geom_ribbon(data = gamCIs[[1]], aes(ymin = X2.5., ymax = X97.5.),\n              color = NA, fill = \"purple\", alpha = 0.5)\nProbability of exceeding a threshold\nA non-linear transform we might like to do is to find the probability of\nthe mean exceeding a threshold, any arbitrary value of x. Let’s find\nthat probability for exceeding a value of\n1\nall the observed values of\nx.\nIn this case we don’t want quantiles over the posterior samples, we want\nto know what’s the probability of\nx>1\n. Since the function\nx>1\nreturns a logical, we can simply\nsum()\nover the posterior samples and\ndivide by the number of samples to get the probability. So below we\nspecify\nfunc_to_apply = \"sum\"\n.\ngam_prob_exceed1 <- simulate_gam_CIs(m1,\n                 newdata = dat,\n                 forms = list(~x>1), \n                 random_var = NULL,\n                 offset = 0,\n                 probs = c(0.025, 0.5, 0.975),\n                 nsims = 1000, \n                 func_to_apply = \"sum\")\n\nggplot(gam_prob_exceed1[[1]]) + \n  aes(x = toxin, y =prob) + \n  geom_line() +\n  ylab(\"Probability of the mean of y exceeding a value of 1\")\nCouple of important points. When providing a formula\nx\nis the name I used in\nthe function to refer to the linear predictor (ie predictions for mean\nof our response), its not the ‘x-variable’.\nWe are predicting the probability the mean exceeds a threshold above,\nnot the probability of data observations exceeding a threshold. That\nwould be called a predictive interval and we would need to additionally\nsample from the observation distribution (in this case a normal).\nApplications\nI find this empirical Bayesian interpretation of GAMs very handy. I use\nit when:\nIts impractical to fit a full Bayesian model, such as for large\ndatasets or simulation applications where I need to repeat fitting\n1000s of times. GAMs are generally much faster than numerical\nBayesian methods like HMC or MCMC.\nI’m working with a collaborator that knows GAMs but not Bayesian\nmodels\nI want to get predictions on the natural scale for a GAM that is\nfitted with a link function (e.g. poisson with log-link).\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nBluecology blog\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "Probability intervals with GAMs A neat trick with GAMs (generalized additive models) fit using the mgcv package is that you can use simulation to get Bayesian credible intervals. This is handy because it means you can easily calculate probabilities fo...",
    "meta_keywords": null,
    "og_description": "Probability intervals with GAMs A neat trick with GAMs (generalized additive models) fit using the mgcv package is that you can use simulation to get Bayesian credible intervals. This is handy because it means you can easily calculate probabilities fo...",
    "og_image": "https://www.seascapemodels.org/images/gam-CIs_files/figure-markdown_strict/unnamed-chunk-2-1.png",
    "og_title": "Probability intervals with GAMs | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 6,
    "sitemap_lastmod": "2024-01-05T00:00:00+00:00",
    "twitter_description": "Probability intervals with GAMs A neat trick with GAMs (generalized additive models) fit using the mgcv package is that you can use simulation to get Bayesian credible intervals. This is handy because it means you can easily calculate probabilities fo...",
    "twitter_title": "Probability intervals with GAMs | R-bloggers",
    "url": "https://www.r-bloggers.com/2024/01/probability-intervals-with-gams/",
    "word_count": 1190
  }
}