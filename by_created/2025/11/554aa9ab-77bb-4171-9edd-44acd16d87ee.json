{
  "uuid": "554aa9ab-77bb-4171-9edd-44acd16d87ee",
  "created_at": "2025-11-17 20:38:42",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2024/01/powerquery-puzzle-solved-with-r-7/",
    "crawled_at": "2025-11-17T09:24:53.571429",
    "external_links": [
      {
        "href": "https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-7bced0c5110d",
        "text": "Numbers around us - Medium"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://www.linkedin.com/in/excelbi/",
        "text": "ExcelBI"
      },
      {
        "href": "https://github.com/kgryczan/excelbi_puzzles",
        "text": "Github"
      },
      {
        "href": "https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-7bced0c5110d",
        "text": "PowerQuery Puzzle solved with R"
      },
      {
        "href": "https://medium.com/number-around-us",
        "text": "Numbers around us"
      },
      {
        "href": "https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-7bced0c5110d",
        "text": "Numbers around us - Medium"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "PowerQuery Puzzle solved with R | R-bloggers",
    "images": [
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*vc1vWdSvUtzUjyIy_YEPhw.jpeg?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*TknasEyqrlAAo7DAqQYEaw.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*oxd-hNA27o9JLpeGJ1wezg.png?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:application/octet-stream;base64,R0lGODlhAQABAO+/vQAA77+977+977+9AAAAIe+/vQQBAAAAACwAAAAAAQABAAACAkQBADs=",
        "src": "https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=7bced0c5110d"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/numbers-around-us/",
        "text": "Numbers around us"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-381237 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">PowerQuery Puzzle solved with R</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">January 2, 2024</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/numbers-around-us/\">Numbers around us</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \r\n<div style=\"min-height: 30px;\">\r\n[social4i size=\"small\" align=\"align-left\"]\r\n</div>\r\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\r\n[This article was first published on  <strong><a href=\"https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-7bced0c5110d\"> Numbers around us - Medium</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 3.8.9--><figure><img alt=\"\" data-lazy-src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*vc1vWdSvUtzUjyIy_YEPhw.jpeg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/cdn-images-1.medium.com/max/1024/1*vc1vWdSvUtzUjyIy_YEPhw.jpeg?w=578&amp;ssl=1\"/></noscript></figure><p>#143–144</p><h3>Puzzles</h3><p>Author: <a href=\"https://www.linkedin.com/in/excelbi/\" rel=\"nofollow\" target=\"_blank\">ExcelBI</a></p><p>From this week all files (xlsx with puzzle and R with solution) for each and every puzzle are available on my <a href=\"https://github.com/kgryczan/excelbi_puzzles\" rel=\"nofollow\" target=\"_blank\">Github</a>. Enjoy.</p><p>Suprisingly this week we have no time-related puzzles, they are rather transformations of tables.</p><h3>Puzzle #143</h3><figure><img alt=\"\" data-lazy-src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*TknasEyqrlAAo7DAqQYEaw.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/cdn-images-1.medium.com/max/1024/1*TknasEyqrlAAo7DAqQYEaw.png?w=578&amp;ssl=1\"/></noscript></figure><p>In this puzzle we have some kind of log. Employees are entering values of observation, but some observation has the same value. To check if it is right or wrong we have to find duplicated values. But only duplicated, so that means do not note first occurence but only second (first duplicated) and last occurence. I know maybe it is little bit chaotic, but lets do it…</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Power Query/PQ_Challenge_143.xlsx\", range = \"A1:C21\")\ntest  = read_excel(\"Power Query/PQ_Challenge_143.xlsx\", range = \"F1:H7\")</pre><h4>Transformation</h4><pre>result = input %&gt;%\n  group_by(Emp, Value) %&gt;%\n  mutate(rn = row_number()) %&gt;%\n  filter(rn == 2 | (rn == max(rn) &amp; rn &gt; 2)) %&gt;%\n  select(-rn) %&gt;%\n  ungroup()\n\n# Pretty easy, isn't it?</pre><h4>Validation</h4><pre>identical(result, test)\n#&gt; [1] TRUE</pre><h3>Puzzle #144</h3><figure><img alt=\"\" data-lazy-src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*oxd-hNA27o9JLpeGJ1wezg.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/cdn-images-1.medium.com/max/1024/1*oxd-hNA27o9JLpeGJ1wezg.png?w=578&amp;ssl=1\"/></noscript></figure><p>Again we have some employee’s log. They forget to note which of two days they log information about, so as work around manager told analyst to break log of each person in the middle (if there are odd number of logs, “first half” should be bigger). So let correct somebody’s mistakes.</p><h4>Load libraries and data</h4><pre>library(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Power Query/PQ_Challenge_144.xlsx\", range = \"A1:B16\")\ntest  = read_excel(\"Power Query/PQ_Challenge_144.xlsx\", range = \"E1:G16\")</pre><h4>Transformation</h4><pre>result = input %&gt;%\n  group_by(Group) %&gt;%\n  mutate(Half = ifelse(row_number() &lt;= ceiling(n()/2), \"First\", \"Second\")) %&gt;%\n  ungroup() %&gt;%\n  group_by(Group, Half) %&gt;%\n  mutate(`Running Total` = cumsum(Value)) %&gt;%\n  ungroup() %&gt;%\n  select(-Half)</pre><h4>Validation</h4><pre>identical(result, test)\n#&gt; [1] TRUE</pre><p>Thanks for your engagement, and let me know if you have any comments.</p><img alt=\"\" data-lazy-src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=7bced0c5110d\" height=\"1\" loading=\"lazy\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" width=\"1\"/><noscript><img alt=\"\" height=\"1\" loading=\"lazy\" src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=7bced0c5110d\" width=\"1\"/></noscript><hr/><p><a href=\"https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-7bced0c5110d\" rel=\"nofollow\" target=\"_blank\">PowerQuery Puzzle solved with R</a> was originally published in <a href=\"https://medium.com/number-around-us\" rel=\"nofollow\" target=\"_blank\">Numbers around us</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 3.8.9-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://medium.com/number-around-us/powerquery-puzzle-solved-with-r-7bced0c5110d\"> Numbers around us - Medium</a></strong>.</div>\n<hr>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\r\n\r\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\r\n</hr></div> </div>\n</article>",
    "main_text": "PowerQuery Puzzle solved with R\nPosted on\nJanuary 2, 2024\nby\nNumbers around us\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nNumbers around us - Medium\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\n#143–144\nPuzzles\nAuthor:\nExcelBI\nFrom this week all files (xlsx with puzzle and R with solution) for each and every puzzle are available on my\nGithub\n. Enjoy.\nSuprisingly this week we have no time-related puzzles, they are rather transformations of tables.\nPuzzle #143\nIn this puzzle we have some kind of log. Employees are entering values of observation, but some observation has the same value. To check if it is right or wrong we have to find duplicated values. But only duplicated, so that means do not note first occurence but only second (first duplicated) and last occurence. I know maybe it is little bit chaotic, but lets do it…\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Power Query/PQ_Challenge_143.xlsx\", range = \"A1:C21\")\ntest  = read_excel(\"Power Query/PQ_Challenge_143.xlsx\", range = \"F1:H7\")\nTransformation\nresult = input %>%\n  group_by(Emp, Value) %>%\n  mutate(rn = row_number()) %>%\n  filter(rn == 2 | (rn == max(rn) & rn > 2)) %>%\n  select(-rn) %>%\n  ungroup()\n\n# Pretty easy, isn't it?\nValidation\nidentical(result, test)\n#> [1] TRUE\nPuzzle #144\nAgain we have some employee’s log. They forget to note which of two days they log information about, so as work around manager told analyst to break log of each person in the middle (if there are odd number of logs, “first half” should be bigger). So let correct somebody’s mistakes.\nLoad libraries and data\nlibrary(tidyverse)\nlibrary(readxl)\n\ninput = read_excel(\"Power Query/PQ_Challenge_144.xlsx\", range = \"A1:B16\")\ntest  = read_excel(\"Power Query/PQ_Challenge_144.xlsx\", range = \"E1:G16\")\nTransformation\nresult = input %>%\n  group_by(Group) %>%\n  mutate(Half = ifelse(row_number() <= ceiling(n()/2), \"First\", \"Second\")) %>%\n  ungroup() %>%\n  group_by(Group, Half) %>%\n  mutate(`Running Total` = cumsum(Value)) %>%\n  ungroup() %>%\n  select(-Half)\nValidation\nidentical(result, test)\n#> [1] TRUE\nThanks for your engagement, and let me know if you have any comments.\nPowerQuery Puzzle solved with R\nwas originally published in\nNumbers around us\non Medium, where people are continuing the conversation by highlighting and responding to this story.\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nNumbers around us - Medium\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "#143–144PuzzlesAuthor: ExcelBIFrom this week all files (xlsx with puzzle and R with solution) for each and every puzzle are available on my Github. Enjoy.Suprisingly this week we have no time-related puzzles, they are rather transformations of tables.Puzzle #143In this puzzle we have some kind of log. Employees are entering values of observation, but some observation has the same value. To check if it is right or wrong we have to find duplicated values. But only duplicated, so that means do not note first occurence but only second (first duplicated) and last occurence. I know maybe it is little bit chaotic, but lets do it…Load libraries and datalibrary(tidyverse)library(readxl)input = read_excel(\"Power Query/PQ_Challenge_143.xlsx\", range = \"A1:C21\")test = read_excel(\"Power Query/PQ_Challenge_143.xlsx\", range = \"F1:H7\")Transformationresult = input %>% group_by(Emp, Value) %>% mutate(rn = row_number()) %>% filter(rn == 2 | (rn == max(rn) & rn > 2)) %>% select(-rn) %>% ungroup()# Pretty easy, isn't it?Validationidentical(result, test)#> [1] TRUEPuzzle #144Again we have some employee’s log. They forget to note which of two days they log information about, so as work around manager told analyst to break log of each person in the middle (if there are odd number of logs, “first half” should be bigger). So let correct somebody’s mistakes.Load libraries and datalibrary(tidyverse)library(readxl)input = read_excel(\"Power Query/PQ_Challenge_144.xlsx\", range = \"A1:B16\")test = read_excel(\"Power Query/PQ_Challenge_144.xlsx\", range = \"E1:G16\")Transformationresult = input %>% group_by(Group) %>% mutate(Half = ifelse(row_number() % ungroup() %>% group_by(Group, Half) %>% mutate(`Running Total` = cumsum(Value)) %>% ungroup() %>% select(-Half)Validationidentical(result, test)#> [1] TRUEThanks for your engagement, and let me know if you have any comments.PowerQuery Puzzle solved with R was originally published in Numbers around us on Medium, where people are continuing the conversation by highlighting and responding to this story.",
    "meta_keywords": null,
    "og_description": "#143–144PuzzlesAuthor: ExcelBIFrom this week all files (xlsx with puzzle and R with solution) for each and every puzzle are available on my Github. Enjoy.Suprisingly this week we have no time-related puzzles, they are rather transformations of tables.Puzzle #143In this puzzle we have some kind of log. Employees are entering values of observation, but some observation has the same value. To check if it is right or wrong we have to find duplicated values. But only duplicated, so that means do not note first occurence but only second (first duplicated) and last occurence. I know maybe it is little bit chaotic, but lets do it…Load libraries and datalibrary(tidyverse)library(readxl)input = read_excel(\"Power Query/PQ_Challenge_143.xlsx\", range = \"A1:C21\")test = read_excel(\"Power Query/PQ_Challenge_143.xlsx\", range = \"F1:H7\")Transformationresult = input %>% group_by(Emp, Value) %>% mutate(rn = row_number()) %>% filter(rn == 2 | (rn == max(rn) & rn > 2)) %>% select(-rn) %>% ungroup()# Pretty easy, isn't it?Validationidentical(result, test)#> [1] TRUEPuzzle #144Again we have some employee’s log. They forget to note which of two days they log information about, so as work around manager told analyst to break log of each person in the middle (if there are odd number of logs, “first half” should be bigger). So let correct somebody’s mistakes.Load libraries and datalibrary(tidyverse)library(readxl)input = read_excel(\"Power Query/PQ_Challenge_144.xlsx\", range = \"A1:B16\")test = read_excel(\"Power Query/PQ_Challenge_144.xlsx\", range = \"E1:G16\")Transformationresult = input %>% group_by(Group) %>% mutate(Half = ifelse(row_number() % ungroup() %>% group_by(Group, Half) %>% mutate(`Running Total` = cumsum(Value)) %>% ungroup() %>% select(-Half)Validationidentical(result, test)#> [1] TRUEThanks for your engagement, and let me know if you have any comments.PowerQuery Puzzle solved with R was originally published in Numbers around us on Medium, where people are continuing the conversation by highlighting and responding to this story.",
    "og_image": "https://cdn-images-1.medium.com/max/1024/1*vc1vWdSvUtzUjyIy_YEPhw.jpeg",
    "og_title": "PowerQuery Puzzle solved with R | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 2.3,
    "sitemap_lastmod": "2024-01-02T19:04:57+00:00",
    "twitter_description": "#143–144PuzzlesAuthor: ExcelBIFrom this week all files (xlsx with puzzle and R with solution) for each and every puzzle are available on my Github. Enjoy.Suprisingly this week we have no time-related puzzles, they are rather transformations of tables.Puzzle #143In this puzzle we have some kind of log. Employees are entering values of observation, but some observation has the same value. To check if it is right or wrong we have to find duplicated values. But only duplicated, so that means do not note first occurence but only second (first duplicated) and last occurence. I know maybe it is little bit chaotic, but lets do it…Load libraries and datalibrary(tidyverse)library(readxl)input = read_excel(\"Power Query/PQ_Challenge_143.xlsx\", range = \"A1:C21\")test = read_excel(\"Power Query/PQ_Challenge_143.xlsx\", range = \"F1:H7\")Transformationresult = input %>% group_by(Emp, Value) %>% mutate(rn = row_number()) %>% filter(rn == 2 | (rn == max(rn) & rn > 2)) %>% select(-rn) %>% ungroup()# Pretty easy, isn't it?Validationidentical(result, test)#> [1] TRUEPuzzle #144Again we have some employee’s log. They forget to note which of two days they log information about, so as work around manager told analyst to break log of each person in the middle (if there are odd number of logs, “first half” should be bigger). So let correct somebody’s mistakes.Load libraries and datalibrary(tidyverse)library(readxl)input = read_excel(\"Power Query/PQ_Challenge_144.xlsx\", range = \"A1:B16\")test = read_excel(\"Power Query/PQ_Challenge_144.xlsx\", range = \"E1:G16\")Transformationresult = input %>% group_by(Group) %>% mutate(Half = ifelse(row_number() % ungroup() %>% group_by(Group, Half) %>% mutate(`Running Total` = cumsum(Value)) %>% ungroup() %>% select(-Half)Validationidentical(result, test)#> [1] TRUEThanks for your engagement, and let me know if you have any comments.PowerQuery Puzzle solved with R was originally published in Numbers around us on Medium, where people are continuing the conversation by highlighting and responding to this story.",
    "twitter_title": "PowerQuery Puzzle solved with R | R-bloggers",
    "url": "https://www.r-bloggers.com/2024/01/powerquery-puzzle-solved-with-r-7/",
    "word_count": 466
  }
}