{
  "uuid": "ac56be96-ed86-4fd8-8655-7386c3755d5e",
  "created_at": "2025-11-22 19:57:34",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2025/10/double-y-axis-plots-with-ggplot2-and-purrr/",
    "crawled_at": "2025-11-22T10:42:19.176490",
    "external_links": [
      {
        "href": "https://pacha.dev/blog/2025/10/03/",
        "text": "pacha.dev/blog"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://buymeacoffee.com/pacha/e/80976",
        "text": "Buy Me a Coffee"
      },
      {
        "href": "https://pacha.dev/blog/2025/09/23/delayedpayments",
        "text": "A Personal Message from an Open Source Contributor"
      },
      {
        "href": "https://docs.google.com/forms/d/e/1FAIpQLScMpMtKjDe2h53iHUvlYHDdBNMD1_x9WO5wg5wi_EO7ak_DRA/viewform?usp=sharing&ouid=115091451666829859711",
        "text": "this form"
      },
      {
        "href": "https://github.com/pachadotdev/spuriouscorrelations",
        "text": "spuriouscorrelations"
      },
      {
        "href": "https://pacha.dev/blog/2025/10/03/",
        "text": "pacha.dev/blog"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "Double y-axis plots with ggplot2 and purrr | R-bloggers",
    "images": [
      {
        "alt": "Correlation is not Causation",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "Correlation is not Causation",
        "base64": null,
        "src": "https://i2.wp.com/pacha.dev/blog/2025/10/03/meme.jpg?w=578&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAALBAMAAABSacpvAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMlSZEO8izUR2iatm3bsfPVmmAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAARUlEQVQIHWNgVGZwTWAAAidWAfYGEKNBnoEzwekBkLWagYdBqQDIuAFksIEYXxjEYIwDEIaWDgOEAZRFYlwAcYGgKyYBALSrDX3rPTdyAAAAAElFTkSuQmCC",
        "src": "https://latex.codecogs.com/png.latex?v_1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAALBAMAAABSacpvAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMlSZEO8izUR2iatm3bsfPVmmAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAXElEQVQIHWNgVGZwTWAAAidWAfYGEKNBnoEzQWcxkLWagYdtAvcCBoYbDDyMBTwPGBi+MIgxMHABRb4wHGBg8HVgYNDSYWBg2AjEIMApkACmGToYJoAZbP//LwAAE1oQ6WcQYPoAAAAASUVORK5CYII=",
        "src": "https://latex.codecogs.com/png.latex?v_2"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIcAAAATBAMAAABIPgNsAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdlQyIrtmq82J70QQmd0a05NiAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACUUlEQVQ4EX2TMWgUQRiFv73bbJLbuyRE0cLC44SooGSRFLFyFUQt5A4UK4vNaSISxC0EFYRsYadgiKLYCYoWNoeFmiprGkXRHCm0Ta/FgVooB/rP7O3uGExecfPe//7/ze7sHGyM8kjqJaSSSlnfZDxryioZed2B/kx91OxEot07sobrvEyaxJaQHVmhECh6r6frYLV6HBIvkyZRIVFe0LTR0xIykFtmm1FVVELMLRakVBzp9UjIWI+qRXn/h4T0+bn1Smgl1RJyOrdQnjU6YVTAqU3j3m92KMnm+3mvR4XTB82xBosz4/AIDrTLT/Sg8s5wTfEvVwXXhRyUr3IBp8MQLJe8gdaynMWwGC8pzhM6IZdhjXL1MbcKF9vacxqo0Rx7/GL5uzqT49A6hOXXIijFcIPCTbwVjzp2hFvssPWwmhWvFPAcE/2/r7hdFTIp1Qc42BEMxRDC3DN/KZaQopQGQ4JJprVX9yXyHxyZ+9BRIZ+k+rUXIu9dqMo3291dQkLKazLbIoCH8iQgD9xoSXt2Juep7PuhQtSBdZnAjnSj3F/HZ3XFlxB1sMNx0af8TXsl3s0HGLjEoLcdq8tArEIC7AiOwlsJaXPXCtkZc1uFOPLP8LTnru76LN05pppNnNHaT8+qwl65VXYEMzArIdvGqkzVxk8xKq+3EMAWW3tsCDtMLHsNzkLDbDyWCLdlac+01nGZVFh86kue3U5U8tsX67X+5xfpXqZt8JMZr8RYXqaEGJHibQa3mrrn9KVPlVpfZEK8TeGnrhA5QRO5FO8viw+B+hRH2yYAAAAASUVORK5CYII=",
        "src": "https://latex.codecogs.com/png.latex?a%20=%20%5Ctext%7Bsd%7D(v_1)%20/%20%5Ctext%7Bsd%7D(v_2)"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAOQAAAATBAMAAABy7rwfAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAIqsyZrt270RUEIndzZm1YPYEAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACYklEQVRIDZ2Uz2vTYBjHv2+Tpm26rlF29EdxIAMPy/4Atxw6Dx5qD3rxYi6KMBgVepCdIkMURKlzCFWYuclgkOJNBCl4UU+9e+nBkxc7vWgv83mSpknjlr3dA83zfZLv532S90kKSIVuhzYtFNPkSVwsGhJwZuzR+2MpLxL4igx5NzJtR1JaJfBVGbAXmUqRlFYJ/KIEWLAiU7EVaUmVxO9LcNnYvPOVQwDRBzTnkAv+qQQu/r6M37Zya27nVXUBqNZcVNdA9ZaDHKDs4G3QuDGx8p0X/tktYI3OS+HqPWwAsxc4OgR5ttLEIxQ7SldraXWuG5gBdnNmydmtk2MQb5m1Mj2u1b7GdDq+/ZEcA2Q6mNjasqP/ged6Bj4VK8oAVA9xFnBWoBltXp7uMIpVXoCjtu6nNPyUzd4N5Bz89s2jQ9nAPrV8025/AeaopYEhLtPFd1AhuOVX+j28QXGdRJMX4Mh0/ZSGKz21zriHwsA3jw5+C8+9RqW4tDRquUfV57BlI2YX+xh91zUeJYI7PAqncQENnEHGjs9y1PK8Cz1niYHp1/T60LMuBU8Zb0k7fzvPrcJZpuLYc7nlDJ4yMo6yofPGznbw3DMLQ8uvSy63tPyWoj72kmjo31Su6Y39wDkVxzxtXR359zZbw1B+Liz/2lycx5WqqX5/sL7JtaO1gNf0T8ezVK3Qy/lZe/kqJVEBig59JKm4ZhoJHEeGqASXRBfIupg2RCUgHsNG1g30scebgeNJ08DpY83/GwJcHBx05PFz0TI/IimtToLnaZhBqGaopsgnwo2wgQjFVDmO/wONqMs2W4Or5gAAAABJRU5ErkJggg==",
        "src": "https://latex.codecogs.com/png.latex?b%20=%20%5Ctext%7Bmean%7D(v_1)%20-%20a%20%5Ctimes%20%5Ctext%7Bmean%7D(v_2)"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAACUAAAATBAMAAADlk9mAAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAEHarRM1UZrsi790ymYmFLq+pAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA5klEQVQYGU2PvWoCURCFP3Xjb8TbpAqChViHgK0I9uIjLBZWQrYTgoVWtgsi2EgaH8BHSGORNOlimyq1rZ3nzq6sA3vOnI+5c+9CrsV9WSpkZH2Bpo/tjD2eoRgpjzJWWiTZeIoLLTX/UI5TIKv2JQO5LN/5ksLHpGOgpn5F19h7XHU0YANa3TPW86eFj5qO2Bvb0/ik5njWmtg/DHJn3myf7vghv+iLVQ68GntwuvrpL1o7OAT6ga3eERL8Tk/uO4LhWNMzHXiR+wpNYSn3n6/QNJnZJX0xMeraSxBaurG5pdj0JkpXFjYk04o5AUYAAAAASUVORK5CYII=",
        "src": "https://latex.codecogs.com/png.latex?(a,%20b)"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot2-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAD8AAAATBAMAAADVH8ihAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdmZU3TIiRM0Qibvvq5mze/DLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABMUlEQVQoFWWQv0vDYBCGn6RNbDW13ZyEqLiX6uQgLuKaSdz8JhUE6SAIgpLZKZCOogVdla6uBXcdHPwvunaqd19+tMGDu3vuvfe7QCCLZieHSstFZwtalUUxPGWwsQtrhVbptdCOh+cQVxblYGV/Arm1XBTwolCLYcUo/Y87kZqvD30C8PZ5NLmlZNHldQh1SIOo0U9H1mK59w5tHYMILqB/imN2YmtQPuu0hgSJzM+SJ5JvuPixgISwF7sj6mq4lhxIHi0YlFmWC6KzLqkw5bi8oMwgyQzfsmzIqSmhGvxfaw7hBy6F+ZR0urDXQw3eWGZlJzJsCjcnUvwvKdoP5MdZghs6fMBSandCGrdjUxj82Wyo79r3kW6utGTRLQBWE3D1M3JoLs+J7bkXs8AlivgHIKI5QaPzCwMAAAAASUVORK5CYII=",
        "src": "https://latex.codecogs.com/png.latex?f(v_1,%20v_2)"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-1.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-2.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-3.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-4.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-5.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-6.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-7.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-8.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-9.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-10.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-11.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-12.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-13.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-14.png?w=450&ssl=1"
      },
      {
        "alt": null,
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": null,
        "base64": null,
        "src": "https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-15.png?w=450&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/pacha-dev-blog/",
        "text": "pacha.dev/blog"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-395867 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Double y-axis plots with ggplot2 and purrr</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">October 2, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/pacha-dev-blog/\">pacha.dev/blog</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://pacha.dev/blog/2025/10/03/\"> pacha.dev/blog</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<p><em>If this post is useful to you I kindly ask a minimal donation on <a href=\"https://buymeacoffee.com/pacha/e/80976\" rel=\"nofollow\" target=\"_blank\">Buy Me a Coffee</a>. It shall be used to continue my Open Source efforts. The full explanation is here: <a href=\"https://pacha.dev/blog/2025/09/23/delayedpayments\" rel=\"nofollow\" target=\"_blank\">A Personal Message from an Open Source Contributor</a>.</em></p>\n<p><em>You can send me questions for the blog using <a href=\"https://docs.google.com/forms/d/e/1FAIpQLScMpMtKjDe2h53iHUvlYHDdBNMD1_x9WO5wg5wi_EO7ak_DRA/viewform?usp=sharing&amp;ouid=115091451666829859711\" rel=\"nofollow\" target=\"_blank\">this form</a> and subscribe to receive an email when there is a new post.</em></p>\n<p>I did not expect the Spurious Correlations post to be so popular, but it seems that many people found it useful and it became the top weekly post on R-Bloggers. Because of that, I will detail a bit more how to create double y-axis plots with ggplot2, using the <a href=\"https://github.com/pachadotdev/spuriouscorrelations\" rel=\"nofollow\" target=\"_blank\">spuriouscorrelations</a> package.</p>\n<p>All about the Spurious Correlations package is:</p>\n<p><img alt=\"Correlation is not Causation\" data-lazy-src=\"https://i2.wp.com/pacha.dev/blog/2025/10/03/meme.jpg?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\" style=\"display: block; margin: auto;\"/><noscript><img alt=\"Correlation is not Causation\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/pacha.dev/blog/2025/10/03/meme.jpg?w=578&amp;ssl=1\" style=\"display: block; margin: auto;\"/></noscript></p>\n<section class=\"level1\" id=\"number-of-people-who-drowned-by-falling-into-a-pool-and-the-number-of-films-nicolas-cage-appeared-in\">\n<h1>Number of people who drowned by falling into a pool and the number of films Nicolas Cage appeared in</h1>\n<p>Let’s start by loading the package:</p>\n<div class=\"cell\">\n<pre># install.packages(\"spuriouscorrelations\", repos = \"https://cran.rstudio.com\")\nlibrary(spuriouscorrelations)</pre>\n</div>\n<p>Let’s start with the data for number of people who drowned by falling into a pool and the number of films Nicolas Cage appeared in:</p>\n<div class=\"cell\">\n<pre>library(dplyr)\n\nnic_cage &lt;- filter(spurious_correlations, var2_short == \"Nicholas Cage\")\n\nglimpse(nic_cage)</pre>\n<div class=\"cell-output cell-output-stdout\">\n<pre>Rows: 11\nColumns: 10\n$ year       &lt;int&gt; 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008,…\n$ var1       &lt;fct&gt; \"Number of people who drowned by falling into a pool\", \"Num…\n$ var2       &lt;fct&gt; \"Films Nicolas Cage appeared in\", \"Films Nicolas Cage appea…\n$ var1_short &lt;fct&gt; Falling into a pool drownings, Falling into a pool drowning…\n$ var2_short &lt;fct&gt; Nicholas Cage, Nicholas Cage, Nicholas Cage, Nicholas Cage,…\n$ var1_unit  &lt;fct&gt; \"drownings\", \"drownings\", \"drownings\", \"drownings\", \"drowni…\n$ var2_unit  &lt;fct&gt; \"films\", \"films\", \"films\", \"films\", \"films\", \"films\", \"film…\n$ var1_value &lt;dbl&gt; 109, 102, 102, 98, 85, 95, 96, 98, 123, 94, 102\n$ var2_value &lt;dbl&gt; 2, 2, 2, 3, 1, 1, 2, 3, 4, 1, 4\n$ source     &lt;fct&gt; Centers for Disease Control &amp; Prevention and Internet Movie…</pre>\n</div>\n</div>\n<p>Now let’s define a function that will:</p>\n<ol type=\"1\">\n<li>Compute the standard deviations of two series <img data-lazy-src=\"https://latex.codecogs.com/png.latex?v_1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?v_1\"/></noscript> and <img data-lazy-src=\"https://latex.codecogs.com/png.latex?v_2\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?v_2\"/></noscript>.</li>\n<li>Compute the scaling factor <img data-lazy-src=\"https://latex.codecogs.com/png.latex?a%20=%20%5Ctext%7Bsd%7D(v_1)%20/%20%5Ctext%7Bsd%7D(v_2)\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?a%20=%20%5Ctext%7Bsd%7D(v_1)%20/%20%5Ctext%7Bsd%7D(v_2)\"/></noscript>.</li>\n<li>Compute the offset <img data-lazy-src=\"https://latex.codecogs.com/png.latex?b%20=%20%5Ctext%7Bmean%7D(v_1)%20-%20a%20%5Ctimes%20%5Ctext%7Bmean%7D(v_2)\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?b%20=%20%5Ctext%7Bmean%7D(v_1)%20-%20a%20%5Ctimes%20%5Ctext%7Bmean%7D(v_2)\"/></noscript>.</li>\n<li>Return the vector <img data-lazy-src=\"https://latex.codecogs.com/png.latex?(a,%20b)\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?(a,%20b)\"/></noscript>.</li>\n</ol>\n<div class=\"cell\">\n<pre># Align the two series visually (works for any two series v1 and v2)\nfun_adjust &lt;- function(v1, v2) {\n  s1 &lt;- sd(v1, na.rm = TRUE)\n  s2 &lt;- sd(v2, na.rm = TRUE)\n  a &lt;- ifelse(s2 == 0, 1, s1 / s2)\n  b &lt;- mean(v1, na.rm = TRUE) - a * mean(v2, na.rm = TRUE)\n  c(a = as.numeric(a), b = as.numeric(b))\n}\n\nv1 &lt;- nic_cage$var1_value\nv2 &lt;- nic_cage$var2_value\n\nadjust &lt;- fun_adjust(v1, v2)\nscale_a &lt;- adjust[\"a\"]\nscale_b &lt;- adjust[\"b\"]</pre>\n</div>\n<p>With this function in mind, we need to reshape the data to a long format, so we can plot both series with ggplot2 and we can apply the transformation to the second series for plotting.</p>\n<div class=\"cell\">\n<pre># install.packages(\"tintin\", repos = \"https://cran.rstudio.com\")\nlibrary(tidyr)\nlibrary(tintin)\n\ny1_title &lt;- as.character(unique(nic_cage$var1))\ny2_title &lt;- as.character(unique(nic_cage$var2))\n\nnic_cage_long &lt;- nic_cage %&gt;%\n  select(year, var1_value, var2_value) %&gt;%\n  pivot_longer(\n    cols = c(var1_value, var2_value),\n    names_to = \"variable\",\n    values_to = \"value\"\n  ) %&gt;%\n  mutate(\n    # apply transform to var2 for plotting: plot_value = a * var2 + b\n    plot_value = ifelse(variable == \"var2_value\", value * scale_a + scale_b, value),\n\n    # add proper labels for legend\n    variable_label = case_when(\n      variable == \"var1_value\" ~ y1_title,\n      variable == \"var2_value\" ~ y2_title\n    )\n  )</pre>\n</div>\n<p>Now we can compute the correlation value and make the double y-axis plot:</p>\n<div class=\"cell\">\n<pre>library(ggplot2)\n\ncor_val &lt;- cor(nic_cage$var1_value, nic_cage$var2_value)\n\n# make a double y axis plot with year on the x axis\nggplot(nic_cage_long, aes(x = year)) +\n  geom_line(aes(y = plot_value, color = variable_label, group = variable_label), linewidth = 1.5) +\n  geom_point(aes(y = plot_value, color = variable_label), size = 3) +\n  labs(\n    x = \"Year\",\n    y = y1_title,\n    title = sprintf(\"%s\\nvs\\n%s\\n\", y1_title, y2_title),\n    subtitle = sprintf(\"Correlation: %.2f\", cor_val),\n    color = \"\"\n  ) +\n  # display all years on the x axis\n  scale_x_continuous(breaks = nic_cage$year) +\n  # primary y axis is the var1 scale\n  # secondary shows var2 original scale by inverse-transforming\n  scale_y_continuous(\n    sec.axis = sec_axis(~ (. - scale_b) / scale_a, name = y2_title)\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(legend.position = \"top\") +\n  # use tintin color palette\n  scale_colour_manual(\n    values = tintin_pal(option = \"the black island\")(2), \n    name = \"\"\n  ) +\n  # center title and subtitle\n  theme(\n    plot.title = element_text(hjust = 0.5, size = 16, face = \"bold\"),\n    plot.subtitle = element_text(hjust = 0.5)\n  )</pre>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n</section>\n<section class=\"level1\" id=\"per-capita-consumption-of-mozzarella-cheese-and-civil-engineering-doctorates-awarded-in-the-us\">\n<h1>Per capita consumption of mozzarella cheese and civil engineering doctorates awarded in the US</h1>\n<p>Reusing the same code as above, we can create a similar plot for the per capita consumption of mozzarella cheese and civil engineering doctorates awarded in the US:</p>\n<div class=\"cell\">\n<pre>engineering_doctorates &lt;- filter(spurious_correlations, var2_short == \"Engineering doctorates\")\n\ncor_val &lt;- cor(engineering_doctorates$var1_value, engineering_doctorates$var2_value)\n\nv1 &lt;- engineering_doctorates$var1_value\nv2 &lt;- engineering_doctorates$var2_value\n\nadjust &lt;- fun_adjust(v1, v2)\nscale_a &lt;- adjust[\"a\"]\nscale_b &lt;- adjust[\"b\"]\n\ny1_title &lt;- as.character(unique(engineering_doctorates$var1))\ny2_title &lt;- as.character(unique(engineering_doctorates$var2))\n\nengineering_doctorates_long &lt;- engineering_doctorates %&gt;%\n  select(year, var1_value, var2_value) %&gt;%\n  pivot_longer(\n    cols = c(var1_value, var2_value),\n    names_to = \"variable\",\n    values_to = \"value\"\n  ) %&gt;%\n  mutate(\n    variable_label = case_when(\n      variable == \"var1_value\" ~ y1_title,\n      variable == \"var2_value\" ~ y2_title\n    ),\n  # apply transform to var2 for plotting: plot_value = a * var2 + b\n  plot_value = ifelse(variable == \"var2_value\", value * scale_a + scale_b, value)\n  )\n\n# make a double y axis plot with year on the x axis\nggplot(engineering_doctorates_long, aes(x = year)) +\n  geom_line(aes(y = plot_value, color = variable_label, group = variable_label), linewidth = 1.5) +\n  geom_point(aes(y = plot_value, color = variable_label), size = 3) +\n  labs(\n    x = \"Year\",\n    y = y1_title,\n    title = sprintf(\"%s\\nvs\\n%s\\n\", y1_title, y2_title),\n    subtitle = sprintf(\"Correlation: %.2f\", cor_val),\n    color = \"\"\n  ) +\n  # display all years on the x axis\n  scale_x_continuous(breaks = nic_cage$year) +\n  # primary y axis is the var1 scale\n  # secondary shows var2 original scale by inverse-transforming\n  scale_y_continuous(\n    sec.axis = sec_axis(~ (. - scale_b) / scale_a, name = y2_title)\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(legend.position = \"top\") +\n  # use tintin color palette\n  scale_colour_manual(\n    values = tintin_pal(option = \"the black island\")(2), \n    name = \"\"\n  ) +\n  # center title and subtitle\n  theme(\n    plot.title = element_text(hjust = 0.5, size = 16, face = \"bold\"),\n    plot.subtitle = element_text(hjust = 0.5)\n  )</pre>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot2-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot2-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n</section>\n<section class=\"level1\" id=\"all-the-correlations-in-the-package\">\n<h1>All the correlations in the package</h1>\n<p>Instead of repeating the same code for each correlation, we can create a function <img data-lazy-src=\"https://latex.codecogs.com/png.latex?f(v_1,%20v_2)\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img src=\"https://latex.codecogs.com/png.latex?f(v_1,%20v_2)\"/></noscript> that does the plotting for two series and then use <code>purrr::walk()</code> to iterate over all the correlations in the package.</p>\n<p>It is important to include a <code>print(p)</code> statement inside the function to ensure that each plot is displayed when using <code>walk()</code>.</p>\n<p>Happy plotting!</p>\n<div class=\"cell\">\n<pre>library(purrr)\n\n# All variable 2 in the dataset\nvar2_all &lt;- unique(spurious_correlations$var2_short)\n\n# Function to plot a single correlation\nplot_correlation &lt;- function(var2_name) {\n  data &lt;- filter(spurious_correlations, var2_short == var2_name)\n  \n  v1 &lt;- data$var1_value\n  v2 &lt;- data$var2_value\n  \n  adjust &lt;- fun_adjust(v1, v2)\n  scale_a &lt;- adjust[\"a\"]\n  scale_b &lt;- adjust[\"b\"]\n  \n  cor_val &lt;- cor(v1, v2)\n  \n  y1_title &lt;- as.character(unique(data$var1))\n  y2_title &lt;- as.character(unique(data$var2))\n  \n  data_long &lt;- data %&gt;%\n    select(year, var1_value, var2_value) %&gt;%\n    pivot_longer(\n      cols = c(var1_value, var2_value),\n      names_to = \"variable\",\n      values_to = \"value\"\n    ) %&gt;%\n    mutate(\n      variable_label = case_when(\n        variable == \"var1_value\" ~ y1_title,\n        variable == \"var2_value\" ~ y2_title\n      ),\n      plot_value = ifelse(variable == \"var2_value\", value * scale_a + scale_b, value)\n    )\n  \n  p &lt;- ggplot(data_long, aes(x = year)) +\n    geom_line(aes(y = plot_value, color = variable_label, group = variable_label), linewidth = 1.5) +\n    geom_point(aes(y = plot_value, color = variable_label), size = 3) +\n    labs(\n      x = \"Year\",\n      y = y1_title,\n      title = sprintf(\"%s\\nvs\\n%s\\n\", y1_title, y2_title),\n      subtitle = sprintf(\"Correlation: %.2f\", cor_val),\n      color = \"\"\n    ) +\n    scale_x_continuous(breaks = data$year) +\n    scale_y_continuous(\n      sec.axis = sec_axis(~ (. - scale_b) / scale_a, name = y2_title)\n    ) +\n    theme_minimal(base_size = 13) +\n    theme(legend.position = \"top\") +\n    scale_colour_manual(\n      values = tintin_pal(option = \"the black island\")(2), \n      name = \"\"\n    ) +\n    theme(\n      plot.title = element_text(hjust = 0.5, size = 16, face = \"bold\"),\n      plot.subtitle = element_text(hjust = 0.5)\n    )\n  \n  print(p)\n}\n\nwalk(var2_all, plot_correlation)</pre>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-1.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-1.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-2.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-2.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-3.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-3.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-4.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-4.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-5.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-5.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-6.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-6.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-7.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-7.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-8.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-8.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-9.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-9.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-10.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-10.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-11.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-11.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-12.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i0.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-12.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-13.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-13.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-14.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-14.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n<div class=\"cell-output-display\">\n<div>\n<figure class=\"figure\">\n<p><img class=\"img-fluid figure-img\" data-lazy-src=\"https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-15.png?w=450&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img class=\"img-fluid figure-img\" data-recalc-dims=\"1\" src=\"https://i2.wp.com/pacha.dev/blog/2025/10/03/index_files/figure-html/plot3-15.png?w=450&amp;ssl=1\"/></noscript></p>\n</figure>\n</div>\n</div>\n</div>\n</section>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://pacha.dev/blog/2025/10/03/\"> pacha.dev/blog</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
    "main_text": "Double y-axis plots with ggplot2 and purrr\nPosted on\nOctober 2, 2025\nby\npacha.dev/blog\nin\nR bloggers\n| 0 Comments\n[This article was first published on\npacha.dev/blog\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nIf this post is useful to you I kindly ask a minimal donation on\nBuy Me a Coffee\n. It shall be used to continue my Open Source efforts. The full explanation is here:\nA Personal Message from an Open Source Contributor\n.\nYou can send me questions for the blog using\nthis form\nand subscribe to receive an email when there is a new post.\nI did not expect the Spurious Correlations post to be so popular, but it seems that many people found it useful and it became the top weekly post on R-Bloggers. Because of that, I will detail a bit more how to create double y-axis plots with ggplot2, using the\nspuriouscorrelations\npackage.\nAll about the Spurious Correlations package is:\nNumber of people who drowned by falling into a pool and the number of films Nicolas Cage appeared in\nLet’s start by loading the package:\n# install.packages(\"spuriouscorrelations\", repos = \"https://cran.rstudio.com\")\nlibrary(spuriouscorrelations)\nLet’s start with the data for number of people who drowned by falling into a pool and the number of films Nicolas Cage appeared in:\nlibrary(dplyr)\n\nnic_cage <- filter(spurious_correlations, var2_short == \"Nicholas Cage\")\n\nglimpse(nic_cage)\nRows: 11\nColumns: 10\n$ year       <int> 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008,…\n$ var1       <fct> \"Number of people who drowned by falling into a pool\", \"Num…\n$ var2       <fct> \"Films Nicolas Cage appeared in\", \"Films Nicolas Cage appea…\n$ var1_short <fct> Falling into a pool drownings, Falling into a pool drowning…\n$ var2_short <fct> Nicholas Cage, Nicholas Cage, Nicholas Cage, Nicholas Cage,…\n$ var1_unit  <fct> \"drownings\", \"drownings\", \"drownings\", \"drownings\", \"drowni…\n$ var2_unit  <fct> \"films\", \"films\", \"films\", \"films\", \"films\", \"films\", \"film…\n$ var1_value <dbl> 109, 102, 102, 98, 85, 95, 96, 98, 123, 94, 102\n$ var2_value <dbl> 2, 2, 2, 3, 1, 1, 2, 3, 4, 1, 4\n$ source     <fct> Centers for Disease Control & Prevention and Internet Movie…\nNow let’s define a function that will:\nCompute the standard deviations of two series\nand\n.\nCompute the scaling factor\n.\nCompute the offset\n.\nReturn the vector\n.\n# Align the two series visually (works for any two series v1 and v2)\nfun_adjust <- function(v1, v2) {\n  s1 <- sd(v1, na.rm = TRUE)\n  s2 <- sd(v2, na.rm = TRUE)\n  a <- ifelse(s2 == 0, 1, s1 / s2)\n  b <- mean(v1, na.rm = TRUE) - a * mean(v2, na.rm = TRUE)\n  c(a = as.numeric(a), b = as.numeric(b))\n}\n\nv1 <- nic_cage$var1_value\nv2 <- nic_cage$var2_value\n\nadjust <- fun_adjust(v1, v2)\nscale_a <- adjust[\"a\"]\nscale_b <- adjust[\"b\"]\nWith this function in mind, we need to reshape the data to a long format, so we can plot both series with ggplot2 and we can apply the transformation to the second series for plotting.\n# install.packages(\"tintin\", repos = \"https://cran.rstudio.com\")\nlibrary(tidyr)\nlibrary(tintin)\n\ny1_title <- as.character(unique(nic_cage$var1))\ny2_title <- as.character(unique(nic_cage$var2))\n\nnic_cage_long <- nic_cage %>%\n  select(year, var1_value, var2_value) %>%\n  pivot_longer(\n    cols = c(var1_value, var2_value),\n    names_to = \"variable\",\n    values_to = \"value\"\n  ) %>%\n  mutate(\n    # apply transform to var2 for plotting: plot_value = a * var2 + b\n    plot_value = ifelse(variable == \"var2_value\", value * scale_a + scale_b, value),\n\n    # add proper labels for legend\n    variable_label = case_when(\n      variable == \"var1_value\" ~ y1_title,\n      variable == \"var2_value\" ~ y2_title\n    )\n  )\nNow we can compute the correlation value and make the double y-axis plot:\nlibrary(ggplot2)\n\ncor_val <- cor(nic_cage$var1_value, nic_cage$var2_value)\n\n# make a double y axis plot with year on the x axis\nggplot(nic_cage_long, aes(x = year)) +\n  geom_line(aes(y = plot_value, color = variable_label, group = variable_label), linewidth = 1.5) +\n  geom_point(aes(y = plot_value, color = variable_label), size = 3) +\n  labs(\n    x = \"Year\",\n    y = y1_title,\n    title = sprintf(\"%s\\nvs\\n%s\\n\", y1_title, y2_title),\n    subtitle = sprintf(\"Correlation: %.2f\", cor_val),\n    color = \"\"\n  ) +\n  # display all years on the x axis\n  scale_x_continuous(breaks = nic_cage$year) +\n  # primary y axis is the var1 scale\n  # secondary shows var2 original scale by inverse-transforming\n  scale_y_continuous(\n    sec.axis = sec_axis(~ (. - scale_b) / scale_a, name = y2_title)\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(legend.position = \"top\") +\n  # use tintin color palette\n  scale_colour_manual(\n    values = tintin_pal(option = \"the black island\")(2), \n    name = \"\"\n  ) +\n  # center title and subtitle\n  theme(\n    plot.title = element_text(hjust = 0.5, size = 16, face = \"bold\"),\n    plot.subtitle = element_text(hjust = 0.5)\n  )\nPer capita consumption of mozzarella cheese and civil engineering doctorates awarded in the US\nReusing the same code as above, we can create a similar plot for the per capita consumption of mozzarella cheese and civil engineering doctorates awarded in the US:\nengineering_doctorates <- filter(spurious_correlations, var2_short == \"Engineering doctorates\")\n\ncor_val <- cor(engineering_doctorates$var1_value, engineering_doctorates$var2_value)\n\nv1 <- engineering_doctorates$var1_value\nv2 <- engineering_doctorates$var2_value\n\nadjust <- fun_adjust(v1, v2)\nscale_a <- adjust[\"a\"]\nscale_b <- adjust[\"b\"]\n\ny1_title <- as.character(unique(engineering_doctorates$var1))\ny2_title <- as.character(unique(engineering_doctorates$var2))\n\nengineering_doctorates_long <- engineering_doctorates %>%\n  select(year, var1_value, var2_value) %>%\n  pivot_longer(\n    cols = c(var1_value, var2_value),\n    names_to = \"variable\",\n    values_to = \"value\"\n  ) %>%\n  mutate(\n    variable_label = case_when(\n      variable == \"var1_value\" ~ y1_title,\n      variable == \"var2_value\" ~ y2_title\n    ),\n  # apply transform to var2 for plotting: plot_value = a * var2 + b\n  plot_value = ifelse(variable == \"var2_value\", value * scale_a + scale_b, value)\n  )\n\n# make a double y axis plot with year on the x axis\nggplot(engineering_doctorates_long, aes(x = year)) +\n  geom_line(aes(y = plot_value, color = variable_label, group = variable_label), linewidth = 1.5) +\n  geom_point(aes(y = plot_value, color = variable_label), size = 3) +\n  labs(\n    x = \"Year\",\n    y = y1_title,\n    title = sprintf(\"%s\\nvs\\n%s\\n\", y1_title, y2_title),\n    subtitle = sprintf(\"Correlation: %.2f\", cor_val),\n    color = \"\"\n  ) +\n  # display all years on the x axis\n  scale_x_continuous(breaks = nic_cage$year) +\n  # primary y axis is the var1 scale\n  # secondary shows var2 original scale by inverse-transforming\n  scale_y_continuous(\n    sec.axis = sec_axis(~ (. - scale_b) / scale_a, name = y2_title)\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(legend.position = \"top\") +\n  # use tintin color palette\n  scale_colour_manual(\n    values = tintin_pal(option = \"the black island\")(2), \n    name = \"\"\n  ) +\n  # center title and subtitle\n  theme(\n    plot.title = element_text(hjust = 0.5, size = 16, face = \"bold\"),\n    plot.subtitle = element_text(hjust = 0.5)\n  )\nAll the correlations in the package\nInstead of repeating the same code for each correlation, we can create a function\nthat does the plotting for two series and then use\npurrr::walk()\nto iterate over all the correlations in the package.\nIt is important to include a\nprint(p)\nstatement inside the function to ensure that each plot is displayed when using\nwalk()\n.\nHappy plotting!\nlibrary(purrr)\n\n# All variable 2 in the dataset\nvar2_all <- unique(spurious_correlations$var2_short)\n\n# Function to plot a single correlation\nplot_correlation <- function(var2_name) {\n  data <- filter(spurious_correlations, var2_short == var2_name)\n  \n  v1 <- data$var1_value\n  v2 <- data$var2_value\n  \n  adjust <- fun_adjust(v1, v2)\n  scale_a <- adjust[\"a\"]\n  scale_b <- adjust[\"b\"]\n  \n  cor_val <- cor(v1, v2)\n  \n  y1_title <- as.character(unique(data$var1))\n  y2_title <- as.character(unique(data$var2))\n  \n  data_long <- data %>%\n    select(year, var1_value, var2_value) %>%\n    pivot_longer(\n      cols = c(var1_value, var2_value),\n      names_to = \"variable\",\n      values_to = \"value\"\n    ) %>%\n    mutate(\n      variable_label = case_when(\n        variable == \"var1_value\" ~ y1_title,\n        variable == \"var2_value\" ~ y2_title\n      ),\n      plot_value = ifelse(variable == \"var2_value\", value * scale_a + scale_b, value)\n    )\n  \n  p <- ggplot(data_long, aes(x = year)) +\n    geom_line(aes(y = plot_value, color = variable_label, group = variable_label), linewidth = 1.5) +\n    geom_point(aes(y = plot_value, color = variable_label), size = 3) +\n    labs(\n      x = \"Year\",\n      y = y1_title,\n      title = sprintf(\"%s\\nvs\\n%s\\n\", y1_title, y2_title),\n      subtitle = sprintf(\"Correlation: %.2f\", cor_val),\n      color = \"\"\n    ) +\n    scale_x_continuous(breaks = data$year) +\n    scale_y_continuous(\n      sec.axis = sec_axis(~ (. - scale_b) / scale_a, name = y2_title)\n    ) +\n    theme_minimal(base_size = 13) +\n    theme(legend.position = \"top\") +\n    scale_colour_manual(\n      values = tintin_pal(option = \"the black island\")(2), \n      name = \"\"\n    ) +\n    theme(\n      plot.title = element_text(hjust = 0.5, size = 16, face = \"bold\"),\n      plot.subtitle = element_text(hjust = 0.5)\n    )\n  \n  print(p)\n}\n\nwalk(var2_all, plot_correlation)\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\npacha.dev/blog\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "If this post is useful to you I kindly ask a minimal donation on Buy Me a Coffee. It shall be used to continue my Open Source efforts. The full explanation is here: A Personal Message from an Open Source Contributor. You can send me questions for...",
    "meta_keywords": null,
    "og_description": "If this post is useful to you I kindly ask a minimal donation on Buy Me a Coffee. It shall be used to continue my Open Source efforts. The full explanation is here: A Personal Message from an Open Source Contributor. You can send me questions for...",
    "og_image": "https://pacha.dev/blog/2025/10/03/meme.jpg",
    "og_title": "Double y-axis plots with ggplot2 and purrr | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 6.6,
    "sitemap_lastmod": null,
    "twitter_description": "If this post is useful to you I kindly ask a minimal donation on Buy Me a Coffee. It shall be used to continue my Open Source efforts. The full explanation is here: A Personal Message from an Open Source Contributor. You can send me questions for...",
    "twitter_title": "Double y-axis plots with ggplot2 and purrr | R-bloggers",
    "url": "https://www.r-bloggers.com/2025/10/double-y-axis-plots-with-ggplot2-and-purrr/",
    "word_count": 1318
  }
}