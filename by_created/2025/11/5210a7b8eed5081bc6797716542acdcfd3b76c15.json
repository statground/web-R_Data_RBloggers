{
  "id": "5210a7b8eed5081bc6797716542acdcfd3b76c15",
  "url": "https://www.r-bloggers.com/2025/05/security-blind-spots-in-shiny-why-your-app-is-more-vulnerable-than-you-think/",
  "created_at_utc": "2025-11-22T19:58:33Z",
  "data": null,
  "raw_original": {
    "uuid": "9eb35205-44ea-42c3-906f-9368505e27f1",
    "created_at": "2025-11-22 19:58:33",
    "raw_json": {
      "article_author": null,
      "article_headline": null,
      "article_modified": null,
      "article_published": null,
      "article_section": null,
      "article_tags": null,
      "canonical_url": "https://www.r-bloggers.com/2025/05/security-blind-spots-in-shiny-why-your-app-is-more-vulnerable-than-you-think/",
      "crawled_at": "2025-11-22T10:48:35.969152",
      "external_links": [
        {
          "href": "https://rtask.thinkr.fr/security-blind-spots-in-shiny-why-your-app-is-more-vulnerable-than-you-think/",
          "text": "Rtask"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        },
        {
          "href": "https://rtask.thinkr.fr/",
          "text": "Rtask"
        },
        {
          "href": "https://rtask.thinkr.fr/security-blind-spots-in-shiny-why-your-app-is-more-vulnerable-than-you-think/",
          "text": "Security blind spots in Shiny: why your app is more vulnerable than you think"
        },
        {
          "href": "https://rtask.thinkr.fr/fr/signature-py-application-laureate-du-shiny-contest-2024/",
          "text": "the Signature.py application"
        },
        {
          "href": "https://github.com/ThinkR-open/signature.py",
          "text": "Versioned on Github"
        },
        {
          "href": "https://thinkr.fr/catalogue-formations/formation-shiny/",
          "text": "here"
        },
        {
          "href": "https://rtask.thinkr.fr/security-blind-spots-in-shiny-why-your-app-is-more-vulnerable-than-you-think/",
          "text": "Security blind spots in Shiny: why your app is more vulnerable than you think"
        },
        {
          "href": "https://rtask.thinkr.fr/security-blind-spots-in-shiny-why-your-app-is-more-vulnerable-than-you-think/",
          "text": "Rtask"
        },
        {
          "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
          "text": "daily e-mail updates"
        },
        {
          "href": "https://www.r-project.org/",
          "text": "R"
        },
        {
          "href": "https://www.r-users.com/",
          "text": "Click here if you're looking to post or find an R/data-science job"
        },
        {
          "href": "http://r-posts.com/",
          "text": "here"
        }
      ],
      "h1_title": "R-bloggers",
      "html_title": "Security blind spots in Shiny: why your app is more vulnerable than you think | R-bloggers",
      "images": [],
      "internal_links": [
        {
          "href": "https://www.r-bloggers.com/author/arthur-breant/",
          "text": "Arthur Br√©ant"
        },
        {
          "href": "https://www.r-bloggers.com/category/r-bloggers/",
          "text": "R bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers"
        },
        {
          "href": "https://www.r-bloggers.com/contact-us/",
          "text": "here"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        },
        {
          "href": "https://www.r-bloggers.com/",
          "text": "R-bloggers.com"
        },
        {
          "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
          "text": "learning R"
        },
        {
          "href": "https://www.r-bloggers.com/add-your-blog/",
          "text": "click here"
        }
      ],
      "lang": "en-US",
      "main_html": "<article class=\"post-392557 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">Security blind spots in Shiny: why your app is more vulnerable than you think</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">May 21, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/arthur-breant/\">Arthur Br√©ant</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://rtask.thinkr.fr/security-blind-spots-in-shiny-why-your-app-is-more-vulnerable-than-you-think/\"> Rtask</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47--><p>You can read the original post in its original format on <a href=\"https://rtask.thinkr.fr/\" rel=\"nofollow\" target=\"_blank\">Rtask</a> website by ThinkR here: <a href=\"https://rtask.thinkr.fr/security-blind-spots-in-shiny-why-your-app-is-more-vulnerable-than-you-think/\" rel=\"nofollow\" target=\"_blank\">Security blind spots in Shiny: why your app is more vulnerable than you think</a></p>\n<p><em>Buckle up, we‚Äôre talking about security‚Ä¶</em></p>\n<p>While developing <a href=\"https://rtask.thinkr.fr/fr/signature-py-application-laureate-du-shiny-contest-2024/\" rel=\"nofollow\" target=\"_blank\">the Signature.py application</a>, ThinkR recently faced a security issue ‚Äì in Python ‚Äì that deserves our full attention.</p>\n<p><a href=\"https://github.com/ThinkR-open/signature.py\" rel=\"nofollow\" target=\"_blank\">Versioned on Github</a>, the Signature.py code is analyzed by <code>Dependabot</code>. This is a robot that automatically scans projects for obsolete or vulnerable dependencies and can potentially suggest corrective measures.</p>\n<p><code>Dependabot</code> alerted us to a security vulnerability related to the use of <code>jinja2</code>, and this led us to a broader reflection: are we, as R and Shiny application developers, also concerned by these security issues?</p>\n<p>The answer is a resounding <strong>YES</strong>.</p>\n<h2>What exactly are we talking about?</h2>\n<p>The impact of the problem identified in our Python application was potentially serious: unintentional code execution on the backend, potentially accessing the entire machine infrastructure. Fortunately, Signature.py only manipulates character strings, and updating <code>jinja2</code> was able to fix the alert.</p>\n<p>But what about the R ecosystem? Are Shiny developers also exposed to these types of vulnerabilities?</p>\n<h2>Code injection: an omnipresent danger</h2>\n<p>Code injection is a common security vulnerability that involves injecting malicious code into a page or application. This code is then executed, creating the security breach. There are several ways to inject code into an application, and Shiny is unfortunately not immune to these risks.</p>\n<h2>Vulnerabilities in Shiny</h2>\n<h3>The good news</h3>\n<p>‚Äú<em>Shiny is well-designed</em>‚Äù! By default, inputs in Shiny return (almost) only character strings. As long as the input content is not evaluated, we are relatively safe.</p>\n<p>For example, this simple application that simply displays the content entered by the user is secure:</p>\n<pre>library(shiny)\nui &lt;- fluidPage(\n  textInput(\"template\", \"Enter something\"),\n  textOutput(\"result\")\n)\nserver &lt;- function(input, output, session) {\n  output$result &lt;- renderText({\n    paste(\"Your choice is\", input$template)\n  })\n}\nshinyApp(ui, server)</pre>\n<h3>The bad news</h3>\n<p>The input content can be evaluated and introduce a security flaw. As soon as we start evaluating the content of an input, risks appear.</p>\n<h2>The three major families of injection in web applications</h2>\n<h3>1. XSS (Cross-Site Scripting): client-side</h3>\n<p>JavaScript or CSS code is injected and executed in another user‚Äôs browser. In Shiny, this can happen when we render HTML directly from user input without properly escaping it.</p>\n<p>For example, this application is vulnerable:</p>\n<pre>library(shiny)\nui &lt;- fluidPage(\n  textInput(\"text\", \"Enter something\"),\n  uiOutput(\"result\")\n)\nserver &lt;- function(input, output, session) {\n  output$result &lt;- renderUI({\n    HTML(input$text)\n  })\n}\nshinyApp(ui, server)</pre>\n<p>In the text input, a malicious user could enter <code>&lt;script&gt;alert('hello')&lt;/script&gt;</code> or even more dangerous code like:</p>\n<pre>&lt;script&gt;\n  const fakeBtn = document.createElement(\"button\");\n  fakeBtn.innerText = \"üîê Login required\";\n  fakeBtn.style = \"display:block; margin:10px 0; padding:10px; background-color:red; color:white;\";\n  fakeBtn.onclick = function() {\n    alert(\"Enter your credentials!\");\n  };\n  document.body.prepend(fakeBtn);\n&lt;/script&gt;</pre>\n<p>In the following vulnerable application, you can copy/paste the entirety of this code snippet into the application below, with the <code>&lt;script&gt;</code> tags to see the threat.</p>\n<blockquote><p>\nYou can write a first comment and then copy/paste the code to see the vulnerability.<br/>\nNo worries here, we don‚Äôt store the information in a database üòâ\n</p></blockquote>\n<pre>library(shiny)\nui &lt;- fluidPage(\n  h2(\"üí¨ User comments\"),\n  textInput(\"pseudo\", \"Your username:\", \"Guest\"),\n  textAreaInput(\"message\", \"Your message:\", rows = 3),\n  actionButton(\"envoyer\", \"Send\"),\n  tags$hr(),\n  h3(\"üí¨ Received comments:\"),\n  uiOutput(\"commentaires\")\n)\nserver &lt;- function(input, output, session) {\n  commentaires &lt;- reactiveVal(\n    data.frame(\n      pseudo = character(), \n      message = character()\n    )\n  )\n  observeEvent(input$envoyer, {\n    new_entry &lt;- data.frame(\n      pseudo = input$pseudo,\n      message = input$message\n    )\n    commentaires(rbind(commentaires(), new_entry))\n  })\n  output$commentaires &lt;- renderUI({\n    coms &lt;- commentaires()\n    if (nrow(coms) == 0) {\n      return(NULL)\n    }\n    HTML(paste0(\n      apply(coms, 1, function(row) {\n        glue::glue(\"&lt;p&gt;&lt;strong&gt;{row[['pseudo']]}&lt;/strong&gt; : {row[['message']]}&lt;/p&gt;\")\n      }),\n      collapse = \"\\n\"\n    ))\n  })\n}\nshinyApp(ui, server)</pre>\n<p>There are two main types of XSS:</p>\n<ul>\n<li><strong>Reflected XSS</strong>: The malicious code is immediately executed.</li>\n<li><strong>Stored XSS</strong>: The malicious code is stored in a database and executed when other users access the page.</li>\n</ul>\n<p><strong>The threat of Stored XSS is particularly concerning.</strong> In the example above, this malicious JavaScript code adds a fake login button that will appear for all future users of the application. Imagine the scenario: an attacker injects this code into your application, and all subsequent users see a red button requesting a login. They click on it, enter their credentials‚Ä¶ and this information can be easily retrieved by the attacker.</p>\n<h3>2. Command Injection: server-side</h3>\n<p>The code is executed directly on the server. This can happen in Shiny when we directly evaluate the content of an input.</p>\n<p>Consider this seemingly harmless application:</p>\n<pre>library(shiny)\nlibrary(glue)\nui &lt;- fluidPage(\n  textInput(\"template\", \"Enter something\"),\n  textOutput(\"result\")\n)\nserver &lt;- function(input, output, session) {\n  output$result &lt;- renderText({\n    glue(input$template)\n  })\n}\nshinyApp(ui, server)</pre>\n<p>This application is actually vulnerable because <code>glue()</code> automatically evaluates what is between <code>{}</code>. A malicious user could enter <code>{system(\"ls /\", intern = TRUE)}</code> or worse <code>{system(\"rm -rf /\")}</code>.</p>\n<blockquote><p>\n<code>system()</code> is an R function that executes shell commands.<br/>\nWhile <code>system(\"ls /\", intern = TRUE)</code> presents a relative risk as it only displays the contents of the root directory of your computer, <code>{system(\"rm -rf /\")}</code> is a potentially destructive command. This command will try to delete all files on the system! Handle with caution üòâ\n</p></blockquote>\n<p>The use of <code>glue()</code> seems harmless, yet <code>glue::glue(input$template)</code> amounts to the same thing as <code>eval(parse(text = input$template))</code>. The <code>eval(parse(text = ...))</code> duo is an operation that will try to evaluate text. The developer‚Äôs use of these functions is clear: they are trying to evaluate text. However, the use of the <code>glue()</code> function is more insidious here.</p>\n<h3>3. SQL Injection: database-side</h3>\n<p>SQL code is executed in the database. This can happen when we build SQL queries from user inputs without properly escaping them.</p>\n<p>For example, this application is vulnerable:</p>\n<pre>library(shiny)\nlibrary(DBI)\nlibrary(RSQLite)\ncon &lt;- dbConnect(RSQLite::SQLite(), \":memory:\")\ndbExecute(\n  conn = con, \n  \"CREATE TABLE users (\n    id INTEGER, name TEXT\n  )\"\n)\ndbExecute(\n  conn = con, \n  \"INSERT INTO users (id, name) \n  VALUES \n    (1, 'Arthur'), \n    (2, 'Adrien'), \n    (3, 'Lucas'), \n    (4, 'Lily'), \n    (5, 'Margot')\"\n)\nui &lt;- fluidPage(\n  h2(\"SQL Injection Test\"),\n  textInput(\n    inputId = \"user_input\",\n    label = \"Select only 1 ID to find your individual\",\n    value = 1\n  ),\n  actionButton(\n    inputId = \"submit\",\n    label = \"Submit\"\n  ),\n  tableOutput(\n    outputId = \"result\"\n  )\n)\nserver &lt;- function(input, output, session) {\n  rv &lt;- reactiveValues()\n  observeEvent(input$submit, {\n    req(input$user_input)\n    rv$query &lt;- paste0(\n      \"SELECT * FROM users WHERE id = \", \n      input$user_input\n    )\n    rv$result &lt;- dbGetQuery(con, rv$query)\n  })\n  output$result &lt;- renderTable({\n    req(rv$result)\n    rv$result\n  })\n}\nshinyApp(ui, server)</pre>\n<p>A user could enter <code>1 OR 1=1</code> to retrieve all data from the table, or even <code>1; DROP TABLE users;</code> to delete the table.</p>\n<h2>How to protect yourself?</h2>\n<h3>Golden rule: Never trust user input, regardless of context</h3>\n<p>Here are some best practices to secure your Shiny applications:</p>\n<ol style=\"list-style-type: decimal\">\n<li><strong>For XSS</strong>: Use <code>htmltools::htmlEscape()</code> to escape HTML or JavaScript tags if you need to store them in a database.</li>\n</ol>\n<pre>htmltools::htmlEscape(\"&lt;script&gt;alert('hello')&lt;/script&gt;\")\n[1] \"&lt;script&gt;alert('hello')&lt;/script&gt;\"</pre>\n<ol start=\"2\" style=\"list-style-type: decimal\">\n<li><strong>For Command Injections</strong>:\n<ul>\n<li>Avoid using <code>eval(parse(text = input$template))</code> or strictly control user input.</li>\n<li>Only manipulate character strings without evaluating them.</li>\n<li>Filter and secure user choices with <code>match.arg()</code>, <code>switch()</code>, or conditional <code>if</code> structures.</li>\n<li>Use a <code>sandbox</code> when evaluation is necessary.</li>\n<li>For uploaded files, prefer simple formats like <code>.csv</code> or <code>.txt</code>.</li>\n</ul>\n</li>\n<li><strong>For SQL Injections</strong>:\n<ul>\n<li>Use <code>sqlInterpolate()</code> rather than constructing queries with <code>paste()</code>:</li>\n</ul>\n</li>\n</ol>\n<pre># Vulnerable\nquery_vuln &lt;- paste0(\"\n  SELECT * \n  FROM users \n  WHERE id = \", input$user_input\n)\n# Secure\nquery_str &lt;- \"\n  SELECT * \n  FROM users \n  WHERE id = ?id\n\"\nquery &lt;- sqlInterpolate(con, query_str, id = input$user_input)\nquery\n# &lt;SQL&gt; \n#  SELECT * \n#  FROM users \n#  WHERE id = 1\ndbGetQuery(con, query)</pre>\n<h2>Conclusion</h2>\n<p>Security is a crucial aspect of web application development, including Shiny applications. Never underestimate the risks related to unvalidated or unescaped user inputs. By following a few simple best practices, you can significantly improve the security of your applications.</p>\n<p>Don‚Äôt hesitate to contact us if you would like to discuss the security of your Shiny applications!</p>\n<p>You can also find all our upcoming training sessions to discover Shiny application development <a href=\"https://thinkr.fr/catalogue-formations/formation-shiny/\" rel=\"nofollow\" target=\"_blank\">here</a>!</p>\n<p>This post is better presented on its original ThinkR website here: <a href=\"https://rtask.thinkr.fr/security-blind-spots-in-shiny-why-your-app-is-more-vulnerable-than-you-think/\" rel=\"nofollow\" target=\"_blank\">Security blind spots in Shiny: why your app is more vulnerable than you think</a></p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://rtask.thinkr.fr/security-blind-spots-in-shiny-why-your-app-is-more-vulnerable-than-you-think/\"> Rtask</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
      "main_text": "Security blind spots in Shiny: why your app is more vulnerable than you think\nPosted on\nMay 21, 2025\nby\nArthur Br√©ant\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nRtask\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nYou can read the original post in its original format on\nRtask\nwebsite by ThinkR here:\nSecurity blind spots in Shiny: why your app is more vulnerable than you think\nBuckle up, we‚Äôre talking about security‚Ä¶\nWhile developing\nthe Signature.py application\n, ThinkR recently faced a security issue ‚Äì in Python ‚Äì that deserves our full attention.\nVersioned on Github\n, the Signature.py code is analyzed by\nDependabot\n. This is a robot that automatically scans projects for obsolete or vulnerable dependencies and can potentially suggest corrective measures.\nDependabot\nalerted us to a security vulnerability related to the use of\njinja2\n, and this led us to a broader reflection: are we, as R and Shiny application developers, also concerned by these security issues?\nThe answer is a resounding\nYES\n.\nWhat exactly are we talking about?\nThe impact of the problem identified in our Python application was potentially serious: unintentional code execution on the backend, potentially accessing the entire machine infrastructure. Fortunately, Signature.py only manipulates character strings, and updating\njinja2\nwas able to fix the alert.\nBut what about the R ecosystem? Are Shiny developers also exposed to these types of vulnerabilities?\nCode injection: an omnipresent danger\nCode injection is a common security vulnerability that involves injecting malicious code into a page or application. This code is then executed, creating the security breach. There are several ways to inject code into an application, and Shiny is unfortunately not immune to these risks.\nVulnerabilities in Shiny\nThe good news\n‚Äú\nShiny is well-designed\n‚Äù! By default, inputs in Shiny return (almost) only character strings. As long as the input content is not evaluated, we are relatively safe.\nFor example, this simple application that simply displays the content entered by the user is secure:\nlibrary(shiny)\nui <- fluidPage(\n  textInput(\"template\", \"Enter something\"),\n  textOutput(\"result\")\n)\nserver <- function(input, output, session) {\n  output$result <- renderText({\n    paste(\"Your choice is\", input$template)\n  })\n}\nshinyApp(ui, server)\nThe bad news\nThe input content can be evaluated and introduce a security flaw. As soon as we start evaluating the content of an input, risks appear.\nThe three major families of injection in web applications\n1. XSS (Cross-Site Scripting): client-side\nJavaScript or CSS code is injected and executed in another user‚Äôs browser. In Shiny, this can happen when we render HTML directly from user input without properly escaping it.\nFor example, this application is vulnerable:\nlibrary(shiny)\nui <- fluidPage(\n  textInput(\"text\", \"Enter something\"),\n  uiOutput(\"result\")\n)\nserver <- function(input, output, session) {\n  output$result <- renderUI({\n    HTML(input$text)\n  })\n}\nshinyApp(ui, server)\nIn the text input, a malicious user could enter\n<script>alert('hello')</script>\nor even more dangerous code like:\n<script>\n  const fakeBtn = document.createElement(\"button\");\n  fakeBtn.innerText = \"üîê Login required\";\n  fakeBtn.style = \"display:block; margin:10px 0; padding:10px; background-color:red; color:white;\";\n  fakeBtn.onclick = function() {\n    alert(\"Enter your credentials!\");\n  };\n  document.body.prepend(fakeBtn);\n</script>\nIn the following vulnerable application, you can copy/paste the entirety of this code snippet into the application below, with the\n<script>\ntags to see the threat.\nYou can write a first comment and then copy/paste the code to see the vulnerability.\nNo worries here, we don‚Äôt store the information in a database üòâ\nlibrary(shiny)\nui <- fluidPage(\n  h2(\"üí¨ User comments\"),\n  textInput(\"pseudo\", \"Your username:\", \"Guest\"),\n  textAreaInput(\"message\", \"Your message:\", rows = 3),\n  actionButton(\"envoyer\", \"Send\"),\n  tags$hr(),\n  h3(\"üí¨ Received comments:\"),\n  uiOutput(\"commentaires\")\n)\nserver <- function(input, output, session) {\n  commentaires <- reactiveVal(\n    data.frame(\n      pseudo = character(), \n      message = character()\n    )\n  )\n  observeEvent(input$envoyer, {\n    new_entry <- data.frame(\n      pseudo = input$pseudo,\n      message = input$message\n    )\n    commentaires(rbind(commentaires(), new_entry))\n  })\n  output$commentaires <- renderUI({\n    coms <- commentaires()\n    if (nrow(coms) == 0) {\n      return(NULL)\n    }\n    HTML(paste0(\n      apply(coms, 1, function(row) {\n        glue::glue(\"<p><strong>{row[['pseudo']]}</strong> : {row[['message']]}</p>\")\n      }),\n      collapse = \"\\n\"\n    ))\n  })\n}\nshinyApp(ui, server)\nThere are two main types of XSS:\nReflected XSS\n: The malicious code is immediately executed.\nStored XSS\n: The malicious code is stored in a database and executed when other users access the page.\nThe threat of Stored XSS is particularly concerning.\nIn the example above, this malicious JavaScript code adds a fake login button that will appear for all future users of the application. Imagine the scenario: an attacker injects this code into your application, and all subsequent users see a red button requesting a login. They click on it, enter their credentials‚Ä¶ and this information can be easily retrieved by the attacker.\n2. Command Injection: server-side\nThe code is executed directly on the server. This can happen in Shiny when we directly evaluate the content of an input.\nConsider this seemingly harmless application:\nlibrary(shiny)\nlibrary(glue)\nui <- fluidPage(\n  textInput(\"template\", \"Enter something\"),\n  textOutput(\"result\")\n)\nserver <- function(input, output, session) {\n  output$result <- renderText({\n    glue(input$template)\n  })\n}\nshinyApp(ui, server)\nThis application is actually vulnerable because\nglue()\nautomatically evaluates what is between\n{}\n. A malicious user could enter\n{system(\"ls /\", intern = TRUE)}\nor worse\n{system(\"rm -rf /\")}\n.\nsystem()\nis an R function that executes shell commands.\nWhile\nsystem(\"ls /\", intern = TRUE)\npresents a relative risk as it only displays the contents of the root directory of your computer,\n{system(\"rm -rf /\")}\nis a potentially destructive command. This command will try to delete all files on the system! Handle with caution üòâ\nThe use of\nglue()\nseems harmless, yet\nglue::glue(input$template)\namounts to the same thing as\neval(parse(text = input$template))\n. The\neval(parse(text = ...))\nduo is an operation that will try to evaluate text. The developer‚Äôs use of these functions is clear: they are trying to evaluate text. However, the use of the\nglue()\nfunction is more insidious here.\n3. SQL Injection: database-side\nSQL code is executed in the database. This can happen when we build SQL queries from user inputs without properly escaping them.\nFor example, this application is vulnerable:\nlibrary(shiny)\nlibrary(DBI)\nlibrary(RSQLite)\ncon <- dbConnect(RSQLite::SQLite(), \":memory:\")\ndbExecute(\n  conn = con, \n  \"CREATE TABLE users (\n    id INTEGER, name TEXT\n  )\"\n)\ndbExecute(\n  conn = con, \n  \"INSERT INTO users (id, name) \n  VALUES \n    (1, 'Arthur'), \n    (2, 'Adrien'), \n    (3, 'Lucas'), \n    (4, 'Lily'), \n    (5, 'Margot')\"\n)\nui <- fluidPage(\n  h2(\"SQL Injection Test\"),\n  textInput(\n    inputId = \"user_input\",\n    label = \"Select only 1 ID to find your individual\",\n    value = 1\n  ),\n  actionButton(\n    inputId = \"submit\",\n    label = \"Submit\"\n  ),\n  tableOutput(\n    outputId = \"result\"\n  )\n)\nserver <- function(input, output, session) {\n  rv <- reactiveValues()\n  observeEvent(input$submit, {\n    req(input$user_input)\n    rv$query <- paste0(\n      \"SELECT * FROM users WHERE id = \", \n      input$user_input\n    )\n    rv$result <- dbGetQuery(con, rv$query)\n  })\n  output$result <- renderTable({\n    req(rv$result)\n    rv$result\n  })\n}\nshinyApp(ui, server)\nA user could enter\n1 OR 1=1\nto retrieve all data from the table, or even\n1; DROP TABLE users;\nto delete the table.\nHow to protect yourself?\nGolden rule: Never trust user input, regardless of context\nHere are some best practices to secure your Shiny applications:\nFor XSS\n: Use\nhtmltools::htmlEscape()\nto escape HTML or JavaScript tags if you need to store them in a database.\nhtmltools::htmlEscape(\"<script>alert('hello')</script>\")\n[1] \"<script>alert('hello')</script>\"\nFor Command Injections\n:\nAvoid using\neval(parse(text = input$template))\nor strictly control user input.\nOnly manipulate character strings without evaluating them.\nFilter and secure user choices with\nmatch.arg()\n,\nswitch()\n, or conditional\nif\nstructures.\nUse a\nsandbox\nwhen evaluation is necessary.\nFor uploaded files, prefer simple formats like\n.csv\nor\n.txt\n.\nFor SQL Injections\n:\nUse\nsqlInterpolate()\nrather than constructing queries with\npaste()\n:\n# Vulnerable\nquery_vuln <- paste0(\"\n  SELECT * \n  FROM users \n  WHERE id = \", input$user_input\n)\n# Secure\nquery_str <- \"\n  SELECT * \n  FROM users \n  WHERE id = ?id\n\"\nquery <- sqlInterpolate(con, query_str, id = input$user_input)\nquery\n# <SQL> \n#  SELECT * \n#  FROM users \n#  WHERE id = 1\ndbGetQuery(con, query)\nConclusion\nSecurity is a crucial aspect of web application development, including Shiny applications. Never underestimate the risks related to unvalidated or unescaped user inputs. By following a few simple best practices, you can significantly improve the security of your applications.\nDon‚Äôt hesitate to contact us if you would like to discuss the security of your Shiny applications!\nYou can also find all our upcoming training sessions to discover Shiny application development\nhere\n!\nThis post is better presented on its original ThinkR website here:\nSecurity blind spots in Shiny: why your app is more vulnerable than you think\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nRtask\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
      "meta_description": "You can read the original post in its original format on Rtask website by ThinkR here: Security blind spots in Shiny: why your app is more vulnerable than you think Buckle up, we‚Äôre talking about security‚Ä¶ While developing the Signature.py application, ThinkR recently faced a security issue ‚Äì in Python ‚Äì that deserves our full attention. Versioned on Github, the Signature.py code is analyzed by Dependabot. This is a robot that automatically scans projects for obsolete or vulnerable dependencies and can potentially suggest corrective measures. Dependabot alerted us to a This post is better presented on its original ThinkR website here: Security blind spots in Shiny: why your app is more vulnerable than you think",
      "meta_keywords": null,
      "og_description": "You can read the original post in its original format on Rtask website by ThinkR here: Security blind spots in Shiny: why your app is more vulnerable than you think Buckle up, we‚Äôre talking about security‚Ä¶ While developing the Signature.py application, ThinkR recently faced a security issue ‚Äì in Python ‚Äì that deserves our full attention. Versioned on Github, the Signature.py code is analyzed by Dependabot. This is a robot that automatically scans projects for obsolete or vulnerable dependencies and can potentially suggest corrective measures. Dependabot alerted us to a This post is better presented on its original ThinkR website here: Security blind spots in Shiny: why your app is more vulnerable than you think",
      "og_image": "https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png",
      "og_title": "Security blind spots in Shiny: why your app is more vulnerable than you think | R-bloggers",
      "raw_jsonld_article": null,
      "reading_time_min": 7.4,
      "sitemap_lastmod": null,
      "twitter_description": "You can read the original post in its original format on Rtask website by ThinkR here: Security blind spots in Shiny: why your app is more vulnerable than you think Buckle up, we‚Äôre talking about security‚Ä¶ While developing the Signature.py application, ThinkR recently faced a security issue ‚Äì in Python ‚Äì that deserves our full attention. Versioned on Github, the Signature.py code is analyzed by Dependabot. This is a robot that automatically scans projects for obsolete or vulnerable dependencies and can potentially suggest corrective measures. Dependabot alerted us to a This post is better presented on its original ThinkR website here: Security blind spots in Shiny: why your app is more vulnerable than you think",
      "twitter_title": "Security blind spots in Shiny: why your app is more vulnerable than you think | R-bloggers",
      "url": "https://www.r-bloggers.com/2025/05/security-blind-spots-in-shiny-why-your-app-is-more-vulnerable-than-you-think/",
      "word_count": 1484
    }
  }
}