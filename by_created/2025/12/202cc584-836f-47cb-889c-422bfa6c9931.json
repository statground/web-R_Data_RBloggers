{
  "uuid": "202cc584-836f-47cb-889c-422bfa6c9931",
  "created_at": "2025-12-08 14:56:52",
  "raw_json": {
    "article_author": null,
    "article_headline": null,
    "article_modified": null,
    "article_published": null,
    "article_section": null,
    "article_tags": null,
    "canonical_url": "https://www.r-bloggers.com/2025/12/arima-black-scholes-semi-parametric-market-price-of-risk-for-risk-neutral-pricing-code-preprint/",
    "crawled_at": "2025-12-08T05:56:19.244913",
    "external_links": [
      {
        "href": "https://thierrymoudiki.github.io//blog/2025/12/07/r/forecasting/ARIMA-Pricing",
        "text": "T. Moudiki's Webpage - R"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      },
      {
        "href": "https://github.com/Techtonique/esgtoolkit",
        "text": "esgtoolkit"
      },
      {
        "href": "https://github.com/Techtonique/ahead",
        "text": "ahead"
      },
      {
        "href": "https://github.com/thierrymoudiki/2025-12-07-risk-neutralization-with-ARIMA",
        "text": "https://github.com/thierrymoudiki/2025-12-07-risk-neutralization-with-ARIMA"
      },
      {
        "href": "https://www.researchgate.net/publication/398427354_An_ARIMA-Based_Semi-Parametric_Approach_to_Market_Price_of_Risk_estimation_and_Risk-Neutral_Pricing",
        "text": "https://www.researchgate.net/publication/398427354_An_ARIMA-Based_Semi-Parametric_Approach_to_Market_Price_of_Risk_estimation_and_Risk-Neutral_Pricing"
      },
      {
        "href": "https://thierrymoudiki.github.io//blog/2025/12/07/r/forecasting/ARIMA-Pricing",
        "text": "T. Moudiki's Webpage - R"
      },
      {
        "href": "https://feedburner.google.com/fb/a/mailverify?uri=RBloggers",
        "text": "daily e-mail updates"
      },
      {
        "href": "https://www.r-project.org/",
        "text": "R"
      },
      {
        "href": "https://www.r-users.com/",
        "text": "Click here if you're looking to post or find an R/data-science job"
      },
      {
        "href": "http://r-posts.com/",
        "text": "here"
      }
    ],
    "h1_title": "R-bloggers",
    "html_title": "ARIMA-Black-Scholes: Semi-Parametric Market price of risk for Risk-Neutral Pricing (code + preprint) | R-bloggers",
    "images": [
      {
        "alt": "image-title-here",
        "base64": "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
        "src": "https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif"
      },
      {
        "alt": "image-title-here",
        "base64": null,
        "src": "https://i1.wp.com/thierrymoudiki.github.io/images/2025-12-07/2025-12-07-image1.png?w=578&ssl=1"
      }
    ],
    "internal_links": [
      {
        "href": "https://www.r-bloggers.com/author/t-moudiki/",
        "text": "T. Moudiki"
      },
      {
        "href": "https://www.r-bloggers.com/category/r-bloggers/",
        "text": "R bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers"
      },
      {
        "href": "https://www.r-bloggers.com/contact-us/",
        "text": "here"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      },
      {
        "href": "https://www.r-bloggers.com/",
        "text": "R-bloggers.com"
      },
      {
        "href": "https://www.r-bloggers.com/how-to-learn-r-2/",
        "text": "learning R"
      },
      {
        "href": "https://www.r-bloggers.com/add-your-blog/",
        "text": "click here"
      }
    ],
    "lang": "en-US",
    "main_html": "<article class=\"post-397459 post type-post status-publish format-standard hentry category-r-bloggers\">\n<header class=\"post-header\">\n<h1 class=\"entry-title\">ARIMA-Black-Scholes: Semi-Parametric Market price of risk for Risk-Neutral Pricing (code + preprint)</h1>\n<p class=\"meta post-meta\">Posted on <span class=\"updated\">December 6, 2025</span>  by <span class=\"vcard author\"><a class=\"fn\" href=\"https://www.r-bloggers.com/author/t-moudiki/\">T. Moudiki</a></span>  in <a href=\"https://www.r-bloggers.com/category/r-bloggers/\" rel=\"category tag\">R bloggers</a> | 0 Comments</p>\n</header>\n<div class=\"entry clearfix\">\n<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://thierrymoudiki.github.io//blog/2025/12/07/r/forecasting/ARIMA-Pricing\"> T. Moudiki's Webpage - R</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<!-- Share buttons by mashshare.net - Version: 4.0.47--><p>In quantitative finance, pricing derivatives often requires working under a <strong>risk-neutral measure</strong> (Q) rather than the real-world <strong>physical measure</strong> (P). While the Girsanov theorem provides a theoretical framework for this change of measure, practical implementation can be challenging—especially for complex models like stochastic volatility with jumps.</p>\n<p>This blog post demonstrates a <strong>semi-parametric approach</strong> that bridges classical time series modeling with risk-neutral pricing. We’ll show how to:</p>\n<ol>\n<li><strong>Simulate</strong> stock price paths under three different models (GBM, SVJD, Heston) using the physical measure</li>\n<li><strong>Extract</strong> the risk premium using ARIMA modeling</li>\n<li><strong>Transform</strong> physical paths to risk-neutral paths through residual resampling</li>\n<li><strong>Price</strong> European options under the risk-neutral measure</li>\n</ol>\n<h2 id=\"models-compared\">Models Compared</h2>\n<ul>\n<li><strong>Geometric Brownian Motion (GBM)</strong>: The classic Black-Scholes model with constant volatility</li>\n<li><strong>Stochastic Volatility Jump Diffusion (SVJD)</strong>: Incorporates both stochastic volatility and price jumps</li>\n<li><strong>Heston Model</strong>: Stochastic volatility without jumps (a special case of SVJD)</li>\n</ul>\n<h2 id=\"methodological-approach\">Methodological Approach</h2>\n<p>Our semi-parametric method involves:</p>\n<ol>\n<li><strong>Physical Simulation</strong>: Generate paths under the real-world measure with expected return μ</li>\n<li><strong>Risk Premium Extraction</strong>: Fit ARIMA models to discounted price increments to capture serial dependence</li>\n<li><strong>Residual Resampling</strong>: Use Gaussian density estimation to resample centered ARIMA residuals</li>\n<li><strong>Risk-Neutral Path Generation</strong>: Combine fitted ARIMA models with resampled residuals to create martingale paths</li>\n<li><strong>Option Pricing</strong>: Compute option prices as discounted expected payoffs under Q</li>\n</ol>\n<h2 id=\"r-packages-used\">R Packages Used</h2>\n<ul>\n<li><strong><a href=\"https://github.com/Techtonique/esgtoolkit\" rel=\"nofollow\" target=\"_blank\">esgtoolkit</a></strong>: For financial simulations and risk-neutral transformations</li>\n<li><strong><a href=\"https://github.com/Techtonique/ahead\" rel=\"nofollow\" target=\"_blank\">ahead</a></strong>: For time series forecasting and residual resampling</li>\n<li><strong>forecast</strong> (<code>auto.arima</code>): For automatic ARIMA model selection</li>\n</ul>\n<p>The complete reproducible code is presented below, organized in logical sections from simulation to option pricing.</p>\n<hr/>\n<pre>## ----setup, include=FALSE------------------------------------------------------\nknitr::opts_chunk$set(echo = TRUE)\n\n\n## ----1-simulate-SVJD, cache=TRUE-----------------------------------------------\n# ARIMA-Black-Scholes: Semi-Parametric Risk-Neutral Pricing\n# T. Moudiki\n# 2025-12-04\n\nlibrary(esgtoolkit)\nlibrary(forecast)\nlibrary(ahead)\n\n# =============================================================================\n# 1 - SVJD SIMULATION (Physical Measure)\n# =============================================================================\n\nset.seed(123)\nn &lt;- 250L\nh &lt;- 5\nfreq &lt;- \"daily\"\nr &lt;- 0.05\nmaturity &lt;- 5\nS0 &lt;- 100\nmu &lt;- 0.08\nsigma &lt;- 0.04\n\n# Simulate under physical measure with stochastic volatility and jumps\nsim_GBM &lt;- esgtoolkit::simdiff(n=n, horizon = h, frequency = freq, x0=S0, theta1 = mu, theta2 = sigma)\nsim_SVJD &lt;- esgtoolkit::rsvjd(n=n, r0=mu)\nsim_Heston &lt;- esgtoolkit::rsvjd(n=n, r0=mu, \n                                lambda = 0,\n                                mu_J = 0,\n                                sigma_J = 0)\n\ncat(\"Simulation dimensions:\\n\")\ncat(\"Start:\", start(sim_SVJD), \"\\n\")\ncat(\"End:\", end(sim_SVJD), \"\\n\")\ncat(\"Paths:\", ncol(sim_SVJD), \"\\n\")\ncat(\"Time steps:\", nrow(sim_SVJD), \"\\n\\n\")\n\npar(mfrow=c(1, 3))\n# Plot historical (physical measure) paths\nesgtoolkit::esgplotbands(sim_GBM, main=\"GBM Paths under the Physical Measure\", \n                         xlab=\"Time\",\n                         ylab=\"Stock prices\")\nesgtoolkit::esgplotbands(sim_SVJD, main=\"SVJD Paths under the Physical Measure\", \n                         xlab=\"Time\",\n                         ylab=\"Stock prices\")\nesgtoolkit::esgplotbands(sim_Heston, main=\"Heston Paths under the Physical Measure\", \n                         xlab=\"Time\",\n                         ylab=\"Stock prices\")                         \n\n# Summary statistics\ncat(\"Physical measure statistics (GBM):\\n\")\nterminal_prices_physical_GBM &lt;- sim_GBM[nrow(sim_GBM), ]\ncat(\"Mean terminal price:\", mean(terminal_prices_physical_GBM), \"\\n\")\ncat(\"Std terminal price:\", sd(terminal_prices_physical_GBM), \"\\n\")\ncat(\"Expected under P:\", S0 * exp(mu * maturity), \"\\n\\n\")\n \ncat(\"Physical measure statistics (SVJD):\\n\")\nterminal_prices_physical_SVJD &lt;- sim_SVJD[nrow(sim_SVJD), ]\ncat(\"Mean terminal price:\", mean(terminal_prices_physical_SVJD), \"\\n\")\ncat(\"Std terminal price:\", sd(terminal_prices_physical_SVJD), \"\\n\")\ncat(\"Expected under P:\", S0 * exp(mu * maturity), \"\\n\\n\")\n\ncat(\"Physical measure statistics (Heston):\\n\")\nterminal_prices_physical_Heston &lt;- sim_Heston[nrow(sim_Heston), ]\ncat(\"Mean terminal price:\", mean(terminal_prices_physical_Heston), \"\\n\")\ncat(\"Std terminal price:\", sd(terminal_prices_physical_Heston), \"\\n\")\ncat(\"Expected under P:\", S0 * exp(mu * maturity), \"\\n\\n\")\n\n\n## ----2-compute-discounted, cache=TRUE------------------------------------------\n# =============================================================================\n# 2 - COMPUTE DISCOUNTED PRICES (Transform to Martingale Domain)\n# =============================================================================\n\ndiscounted_prices_GBM &lt;- esgtoolkit::esgdiscountfactor(r=r, X=sim_GBM)\ndiscounted_prices_SVJD &lt;- esgtoolkit::esgdiscountfactor(r=r, X=sim_SVJD)\ndiscounted_prices_Heston &lt;- esgtoolkit::esgdiscountfactor(r=r, X=sim_Heston)\nmartingale_diff_GBM &lt;- discounted_prices_GBM - S0 \nmartingale_diff_SVJD &lt;- discounted_prices_SVJD - S0 \nmartingale_diff_Heston &lt;- discounted_prices_Heston - S0 \n\ncat(\"Martingale differences dimensions (GBM):\", dim(martingale_diff_GBM), \"\\n\")\ncat(\"Mean martingale diff (should be ≠ 0 under P):\\n\")\nprint(t.test(rowMeans(martingale_diff_GBM)))\n\ncat(\"\\nMartingale differences dimensions (SVJD):\", dim(martingale_diff_SVJD), \"\\n\")\ncat(\"Mean martingale diff (should be ≠ 0 under P):\\n\")\nprint(t.test(rowMeans(martingale_diff_SVJD)))\n\ncat(\"\\nMartingale differences dimensions (Heston):\", dim(martingale_diff_Heston), \"\\n\")\ncat(\"Mean martingale diff (should be ≠ 0 under P):\\n\")\nprint(t.test(rowMeans(martingale_diff_Heston)))\n\n# =============================================================================\n# 3 - VISUALIZE RISK PREMIUM\n# =============================================================================\n\npar(mfrow=c(2,2))\n\nmatplot(discounted_prices_GBM, type='l', col=rgb(0,0,1,0.3),\n        main=\"Discounted Stock Prices (Physical Measure - GBM)\",\n        ylab=\"exp(-rt) * S_t\", xlab=\"Time step\")\nabline(h=S0, col='red', lwd=2, lty=2)\n\nmatplot(discounted_prices_SVJD, type='l', col=rgb(0,0,1,0.3),\n        main=\"Discounted Stock Prices (Physical Measure - SVJD)\",\n        ylab=\"exp(-rt) * S_t\", xlab=\"Time step\")\nabline(h=S0, col='red', lwd=2, lty=2)\n\nmatplot(discounted_prices_Heston, type='l', col=rgb(0,0,1,0.3),\n        main=\"Discounted Stock Prices (Physical Measure - Heston)\",\n        ylab=\"exp(-rt) * S_t\", xlab=\"Time step\")\nabline(h=S0, col='red', lwd=2, lty=2)\n\npar(mfrow=c(1,1))\n\nmean_disc_path_GBM &lt;- rowMeans(discounted_prices_GBM)\ntimes_plot &lt;- as.numeric(time(discounted_prices_GBM)) \nplot(times_plot, mean_disc_path_GBM, type='l', lwd=2, col='blue',\n     main=\"Risk Premium in Discounted Prices (GBM)\",\n     xlab=\"Time (years)\", ylab=\"E[exp(-rt)*S_t]\")\nabline(h=S0, col='red', lwd=2, lty=2)\nlines(times_plot, S0 * exp((mu-r)*times_plot), col='green', lwd=2, lty=3)\nlegend(\"topleft\",\n       legend=c(\"Empirical mean\", \"S0\", \"Theoretical (μ-r drift)\"),\n       col=c('blue','red','green'), lty=c(1,2,3), lwd=2)\n\nmean_disc_path_SVJD &lt;- rowMeans(discounted_prices_SVJD)\ntimes_plot &lt;- as.numeric(time(discounted_prices_SVJD)) \nplot(times_plot, mean_disc_path_SVJD, type='l', lwd=2, col='blue',\n     main=\"Risk Premium in Discounted Prices (SVJD)\",\n     xlab=\"Time (years)\", ylab=\"E[exp(-rt)*S_t]\")\nabline(h=S0, col='red', lwd=2, lty=2)\nlines(times_plot, S0 * exp((mu-r)*times_plot), col='green', lwd=2, lty=3)\nlegend(\"topleft\",\n       legend=c(\"Empirical mean\", \"S0\", \"Theoretical (μ-r drift)\"),\n       col=c('blue','red','green'), lty=c(1,2,3), lwd=2)\n\nmean_disc_path_Heston &lt;- rowMeans(discounted_prices_Heston)\ntimes_plot &lt;- as.numeric(time(discounted_prices_Heston)) \nplot(times_plot, mean_disc_path_Heston, type='l', lwd=2, col='blue',\n     main=\"Risk Premium in Discounted Prices (Heston)\",\n     xlab=\"Time (years)\", ylab=\"E[exp(-rt)*S_t]\")\nabline(h=S0, col='red', lwd=2, lty=2)\nlines(times_plot, S0 * exp((mu-r)*times_plot), col='green', lwd=2, lty=3)\nlegend(\"topleft\",\n       legend=c(\"Empirical mean\", \"S0\", \"Theoretical (μ-r drift)\"),\n       col=c('blue','red','green'), lty=c(1,2,3), lwd=2)     \n\n\n## ----3-fit-ARIMA, cache=TRUE, eval=TRUE----------------------------------------\n# =============================================================================\n# 4 - FIT ARIMA MODELS TO EXTRACT RISK PREMIUM\n# =============================================================================\n\nn_periods &lt;- nrow(martingale_diff_GBM)\nn_paths &lt;- ncol(martingale_diff_GBM)\n\nmartingale_increments_GBM &lt;- diff(martingale_diff_GBM)\nmartingale_increments_SVJD &lt;- diff(martingale_diff_SVJD)\nmartingale_increments_Heston &lt;- diff(martingale_diff_Heston)\n\n# Initialize storage arrays\narima_residuals_GBM &lt;- array(NA, dim = c(nrow(martingale_increments_GBM), n_paths))\ncentered_arima_residuals_GBM &lt;- array(NA, dim = c(nrow(martingale_increments_GBM), n_paths))\nmeans_arima_residuals_GBM &lt;- rep(NA, n_paths)\narima_models_GBM &lt;- list()\n\narima_residuals_SVJD &lt;- array(NA, dim = c(nrow(martingale_increments_SVJD), n_paths))\ncentered_arima_residuals_SVJD &lt;- array(NA, dim = c(nrow(martingale_increments_SVJD), n_paths))\nmeans_arima_residuals_SVJD &lt;- rep(NA, n_paths)\narima_models_SVJD &lt;- list()\n\narima_residuals_Heston &lt;- array(NA, dim = c(nrow(martingale_increments_Heston), n_paths))\ncentered_arima_residuals_Heston &lt;- array(NA, dim = c(nrow(martingale_increments_Heston), n_paths))\nmeans_arima_residuals_Heston &lt;- rep(NA, n_paths)\narima_models_Heston &lt;- list()\n\n# Fit ARIMA models to GBM\ncat(\"Fitting ARIMA models to\", n_paths, \"GBM paths...\\n\")\nfor (i in 1:n_paths) {\n  y &lt;- as.numeric(martingale_increments_GBM[, i])\n  fit &lt;- forecast::auto.arima(y, allowmean = FALSE)\n  arima_models_GBM[[i]] &lt;- fit\n  \n  res &lt;- as.numeric(residuals(fit))\n  arima_residuals_GBM[, i] &lt;- res\n  \n  centre_arima_residuals &lt;- scale(res, center = TRUE, scale = FALSE)\n  means_arima_residuals_GBM[i] &lt;- attr(centre_arima_residuals, \"scaled:center\")\n  centered_arima_residuals_GBM[, i] &lt;- centre_arima_residuals[,1]\n}\n\n# Fit ARIMA models to SVJD\ncat(\"Fitting ARIMA models to\", n_paths, \"SVJD paths...\\n\")\nfor (i in 1:n_paths) {\n  y &lt;- as.numeric(martingale_increments_SVJD[, i])\n  fit &lt;- forecast::auto.arima(y, allowmean = FALSE)\n  arima_models_SVJD[[i]] &lt;- fit\n  \n  res &lt;- as.numeric(residuals(fit))\n  arima_residuals_SVJD[, i] &lt;- res\n  \n  centre_arima_residuals &lt;- scale(res, center = TRUE, scale = FALSE)\n  means_arima_residuals_SVJD[i] &lt;- attr(centre_arima_residuals, \"scaled:center\")\n  centered_arima_residuals_SVJD[, i] &lt;- centre_arima_residuals[,1]\n}\n\n# Fit ARIMA models to Heston\ncat(\"Fitting ARIMA models to\", n_paths, \"Heston paths...\\n\")\nfor (i in 1:n_paths) {\n  y &lt;- as.numeric(martingale_increments_Heston[, i])\n  fit &lt;- forecast::auto.arima(y, allowmean = FALSE)\n  arima_models_Heston[[i]] &lt;- fit\n  \n  res &lt;- as.numeric(residuals(fit))\n  arima_residuals_Heston[, i] &lt;- res\n  \n  centre_arima_residuals &lt;- scale(res, center = TRUE, scale = FALSE)\n  means_arima_residuals_Heston[i] &lt;- attr(centre_arima_residuals, \"scaled:center\")\n  centered_arima_residuals_Heston[, i] &lt;- centre_arima_residuals[,1]\n}\n\ncat(\"\\nARIMA model summary (first 5 GBM paths):\\n\")\nfor (i in 1:min(5, n_paths)) {\n  cat(\"Path\", i, \":\", as.character(arima_models_GBM[[i]]), \"\\n\")\n}\n\n# Box-Ljung tests\npvalues_GBM &lt;- sapply(1:ncol(centered_arima_residuals_GBM), \n                  function(i) Box.test(centered_arima_residuals_GBM[,i])$p.value)\ncat(\"\\nBox-Ljung test p-values (GBM):\\n\")\ncat(\"Mean p-value:\", mean(pvalues_GBM), \"\\n\")\ncat(\"Proportion &gt; 0.05:\", mean(pvalues_GBM &gt; 0.05), \"\\n\")\n\npvalues_SVJD &lt;- sapply(1:ncol(centered_arima_residuals_SVJD), \n                  function(i) Box.test(centered_arima_residuals_SVJD[,i])$p.value)\ncat(\"\\nBox-Ljung test p-values (SVJD):\\n\")\ncat(\"Mean p-value:\", mean(pvalues_SVJD), \"\\n\")\ncat(\"Proportion &gt; 0.05:\", mean(pvalues_SVJD &gt; 0.05), \"\\n\")\n\npvalues_Heston &lt;- sapply(1:ncol(centered_arima_residuals_Heston), \n                  function(i) Box.test(centered_arima_residuals_Heston[,i])$p.value)\ncat(\"\\nBox-Ljung test p-values (Heston):\\n\")\ncat(\"Mean p-value:\", mean(pvalues_Heston), \"\\n\")\ncat(\"Proportion &gt; 0.05:\", mean(pvalues_Heston &gt; 0.05), \"\\n\")\n\npar(mfrow=c(1,3))\nhist(pvalues_GBM, breaks=20, col='lightgreen',\n     main=\"Box-Ljung P-values (GBM)\",\n     xlab=\"P-value\")\nabline(v=0.05, col='red', lwd=2, lty=2)\n\nhist(pvalues_SVJD, breaks=20, col='lightblue',\n     main=\"Box-Ljung P-values (SVJD)\",\n     xlab=\"P-value\")\nabline(v=0.05, col='red', lwd=2, lty=2)\n\nhist(pvalues_Heston, breaks=20, col='lightcoral',\n     main=\"Box-Ljung P-values (Heston)\",\n     xlab=\"P-value\")\nabline(v=0.05, col='red', lwd=2, lty=2)\npar(mfrow=c(1,1))\n\n\n## ----4-generate-rn-paths, cache=TRUE, eval=TRUE--------------------------------\n# =============================================================================\n# 5 - GENERATE RISK-NEUTRAL PATHS\n# =============================================================================\n\ncat(\"\\n\\nGenerating risk-neutral paths from ALL historical paths...\\n\")\nn_sim_per_path &lt;- 20  # Generate 10 paths per historical path\ntimes &lt;- seq(0, maturity, length.out = n_periods)\ndiscount_factor &lt;- exp(r * times)\n\n# Storage for all risk-neutral paths\nall_S_tilde_GBM &lt;- list()\nall_S_tilde_SVJD &lt;- list()\nall_S_tilde_Heston &lt;- list()\n\n# Generate GBM risk-neutral paths\nfor (i in 1:n_paths) {\n  resampled_residuals &lt;- ahead::rgaussiandens(centered_arima_residuals_GBM[, i], \n                                              p = n_sim_per_path)\n  fit &lt;- arima_models_GBM[[i]]\n  fitted_increments &lt;- as.numeric(fitted(fit))\n  \n  discounted_path &lt;- matrix(0, nrow = n_periods, ncol = n_sim_per_path)\n  discounted_path[1, ] &lt;- S0\n  \n  increments &lt;- matrix(scale(fitted_increments, center = TRUE, \n                             scale = FALSE)[,1], nrow = n_periods - 1, ncol = n_sim_per_path) + \n                resampled_residuals[1:(n_periods - 1), ]\n  \n  discounted_path[-1, ] &lt;- S0 + apply(increments, 2, cumsum)\n  S_tilde_price &lt;- discounted_path * discount_factor\n  all_S_tilde_GBM[[i]] &lt;- S_tilde_price\n}\n\n# Generate SVJD risk-neutral paths\nfor (i in 1:n_paths) {\n  resampled_residuals &lt;- ahead::rgaussiandens(centered_arima_residuals_SVJD[, i], \n                                              p = n_sim_per_path)\n  fit &lt;- arima_models_SVJD[[i]]\n  fitted_increments &lt;- as.numeric(fitted(fit))\n  \n  discounted_path &lt;- matrix(0, nrow = n_periods, ncol = n_sim_per_path)\n  discounted_path[1, ] &lt;- S0\n  \n  increments &lt;- matrix(scale(fitted_increments, center = TRUE, \n                             scale = FALSE)[,1], nrow = n_periods - 1, ncol = n_sim_per_path) + \n                resampled_residuals[1:(n_periods - 1), ]\n  \n  discounted_path[-1, ] &lt;- S0 + apply(increments, 2, cumsum)\n  S_tilde_price &lt;- discounted_path * discount_factor\n  all_S_tilde_SVJD[[i]] &lt;- S_tilde_price\n}\n\n# Generate Heston risk-neutral paths\nfor (i in 1:n_paths) {\n  resampled_residuals &lt;- ahead::rgaussiandens(centered_arima_residuals_Heston[, i], \n                                              p = n_sim_per_path)\n  fit &lt;- arima_models_Heston[[i]]\n  fitted_increments &lt;- as.numeric(fitted(fit))\n  \n  discounted_path &lt;- matrix(0, nrow = n_periods, ncol = n_sim_per_path)\n  discounted_path[1, ] &lt;- S0\n  \n  increments &lt;- matrix(scale(fitted_increments, center = TRUE, \n                             scale = FALSE)[,1], nrow = n_periods - 1, ncol = n_sim_per_path) + \n                resampled_residuals[1:(n_periods - 1), ]\n  \n  discounted_path[-1, ] &lt;- S0 + apply(increments, 2, cumsum)\n  S_tilde_price &lt;- discounted_path * discount_factor\n  all_S_tilde_Heston[[i]] &lt;- S_tilde_price\n}\n\n# Combine all paths\nS_tilde_combined_GBM &lt;- do.call(cbind, all_S_tilde_GBM)\ncat(\"Total GBM risk-neutral paths generated:\", ncol(S_tilde_combined_GBM), \"\\n\")\n\nS_tilde_combined_SVJD &lt;- do.call(cbind, all_S_tilde_SVJD)\ncat(\"Total SVJD risk-neutral paths generated:\", ncol(S_tilde_combined_SVJD), \"\\n\")\n\nS_tilde_combined_Heston &lt;- do.call(cbind, all_S_tilde_Heston)\ncat(\"Total Heston risk-neutral paths generated:\", ncol(S_tilde_combined_Heston), \"\\n\\n\")\n\n# Convert to time series\nS_tilde_ts_GBM &lt;- ts(S_tilde_combined_GBM, start = start(sim_GBM), \n                     frequency = frequency(sim_GBM))\nS_tilde_ts_SVJD &lt;- ts(S_tilde_combined_SVJD, start = start(sim_SVJD), \n                      frequency = frequency(sim_SVJD))\nS_tilde_ts_Heston &lt;- ts(S_tilde_combined_Heston, start = start(sim_Heston), \n                        frequency = frequency(sim_Heston))\n\n# Visualize risk-neutral paths\npar(mfrow=c(1,3))\nesgtoolkit::esgplotbands(S_tilde_ts_GBM, \n                        main=\"Risk-Neutral Paths - GBM\")\nesgtoolkit::esgplotbands(S_tilde_ts_SVJD, \n                        main=\"Risk-Neutral Paths - SVJD\")\nesgtoolkit::esgplotbands(S_tilde_ts_Heston, \n                        main=\"Risk-Neutral Paths - Heston\")\n\n# Sample plots\npar(mfrow=c(1,3))\nmatplot(S_tilde_combined_GBM[, sample(ncol(S_tilde_combined_GBM), 200)], \n        type='l', col=rgb(0,0,1,0.1),\n        main=\"Risk-Neutral Paths (GBM)\",\n        xlab=\"Time step\", ylab=\"Stock Price\")\nlines(rowMeans(S_tilde_combined_GBM), col='red', lwd=3)\nabline(h=S0, col='green', lwd=2, lty=2)\n\nmatplot(S_tilde_combined_SVJD[, sample(ncol(S_tilde_combined_SVJD), 200)], \n        type='l', col=rgb(0,0,1,0.1),\n        main=\"Risk-Neutral Paths (SVJD)\",\n        xlab=\"Time step\", ylab=\"Stock Price\")\nlines(rowMeans(S_tilde_combined_SVJD), col='red', lwd=3)\nabline(h=S0, col='green', lwd=2, lty=2)\n\nmatplot(S_tilde_combined_Heston[, sample(ncol(S_tilde_combined_Heston), 200)], \n        type='l', col=rgb(0,0,1,0.1),\n        main=\"Risk-Neutral Paths (Heston)\",\n        xlab=\"Time step\", ylab=\"Stock Price\")\nlines(rowMeans(S_tilde_combined_Heston), col='red', lwd=3)\nabline(h=S0, col='green', lwd=2, lty=2)\npar(mfrow=c(1,1))\n\n\n## ----5-rn-verif, cache=TRUE, eval=TRUE-----------------------------------------\n# =============================================================================\n# 6 - VERIFY RISK-NEUTRAL PROPERTY\n# =============================================================================\n\ncat(\"\\n=== RISK-NEUTRAL VERIFICATION ===\\n\\n\")\n\nterminal_prices_rn_GBM &lt;- S_tilde_combined_GBM[n_periods, ]\nterminal_prices_rn_SVJD &lt;- S_tilde_combined_SVJD[n_periods, ]\nterminal_prices_rn_Heston &lt;- S_tilde_combined_Heston[n_periods, ]\ncapitalized_stock_price &lt;- S0 * exp(r * maturity)\n\ncat(\"GBM Risk-Neutral Verification:\\n\")\ncat(\"Expected terminal price (Q):\", capitalized_stock_price, \"\\n\")\ncat(\"Empirical mean:\", mean(terminal_prices_rn_GBM), \"\\n\")\ncat(\"Difference:\", mean(terminal_prices_rn_GBM) - capitalized_stock_price, \"\\n\")\nprint(t.test(terminal_prices_rn_GBM - capitalized_stock_price))\n\ncat(\"\\nSVJD Risk-Neutral Verification:\\n\")\ncat(\"Expected terminal price (Q):\", capitalized_stock_price, \"\\n\")\ncat(\"Empirical mean:\", mean(terminal_prices_rn_SVJD), \"\\n\")\ncat(\"Difference:\", mean(terminal_prices_rn_SVJD) - capitalized_stock_price, \"\\n\")\nprint(t.test(terminal_prices_rn_SVJD - capitalized_stock_price))\n\ncat(\"\\nHeston Risk-Neutral Verification:\\n\")\ncat(\"Expected terminal price (Q):\", capitalized_stock_price, \"\\n\")\ncat(\"Empirical mean:\", mean(terminal_prices_rn_Heston), \"\\n\")\ncat(\"Difference:\", mean(terminal_prices_rn_Heston) - capitalized_stock_price, \"\\n\")\nprint(t.test(terminal_prices_rn_Heston - capitalized_stock_price))\n\n# Visualization comparison\npar(mfrow=c(3, 2))\nhist(terminal_prices_physical_GBM, breaks=30, col=rgb(1,0,0,0.5),\n     main=\"Terminal Prices: Physical (GBM)\",\n     xlab=\"Price\", xlim=c(50, 300))\nabline(v=mean(terminal_prices_physical_GBM), col='red', lwd=2)\nabline(v=S0*exp(mu*maturity), col='blue', lwd=2, lty=2)\n\nhist(terminal_prices_rn_GBM, breaks=30, col=rgb(0,0,1,0.5),\n     main=\"Terminal Prices: Risk-Neutral (GBM)\",\n     xlab=\"Price\", xlim=c(50, 300))\nabline(v=mean(terminal_prices_rn_GBM), col='blue', lwd=2)\nabline(v=S0*exp(r*maturity), col='red', lwd=2, lty=2)\n\nhist(terminal_prices_physical_SVJD, breaks=30, col=rgb(1,0,0,0.5),\n     main=\"Terminal Prices: Physical (SVJD)\",\n     xlab=\"Price\", xlim=c(50, 300))\nabline(v=mean(terminal_prices_physical_SVJD), col='red', lwd=2)\nabline(v=S0*exp(mu*maturity), col='blue', lwd=2, lty=2)\n\nhist(terminal_prices_rn_SVJD, breaks=30, col=rgb(0,0,1,0.5),\n     main=\"Terminal Prices: Risk-Neutral (SVJD)\",\n     xlab=\"Price\", xlim=c(50, 300))\nabline(v=mean(terminal_prices_rn_SVJD), col='blue', lwd=2)\nabline(v=S0*exp(r*maturity), col='red', lwd=2, lty=2)\n\nhist(terminal_prices_physical_Heston, breaks=30, col=rgb(1,0,0,0.5),\n     main=\"Terminal Prices: Physical (Heston)\",\n     xlab=\"Price\", xlim=c(50, 300))\nabline(v=mean(terminal_prices_physical_Heston), col='red', lwd=2)\nabline(v=S0*exp(mu*maturity), col='blue', lwd=2, lty=2)\n\nhist(terminal_prices_rn_Heston, breaks=30, col=rgb(0,0,1,0.5),\n     main=\"Terminal Prices: Risk-Neutral (Heston)\",\n     xlab=\"Price\", xlim=c(50, 300))\nabline(v=mean(terminal_prices_rn_Heston), col='blue', lwd=2)\nabline(v=S0*exp(r*maturity), col='red', lwd=2, lty=2)\npar(mfrow=c(1,1))\n\n\n## ----6-option-pricing, cache=TRUE, eval=TRUE-----------------------------------\n# =============================================================================\n# 7 - OPTION PRICING\n# =============================================================================\n\ncat(\"\\n=== OPTION PRICING ===\\n\\n\")\n\nbs_price &lt;- function(S, K, r, sigma, T, q = 0) {\n\n  d1 &lt;- (log(S / K) + (r - q + 0.5 * sigma^2) * T) / (sigma * sqrt(T))\n  d2 &lt;- d1 - sigma * sqrt(T)\n\n  call &lt;- S * exp(-q * T) * pnorm(d1) - K * exp(-r * T) * pnorm(d2)\n  put  &lt;- K * exp(-r * T) * pnorm(-d2) - S * exp(-q * T) * pnorm(-d1)\n\n  list(call = call, put = put)\n}\n\n\nstrikes &lt;- seq(80, 160, by=10)\nd_f &lt;- exp(-r * maturity)\n\n# Function to price options\nprice_options &lt;- function(terminal_prices, strikes, discount_factor) {\n  n_strikes &lt;- length(strikes)\n  call_prices &lt;- numeric(n_strikes)\n  bs_call_prices &lt;- numeric(n_strikes)\n  put_prices &lt;- numeric(n_strikes)\n  bs_put_prices &lt;- numeric(n_strikes)\n  call_se &lt;- numeric(n_strikes)\n  put_se &lt;- numeric(n_strikes)\n  \n  for (k in 1:n_strikes) {\n    K &lt;- strikes[k]\n    call_payoffs &lt;- pmax(terminal_prices - K, 0)\n    call_prices[k] &lt;- mean(call_payoffs) * discount_factor\n    call_se[k] &lt;- sd(call_payoffs) / sqrt(length(call_payoffs)) * discount_factor\n    \n    put_payoffs &lt;- pmax(K - terminal_prices, 0)\n    put_prices[k] &lt;- mean(put_payoffs) * discount_factor\n    put_se[k] &lt;- sd(put_payoffs) / sqrt(length(put_payoffs)) * discount_factor\n    \n    bs_prices &lt;- bs_price(S0, K, r, sigma=sigma, T=5, q = 0)\n    bs_call_prices[k] &lt;- bs_prices$call\n    bs_put_prices[k] &lt;- bs_prices$put\n  }\n  \n  list(call_prices = call_prices, put_prices = put_prices,\n       bs_call_prices = bs_call_prices, bs_put_prices = bs_put_prices,\n       call_se = call_se, put_se = put_se)\n}\n\n# Price options for all models\noptions_GBM &lt;- price_options(terminal_prices_rn_GBM, strikes, d_f)\noptions_SVJD &lt;- price_options(terminal_prices_rn_SVJD, strikes, d_f)\noptions_Heston &lt;- price_options(terminal_prices_rn_Heston, strikes, d_f)\n\n\n## ------------------------------------------------------------------------------\nkableExtra::kable(as.data.frame(options_GBM))\nkableExtra::kable(as.data.frame(options_Heston))\nkableExtra::kable(as.data.frame(options_SVJD))\n</pre>\n<p>Full code and additional details are available on GitHub:</p>\n<p><a href=\"https://github.com/thierrymoudiki/2025-12-07-risk-neutralization-with-ARIMA\" rel=\"nofollow\" target=\"_blank\">https://github.com/thierrymoudiki/2025-12-07-risk-neutralization-with-ARIMA</a></p>\n<p>The preprint of the associated research paper can be found here:</p>\n<p><a href=\"https://www.researchgate.net/publication/398427354_An_ARIMA-Based_Semi-Parametric_Approach_to_Market_Price_of_Risk_estimation_and_Risk-Neutral_Pricing\" rel=\"nofollow\" target=\"_blank\">https://www.researchgate.net/publication/398427354_An_ARIMA-Based_Semi-Parametric_Approach_to_Market_Price_of_Risk_estimation_and_Risk-Neutral_Pricing</a></p>\n<p><img alt=\"image-title-here\" class=\"img-responsive\" data-lazy-src=\"https://i1.wp.com/thierrymoudiki.github.io/images/2025-12-07/2025-12-07-image1.png?w=578&amp;ssl=1\" data-recalc-dims=\"1\" src=\"https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/lazy-images/images/1x1.trans.gif\"/><noscript><img alt=\"image-title-here\" class=\"img-responsive\" data-recalc-dims=\"1\" src=\"https://i1.wp.com/thierrymoudiki.github.io/images/2025-12-07/2025-12-07-image1.png?w=578&amp;ssl=1\"/></noscript></p>\n<div class=\"jp-relatedposts\" id=\"jp-relatedposts\">\n<h3 class=\"jp-relatedposts-headline\"><em>Related</em></h3>\n</div>\n<!-- Share buttons by mashshare.net - Version: 4.0.47-->\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://thierrymoudiki.github.io//blog/2025/12/07/r/forecasting/ARIMA-Pricing\"> T. Moudiki's Webpage - R</a></strong>.</div>\n<hr/>\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a href=\"https://www.r-project.org/\" rel=\"nofollow\" title=\"The R Project for Statistical Computing\">R</a> news and tutorials about <a href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\" title=\"R tutorials\">learning R</a> and many other topics. <a href=\"https://www.r-users.com/\" rel=\"nofollow\" title=\"Data science jobs\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr/>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div> </div>\n</article>",
    "main_text": "ARIMA-Black-Scholes: Semi-Parametric Market price of risk for Risk-Neutral Pricing (code + preprint)\nPosted on\nDecember 6, 2025\nby\nT. Moudiki\nin\nR bloggers\n| 0 Comments\n[This article was first published on\nT. Moudiki's Webpage - R\n, and kindly contributed to\nR-bloggers\n].  (You can report issue about the content on this page\nhere\n)\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.\nIn quantitative finance, pricing derivatives often requires working under a\nrisk-neutral measure\n(Q) rather than the real-world\nphysical measure\n(P). While the Girsanov theorem provides a theoretical framework for this change of measure, practical implementation can be challenging—especially for complex models like stochastic volatility with jumps.\nThis blog post demonstrates a\nsemi-parametric approach\nthat bridges classical time series modeling with risk-neutral pricing. We’ll show how to:\nSimulate\nstock price paths under three different models (GBM, SVJD, Heston) using the physical measure\nExtract\nthe risk premium using ARIMA modeling\nTransform\nphysical paths to risk-neutral paths through residual resampling\nPrice\nEuropean options under the risk-neutral measure\nModels Compared\nGeometric Brownian Motion (GBM)\n: The classic Black-Scholes model with constant volatility\nStochastic Volatility Jump Diffusion (SVJD)\n: Incorporates both stochastic volatility and price jumps\nHeston Model\n: Stochastic volatility without jumps (a special case of SVJD)\nMethodological Approach\nOur semi-parametric method involves:\nPhysical Simulation\n: Generate paths under the real-world measure with expected return μ\nRisk Premium Extraction\n: Fit ARIMA models to discounted price increments to capture serial dependence\nResidual Resampling\n: Use Gaussian density estimation to resample centered ARIMA residuals\nRisk-Neutral Path Generation\n: Combine fitted ARIMA models with resampled residuals to create martingale paths\nOption Pricing\n: Compute option prices as discounted expected payoffs under Q\nR Packages Used\nesgtoolkit\n: For financial simulations and risk-neutral transformations\nahead\n: For time series forecasting and residual resampling\nforecast\n(\nauto.arima\n): For automatic ARIMA model selection\nThe complete reproducible code is presented below, organized in logical sections from simulation to option pricing.\n## ----setup, include=FALSE------------------------------------------------------\nknitr::opts_chunk$set(echo = TRUE)\n\n## ----1-simulate-SVJD, cache=TRUE-----------------------------------------------\n# ARIMA-Black-Scholes: Semi-Parametric Risk-Neutral Pricing\n# T. Moudiki\n# 2025-12-04\n\nlibrary(esgtoolkit)\nlibrary(forecast)\nlibrary(ahead)\n\n# =============================================================================\n# 1 - SVJD SIMULATION (Physical Measure)\n# =============================================================================\n\nset.seed(123)\nn <- 250L\nh <- 5\nfreq <- \"daily\"\nr <- 0.05\nmaturity <- 5\nS0 <- 100\nmu <- 0.08\nsigma <- 0.04\n\n# Simulate under physical measure with stochastic volatility and jumps\nsim_GBM <- esgtoolkit::simdiff(n=n, horizon = h, frequency = freq, x0=S0, theta1 = mu, theta2 = sigma)\nsim_SVJD <- esgtoolkit::rsvjd(n=n, r0=mu)\nsim_Heston <- esgtoolkit::rsvjd(n=n, r0=mu, \n                                lambda = 0,\n                                mu_J = 0,\n                                sigma_J = 0)\n\ncat(\"Simulation dimensions:\\n\")\ncat(\"Start:\", start(sim_SVJD), \"\\n\")\ncat(\"End:\", end(sim_SVJD), \"\\n\")\ncat(\"Paths:\", ncol(sim_SVJD), \"\\n\")\ncat(\"Time steps:\", nrow(sim_SVJD), \"\\n\\n\")\n\npar(mfrow=c(1, 3))\n# Plot historical (physical measure) paths\nesgtoolkit::esgplotbands(sim_GBM, main=\"GBM Paths under the Physical Measure\", \n                         xlab=\"Time\",\n                         ylab=\"Stock prices\")\nesgtoolkit::esgplotbands(sim_SVJD, main=\"SVJD Paths under the Physical Measure\", \n                         xlab=\"Time\",\n                         ylab=\"Stock prices\")\nesgtoolkit::esgplotbands(sim_Heston, main=\"Heston Paths under the Physical Measure\", \n                         xlab=\"Time\",\n                         ylab=\"Stock prices\")                         \n\n# Summary statistics\ncat(\"Physical measure statistics (GBM):\\n\")\nterminal_prices_physical_GBM <- sim_GBM[nrow(sim_GBM), ]\ncat(\"Mean terminal price:\", mean(terminal_prices_physical_GBM), \"\\n\")\ncat(\"Std terminal price:\", sd(terminal_prices_physical_GBM), \"\\n\")\ncat(\"Expected under P:\", S0 * exp(mu * maturity), \"\\n\\n\")\n \ncat(\"Physical measure statistics (SVJD):\\n\")\nterminal_prices_physical_SVJD <- sim_SVJD[nrow(sim_SVJD), ]\ncat(\"Mean terminal price:\", mean(terminal_prices_physical_SVJD), \"\\n\")\ncat(\"Std terminal price:\", sd(terminal_prices_physical_SVJD), \"\\n\")\ncat(\"Expected under P:\", S0 * exp(mu * maturity), \"\\n\\n\")\n\ncat(\"Physical measure statistics (Heston):\\n\")\nterminal_prices_physical_Heston <- sim_Heston[nrow(sim_Heston), ]\ncat(\"Mean terminal price:\", mean(terminal_prices_physical_Heston), \"\\n\")\ncat(\"Std terminal price:\", sd(terminal_prices_physical_Heston), \"\\n\")\ncat(\"Expected under P:\", S0 * exp(mu * maturity), \"\\n\\n\")\n\n## ----2-compute-discounted, cache=TRUE------------------------------------------\n# =============================================================================\n# 2 - COMPUTE DISCOUNTED PRICES (Transform to Martingale Domain)\n# =============================================================================\n\ndiscounted_prices_GBM <- esgtoolkit::esgdiscountfactor(r=r, X=sim_GBM)\ndiscounted_prices_SVJD <- esgtoolkit::esgdiscountfactor(r=r, X=sim_SVJD)\ndiscounted_prices_Heston <- esgtoolkit::esgdiscountfactor(r=r, X=sim_Heston)\nmartingale_diff_GBM <- discounted_prices_GBM - S0 \nmartingale_diff_SVJD <- discounted_prices_SVJD - S0 \nmartingale_diff_Heston <- discounted_prices_Heston - S0 \n\ncat(\"Martingale differences dimensions (GBM):\", dim(martingale_diff_GBM), \"\\n\")\ncat(\"Mean martingale diff (should be ≠ 0 under P):\\n\")\nprint(t.test(rowMeans(martingale_diff_GBM)))\n\ncat(\"\\nMartingale differences dimensions (SVJD):\", dim(martingale_diff_SVJD), \"\\n\")\ncat(\"Mean martingale diff (should be ≠ 0 under P):\\n\")\nprint(t.test(rowMeans(martingale_diff_SVJD)))\n\ncat(\"\\nMartingale differences dimensions (Heston):\", dim(martingale_diff_Heston), \"\\n\")\ncat(\"Mean martingale diff (should be ≠ 0 under P):\\n\")\nprint(t.test(rowMeans(martingale_diff_Heston)))\n\n# =============================================================================\n# 3 - VISUALIZE RISK PREMIUM\n# =============================================================================\n\npar(mfrow=c(2,2))\n\nmatplot(discounted_prices_GBM, type='l', col=rgb(0,0,1,0.3),\n        main=\"Discounted Stock Prices (Physical Measure - GBM)\",\n        ylab=\"exp(-rt) * S_t\", xlab=\"Time step\")\nabline(h=S0, col='red', lwd=2, lty=2)\n\nmatplot(discounted_prices_SVJD, type='l', col=rgb(0,0,1,0.3),\n        main=\"Discounted Stock Prices (Physical Measure - SVJD)\",\n        ylab=\"exp(-rt) * S_t\", xlab=\"Time step\")\nabline(h=S0, col='red', lwd=2, lty=2)\n\nmatplot(discounted_prices_Heston, type='l', col=rgb(0,0,1,0.3),\n        main=\"Discounted Stock Prices (Physical Measure - Heston)\",\n        ylab=\"exp(-rt) * S_t\", xlab=\"Time step\")\nabline(h=S0, col='red', lwd=2, lty=2)\n\npar(mfrow=c(1,1))\n\nmean_disc_path_GBM <- rowMeans(discounted_prices_GBM)\ntimes_plot <- as.numeric(time(discounted_prices_GBM)) \nplot(times_plot, mean_disc_path_GBM, type='l', lwd=2, col='blue',\n     main=\"Risk Premium in Discounted Prices (GBM)\",\n     xlab=\"Time (years)\", ylab=\"E[exp(-rt)*S_t]\")\nabline(h=S0, col='red', lwd=2, lty=2)\nlines(times_plot, S0 * exp((mu-r)*times_plot), col='green', lwd=2, lty=3)\nlegend(\"topleft\",\n       legend=c(\"Empirical mean\", \"S0\", \"Theoretical (μ-r drift)\"),\n       col=c('blue','red','green'), lty=c(1,2,3), lwd=2)\n\nmean_disc_path_SVJD <- rowMeans(discounted_prices_SVJD)\ntimes_plot <- as.numeric(time(discounted_prices_SVJD)) \nplot(times_plot, mean_disc_path_SVJD, type='l', lwd=2, col='blue',\n     main=\"Risk Premium in Discounted Prices (SVJD)\",\n     xlab=\"Time (years)\", ylab=\"E[exp(-rt)*S_t]\")\nabline(h=S0, col='red', lwd=2, lty=2)\nlines(times_plot, S0 * exp((mu-r)*times_plot), col='green', lwd=2, lty=3)\nlegend(\"topleft\",\n       legend=c(\"Empirical mean\", \"S0\", \"Theoretical (μ-r drift)\"),\n       col=c('blue','red','green'), lty=c(1,2,3), lwd=2)\n\nmean_disc_path_Heston <- rowMeans(discounted_prices_Heston)\ntimes_plot <- as.numeric(time(discounted_prices_Heston)) \nplot(times_plot, mean_disc_path_Heston, type='l', lwd=2, col='blue',\n     main=\"Risk Premium in Discounted Prices (Heston)\",\n     xlab=\"Time (years)\", ylab=\"E[exp(-rt)*S_t]\")\nabline(h=S0, col='red', lwd=2, lty=2)\nlines(times_plot, S0 * exp((mu-r)*times_plot), col='green', lwd=2, lty=3)\nlegend(\"topleft\",\n       legend=c(\"Empirical mean\", \"S0\", \"Theoretical (μ-r drift)\"),\n       col=c('blue','red','green'), lty=c(1,2,3), lwd=2)     \n\n## ----3-fit-ARIMA, cache=TRUE, eval=TRUE----------------------------------------\n# =============================================================================\n# 4 - FIT ARIMA MODELS TO EXTRACT RISK PREMIUM\n# =============================================================================\n\nn_periods <- nrow(martingale_diff_GBM)\nn_paths <- ncol(martingale_diff_GBM)\n\nmartingale_increments_GBM <- diff(martingale_diff_GBM)\nmartingale_increments_SVJD <- diff(martingale_diff_SVJD)\nmartingale_increments_Heston <- diff(martingale_diff_Heston)\n\n# Initialize storage arrays\narima_residuals_GBM <- array(NA, dim = c(nrow(martingale_increments_GBM), n_paths))\ncentered_arima_residuals_GBM <- array(NA, dim = c(nrow(martingale_increments_GBM), n_paths))\nmeans_arima_residuals_GBM <- rep(NA, n_paths)\narima_models_GBM <- list()\n\narima_residuals_SVJD <- array(NA, dim = c(nrow(martingale_increments_SVJD), n_paths))\ncentered_arima_residuals_SVJD <- array(NA, dim = c(nrow(martingale_increments_SVJD), n_paths))\nmeans_arima_residuals_SVJD <- rep(NA, n_paths)\narima_models_SVJD <- list()\n\narima_residuals_Heston <- array(NA, dim = c(nrow(martingale_increments_Heston), n_paths))\ncentered_arima_residuals_Heston <- array(NA, dim = c(nrow(martingale_increments_Heston), n_paths))\nmeans_arima_residuals_Heston <- rep(NA, n_paths)\narima_models_Heston <- list()\n\n# Fit ARIMA models to GBM\ncat(\"Fitting ARIMA models to\", n_paths, \"GBM paths...\\n\")\nfor (i in 1:n_paths) {\n  y <- as.numeric(martingale_increments_GBM[, i])\n  fit <- forecast::auto.arima(y, allowmean = FALSE)\n  arima_models_GBM[[i]] <- fit\n  \n  res <- as.numeric(residuals(fit))\n  arima_residuals_GBM[, i] <- res\n  \n  centre_arima_residuals <- scale(res, center = TRUE, scale = FALSE)\n  means_arima_residuals_GBM[i] <- attr(centre_arima_residuals, \"scaled:center\")\n  centered_arima_residuals_GBM[, i] <- centre_arima_residuals[,1]\n}\n\n# Fit ARIMA models to SVJD\ncat(\"Fitting ARIMA models to\", n_paths, \"SVJD paths...\\n\")\nfor (i in 1:n_paths) {\n  y <- as.numeric(martingale_increments_SVJD[, i])\n  fit <- forecast::auto.arima(y, allowmean = FALSE)\n  arima_models_SVJD[[i]] <- fit\n  \n  res <- as.numeric(residuals(fit))\n  arima_residuals_SVJD[, i] <- res\n  \n  centre_arima_residuals <- scale(res, center = TRUE, scale = FALSE)\n  means_arima_residuals_SVJD[i] <- attr(centre_arima_residuals, \"scaled:center\")\n  centered_arima_residuals_SVJD[, i] <- centre_arima_residuals[,1]\n}\n\n# Fit ARIMA models to Heston\ncat(\"Fitting ARIMA models to\", n_paths, \"Heston paths...\\n\")\nfor (i in 1:n_paths) {\n  y <- as.numeric(martingale_increments_Heston[, i])\n  fit <- forecast::auto.arima(y, allowmean = FALSE)\n  arima_models_Heston[[i]] <- fit\n  \n  res <- as.numeric(residuals(fit))\n  arima_residuals_Heston[, i] <- res\n  \n  centre_arima_residuals <- scale(res, center = TRUE, scale = FALSE)\n  means_arima_residuals_Heston[i] <- attr(centre_arima_residuals, \"scaled:center\")\n  centered_arima_residuals_Heston[, i] <- centre_arima_residuals[,1]\n}\n\ncat(\"\\nARIMA model summary (first 5 GBM paths):\\n\")\nfor (i in 1:min(5, n_paths)) {\n  cat(\"Path\", i, \":\", as.character(arima_models_GBM[[i]]), \"\\n\")\n}\n\n# Box-Ljung tests\npvalues_GBM <- sapply(1:ncol(centered_arima_residuals_GBM), \n                  function(i) Box.test(centered_arima_residuals_GBM[,i])$p.value)\ncat(\"\\nBox-Ljung test p-values (GBM):\\n\")\ncat(\"Mean p-value:\", mean(pvalues_GBM), \"\\n\")\ncat(\"Proportion > 0.05:\", mean(pvalues_GBM > 0.05), \"\\n\")\n\npvalues_SVJD <- sapply(1:ncol(centered_arima_residuals_SVJD), \n                  function(i) Box.test(centered_arima_residuals_SVJD[,i])$p.value)\ncat(\"\\nBox-Ljung test p-values (SVJD):\\n\")\ncat(\"Mean p-value:\", mean(pvalues_SVJD), \"\\n\")\ncat(\"Proportion > 0.05:\", mean(pvalues_SVJD > 0.05), \"\\n\")\n\npvalues_Heston <- sapply(1:ncol(centered_arima_residuals_Heston), \n                  function(i) Box.test(centered_arima_residuals_Heston[,i])$p.value)\ncat(\"\\nBox-Ljung test p-values (Heston):\\n\")\ncat(\"Mean p-value:\", mean(pvalues_Heston), \"\\n\")\ncat(\"Proportion > 0.05:\", mean(pvalues_Heston > 0.05), \"\\n\")\n\npar(mfrow=c(1,3))\nhist(pvalues_GBM, breaks=20, col='lightgreen',\n     main=\"Box-Ljung P-values (GBM)\",\n     xlab=\"P-value\")\nabline(v=0.05, col='red', lwd=2, lty=2)\n\nhist(pvalues_SVJD, breaks=20, col='lightblue',\n     main=\"Box-Ljung P-values (SVJD)\",\n     xlab=\"P-value\")\nabline(v=0.05, col='red', lwd=2, lty=2)\n\nhist(pvalues_Heston, breaks=20, col='lightcoral',\n     main=\"Box-Ljung P-values (Heston)\",\n     xlab=\"P-value\")\nabline(v=0.05, col='red', lwd=2, lty=2)\npar(mfrow=c(1,1))\n\n## ----4-generate-rn-paths, cache=TRUE, eval=TRUE--------------------------------\n# =============================================================================\n# 5 - GENERATE RISK-NEUTRAL PATHS\n# =============================================================================\n\ncat(\"\\n\\nGenerating risk-neutral paths from ALL historical paths...\\n\")\nn_sim_per_path <- 20  # Generate 10 paths per historical path\ntimes <- seq(0, maturity, length.out = n_periods)\ndiscount_factor <- exp(r * times)\n\n# Storage for all risk-neutral paths\nall_S_tilde_GBM <- list()\nall_S_tilde_SVJD <- list()\nall_S_tilde_Heston <- list()\n\n# Generate GBM risk-neutral paths\nfor (i in 1:n_paths) {\n  resampled_residuals <- ahead::rgaussiandens(centered_arima_residuals_GBM[, i], \n                                              p = n_sim_per_path)\n  fit <- arima_models_GBM[[i]]\n  fitted_increments <- as.numeric(fitted(fit))\n  \n  discounted_path <- matrix(0, nrow = n_periods, ncol = n_sim_per_path)\n  discounted_path[1, ] <- S0\n  \n  increments <- matrix(scale(fitted_increments, center = TRUE, \n                             scale = FALSE)[,1], nrow = n_periods - 1, ncol = n_sim_per_path) + \n                resampled_residuals[1:(n_periods - 1), ]\n  \n  discounted_path[-1, ] <- S0 + apply(increments, 2, cumsum)\n  S_tilde_price <- discounted_path * discount_factor\n  all_S_tilde_GBM[[i]] <- S_tilde_price\n}\n\n# Generate SVJD risk-neutral paths\nfor (i in 1:n_paths) {\n  resampled_residuals <- ahead::rgaussiandens(centered_arima_residuals_SVJD[, i], \n                                              p = n_sim_per_path)\n  fit <- arima_models_SVJD[[i]]\n  fitted_increments <- as.numeric(fitted(fit))\n  \n  discounted_path <- matrix(0, nrow = n_periods, ncol = n_sim_per_path)\n  discounted_path[1, ] <- S0\n  \n  increments <- matrix(scale(fitted_increments, center = TRUE, \n                             scale = FALSE)[,1], nrow = n_periods - 1, ncol = n_sim_per_path) + \n                resampled_residuals[1:(n_periods - 1), ]\n  \n  discounted_path[-1, ] <- S0 + apply(increments, 2, cumsum)\n  S_tilde_price <- discounted_path * discount_factor\n  all_S_tilde_SVJD[[i]] <- S_tilde_price\n}\n\n# Generate Heston risk-neutral paths\nfor (i in 1:n_paths) {\n  resampled_residuals <- ahead::rgaussiandens(centered_arima_residuals_Heston[, i], \n                                              p = n_sim_per_path)\n  fit <- arima_models_Heston[[i]]\n  fitted_increments <- as.numeric(fitted(fit))\n  \n  discounted_path <- matrix(0, nrow = n_periods, ncol = n_sim_per_path)\n  discounted_path[1, ] <- S0\n  \n  increments <- matrix(scale(fitted_increments, center = TRUE, \n                             scale = FALSE)[,1], nrow = n_periods - 1, ncol = n_sim_per_path) + \n                resampled_residuals[1:(n_periods - 1), ]\n  \n  discounted_path[-1, ] <- S0 + apply(increments, 2, cumsum)\n  S_tilde_price <- discounted_path * discount_factor\n  all_S_tilde_Heston[[i]] <- S_tilde_price\n}\n\n# Combine all paths\nS_tilde_combined_GBM <- do.call(cbind, all_S_tilde_GBM)\ncat(\"Total GBM risk-neutral paths generated:\", ncol(S_tilde_combined_GBM), \"\\n\")\n\nS_tilde_combined_SVJD <- do.call(cbind, all_S_tilde_SVJD)\ncat(\"Total SVJD risk-neutral paths generated:\", ncol(S_tilde_combined_SVJD), \"\\n\")\n\nS_tilde_combined_Heston <- do.call(cbind, all_S_tilde_Heston)\ncat(\"Total Heston risk-neutral paths generated:\", ncol(S_tilde_combined_Heston), \"\\n\\n\")\n\n# Convert to time series\nS_tilde_ts_GBM <- ts(S_tilde_combined_GBM, start = start(sim_GBM), \n                     frequency = frequency(sim_GBM))\nS_tilde_ts_SVJD <- ts(S_tilde_combined_SVJD, start = start(sim_SVJD), \n                      frequency = frequency(sim_SVJD))\nS_tilde_ts_Heston <- ts(S_tilde_combined_Heston, start = start(sim_Heston), \n                        frequency = frequency(sim_Heston))\n\n# Visualize risk-neutral paths\npar(mfrow=c(1,3))\nesgtoolkit::esgplotbands(S_tilde_ts_GBM, \n                        main=\"Risk-Neutral Paths - GBM\")\nesgtoolkit::esgplotbands(S_tilde_ts_SVJD, \n                        main=\"Risk-Neutral Paths - SVJD\")\nesgtoolkit::esgplotbands(S_tilde_ts_Heston, \n                        main=\"Risk-Neutral Paths - Heston\")\n\n# Sample plots\npar(mfrow=c(1,3))\nmatplot(S_tilde_combined_GBM[, sample(ncol(S_tilde_combined_GBM), 200)], \n        type='l', col=rgb(0,0,1,0.1),\n        main=\"Risk-Neutral Paths (GBM)\",\n        xlab=\"Time step\", ylab=\"Stock Price\")\nlines(rowMeans(S_tilde_combined_GBM), col='red', lwd=3)\nabline(h=S0, col='green', lwd=2, lty=2)\n\nmatplot(S_tilde_combined_SVJD[, sample(ncol(S_tilde_combined_SVJD), 200)], \n        type='l', col=rgb(0,0,1,0.1),\n        main=\"Risk-Neutral Paths (SVJD)\",\n        xlab=\"Time step\", ylab=\"Stock Price\")\nlines(rowMeans(S_tilde_combined_SVJD), col='red', lwd=3)\nabline(h=S0, col='green', lwd=2, lty=2)\n\nmatplot(S_tilde_combined_Heston[, sample(ncol(S_tilde_combined_Heston), 200)], \n        type='l', col=rgb(0,0,1,0.1),\n        main=\"Risk-Neutral Paths (Heston)\",\n        xlab=\"Time step\", ylab=\"Stock Price\")\nlines(rowMeans(S_tilde_combined_Heston), col='red', lwd=3)\nabline(h=S0, col='green', lwd=2, lty=2)\npar(mfrow=c(1,1))\n\n## ----5-rn-verif, cache=TRUE, eval=TRUE-----------------------------------------\n# =============================================================================\n# 6 - VERIFY RISK-NEUTRAL PROPERTY\n# =============================================================================\n\ncat(\"\\n=== RISK-NEUTRAL VERIFICATION ===\\n\\n\")\n\nterminal_prices_rn_GBM <- S_tilde_combined_GBM[n_periods, ]\nterminal_prices_rn_SVJD <- S_tilde_combined_SVJD[n_periods, ]\nterminal_prices_rn_Heston <- S_tilde_combined_Heston[n_periods, ]\ncapitalized_stock_price <- S0 * exp(r * maturity)\n\ncat(\"GBM Risk-Neutral Verification:\\n\")\ncat(\"Expected terminal price (Q):\", capitalized_stock_price, \"\\n\")\ncat(\"Empirical mean:\", mean(terminal_prices_rn_GBM), \"\\n\")\ncat(\"Difference:\", mean(terminal_prices_rn_GBM) - capitalized_stock_price, \"\\n\")\nprint(t.test(terminal_prices_rn_GBM - capitalized_stock_price))\n\ncat(\"\\nSVJD Risk-Neutral Verification:\\n\")\ncat(\"Expected terminal price (Q):\", capitalized_stock_price, \"\\n\")\ncat(\"Empirical mean:\", mean(terminal_prices_rn_SVJD), \"\\n\")\ncat(\"Difference:\", mean(terminal_prices_rn_SVJD) - capitalized_stock_price, \"\\n\")\nprint(t.test(terminal_prices_rn_SVJD - capitalized_stock_price))\n\ncat(\"\\nHeston Risk-Neutral Verification:\\n\")\ncat(\"Expected terminal price (Q):\", capitalized_stock_price, \"\\n\")\ncat(\"Empirical mean:\", mean(terminal_prices_rn_Heston), \"\\n\")\ncat(\"Difference:\", mean(terminal_prices_rn_Heston) - capitalized_stock_price, \"\\n\")\nprint(t.test(terminal_prices_rn_Heston - capitalized_stock_price))\n\n# Visualization comparison\npar(mfrow=c(3, 2))\nhist(terminal_prices_physical_GBM, breaks=30, col=rgb(1,0,0,0.5),\n     main=\"Terminal Prices: Physical (GBM)\",\n     xlab=\"Price\", xlim=c(50, 300))\nabline(v=mean(terminal_prices_physical_GBM), col='red', lwd=2)\nabline(v=S0*exp(mu*maturity), col='blue', lwd=2, lty=2)\n\nhist(terminal_prices_rn_GBM, breaks=30, col=rgb(0,0,1,0.5),\n     main=\"Terminal Prices: Risk-Neutral (GBM)\",\n     xlab=\"Price\", xlim=c(50, 300))\nabline(v=mean(terminal_prices_rn_GBM), col='blue', lwd=2)\nabline(v=S0*exp(r*maturity), col='red', lwd=2, lty=2)\n\nhist(terminal_prices_physical_SVJD, breaks=30, col=rgb(1,0,0,0.5),\n     main=\"Terminal Prices: Physical (SVJD)\",\n     xlab=\"Price\", xlim=c(50, 300))\nabline(v=mean(terminal_prices_physical_SVJD), col='red', lwd=2)\nabline(v=S0*exp(mu*maturity), col='blue', lwd=2, lty=2)\n\nhist(terminal_prices_rn_SVJD, breaks=30, col=rgb(0,0,1,0.5),\n     main=\"Terminal Prices: Risk-Neutral (SVJD)\",\n     xlab=\"Price\", xlim=c(50, 300))\nabline(v=mean(terminal_prices_rn_SVJD), col='blue', lwd=2)\nabline(v=S0*exp(r*maturity), col='red', lwd=2, lty=2)\n\nhist(terminal_prices_physical_Heston, breaks=30, col=rgb(1,0,0,0.5),\n     main=\"Terminal Prices: Physical (Heston)\",\n     xlab=\"Price\", xlim=c(50, 300))\nabline(v=mean(terminal_prices_physical_Heston), col='red', lwd=2)\nabline(v=S0*exp(mu*maturity), col='blue', lwd=2, lty=2)\n\nhist(terminal_prices_rn_Heston, breaks=30, col=rgb(0,0,1,0.5),\n     main=\"Terminal Prices: Risk-Neutral (Heston)\",\n     xlab=\"Price\", xlim=c(50, 300))\nabline(v=mean(terminal_prices_rn_Heston), col='blue', lwd=2)\nabline(v=S0*exp(r*maturity), col='red', lwd=2, lty=2)\npar(mfrow=c(1,1))\n\n## ----6-option-pricing, cache=TRUE, eval=TRUE-----------------------------------\n# =============================================================================\n# 7 - OPTION PRICING\n# =============================================================================\n\ncat(\"\\n=== OPTION PRICING ===\\n\\n\")\n\nbs_price <- function(S, K, r, sigma, T, q = 0) {\n\n  d1 <- (log(S / K) + (r - q + 0.5 * sigma^2) * T) / (sigma * sqrt(T))\n  d2 <- d1 - sigma * sqrt(T)\n\n  call <- S * exp(-q * T) * pnorm(d1) - K * exp(-r * T) * pnorm(d2)\n  put  <- K * exp(-r * T) * pnorm(-d2) - S * exp(-q * T) * pnorm(-d1)\n\n  list(call = call, put = put)\n}\n\nstrikes <- seq(80, 160, by=10)\nd_f <- exp(-r * maturity)\n\n# Function to price options\nprice_options <- function(terminal_prices, strikes, discount_factor) {\n  n_strikes <- length(strikes)\n  call_prices <- numeric(n_strikes)\n  bs_call_prices <- numeric(n_strikes)\n  put_prices <- numeric(n_strikes)\n  bs_put_prices <- numeric(n_strikes)\n  call_se <- numeric(n_strikes)\n  put_se <- numeric(n_strikes)\n  \n  for (k in 1:n_strikes) {\n    K <- strikes[k]\n    call_payoffs <- pmax(terminal_prices - K, 0)\n    call_prices[k] <- mean(call_payoffs) * discount_factor\n    call_se[k] <- sd(call_payoffs) / sqrt(length(call_payoffs)) * discount_factor\n    \n    put_payoffs <- pmax(K - terminal_prices, 0)\n    put_prices[k] <- mean(put_payoffs) * discount_factor\n    put_se[k] <- sd(put_payoffs) / sqrt(length(put_payoffs)) * discount_factor\n    \n    bs_prices <- bs_price(S0, K, r, sigma=sigma, T=5, q = 0)\n    bs_call_prices[k] <- bs_prices$call\n    bs_put_prices[k] <- bs_prices$put\n  }\n  \n  list(call_prices = call_prices, put_prices = put_prices,\n       bs_call_prices = bs_call_prices, bs_put_prices = bs_put_prices,\n       call_se = call_se, put_se = put_se)\n}\n\n# Price options for all models\noptions_GBM <- price_options(terminal_prices_rn_GBM, strikes, d_f)\noptions_SVJD <- price_options(terminal_prices_rn_SVJD, strikes, d_f)\noptions_Heston <- price_options(terminal_prices_rn_Heston, strikes, d_f)\n\n## ------------------------------------------------------------------------------\nkableExtra::kable(as.data.frame(options_GBM))\nkableExtra::kable(as.data.frame(options_Heston))\nkableExtra::kable(as.data.frame(options_SVJD))\nFull code and additional details are available on GitHub:\nhttps://github.com/thierrymoudiki/2025-12-07-risk-neutralization-with-ARIMA\nThe preprint of the associated research paper can be found here:\nhttps://www.researchgate.net/publication/398427354_An_ARIMA-Based_Semi-Parametric_Approach_to_Market_Price_of_Risk_estimation_and_Risk-Neutral_Pricing\nRelated\nTo\nleave a comment\nfor the author, please follow the link and comment on their blog:\nT. Moudiki's Webpage - R\n.\nR-bloggers.com\noffers\ndaily e-mail updates\nabout\nR\nnews and tutorials about\nlearning R\nand many other topics.\nClick here if you're looking to post or find an R/data-science job\n.\nWant to share your content on R-bloggers?\nclick here\nif you have a blog, or\nhere\nif you don't.",
    "meta_description": "The post demonstrates a semi-parametric approach using ARIMA models to extract the market price of risk from physical stock price simulations and transform them into risk-neutral paths for option pricing.",
    "meta_keywords": null,
    "og_description": "The post demonstrates a semi-parametric approach using ARIMA models to extract the market price of risk from physical stock price simulations and transform them into risk-neutral paths for option pricing.",
    "og_image": "https://thierrymoudiki.github.io/images/2025-12-07/2025-12-07-image1.png",
    "og_title": "ARIMA-Black-Scholes: Semi-Parametric Market price of risk for Risk-Neutral Pricing (code + preprint) | R-bloggers",
    "raw_jsonld_article": null,
    "reading_time_min": 14.1,
    "sitemap_lastmod": null,
    "twitter_description": "The post demonstrates a semi-parametric approach using ARIMA models to extract the market price of risk from physical stock price simulations and transform them into risk-neutral paths for option pricing.",
    "twitter_title": "ARIMA-Black-Scholes: Semi-Parametric Market price of risk for Risk-Neutral Pricing (code + preprint) | R-bloggers",
    "url": "https://www.r-bloggers.com/2025/12/arima-black-scholes-semi-parametric-market-price-of-risk-for-risk-neutral-pricing-code-preprint/",
    "word_count": 2827
  }
}